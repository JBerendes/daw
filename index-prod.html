<!DOCTYPE html>
<html lang="en">
<head>
<title>GridSound</title>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, user-scalable=no"/>
<meta name="description" content="A free and Open-Source DAW (digital audio workstation)"/>
<meta name="google" content="notranslate"/>
<meta property="og:type" content="website"/>
<meta property="og:title" content="GridSound"/>
<meta property="og:url" content="https://gridsound.com/daw/"/>
<meta property="og:image" content="https://gridsound.com/assets/og-image.jpg"/>
<meta property="og:image:width" content="800"/>
<meta property="og:image:height" content="400"/>
<meta property="og:description" content="a free and open source DAW (digital audio workstation)"/>
<meta name="theme-color" content="#3a5158"/>
<link rel="manifest" href="manifest.json"/>
<link rel="shortcut icon" href="/assets/favicon.png"/>
<style>
@keyframes splashScreen-textAnim{0%{background-color:rgba(var(--gsui-rgb-gain),.2)}to{background-color:transparent}}@keyframes gsuiIcon-spin{0%{transform:rotate(0deg)}to{transform:rotate(360deg)}}@keyframes gsuiDrumrow-startCursor-anim{0%{left:-100%}to{left:100%}}@keyframes gsuiLibrary-sample-loading-anim{0%{background-color:none}to{background-color:var(--gsuiLibrary-sample-hover-bg)}}:root{--gsui-font:"Montserrat", sans-serif;--gsui-font-title:"Oswald", var( --gsui-font );--gsui-font-monospace:"Inconsolata", "consolas", monospace;--gsui-font-number:"Unica One", var( --gsui-font-monospace )}@font-face{font-family:"FontAwesome";font-style:normal;font-weight:400;src:url(/assets/fonts/fa-duotone-900.woff2)}@font-face{font-family:"FontAwesomeBrands";font-style:normal;font-weight:400;src:url(/assets/fonts/fa-brands-400.woff2)}@font-face{font-family:"Oswald";font-style:normal;font-weight:400;src:local("Oswald Regular"),local("Oswald-Regular"),url(/assets/fonts/oswald-400-latin.woff2)format("woff2");unicode-range:u+0000-00ff,u+0131,u+0152-0153,u+02bb-02bc,u+02c6,u+02da,u+02dc,u+2000-206f,u+2074,u+20ac,u+2122,u+2191,u+2193,u+2212,u+2215,u+feff,u+fffd}@font-face{font-family:"Unica One";font-style:normal;font-weight:400;src:local("Unica One"),local("UnicaOne-Regular"),url(/assets/fonts/unica-one-400-latin.woff2)format("woff2");unicode-range:u+0000-00ff,u+0131,u+0152-0153,u+02bb-02bc,u+02c6,u+02da,u+02dc,u+2000-206f,u+2074,u+20ac,u+2122,u+2191,u+2193,u+2212,u+2215,u+feff,u+fffd}@font-face{font-family:"Inconsolata";font-style:normal;font-weight:400;src:local("Inconsolata Regular"),local("Inconsolata-Regular"),url(/assets/fonts/inconsolata-400-latin.woff2)format("woff2");unicode-range:u+0000-00ff,u+0131,u+0152-0153,u+02bb-02bc,u+02c6,u+02da,u+02dc,u+2000-206f,u+2074,u+20ac,u+2122,u+2191,u+2193,u+2212,u+2215,u+feff,u+fffd}@font-face{font-family:"Montserrat";font-style:normal;font-weight:400;src:local("Montserrat Medium"),local("Montserrat-Medium"),url(/assets/fonts/montserrat-500-cyrillic-ext.woff2)format("woff2");unicode-range:u+0460-052f,u+1c80-1c88,u+20b4,u+2de0-2dff,u+a640-a69f,u+fe2e-fe2f}@font-face{font-family:"Montserrat";font-style:normal;font-weight:400;src:local("Montserrat Medium"),local("Montserrat-Medium"),url(/assets/fonts/montserrat-500-cyrillic.woff2)format("woff2");unicode-range:u+0400-045f,u+0490-0491,u+04b0-04b1,u+2116}@font-face{font-family:"Montserrat";font-style:normal;font-weight:400;src:local("Montserrat Medium"),local("Montserrat-Medium"),url(/assets/fonts/montserrat-500-vietnamese.woff2)format("woff2");unicode-range:u+0102-0103,u+0110-0111,u+1ea0-1ef9,u+20ab}@font-face{font-family:"Montserrat";font-style:normal;font-weight:400;src:local("Montserrat Medium"),local("Montserrat-Medium"),url(/assets/fonts/montserrat-500-latin-ext.woff2)format("woff2");unicode-range:u+0100-024f,u+0259,u+1e00-1eff,u+2020,u+20a0-20ab,u+20ad-20cf,u+2113,u+2c60-2c7f,u+a720-a7ff}@font-face{font-family:"Montserrat";font-style:normal;font-weight:400;src:local("Montserrat Medium"),local("Montserrat-Medium"),url(/assets/fonts/montserrat-500-latin.woff2)format("woff2");unicode-range:u+0000-00ff,u+0131,u+0152-0153,u+02bb-02bc,u+02c6,u+02da,u+02dc,u+2000-206f,u+2074,u+20ac,u+2122,u+2191,u+2193,u+2212,u+2215,u+feff,u+fffd}@font-face{font-family:"Montserrat";font-style:normal;font-weight:700;src:local("Montserrat Bold"),local("Montserrat-Bold"),url(/assets/fonts/montserrat-700-cyrillic-ext.woff2)format("woff2");unicode-range:u+0460-052f,u+1c80-1c88,u+20b4,u+2de0-2dff,u+a640-a69f,u+fe2e-fe2f}@font-face{font-family:"Montserrat";font-style:normal;font-weight:700;src:local("Montserrat Bold"),local("Montserrat-Bold"),url(/assets/fonts/montserrat-700-cyrillic.woff2)format("woff2");unicode-range:u+0400-045f,u+0490-0491,u+04b0-04b1,u+2116}@font-face{font-family:"Montserrat";font-style:normal;font-weight:700;src:local("Montserrat Bold"),local("Montserrat-Bold"),url(/assets/fonts/montserrat-700-vietnamese.woff2)format("woff2");unicode-range:u+0102-0103,u+0110-0111,u+1ea0-1ef9,u+20ab}@font-face{font-family:"Montserrat";font-style:normal;font-weight:700;src:local("Montserrat Bold"),local("Montserrat-Bold"),url(/assets/fonts/montserrat-700-latin-ext.woff2)format("woff2");unicode-range:u+0100-024f,u+0259,u+1e00-1eff,u+2020,u+20a0-20ab,u+20ad-20cf,u+2113,u+2c60-2c7f,u+a720-a7ff}@font-face{font-family:"Montserrat";font-style:normal;font-weight:700;src:local("Montserrat Bold"),local("Montserrat-Bold"),url(/assets/fonts/montserrat-700-latin.woff2)format("woff2");unicode-range:u+0000-00ff,u+0131,u+0152-0153,u+02bb-02bc,u+02c6,u+02da,u+02dc,u+2000-206f,u+2074,u+20ac,u+2122,u+2191,u+2193,u+2212,u+2215,u+feff,u+fffd}body,html{height:100%;margin:0;overflow:hidden;font-family:var(--gsui-font);background-color:#333}noscript{z-index:2;display:flex;align-items:center;color:#ddd}#splashScreen,#splashScreen-content{display:flex;flex-direction:column;align-items:center}#splashScreen,noscript{position:absolute;justify-content:center;inset:0;background-color:#333}#splashScreen{z-index:1;color:#fff8;transition:.5s opacity}#splashScreen.started{opacity:0}#splashScreen-content{position:relative;text-align:center}#splashScreen-version{margin-top:10px;font-size:20px;font-family:var(--gsui-font-number)}#splashScreen-version::before{content:"version";font-size:12px;font-family:inherit;margin-right:5px;margin-bottom:200px;opacity:.5}#splashScreen-start{margin-top:48px;padding:.5ch 1ch;border:2px solid;border-radius:8px;outline:0;font:inherit;font-size:14px;color:var(--gsui-col-gain);cursor:pointer;background-color:rgba(var(--gsui-rgb-gain),.2);transition:box-shadow .25s,opacity .5s}#splashScreen-start:disabled{opacity:.25;pointer-events:none}#splashScreen.loaded #splashScreen-start:not(:disabled):focus,#splashScreen.loaded #splashScreen-start:not(:disabled):hover{box-shadow:0 0 24px rgba(var(--gsui-rgb-gain),.3);animation:.25s splashScreen-textAnim linear infinite alternate}#splashScreen:not(.loaded) #splashScreen-start::before{content:"downloading..."}#splashScreen.loaded #splashScreen-start::before{content:"click to start"}#splashScreen.starting #splashScreen-start::before{content:"starting..."}#splashScreen-form{order:10;margin-top:50px;font-size:10px}.splashScreen-form-row{display:flex;align-items:center;gap:.5ch;cursor:pointer}#splashScreen-form input{cursor:pointer}.TextGlitch{position:relative;color:#ccc;line-height:1em;font-size:68px;font-family:"oswald",monospace}.TextGlitch-blended{color:#fff}.TextGlitch-clip{position:relative}.TextGlitch-clip+.TextGlitch-clip{position:absolute;top:0}.TextGlitch:not(.TextGlitch-blended) .TextGlitch-clip+.TextGlitch-clip{display:none}.TextGlitch-word{margin:0;white-space:nowrap}.TextGlitch-blend{position:absolute;top:0;opacity:0;transition:.1s;transition-property:opacity}.TextGlitch-blendA{color:#2af;margin:-.03em 0 0 .03em;mix-blend-mode:darken}.TextGlitch-blendB{color:#f64;margin:.03em 0 0-.03em;mix-blend-mode:color-burn}.TextGlitch-blended .TextGlitch-blend{opacity:.4}body{color-scheme:dark;--gsui-rgb-pan:221, 153, 255;--gsui-rgb-gain:255, 255, 153;--gsui-rgb-time:255, 119, 119;--gsui-rgb-detune:255, 255, 255;--gsui-rgb-unison:255, 153,  85;--gsui-rgb-pattern:85, 170, 204;--gsui-rgb-patternSelected:255, 136, 136;--gsui-rgb-currentTimeCursor:255, 255, 153;--gsui-col-pan:rgb( var( --gsui-rgb-pan ) );--gsui-col-gain:rgb( var( --gsui-rgb-gain ) );--gsui-col-time:rgb( var( --gsui-rgb-time ) );--gsui-col-detune:rgb( var( --gsui-rgb-detune ) );--gsui-col-unison:rgb( var( --gsui-rgb-unison ) );--gsui-col-pattern:rgb( var( --gsui-rgb-pattern ) );--gsui-col-lowpass:#d96;--gsui-col-patternSelected:rgb( var( --gsui-rgb-patternSelected ) );--gsui-col-currentTimeCursor:rgb( var( --gsui-rgb-currentTimeCursor ) );--gsui-head-bg:#3a3a3a;--gsui-items-bg:#474747;--gsui-item-bg:#5c5c5c;--gsui-item-more-bg:#fff2;--gsui-item-bg-disabled:#505050;--gsui-item-bg-selected:#616161;--gsui-toggle-on:#ffa;--gsui-toggle-off:#222;--gsui-slider-bg:#0003;--gsui-slider-bg-opaque:#444;--gsuiSlider-lineBgColor:var( --gsui-slider-bg )}*{scrollbar-width:thin;scrollbar-color:#ddd #222}::-webkit-scrollbar{width:4px;height:4px}::-webkit-scrollbar-track{background-color:#222}::-webkit-scrollbar-thumb{background-color:#aaa}:root{--gsuiIcon-color-after:currentColor;--gsuiIcon-opacity-after:.6}.gsuiIcon{position:relative;display:inline-flex;align-items:center;justify-content:center;font-family:"FontAwesome";font-size:1em;font-style:normal;font-weight:400;font-variant:normal;text-decoration:none;text-rendering:auto;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}.gsuiIconB{font-family:"FontAwesomeBrands"}.gsuiIcon::before{pointer-events:none}.gsuiIcon:not(.gsuiIconB)::before{position:absolute}.gsuiIcon::after{color:var(--gsuiIcon-color-after);opacity:var(--gsuiIcon-opacity-after);pointer-events:none}.gsuiIcon:not([data-spin=on]):not([data-icon]),.gsuiIcon:not([data-spin=on])[data-icon=""],.gsuiIconB::after,gsui-daw:not([logged]) .gsuiDAW-btn[data-action=logout],gsui-daw:not([logged]) .gsuiDAW-btn[data-action=profile],gsui-daw[logged] .gsuiDAW-btn[data-action=login]{display:none}.gsuiIcon.gsuiIcon.gsuiIcon[data-spin=on]{line-height:1}.gsuiIcon.gsuiIcon.gsuiIcon[data-spin=on]::before{content:"";animation:.7s infinite linear gsuiIcon-spin;opacity:1}.gsuiIcon.gsuiIcon.gsuiIcon[data-spin=on]::after{display:inline-block;content:"􏏴";animation:.7s infinite linear gsuiIcon-spin;opacity:.4}.gsuiIcon[data-icon=github]::before{content:""}.gsuiIcon[data-icon=github]::after{content:"􏂛"}.gsuiIcon[data-icon=codepen]::before{content:""}.gsuiIcon[data-icon=codepen]::after{content:"􏇋"}.gsuiIcon[data-icon=discord]::before{content:""}.gsuiIcon[data-icon=discord]::after{content:"􏎒"}.gsuiIcon[data-icon=patreon]::before{content:""}.gsuiIcon[data-icon=patreon]::after{content:"􏏙"}.gsuiIcon[data-icon=twitter]::before{content:""}.gsuiIcon[data-icon=twitter]::after{content:"􏂙"}.gsuiIcon[data-icon=youtube]::before{content:""}.gsuiIcon[data-icon=youtube]::after{content:"􏅧"}.gsuiIcon[data-icon=facebook]::before{content:""}.gsuiIcon[data-icon=facebook]::after{content:"􏂚"}.gsuiIcon[data-icon=wordpress]::before{content:""}.gsuiIcon[data-icon=wordpress]::after{content:"􏐑"}.gsuiIcon[data-icon=arrow-left]::before{content:""}.gsuiIcon[data-icon=arrow-left]::after{content:"􏍕"}.gsuiIcon[data-icon=arrow-right]::before{content:""}.gsuiIcon[data-icon=arrow-right]::after{content:"􏍖"}.gsuiIcon[data-icon=arrows]::before{content:""}.gsuiIcon[data-icon=arrows]::after{content:"􏂲"}.gsuiIcon[data-icon=arrows-v]::before{content:""}.gsuiIcon[data-icon=arrows-v]::after{content:"􏌸"}.gsuiIcon[data-icon=arrows-h]::before{content:""}.gsuiIcon[data-icon=arrows-h]::after{content:"􏌷"}.gsuiIcon[data-icon=arrow-dropdown]::before{content:""}.gsuiIcon[data-icon=arrow-dropdown]::after{content:"􏍊"}.gsuiIcon[data-icon=arrow-levelleftdown]::before{content:"";transform:scale(-1,1)}.gsuiIcon[data-icon=arrow-levelleftdown]::after{content:"􏎾";transform:scale(-1,1)}.gsuiIcon[data-icon=sort]::before{content:""}.gsuiIcon[data-icon=sort]::after{content:"􏃜"}.gsuiIcon[data-icon=caret-up]::before{content:""}.gsuiIcon[data-icon=caret-up]::after{content:"􏃘"}.gsuiIcon[data-icon=caret-down]::before{content:""}.gsuiIcon[data-icon=caret-down]::after{content:"􏃗"}.gsuiIcon[data-icon=caret-left]::before{content:""}.gsuiIcon[data-icon=caret-left]::after{content:"􏃙"}.gsuiIcon[data-icon=caret-right]::before{content:""}.gsuiIcon[data-icon=caret-right]::after{content:"􏃚"}.gsuiIcon[data-icon=osc-sine]::before{content:""}.gsuiIcon[data-icon=osc-sine]::after{content:"􏢙"}.gsuiIcon[data-icon=osc-triangle]::before{content:""}.gsuiIcon[data-icon=osc-triangle]::after{content:"􏢚"}.gsuiIcon[data-icon=osc-square]::before{content:""}.gsuiIcon[data-icon=osc-square]::after{content:"􏠾"}.gsuiIcon[data-icon=undo]::before{content:""}.gsuiIcon[data-icon=undo]::after{content:"􏋪"}.gsuiIcon[data-icon=redo]::before{content:""}.gsuiIcon[data-icon=redo]::after{content:"􏋹"}.gsuiIcon[data-icon=sync]::before{content:""}.gsuiIcon[data-icon=sync]::after{content:"􏋱"}.gsuiIcon[data-icon=play]::before{content:"";opacity:.6}.gsuiIcon[data-icon=play]::after{content:"􏁋";opacity:1}.gsuiIcon[data-icon=stop]::before{content:"";opacity:.6}.gsuiIcon[data-icon=stop]::after{content:"􏁍";opacity:1}.gsuiIcon[data-icon=loop]::before{content:""}.gsuiIcon[data-icon=loop]::after{content:"􏍤"}.gsuiIcon[data-icon=pause]::before{content:"";opacity:.6}.gsuiIcon[data-icon=pause]::after{content:"􏁌";opacity:1}.gsuiIcon[data-icon=eject]::before{content:""}.gsuiIcon[data-icon=eject]::after{content:"􏁒"}.gsuiIcon[data-icon=circle]::before{content:"";opacity:.6}.gsuiIcon[data-icon=circle]::after{content:"􏄑";opacity:1}.gsuiIcon[data-icon=square]::before{content:"";opacity:.6}.gsuiIcon[data-icon=square]::after{content:"􏃈";opacity:1}.gsuiIcon[data-icon=triangle]::before{content:"";opacity:.6}.gsuiIcon[data-icon=triangle]::after{content:"􏋬";opacity:1}.gsuiIcon[data-icon=diamond]::before{content:"";opacity:.6}.gsuiIcon[data-icon=diamond]::after{content:"􏈙";opacity:1}.gsuiIcon[data-icon=heart]::before{content:"";opacity:.6}.gsuiIcon[data-icon=heart]::after{content:"􏀄";opacity:1}.gsuiIcon[data-icon=hexagon]::before{content:"";opacity:.6}.gsuiIcon[data-icon=hexagon]::after{content:"􏌒";opacity:1}.gsuiIcon[data-icon=octagon]::before{content:"";opacity:.6}.gsuiIcon[data-icon=octagon]::after{content:"􏌆";opacity:1}.gsuiIcon[data-icon=mute]::before{content:""}.gsuiIcon[data-icon=mute]::after{content:"􏋢"}.gsuiIcon[data-icon=unmute]::before{content:""}.gsuiIcon[data-icon=unmute]::after{content:"􏀨"}.gsuiIcon[data-icon=close]::before{content:""}.gsuiIcon[data-icon=close]::after{content:"􏀍"}.gsuiIcon[data-icon=restore]::before{content:""}.gsuiIcon[data-icon=restore]::after{content:"􏋒"}.gsuiIcon[data-icon=minimize]::before{content:""}.gsuiIcon[data-icon=minimize]::after{content:"􏋑";opacity:1}.gsuiIcon[data-icon=maximize]::before{content:""}.gsuiIcon[data-icon=maximize]::after{content:"􏋐";opacity:0}.gsuiIcon[data-icon=save]::before{content:""}.gsuiIcon[data-icon=save]::after{content:"􏃇";opacity:.4}.gsuiIcon[data-icon=render]::before{content:""}.gsuiIcon[data-icon=render]::after{content:"􏃧"}.gsuiIcon[data-icon=upload]::before{content:"";opacity:0}.gsuiIcon[data-icon=upload]::after{content:"􏎂";opacity:1}.gsuiIcon[data-icon=export]::before{content:""}.gsuiIcon[data-icon=export]::after{content:"􏀙"}.gsuiIcon[data-icon=folder-open]::before{content:""}.gsuiIcon[data-icon=folder-open]::after{content:"􏁼"}.gsuiIcon[data-icon=folder-tree]::before{content:""}.gsuiIcon[data-icon=folder-tree]::after{content:"􏠂"}.gsuiIcon[data-icon=file-buffer]::before{content:""}.gsuiIcon[data-icon=file-buffer]::after{content:"􏇇"}.gsuiIcon[data-icon=file-export]::before{content:""}.gsuiIcon[data-icon=file-export]::after{content:"􏕮"}.gsuiIcon[data-icon=file-corrupt]::before{content:""}.gsuiIcon[data-icon=file-corrupt]::after{content:"􏡷"}.gsuiIcon[data-icon=login]::before{content:""}.gsuiIcon[data-icon=login]::after{content:"􏂐"}.gsuiIcon[data-icon=logout]::before{content:""}.gsuiIcon[data-icon=logout]::after{content:"􏂋"}.gsuiIcon[data-icon=profile]::before{content:""}.gsuiIcon[data-icon=profile]::after{content:"􏊽"}.gsuiIcon[data-icon=musician]::before{content:""}.gsuiIcon[data-icon=musician]::after{content:"􏣫"}.gsuiIcon[data-icon=speed]::before{content:"";opacity:0}.gsuiIcon[data-icon=speed]::after{content:"􏘥";opacity:1}.gsuiIcon[data-icon=clock]::before{content:""}.gsuiIcon[data-icon=clock]::after{content:"􏀗";opacity:.3}.gsuiIcon[data-icon=history]::before{content:""}.gsuiIcon[data-icon=history]::after{content:"􏇚"}.gsuiIcon[data-icon=keys]::before{content:""}.gsuiIcon[data-icon=keys]::after{content:"􏣕"}.gsuiIcon[data-icon=drums]::before{content:""}.gsuiIcon[data-icon=drums]::after{content:"􏊡"}.gsuiIcon[data-icon=mixer]::before{content:""}.gsuiIcon[data-icon=mixer]::after{content:"􏏱"}.gsuiIcon[data-icon=channels]::before{content:"";transform:rotate(-90deg)}.gsuiIcon[data-icon=channels]::after{content:"􏠨";transform:rotate(-90deg)}.gsuiIcon[data-icon=music]::before{content:""}.gsuiIcon[data-icon=music]::after{content:"􏀁"}.gsuiIcon[data-icon=musics]::before{content:""}.gsuiIcon[data-icon=musics]::after{content:"􏣉"}.gsuiIcon[data-icon=effects]::before{content:""}.gsuiIcon[data-icon=effects]::after{content:"􏗽"}.gsuiIcon[data-icon=add-effect]::before{content:""}.gsuiIcon[data-icon=add-effect]::after{content:"􏗿"}.gsuiIcon[data-icon=waveform]::before{content:""}.gsuiIcon[data-icon=waveform]::after{content:"􏣲"}.gsuiIcon[data-icon=oscillator]::before{content:""}.gsuiIcon[data-icon=oscillator]::after{content:"􏠾";opacity:1}.gsuiIcon[data-icon=glissando]::before{content:""}.gsuiIcon[data-icon=glissando]::after{content:"􏙧"}.gsuiIcon[data-icon=buf-fx]::before{content:""}.gsuiIcon[data-icon=buf-fx]::after{content:"􎁇"}.gsuiIcon[data-icon=buf-drum]::before{content:""}.gsuiIcon[data-icon=buf-drum]::after{content:"􏕩"}.gsuiIcon[data-icon=buf-loop]::before{content:""}.gsuiIcon[data-icon=buf-loop]::after{content:"􏔴"}.gsuiIcon[data-icon=buf-vocal]::before{content:""}.gsuiIcon[data-icon=buf-vocal]::after{content:"􏣋"}.gsuiIcon[data-icon=buf-undefined]::before{content:""}.gsuiIcon[data-icon=buf-undefined]::after{content:"􏋽";opacity:.2}.gsuiIcon[data-icon=plus]::before{content:""}.gsuiIcon[data-icon=plus]::after{content:"􏁧";opacity:.7}.gsuiIcon[data-icon=minus]::before{content:""}.gsuiIcon[data-icon=minus]::after{content:"􏁨";opacity:1}.gsuiIcon[data-icon=minus-oct]::before{content:""}.gsuiIcon[data-icon=minus-oct]::after{content:"􏌈"}.gsuiIcon[data-icon=check]::before{content:""}.gsuiIcon[data-icon=check]::after{content:"􏀌"}.gsuiIcon[data-icon=warning]::before{content:""}.gsuiIcon[data-icon=warning]::after{content:"􏁱"}.gsuiIcon[data-icon=redirect]::before{content:""}.gsuiIcon[data-icon=redirect]::after{content:"􏗫";opacity:.4}.gsuiIcon[data-icon=pen]::before{content:""}.gsuiIcon[data-icon=pen]::after{content:"􏌄"}.gsuiIcon[data-icon=crop]::before{content:""}.gsuiIcon[data-icon=crop]::after{content:"􏄥"}.gsuiIcon[data-icon=erase]::before{content:""}.gsuiIcon[data-icon=erase]::after{content:"􏄭"}.gsuiIcon[data-icon=list]::before{content:""}.gsuiIcon[data-icon=list]::after{content:"􏃊"}.gsuiIcon[data-icon=local]::before{content:""}.gsuiIcon[data-icon=local]::after{content:"􏣦";opacity:.2}.gsuiIcon[data-icon=cloud]::before{content:"";opacity:.2}.gsuiIcon[data-icon=cloud]::after{content:"􏢮";opacity:1}.gsuiIcon[data-icon=cookie]::before{content:""}.gsuiIcon[data-icon=cookie]::after{content:"􏕣"}.gsuiIcon[data-icon=link]::before{content:""}.gsuiIcon[data-icon=link]::after{content:"􏃁"}.gsuiIcon[data-icon=unlink]::before{content:""}.gsuiIcon[data-icon=unlink]::after{content:"􏄧"}.gsuiIcon[data-icon=public]::before{content:""}.gsuiIcon[data-icon=public]::after{content:"􏞢";opacity:.4}.gsuiIcon[data-icon=private]::before{content:""}.gsuiIcon[data-icon=private]::after{content:"􏌍"}.gsuiIcon[data-icon=grip-h]::before{content:""}.gsuiIcon[data-icon=grip-h]::after{content:"􏖍"}.gsuiIcon[data-icon=grip-v]::before{content:""}.gsuiIcon[data-icon=grip-v]::after{content:"􏖎"}.gsuiIcon[data-icon=cut]::before{content:""}.gsuiIcon[data-icon=cut]::after{content:"􏃄"}.gsuiIcon[data-icon=clone]::before{content:""}.gsuiIcon[data-icon=clone]::after{content:"􏉍"}.gsuiIcon[data-icon=slices]::before{content:"";transform:rotate(-90deg)}.gsuiIcon[data-icon=slices]::after{content:"􏅠";transform:rotate(-90deg)}.gsuiIcon[data-icon=drumcut]{transform:rotate(90deg)}.gsuiIcon[data-icon=drumcut]::before{content:""}.gsuiIcon[data-icon=drumcut]::after{content:"􏁒"}.gsuiIcon[data-icon=drumprops]{transform:rotate(-90deg)}.gsuiIcon[data-icon=drumprops]::before{content:""}.gsuiIcon[data-icon=drumprops]::after{content:"􏢄"}.gsuiIcon[data-icon=smiley]::before{content:"";opacity:0}.gsuiIcon[data-icon=smiley]::after{content:"􏖁";opacity:1}.gsuiIcon[data-icon=bug]::before{content:""}.gsuiIcon[data-icon=bug]::after{content:"􏆈"}.gsuiIcon[data-icon=mouse]::before{content:""}.gsuiIcon[data-icon=mouse]::after{content:"􏉅";opacity:1}.gsuiIcon[data-icon=hand-pointer]::before{content:"";opacity:0}.gsuiIcon[data-icon=hand-pointer]::after{content:"􏉚";opacity:1}.gsuiIcon[data-icon=magnet]::before{content:""}.gsuiIcon[data-icon=magnet]::after{content:"􏁶"}.gsuiIcon[data-icon=tint]::before{content:""}.gsuiIcon[data-icon=tint]::after{content:"􏁃"}.gsuiIcon[data-icon=settings]::before{content:""}.gsuiIcon[data-icon=settings]::after{content:"􏀓"}.gsuiIcon[data-icon=help]::before{content:""}.gsuiIcon[data-icon=help]::after{content:"􏃺"}.gsuiIcon[data-icon=changelog]::before{content:""}.gsuiIcon[data-icon=changelog]::after{content:"􏜎"}.gsuiIcon[data-icon=about]::before{content:""}.gsuiIcon[data-icon=about]::after{content:"􎀯"}.gsuiIcon[data-icon=keyboard]::before{content:""}.gsuiIcon[data-icon=keyboard]::after{content:"􏄜"}gsui-daw{--gsuiDAW-bg:#444;--gsuiDAW-content-bg:#222;--gsuiDAW-color:#fff;--gsuiDAW-playPauseStop-bg:#67a;--gsuiDAW-save-bg:#ba5d5d;--gsuiDAW-currentTime-bg:#0003;--gsuiDAW-currentTime-lineColor:#abd;--gsuiDAW-currentTime-lineBgColor:#222;--gsuiDAW-btn-bg:#ffffff1a;--gsuiDAW-head-winBtn-bg:#222;--gsuiDAW-head-winBtn-open-bg:#ff9;--gsuiDAW-export-color:#ff9;--gsuiDAW-about-color:#ff9;--gsuiDAW-dropdown-shadow:20px 10px #0006;--gsuiDAW-history-bg:#777;--gsuiDAW-history-action-bg:#454750;--gsuiDAW-history-action-color:#ddd;--gsuiDAW-history-action-light-bg:#67a;--gsuiDAW-history-action-lightoff-bg:#1a1a1a;--gsuiDAW-cmps-color:#9ad;--gsuiDAW-cmps-btn-bg:#444;--gsuiDAW-cmps-btn-newCmp-color:#ff9;--gsuiDAW-cmp-cloud-bg:#4c71af;--gsuiDAW-cmp-local-bg:#67a;--gsuiDAW-cmp-text:#fff;--gsuiDAW-cmp-height:42px;--gsuiDAW-cmp-text-size:18px;--gsuiDAW-winBtn-bg:#0004;--gsuiDAW-winBtn-chan-color:#ce93d8;--gsuiDAW-winBtn-synth-color:#a5d6a7;--gsuiDAW-winBtn-slices-color:#e29d8a;--gsuiDAW-winBtn-pattern-color:#81d4fa;--radius:4px;--gap:4px;display:flex;flex-direction:column;position:relative;box-sizing:border-box;width:100%;height:100%;color:var(--gsuiDAW-color);font-size:16px;background-color:var(--gsuiDAW-bg)}.gsuiDAW-head{display:grid;padding:var(--gap);gap:var(--gap);grid-template:"areaUser    areaCtrl    areaHist    areaHelp"28px"areaSave    areaTime    areaWins    areaVers"20px/min-content min-content min-content 1fr}.gsuiDAW-area{display:flex;gap:inherit}.gsuiDAW-resources{display:flex;width:300px;min-width:330px;max-width:700px;border-right:3px solid #555;background-color:#444;transition:margin-left .2s}.gsuiDAW-resources-closed{margin-left:calc(var(--gsuiDAW-panel-margin, 0 ) - 3px)}.gsuiDAW-libraries{flex:1;border:inherit;border-right-width:2px}.gsuiDAW-patterns{flex:1}.gsuiDAW-windows{flex:1;z-index:0;background-color:var(--gsuiDAW-content-bg);background-image:url("data:image/svg+xml,%3Csvg width='6' height='6' viewBox='0 0 6 6' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23000000' fill-opacity='0.2' fill-rule='evenodd'%3E%3Cpath d='M5 0h1L0 6V5zM6 5v1H5z'/%3E%3C/g%3E%3C/svg%3E");background-attachment:local}.gsuiDAW .gsuiDrums,.gsuiDAW .gsuiPatternroll,.gsuiDAW .gsuiPianoroll,.gsuiDAW .gsuiSynthesizer{height:100%;outline:0}.gsuiDAW .gsuiWindow[data-id=mixer] .gsuiWindow-content{overflow-y:hidden}.gsuiDAW-winBtn{height:16px;padding:0 6px;max-width:110px;border:0;outline:0;cursor:pointer;overflow:hidden;border-radius:3px;line-height:1;color:inherit;font-size:10px;font-weight:700;font-family:inherit;white-space:nowrap;text-overflow:ellipsis;background-color:var(--gsuiDAW-winBtn-bg);transition:filter .2s}.gsuiDAW-winBtn:focus,.gsuiDAW-winBtn:hover{filter:brightness(1.1)}.gsuiDAW-winBtn:empty::before{content:"Untitled";font-style:italic}.gsuiDAW-winBtn .gsuiIcon,.gsuiDAW-winBtn span{pointer-events:none}.gsuiDAW-winBtn .gsuiIcon+span{margin-left:4px}.gsuiDAW-winBtn+.gsuiIcon{margin:0 6px;pointer-events:none}.gsuiDAW-winBtn[data-target=channel],.gsuiDAW-winBtn[data-target=synthChannel]{color:var(--gsuiDAW-winBtn-chan-color)}.gsuiDAW-winBtn[data-target=drums],.gsuiDAW-winBtn[data-target=pianoroll]{color:var(--gsuiDAW-winBtn-pattern-color)}.gsuiDAW-winBtn[data-target=synth]{color:var(--gsuiDAW-winBtn-synth-color)}.gsuiDAW-winBtn[data-target=slices]{color:var(--gsuiDAW-winBtn-slices-color)}.gsuiDAW-btn{display:inline-flex;align-items:center;justify-content:center;border:0;padding:0;outline:0;color:inherit;cursor:pointer;font-size:14px;text-decoration:none;border-radius:var(--radius);background:0 0;transition:.2s;transition-property:color,opacity,background-color;user-select:none}.gsuiDAW-btn.gsuiIcon{width:28px}.gsuiDAW-btn:not(.gsuiDAW-btnColor):hover{color:#fff;opacity:1}.gsuiDAW-btnBg{background-color:var(--gsuiDAW-btn-bg)}.gsuiDAW-btnBg:hover{background-color:#fff3}.gsuiDAW-btnColor{color:var(--gsui-color)}.gsuiDAW-btnColor:hover{color:var(--gsuiDAW-bg);background-color:var(--gsui-color)}.gsuiDAW-btns{display:flex;border-radius:var(--radius)}.gsuiDAW-btns .gsuiDAW-btn:first-child{border-top-right-radius:0;border-bottom-right-radius:0}.gsuiDAW-btns .gsuiDAW-btn:last-child{border-top-left-radius:0;border-bottom-left-radius:0}.gsuiDAW-btns .gsuiDAW-btn:not(:first-child):not(:last-child){border-radius:0}.gsuiDAW-cmp{box-sizing:border-box;display:flex;color:var(--gsuiDAW-cmp-text);height:var(--gsuiDAW-cmp-height);font-size:var(--gsuiDAW-cmp-text-size);line-height:var(--gsuiDAW-cmp-height);background-color:var(--gsuiDAW-cmp-bg);filter:brightness(.9)}.gsuiDAW-dropdown-list[data-list=local] .gsuiDAW-cmp{--gsuiDAW-cmp-bg:var( --gsuiDAW-cmp-local-bg )}.gsuiDAW-dropdown-list[data-list=cloud] .gsuiDAW-cmp{--gsuiDAW-cmp-bg:var( --gsuiDAW-cmp-cloud-bg )}.gsuiDAW-cmp:nth-child(odd){filter:brightness(.85)}.gsuiDAW-cmp.gsuiDAW-cmp-loaded{filter:none}.gsuiDAW-cmp-btn{border:0;color:inherit;cursor:pointer;font-size:16px;background:0 0}.gsuiDAW-cmp-btn-light{opacity:.7;padding:0 8px;transition:.2s opacity}.gsuiDAW-cmp-btn-light:focus,.gsuiDAW-cmp-btn-light:hover{opacity:1}.gsuiDAW-cmp-btn[data-action=cmp-save]{width:32px;margin-left:-32px;background-color:var(--gsuiDAW-save-bg);transition:.2s;transition-property:margin-left,color,background-color}gsui-daw:not([saved]) .gsuiDAW-cmp-loaded .gsuiDAW-cmp-btn[data-action=cmp-save]{margin-left:0}.gsuiDAW-cmp-btn[data-action=cmp-save]:hover{color:var(--gsuiDAW-save-bg);background-color:var(--gsuiDAW-cmp-text)}.gsuiDAW-cmp-info{flex:1;display:flex;align-items:flex-start;flex-direction:column;justify-content:space-between;padding:6px 6px 4px;overflow:hidden;text-decoration:none;color:inherit;font-size:13px;line-height:1em;transition:.2s;transition-property:padding-left,opacity;opacity:.7}.gsuiDAW-cmp-info:focus,.gsuiDAW-cmp-info:hover,.gsuiDAW-cmp-loaded .gsuiDAW-cmp-info{opacity:1}.gsuiDAW-cmp-info>div{pointer-events:none;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.gsuiDAW-cmp-name{max-width:100%;font-weight:700;border-radius:2px;padding-right:.4ch;transition:.2s;transition-property:box-shadow,color,background-color}.gsuiDAW-cmp-info:focus .gsuiDAW-cmp-name,.gsuiDAW-cmp-info:hover .gsuiDAW-cmp-name{color:var(--gsuiDAW-cmp-bg);box-shadow:0 0 0 2px var(--gsuiDAW-cmp-text);background-color:var(--gsuiDAW-cmp-text)}gsui-daw:not([saved]) .gsuiDAW-cmp-loaded .gsuiDAW-cmp-name::before,gsui-daw:not([saved]) .gsuiDAW-currCmp-name::before{content:"*"}.gsuiDAW-cmp-name:empty::after{font-style:italic;content:"Untitled"}.gsuiDAW-cmp-bpm-wrap,.gsuiDAW-cmp-duration-wrap{display:inline-flex;align-items:center;font:14px var(--gsui-font-number)}.gsuiDAW-cmp-duration-wrap{margin-right:10px}.gsuiDAW-cmp-info .gsuiIcon{margin-right:4px;opacity:.4}.gsuiDAW-dropdown{position:absolute;overflow:hidden;display:grid;z-index:1;top:calc(60px + var(--gap));height:320px;grid-template-rows:32px 1fr;box-sizing:border-box;outline:0;border:2px solid #444;border-radius:var(--radius);opacity:0;visibility:hidden;transition:.2s;transition-property:opacity,visibility}.gsuiDAW-dropdown:focus{border-color:#69b}.gsuiDAW-dropdown:focus-within{z-index:2}.gsuiDAW-dropdown-btn:focus+.gsuiDAW-dropdown,.gsuiDAW-dropdown:focus-within{opacity:1;visibility:visible}.gsuiDAW-dropdown-head{display:flex;align-items:center;color:#222;font-size:14px;border-radius:inherit inherit 0 0;background-color:#888;user-select:none}.gsuiDAW-dropdown-icon{margin:0 6px;font-size:16px}.gsuiDAW-dropdown-title{font-weight:700}.gsuiDAW-dropdown-list{position:relative;overflow:auto;background-color:#444}.gsuiDAW-dropdown-backdrop{position:absolute;inset:68px 0 0;opacity:0;background-color:#0004;visibility:hidden;transition:.4s;transition-property:visibility,opacity}.gsuiDAW-dropdown-btn:focus~.gsuiDAW-dropdown-backdrop,.gsuiDAW-dropdown:focus-within+.gsuiDAW-dropdown-backdrop{visibility:visible;opacity:1}.gsuiDAW-dropdown-placeholder{position:absolute;display:none;inset:32px 10px auto;align-items:center;justify-content:center;text-align:center;font-size:12px;font-style:italic;opacity:.5;user-select:none}.gsuiDAW-dropdown-placeholder:only-child{display:flex}.gsuiDAW-areaUser{grid-area:areaUser}.gsuiDAW-title{align-self:center;margin-right:var(--gap);font-size:28px;font-family:var(--gsui-font-title);user-select:none}.gsuiDAW-btn[data-action=profile]{width:32px;border:2px solid #222;box-sizing:border-box;background-size:cover;background-color:#fff4}.gsuiDAW-btn[data-action=login]{opacity:.7}.gsuiDAW-btn[data-action=logout]{font-size:24px;opacity:.7}.gsuiDAW-btn[data-action=login]{font-size:22px}.gsuiDAW-cmps{display:flex}.gsuiDAW-btn[data-action=cmps]{font-size:18px;--gsui-color:var( --gsuiDAW-cmps-color )}.gsuiDAW-cmps .gsuiDAW-dropdown{left:var(--gap);width:480px;grid-template-columns:1fr 1fr;box-shadow:2px var(--gsuiDAW-dropdown-shadow)}.gsuiDAW-dropdown-list[data-list=cloud]{border-left:2px solid #0001}gsui-daw:not([logged]) .gsuiDAW-dropdown-list[data-list=cloud] .gsuiDAW-dropdown-placeholder span:first-child,gsui-daw[logged] .gsuiDAW-dropdown-list[data-list=cloud] .gsuiDAW-dropdown-placeholder span:last-child{display:none}.gsuiDAW-cmps-btn{height:20px;padding:0 8px;margin-left:8px;border:0;outline:0;border-radius:3px;color:var(--gsuiDAW-cmps-btn-newCmp-color);font-size:12px;font-weight:700;font-family:inherit;line-height:1;background-color:var(--gsuiDAW-cmps-btn-bg);cursor:pointer;transition:filter .2s}.gsuiDAW-cmps-btn:focus,.gsuiDAW-cmps-btn:hover{filter:brightness(1.1)}.gsuiDAW-cmps-btn-icon,.gsuiDAW-cmps-btn-text{pointer-events:none}.gsuiDAW-cmps-btn-text{margin-left:4px}gsui-daw:not([logged]) .gsuiDAW-cmps-btn[data-action=cloudNewCmp]{color:#888;pointer-events:none}.gsuiDAW-areaSave{grid-area:areaSave;display:flex;width:260px;background-color:var(--gsuiDAW-playPauseStop-bg)}.gsuiDAW-currCmp-saveBtn{color:#fff;background-color:var(--gsuiDAW-save-bg);transition:.2s;transition-property:margin-left,color,background-color,visibility}gsui-daw[saved] .gsuiDAW-currCmp-saveBtn{visibility:hidden;margin-left:-32px}.gsuiDAW-currCmp-saveBtn:hover{color:var(--gsuiDAW-save-bg);background-color:#fff}.gsuiDAW-currCmp-editBtn{flex:1;display:flex;overflow:hidden;align-items:center;justify-content:start;font-family:inherit;padding:0 4px;font-size:14px}.gsuiDAW-currCmp-localIcon{display:none;margin-right:.3em;pointer-events:none}gsui-daw[saved] .gsuiDAW-currCmp-localIcon{display:inline-block}.gsuiDAW-currCmp-name{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:left;padding-right:.4ch;pointer-events:none}.gsuiDAW-currCmp-name:empty::after{content:"Untitled";font-style:italic;padding-right:1px;opacity:.8}.gsuiDAW-currCmp-editIcon{width:0;display:inline-block;overflow:hidden;position:relative;pointer-events:none;transition:.1s;transition-property:width,margin-left}.gsuiDAW-currCmp-editBtn:hover .gsuiDAW-currCmp-editIcon{width:1.4ch;margin-left:4px}.gsuiDAW-currCmp-dur{pointer-events:none}.gsuiDAW-currCmp-dur::before{content:"·";margin:4px}.gsuiDAW-areaCtrl{grid-area:areaCtrl}.gsuiDAW-playPauseStop{background-color:var(--gsuiDAW-playPauseStop-bg)}.gsuiDAW-volume{width:6px;--gsuiSlider-lineRadius:4px;--gsuiSlider-lineColor:var( --gsuiDAW-playPauseStop-bg );--gsuiSlider-lineBgColor:#222}.gsuiDAW-volume .gsuiSlider-eventCatcher{left:-12px;right:calc(var(--gap)*-1)}.gsuiDAW-focusBtn{display:flex;position:relative;flex-direction:column;justify-content:space-between;padding:7px 3px 7px 8px}.gsuiDAW-focusBtn span{width:5px;height:5px;border-radius:1px;background-color:currentColor;pointer-events:none;opacity:.4}gsui-daw[focus=down] .gsuiDAW-focusBtn span:last-child,gsui-daw[focus=up] .gsuiDAW-focusBtn span:first-child{opacity:1}.gsuiDAW-btn[data-action=stop]{margin-left:-3px}.gsuiDAW-btn[data-action=reset]{margin-left:-2px}gsui-daw gsui-clock,gsui-daw gsui-spectrum{border-radius:var(--radius)}.gsuiDAW-tempo{white-space:nowrap;background-color:#222}.gsuiDAW-tempo-bpm,.gsuiDAW-tempo-timeDivision{display:flex;font-family:var(--gsui-font-number);pointer-events:none}.gsuiDAW-tempo-timeDivision{align-items:center;flex-direction:column;justify-content:space-between;height:32%;padding:0 6px 0 8px;font-size:12px;line-height:0}.gsuiDAW-tempo-bpm{align-items:baseline;padding-right:7px;font-size:18px}.gsuiDAW-tempo-bpm::after{content:"bpm";margin-left:2px;font-size:12px;opacity:.5}.gsuiDAW-areaTime{grid-area:areaTime;padding:8px;border-radius:var(--radius);background-color:var(--gsuiDAW-currentTime-bg)}.gsuiDAW-areaTime gsui-slider{--gsuiSlider-lineColor:var( --gsuiDAW-currentTime-lineColor );--gsuiSlider-lineBgColor:var( --gsuiDAW-currentTime-lineBgColor )}.gsuiDAW-areaTime .gsuiSlider-eventCatcher{inset:-10px}.gsuiDAW-areaHist{grid-area:areaHist}.gsuiDAW-history{background-color:var(--gsuiDAW-history-bg)}.gsuiDAW-btn[data-action=redo]{margin-left:-4px}.gsuiDAW-btn[data-action=undoMore]{width:auto;padding:0 6px 0 3px}gsui-daw gsui-spectrum{flex:1;width:140px;min-width:48px;background-color:#000}.gsuiDAW-btn[data-action=export]{--gsui-color:var( --gsuiDAW-export-color )}.gsuiDAW-history .gsuiDAW-dropdown{left:450px;width:360px;box-shadow:2px var(--gsuiDAW-dropdown-shadow)}.gsuiDAW-history-action{display:flex;box-sizing:border-box;align-items:center;cursor:pointer;height:30px;padding:0 6px;color:var(--gsuiDAW-history-action-color);font-size:14px;font-family:var(--gsui-font-monospace);user-select:none;background-color:var(--gsuiDAW-history-action-bg);transition:filter .2s}.gsuiDAW-history-action:hover{filter:brightness(1.3)}.gsuiDAW-history-action::before{content:"";display:block;width:6px;height:6px;border-radius:50%;transition:inherit;background-color:var(--gsuiDAW-history-action-light-bg);pointer-events:none}.gsuiDAW-history-action[data-undone]:not(:hover)::before{background-color:var(--gsuiDAW-history-action-lightoff-bg)}.gsuiDAW-history-action-icon{width:1.4ch;margin:0 6px;text-align:center;pointer-events:none}.gsuiDAW-history-action-text{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;transition-duration:inherit;transition-property:opacity;pointer-events:none}.gsuiDAW-history-action[data-undone] .gsuiDAW-history-action-icon,.gsuiDAW-history-action[data-undone] .gsuiDAW-history-action-text{opacity:.6}.gsuiDAW-areaWins{grid-area:areaWins;white-space:nowrap;gap:0}.gsuiDAW-areaWins .gsuiDAW-btn{flex:1;font-size:11px;background-color:var(--gsuiDAW-head-winBtn-bg)}.gsuiDAW-areaWins .gsuiDAW-btn+.gsuiDAW-btn{margin-left:0;border-left:1px dashed rgba(0,0,0,.2)}.gsuiDAW-areaWins .gsuiDAW-btn[data-open]{color:var(--gsuiDAW-bg);background-color:var(--gsuiDAW-head-winBtn-open-bg)}.gsuiDAW-areaHelp,.gsuiDAW-areaVers{grid-area:areaHelp;justify-content:end}.gsuiDAW-btn[data-action=about]{--gsui-color:var( --gsuiDAW-about-color )}.gsuiDAW-areaVers{grid-area:areaVers}.gsuiDAW-version{font-family:var(--gsui-font-number);opacity:.3}.gsuiDAW-changelog.gsuiIcon{width:auto}.gsuiDAW-changelog{opacity:.3}.gsuiDAW-version:focus,.gsuiDAW-version:hover{opacity:1}.gsuiDAW-popup-auth{width:340px}.gsuiDAW-popup-auth a{font-size:11px}.gsuiDAW-popup-auth-error{margin-top:12px;font-size:12px;color:#ed9a8b}.gsuiDAW-popup-auth-error:empty{display:none}.gsuiDAW-popup-open{width:460px}.gsuiDAW-popup-open .gsuiPopup-row-values{width:200px}.gsuiDAW-popup-about{width:450px;text-align:center}.gsuiDAW-popup-about>div{margin-bottom:16px}.gsuiDAW-popup-about a{color:#ccf;font-weight:700}.gsuiDAW-popup-about-head{display:flex;align-items:baseline;justify-content:center;font-size:18px;gap:4px}.gsuiDAW-popup-about-title{font:32px var(--gsui-font-title)}.gsuiDAW-popup-about-versionNum{opacity:.8;font-family:var(--gsui-font-number)}.gsuiDAW-popup-about-versionCheck{font-size:11px;font-weight:700;opacity:.4;cursor:pointer;transition:.2s opacity}.gsuiDAW-popup-about-links a:hover,.gsuiDAW-popup-about-versionCheck:hover{opacity:1}.gsuiDAW-popup-about-links{display:flex}.gsuiDAW-popup-about-links a{flex:1;padding:20px 0;color:#fff;font-size:36px;font-weight:400;opacity:.5;transition:.4s;transition-property:opacity}.gsuiDAW-popup-about-links a:hover::before{top:-4px;left:4px;text-shadow:-4px 4px 2px rgba(0,0,0,.2)}.gsuiDAW-popup-about-links a::before{position:relative;top:0;left:0;transition:.2s;transition-property:top,left,text-shadow}.gsuiDAW-popup-about-links:hover a:not(:hover){opacity:.3}.gsuiDAW-popup-tempo{width:400px}.gsuiDAW-popup-tempo .gsuiPopup-row-values{width:180px}.gsuiDAW-bpmTap{display:flex;align-self:normal;align-items:center;justify-content:center;cursor:pointer;color:inherit;width:32px;min-width:32px;font-size:18px;border-radius:4px;background-color:#fff2}.gsuiDAW-bpmTap:hover{background-color:#fff3}.gsuiDAW-popup-export{width:500px}.gsuiDAW-popup-export-wrap{display:flex;padding:10px 0}.gsuiDAW-popup-export-progress{flex:1;height:28px}.gsuiDAW-popup-export-btn{padding:0 .8em;border-radius:2px;margin-right:10px;font-size:12px;line-height:28px;font-weight:700;text-decoration:none;background-color:#ff9}.gsuiDAW-popup-export-btn>span{display:none;color:#111}.gsuiDAW-popup-export-btn[data-status="0"] .gsuiDAW-popup-export-btn0,.gsuiDAW-popup-export-btn[data-status="1"] .gsuiDAW-popup-export-btn1,.gsuiDAW-popup-export-btn[data-status="2"] .gsuiDAW-popup-export-btn2{display:inline}.gsuiDAW-popup-export-btn .gsuiIcon{margin-left:.3em}.gsuiDAW-popup-settings{width:480px}.gsuiDAW-popup-settings .gsuiPopup-row-values{width:200px}.gsuiDAW-uiRateFps{font-size:16px;font-family:var(--gsui-font-number);white-space:pre}.gsuiDAW-uiRateFps::after{content:" fps";font-family:var(--gsui-font);font-size:12px;opacity:.6}.gsuiDAW-popup-settings input[name=uiRateFPS]{min-width:0}gsui-dragshield{position:absolute;z-index:2147483647;inset:0;pointer-events:none}.gsuiDragshield-show{pointer-events:auto}gsui-timeline{--gsuiTimeline-bg:#222;--gsuiTimeline-color:#fff;--gsuiTimeline-loop-bg:#656586;--gsuiTimeline-lines-bg:#ffffff07;--gsuiTimeline-cursor-fill:#fff;--gsuiTimeline-loopBorder-bg:#fff;position:relative;display:block;height:100%;color:var(--gsuiTimeline-color);background-color:var(--gsuiTimeline-bg);--gsuiTimeline-beats-offset:0;--gsuiTimeline-beats-incr:1;--gsuiTimeline-beats-per-measure:4}:root{--gsuiTimeline-numbering:1}.gsuiTimeline-beats,.gsuiTimeline-steps{position:absolute;inset:calc(50% - 1px)0 auto;height:2px;pointer-events:none;background-repeat:no-repeat}.gsuiTimeline-beats{top:calc(50% - 2px);height:4px;margin-left:1px;background-image:repeating-linear-gradient(90deg,transparent 0,transparent calc(1em - 2px),currentColor calc(1em - 2px),currentColor calc(1em),transparent calc(1em))}.gsuiTimeline-measures{display:flex;height:100%;counter-reset:beat calc(var(--gsuiTimeline-beats-offset) - var(--gsuiTimeline-beats-incr) + var(--gsuiTimeline-numbering));pointer-events:none}.gsuiTimeline-measure{counter-increment:beat var(--gsuiTimeline-beats-incr);display:inline-block;margin-left:calc(var(--gsuiTimeline-beats-incr)*var(--gsuiTimeline-beats-per-measure)*1em)}.gsuiTimeline-measure:first-child{margin-left:calc(var(--gsuiTimeline-beats-offset)*var(--gsuiTimeline-beats-per-measure)*1em)}.gsuiTimeline-measure::before{content:"";position:absolute;margin-left:-2px;width:4px;height:100%;background-color:var(--gsuiTimeline-bg)}.gsuiTimeline-measure::after{display:flex;content:counter(beat);position:absolute;inset:0 auto;width:52px;margin-left:-26px;align-items:center;justify-content:center;font-size:14px;font-family:var(--gsui-font-number);opacity:var(--gsuiTimeline-measures-opacity, 0 )}.gsuiTimeline-measureBig::after{font-weight:700;opacity:1}.gsuiTimeline-loopLine,.gsuiTimeline-timeLine{position:absolute;inset:0 0 50%;transition:.2s background-color}.gsuiTimeline-draggingLoopBody .gsuiTimeline-loopLine,.gsuiTimeline-draggingLoopHandleA .gsuiTimeline-loopLine,.gsuiTimeline-draggingLoopHandleB .gsuiTimeline-loopLine,.gsuiTimeline-draggingTime .gsuiTimeline-timeLine,.gsuiTimeline-loopLine:hover,.gsuiTimeline-timeLine:hover{background-color:var(--gsuiTimeline-lines-bg)}.gsuiTimeline-timeLine{top:50%;bottom:0}.gsuiTimeline-cursor,.gsuiTimeline-cursorPreview{position:absolute;margin-left:-8px;bottom:1px;fill:var(--gsuiTimeline-cursor-fill);stroke:var(--gsuiTimeline-cursor-fill);stroke-width:2px;stroke-linejoin:round;pointer-events:none}.gsuiTimeline-cursorPreview{opacity:.5}.gsuiTimeline-loop{position:absolute;height:6px;transition:.1s;transition-property:opacity,visibility;opacity:0;visibility:hidden}.gsuiTimeline-looping .gsuiTimeline-loop{opacity:1;visibility:visible}.gsuiTimeline-loopBody{height:100%;transition:filter .2s;background-color:var(--gsuiTimeline-loop-bg)}.gsuiTimeline-draggingLoopBody .gsuiTimeline-loopBody,.gsuiTimeline-loopBody:hover{filter:brightness(1.2)}.gsuiTimeline-loopHandle{position:absolute;inset:0 auto -6px;width:25%;min-width:7px;max-width:12px}.gsuiTimeline-loopHandleA{left:-5px}.gsuiTimeline-loopHandleB{right:-5px}.gsuiTimeline-loopBorder{position:absolute;inset:0 auto;width:2px;transition:.2s;transition-property:bottom,background-color;pointer-events:none}.gsuiTimeline-loopBorderA{left:0}.gsuiTimeline-loopBorderB{right:0}.gsuiTimeline-draggingLoopHandleA .gsuiTimeline-loopBorderA,.gsuiTimeline-draggingLoopHandleB .gsuiTimeline-loopBorderB,.gsuiTimeline-loopHandle:hover+.gsuiTimeline-loopBorder{bottom:-3px;background-color:var(--gsuiTimeline-loopBorder-bg)}gsui-timewindow{--gsuiTimewindow-bg:#456168;--gsuiTimewindow-loop-bg:#0004;--gsuiTimewindow-panel-border:#222;--gsuiTimewindow-currentTime-fill:var( --gsui-col-currentTimeCursor );position:relative;z-index:0;display:flex;align-items:start;width:100%;height:100%;overflow:auto;background-color:var(--gsuiTimewindow-bg);scrollbar-width:none}gsui-drumrows::-webkit-scrollbar,gsui-timewindow::-webkit-scrollbar{display:none}gsui-slicer[disabled],gsui-timewindow[disabled]{overflow:hidden;pointer-events:none;filter:grayscale(1) brightness(.4)}.gsuiTimewindow-main,.gsuiTimewindow-panel{display:flex;min-height:100%;flex-direction:column}.gsuiTimewindow-main{z-index:0}.gsuiTimewindow-panel{position:sticky;z-index:1;left:0;border-right:1px solid var(--gsuiTimewindow-panel-border);background-color:var(--gsui-items-bg)}.gsuiTimewindow-panelUp,.gsuiTimewindow-time{position:sticky;z-index:2;top:0;height:32px}.gsuiTimewindow-panelUp{box-sizing:border-box;display:flex;align-items:center;justify-content:flex-end;padding-right:4px;border-bottom:2px solid #0005;background-color:var(--gsui-head-bg)}.gsuiTimewindow-mainBody,.gsuiTimewindow-panelContent{flex:1}.gsuiTimewindow-mainBody{width:1000000px}.gsuiTimewindow-mainContent{position:relative;z-index:0}.gsuiTimewindow-contentDown,.gsuiTimewindow-panelContentDown{position:sticky;bottom:0;height:96px;overflow:hidden;background-color:var(--gsuiTimewindow-bg);box-shadow:0-1px var(--gsuiTimewindow-panel-border)}.gsuiTimewindow-panelContentDown{background-color:inherit}.gsuiTimewindow-panelExtend{position:absolute}.gsuiTimewindow-panelExtendX{inset:-2px 0 auto;height:6px;cursor:ns-resize}.gsuiTimewindow-panelExtendY{inset:0-2px 0 auto;width:6px;cursor:ew-resize}gsui-timewindow gsui-timeline{--gsuiTimeline-cursor-fill:var( --gsuiTimewindow-currentTime-fill )}.gsuiTimewindow-currentTime,.gsuiTimewindow-loop{position:absolute;z-index:1;inset:0 auto;pointer-events:none}.gsuiTimewindow-currentTime{width:2px;margin-left:-1px;background-color:var(--gsuiTimewindow-currentTime-fill)}gsui-timewindow[currenttime="0"] .gsuiTimewindow-currentTime{display:none}.gsuiTimewindow-loop{opacity:0;transition:.2s opacity;background-color:var(--gsuiTimewindow-loop-bg)}.gsuiTimewindow-looping .gsuiTimewindow-loop{opacity:1}.gsuiTimewindow-loopA{left:0}.gsuiTimewindow-loopB{right:0}.gsuiTimewindow-step{display:flex;align-items:center;border:0;outline:0;padding:4px;border-radius:4px;font-size:inherit;font-family:var(--gsui-font-number);color:inherit;cursor:pointer;background:0 0;user-select:none;opacity:.5;transition:.2s opacity}.gsuiTimewindow-step:focus,.gsuiTimewindow-step:hover{opacity:1}.gsuiTimewindow-stepValue{white-space:nowrap;margin-right:6px}.gsuiTimewindow-panelUp gsui-slider{width:6px;height:80%;--gsuiSlider-lineColor:var( --gsuiTimewindow-bg )}.gsuiTimewindow-panelUp gsui-slider:first-of-type{margin-left:4px;margin-right:2px}gsui-analyser,gsui-spectrum{display:flex;position:relative;overflow:hidden;background-color:#000}gsui-analyser canvas,gsui-spectrum canvas{position:absolute;width:100%;height:100%;filter:saturate(.5) contrast(.8)}gsui-envelope-graph{transition:color .2s}gsui-envelope-graph svg{width:100%;height:100%;stroke:currentColor;stroke-width:2px}.gsuiEnvelopeGraph-line{fill:transparent}.gsuiEnvelopeGraph-mainLine{stroke-dasharray:12 4;stroke-opacity:.5;fill:currentColor;fill-opacity:.1}gsui-envelope,gsui-lfo{display:grid;height:100%;min-height:76px;box-sizing:border-box;padding:6px;grid-gap:6px;font-family:var(--gsui-font);background-color:var(--gsui-item-bg)}gsui-envelope{--gsuiEnvelope-wave-bg:#0004;--gsuiEnvelope-wave-off:#777;--gsuiEnvelope-ctrls-color:#ff9;grid-template:"attack hold  decay sustain release"28px"graph  graph graph graph   graph  "1fr/1fr 1fr 1fr 1fr 1fr;--gsuiSlider-lineColor:var( --gsuiEnvelope-ctrls-color )}.gsuiEnvelope-prop{display:flex;flex-direction:column}.gsuiEnvelope-propLabel{display:flex;align-self:center;align-items:baseline;height:20px;font-size:12px;opacity:.5;user-select:none}.gsuiEnvelope-propValue::before{content:"·";margin:0 2px}.gsuiEnvelope-propValue{font-family:var(--gsui-font-number)}.gsuiEnvelope-propContent{flex:1;position:relative}.gsuiEnvelope-attack{grid-area:attack}.gsuiEnvelope-hold{grid-area:hold}.gsuiEnvelope-decay{grid-area:decay}.gsuiEnvelope-sustain{grid-area:sustain}.gsuiEnvelope-release{grid-area:release}gsui-envelope .gsuiSlider-eventCatcher{top:-26px;bottom:-6px}.gsuiEnvelope-graph{grid-area:graph;position:relative;overflow:hidden;border-radius:4px;background-color:var(--gsuiEnvelope-wave-bg)}gsui-envelope gsui-envelope-graph{position:absolute;inset:4px 0 0;color:var(--gsuiEnvelope-wave-off)}gsui-envelope[toggle] gsui-envelope-graph{color:var(--gsuiEnvelope-ctrls-color)}gsui-lfo{--gsuiLFO-wave-bg:#0004;--gsuiLFO-wave-off:#777;--gsuiLFO-ctrls-bg:#555;min-width:300px;grid-template:"type delay attack speed amp  "28px"type graph graph  graph graph"1fr/32px 1fr 1fr 1fr 1fr;--gsuiSlider-lineColor:var( --gsuiLFO-ctrls-color );--gsuiLFO-ctrls-color:var( --gsui-col-gain )}.gsuiLFO-prop{display:flex;flex-direction:column}.gsuiLFO-propLabel{display:flex;align-self:center;align-items:baseline;height:20px;font-size:12px;opacity:.5;user-select:none}.gsuiLFO-propValue::before{content:"·";margin:0 2px}.gsuiLFO-propValue{font-family:var(--gsui-font-number)}.gsuiLFO-propContent{flex:1;position:relative}.gsuiLFO-btn{position:relative;cursor:pointer}.gsuiLFO-btnInput{position:absolute;visibility:hidden}.gsuiLFO-btnIcon{position:absolute;inset:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center}.gsuiLFO-delay{grid-area:delay}.gsuiLFO-attack{grid-area:attack}.gsuiLFO-speed{grid-area:speed}.gsuiLFO-amp{grid-area:amp}gsui-lfo .gsuiSlider-eventCatcher{top:-26px;bottom:-6px}.gsuiLFO-graph{grid-area:graph;position:relative;overflow:hidden;border-radius:4px;background-color:var(--gsuiLFO-wave-bg)}.gsuiLFO-ampSigns{position:absolute;inset:0;width:10px;display:flex;pointer-events:none;flex-direction:column}gsui-lfo[toggle] .gsuiLFO-ampSigns{pointer-events:auto}.gsuiLFO-ampSign{flex:1;background-color:var(--gsui-slider-bg-opaque)}gsui-lfo[toggle] .gsuiLFO-ampSign,gsui-lfo[toggle] .gsuiLFO-ampSignIcon,gsui-lfo[toggle] gsui-periodicwave{color:var(--gsuiLFO-ctrls-color)}.gsuiLFO-ampSignIcon{color:var(--gsuiLFO-wave-off);font-size:11px}.gsuiLFO-ampSignRadio:checked+.gsuiLFO-ampSignIcon{color:var(--gsuiLFO-ctrls-bg);background-color:var(--gsuiLFO-wave-off)}gsui-lfo[toggle] .gsuiLFO-ampSignRadio:checked+.gsuiLFO-ampSignIcon,gsui-lfo[toggle] .gsuiLFO-typeRadio:checked+.gsuiLFO-typeSVG{background-color:var(--gsuiLFO-ctrls-color)}.gsuiLFO-wave{position:absolute;inset:0-2px 0 8px;pointer-events:none}.gsuiLFO-wave gsui-periodicwave{position:absolute;top:6px;height:calc(100% - 12px);color:var(--gsuiLFO-wave-off);stroke-width:2px;transition:color .2s}.gsuiLFO-type{grid-area:type}.gsuiLFO-type .gsuiLFO-propContent{display:flex;overflow:hidden;border-radius:4px;flex-direction:column}.gsuiLFO-typeBtn{flex:1;cursor:not-allowed;background-color:var(--gsuiSlider-lineBgColor)}gsui-lfo[toggle] .gsuiLFO-typeBtn{cursor:pointer}.gsuiLFO-typeSVG{fill:none;stroke:var(--gsuiLFO-wave-off);stroke-width:2px;transition:.2s;transition-property:stroke,background-color}gsui-lfo[toggle] .gsuiLFO-typeSVG{stroke:var(--gsuiLFO-ctrls-color)}.gsuiLFO-typeSVG path{transform:scale(.6);transform-origin:center}.gsuiLFO-typeRadio:checked+.gsuiLFO-typeSVG{stroke:var(--gsuiLFO-ctrls-bg);background-color:var(--gsuiLFO-wave-off)}gsui-drumrows{--gsuiDrumrow-pan:var( --gsui-col-pan );--gsuiDrumrow-gain:var( --gsui-col-gain );--gsuiDrumrow-detune:var( --gsui-col-detune );--gsuiDrumrow-border:#0002;--gsuiDrumrow-color:#fff;--gsuiDrumrow-grip-bg:#0001;--gsuiDrumrow-prop-bgHover:#fff2;display:flex;flex-direction:column;font-size:var(--gsuiTimewindow-lineH)}.gsuiDrumrows-drop{display:flex;align-items:center;justify-content:center;order:1;height:1em;pointer-events:none;opacity:0}gsui-drumrows.gsuiDrumrows-dragover>.gsuiDrumrows-drop{opacity:1}.gsuiDrumrows-dropIn{font-size:24px;opacity:.5}.gsuiDrumrow{--grip-w:16px;--toggle-w:20px;--name-h:16px;--propsExpand-w:16px;--delete-w:14px;--slider-w:7px;--props-h:1.5em;position:relative;box-sizing:border-box;height:1em;min-height:1em;border-top:2px solid #ffffff11;border-bottom:2px solid #0000003b;background-color:var(--gsui-item-bg);transition:.2s height,.2s min-height}.gsuiDrumrow-mute{border-color:transparent;background-color:var(--gsui-item-bg-disabled)}.gsuiDrumrow-open{height:calc(1em + 1px + var(--props-h));min-height:calc(1em + 1px + var(--props-h))}.gsuiDrumrow-main{position:absolute;box-sizing:border-box;inset:0 1px auto var(--grip-w);height:1em;min-height:1em}.gsuiDrumrow.gsuiDrumrows-dragover .gsuiDrumrow-main{opacity:0;pointer-events:none}.gsuiDrumrow-props{position:absolute;overflow:hidden;display:flex;align-items:center;justify-content:center;inset:1em 0 0 var(--grip-w);background-color:var(--gsui-item-more-bg)}.gsuiDrumrow-prop{outline:0;font-size:11px;font-weight:700;font-family:inherit;cursor:pointer}.gsuiDrumrow-propPan{--color:var( --gsuiDrumrow-pan )}.gsuiDrumrow-propGain{--color:var( --gsuiDrumrow-gain )}.gsuiDrumrow-propDetune{--color:var( --gsuiDrumrow-detune )}.gsuiDrumrow-prop+.gsuiDrumrow-prop{margin-left:4px}.gsuiDrumrow-propRadio{position:absolute;visibility:hidden}.gsuiDrumrow-propSpan{color:var(--color);padding:2px 4px;border-radius:3px;opacity:0;transition:.1s background-color,.2s opacity}.gsuiDrumrow-propSpanValue{font-size:14px;font-family:var(--gsui-font-number)}.gsuiDrumrow-open .gsuiDrumrow-propSpan{opacity:1}.gsuiDrumrow-propSpan:focus,.gsuiDrumrow-propSpan:hover{background-color:var(--gsuiDrumrow-prop-bgHover)}.gsuiDrumrow-propRadio:checked+.gsuiDrumrow-propSpan{color:var(--gsui-item-bg);background-color:var(--color)}.gsuiDrumrow-grip{position:absolute;width:var(--grip-w);inset:0 auto 0 0;display:flex;align-items:center;justify-content:center;font-size:12px;cursor:grab;background-color:var(--gsuiDrumrow-grip-bg)}.gsuiDrumrow-grip .gsuiIcon{pointer-events:none;opacity:.4}gsui-drumrows gsui-toggle{position:absolute;inset:0 auto auto 0;width:var(--toggle-w);height:var(--name-h)}.gsuiDrumrow-name{position:absolute;inset:0 calc(var(--delete-w) + var(--propsExpand-w) + 6px) auto var(--toggle-w);height:var(--name-h);line-height:var(--name-h);overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:12px;font-weight:700;pointer-events:none}.gsuiDrumrow-nameInfo{font-style:italic;font-weight:400;opacity:.7}.gsuiDrumrow-waveWrap{position:absolute;overflow:hidden;inset:var(--name-h) calc(var(--slider-w)*3 + 8px) 4px 0;pointer-events:none}.gsuiDrumrow-startCursor,.gsuiDrumrow-wave{position:absolute;inset:0 auto auto 0;width:100%;height:100%}.gsuiDrumrow-wave{fill:currentColor;opacity:.5}.gsuiDrumrow-startCursor{border-right:2px solid;background-image:linear-gradient(90deg,transparent 0,currentColor 300%);animation-name:gsuiDrumrow-startCursor-anim;animation-duration:inherit;animation-fill-mode:forwards;animation-timing-function:linear}.gsuiDrumrow-mute .gsuiDrumrow-startCursor{visibility:hidden}.gsuiDrumrow-detune,.gsuiDrumrow-gain,.gsuiDrumrow-pan{position:absolute;inset:var(--name-h) auto 4px;width:var(--slider-w)}.gsuiDrumrow .gsuiSlider-eventCatcher{inset:-2px}.gsuiDrumrow-detune{--gsuiSlider-lineColor:var( --gsuiDrumrow-detune );right:calc(2*var(--slider-w) + 6px)}.gsuiDrumrow-pan{--gsuiSlider-lineColor:var( --gsuiDrumrow-pan );right:calc(var(--slider-w) + 4px)}.gsuiDrumrow-gain{--gsuiSlider-lineColor:var( --gsuiDrumrow-gain );right:2px}.gsuiDrumrow .gsuiDrumrows-drop{position:absolute;inset:0}.gsuiDrumrow.gsuiDrumrows-dragover .gsuiDrumrows-drop{opacity:1}.gsuiDrumrow-btnDelete,.gsuiDrumrow-btnProps{position:absolute;right:0;border:0;outline:0;padding:0;height:var(--name-h);color:inherit;cursor:pointer;font-size:12px;background:0 0;transition:.1s opacity}.gsuiDrumrow-btnDelete{width:var(--delete-w);opacity:.3}.gsuiDrumrow-btnProps{right:calc(var(--delete-w) + 2px);width:var(--propsExpand-w);opacity:.5}.gsuiDrumrow-open .gsuiDrumrow-btnProps{text-shadow:0 0 6px;opacity:.8}.gsuiDrumrow .gsuiDrumrow-btnDelete:focus,.gsuiDrumrow .gsuiDrumrow-btnDelete:hover,.gsuiDrumrow .gsuiDrumrow-btnProps:focus,.gsuiDrumrow .gsuiDrumrow-btnProps:hover{opacity:1}gsui-drums{--gsuiDrums-drum-bg:rgba( var( --gsui-rgb-pattern ), .8 );--gsuiDrums-drum-color:#000;--gsuiDrums-drumprop-bg:#0002;--gsuiDrums-drumprop-color:#0004;--gsuiDrums-drumcut-bg:#48ad;--gsuiDrums-line-border:#2e4145;--gsuiDrums-line-mute-bg:#0003;--gsuiDrums-loop-bg:#000;--gsuiDrums-currentTime-bg:rgba( var( --gsui-rgb-currentTimeCursor ), .07 );--gsuiDrums-drumHover-border:var( --gsui-col-pattern );--gsuiDrums-drumHover-bg:rgba( var( --gsui-rgb-pattern ), .2 );height:100%}gsui-drums .gsuiTimewindow-currentTime{margin-left:0;opacity:.1}gsui-drums,gsui-drums gsui-timewindow[currenttime="0"] .gsuiTimewindow-currentTime{display:block}gsui-drums .gsuiTimewindow-step,gsui-drums gsui-slider[data-zoom=y]{display:none}.gsuiDrums-line.gsuiReorder-dragging{opacity:.5;background-color:#0004}.gsuiDrums-line{position:relative;width:1000000px;font-size:var(--gsuiTimewindow-lineH);height:1em;box-sizing:border-box;border-bottom:1px solid var(--gsuiDrums-line-border);transition:.2s height,.1s filter,.1s background-color}.gsuiDrums-lineOpen{height:calc(1em + 1.5em)}.gsuiDrums-line.gsuiDrumrow-mute{filter:brightness(.8) contrast(.8);background-color:var(--gsuiDrums-line-mute-bg)}.gsuiDrums-lineDrums{position:absolute;inset:0;height:1em}.gsuiDrums-lineIn{height:100%;box-sizing:border-box;border-bottom:1px dashed var(--gsuiDrums-line-border);font-size:var(--gsuiTimewindow-pxperbeat);cursor:pointer}.gsuiDrums-lineProps{position:absolute;inset:1em 0 0}.gsuiDrums-drumHover,.gsuiDrums-drumcutHover{position:absolute;z-index:1;background-color:#0002}.gsuiDrums-drumHover{height:66%}.gsuiDrums-drumcutHover{bottom:0;height:34%}.gsuiDrums-drumHoverIn,.gsuiDrums-drumcutHoverIn{box-sizing:border-box;height:100%;margin:0 1px 1px 0;border:2px solid var(--gsuiDrums-drumHover-border);border-radius:4px;background-color:var(--gsuiDrums-drumHover-bg);pointer-events:none}.gsuiDrums-drum,.gsuiDrums-drumcut{position:absolute;width:1em}.gsuiDrums-drum{height:66%}.gsuiDrums-drumcut{bottom:1px;height:calc(34% - 2px)}.gsuiDrums-preview,.gsuiDrums-previewDeleted{opacity:.4}.gsuiDrums-drumIn,.gsuiDrums-drumcutIn{display:flex;align-items:center;flex-direction:column;justify-content:center;height:100%;margin:0 1px 1px 0;border-radius:2px;color:var(--gsuiDrums-drum-color);background-color:var(--gsuiDrums-drum-bg);pointer-events:none}.gsuiDrums-drumcutIn{font-size:10px;background-color:var(--gsuiDrums-drumcut-bg)}.gsuiDrums-drumcutIn .gsuiIcon{opacity:.7}.gsuiDrums-drumProp{position:relative;width:100%;height:3px;background-color:var(--gsuiDrums-drumprop-bg);transition:.1s height}.gsuiDrums-lineOpen[data-prop=detune] .gsuiDrums-drumProp[data-value=detune],.gsuiDrums-lineOpen[data-prop=gain] .gsuiDrums-drumProp[data-value=gain],.gsuiDrums-lineOpen[data-prop=pan] .gsuiDrums-drumProp[data-value=pan]{height:6px}.gsuiDrums-drumProp+.gsuiDrums-drumProp{margin-top:2px}.gsuiDrums-drumPropValue{position:absolute;height:100%;background-color:var(--gsuiDrums-drumprop-color)}gsui-clock{--gsuiClock-bg:#222;display:flex;width:min-content;height:100%;max-height:28px;border-radius:4px;font-size:18px;background-color:var(--gsuiClock-bg)}.gsuiClock-relative{position:relative;height:100%;padding-left:8px;border-top-left-radius:inherit;border-bottom-left-radius:inherit}.gsuiClock-absolute{display:flex;position:absolute;white-space:nowrap;align-items:baseline;padding-top:4px;font-family:var(--gsui-font-number)}.gsuiClock-modes{position:relative;display:flex;margin:0;border:0;outline:0;padding:7px 6px;border-top-right-radius:inherit;border-bottom-right-radius:inherit;cursor:pointer;color:inherit;flex-direction:column;justify-content:space-between;background:0 0}.gsuiClock-modes:focus-visible{box-shadow:0 0 1px 2px #69b}.gsuiClock-mode{width:5px;height:5px;border-radius:1px;background-color:currentColor;opacity:.2}gsui-clock[mode=beat] .gsuiClock-beat,gsui-clock[mode=second] .gsuiClock-second{opacity:.8}.gsuiClock-b::before{content:":";margin:0 .2ch}.gsuiClock-c,.gsuiPopup-content legend{font-size:12px;opacity:.5}.gsuiClock-c::before{content:".";margin:0 .4ch}.gsuiClock-modeText{position:absolute;top:3px;right:0;font-size:8px;font-family:var(--gsui-font);opacity:.25}gsui-clock[mode=beat] .gsuiClock-modeText::before{content:"beat"}gsui-clock[mode=second] .gsuiClock-modeText::before{content:"sec"}gsui-channel{--gsuiChannel-pan-color:var( --gsui-col-pan );--gsuiChannel-gain-color:var( --gsui-col-gain );--gsuiChannel-connect-input-color:#f99;--gsuiChannel-connect-output-color:var( --gsui-col-gain );--gsuiChannel-analyser-bg:#222;--gsuiChannel-name-font:var( --gsui-font );box-sizing:border-box;display:flex;position:relative;align-items:center;flex-direction:column;height:100%;width:50px;min-width:50px;border-left:2px solid #ffffff11;border-right:2px solid #0000003b;background-color:var(--gsuiChannel-bg, var( --gsui-item-bg ) );transition:.2s background-color}gsui-mixer gsui-channel[selected]{background-color:var(--gsui-item-bg-selected);--gsuiChannel-name-weight:bold;--gsuiChannel-name-shadow:inset 0 -2px var( --gsuiChannel-gain-color )}gsui-channel[muted]{--gsuiChannel-bg:var( --gsui-item-bg-disabled );--gsuiChannel-name-opacity:.5;--gsuiChannel-slider-color:#fff5}.gsuiChannel-headBtn{display:flex;position:absolute;align-items:center;justify-content:center;top:2px;right:2px;border:0;padding:0;outline:0;color:inherit;cursor:pointer;font-size:8px;line-height:1em;background:0 0;transition:opacity .2s;opacity:0}gsui-channel:hover .gsuiChannel-headBtn{opacity:.5}gsui-channel .gsuiChannel-headBtn:focus-visible,gsui-channel .gsuiChannel-headBtn:hover{opacity:1}.gsuiChannel-rename{right:14px}.gsuiChannel-delete{font-size:10px}.gsuiChannels-panMain .gsuiChannel-headBtn{display:none}.gsuiChannel-nameWrap{display:flex;align-items:center;justify-content:center;box-sizing:border-box;overflow:hidden;width:100%;border:0;outline:0;padding:0 3px;color:inherit;height:34px;min-height:34px;font-size:12px;font-family:var(--gsuiChannel-name-font);background-color:transparent;box-shadow:var(--gsuiChannel-name-shadow, none );transition:inherit;transition-property:box-shadow}.gsuiChannel-name{display:block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:center;font-size:9px;font-weight:var(--gsuiChannel-name-weight, normal );user-select:none;opacity:var(--gsuiChannel-name-opacity, 1 )}.gsuiChannel-analyser{position:relative;overflow:hidden;flex:2;width:inherit;margin-left:0;min-height:16px}gsui-channel gsui-analyser{height:100%;opacity:.8}.gsuiChannel-effects{display:grid;position:absolute;inset:auto 0 0}.gsuiChannel-effect{display:flex;align-items:center;justify-content:center;width:100%;height:12px;border:0;color:inherit;font-family:inherit;font-size:6px;cursor:pointer;border-top:1px solid #222;border-left:2px solid #ffffff08;border-right:2px solid #0002;background-color:#333}.gsuiChannel-effect:focus-visible,.gsuiChannel-effect:hover{background-color:#3a3a3a}.gsuiChannel-effect-name{pointer-events:none;opacity:.3}.gsuiChannel-effect-enable .gsuiChannel-effect-name{opacity:1}gsui-channel gsui-toggle{width:100%;min-height:18px}.gsuiChannel-pan{width:100%;height:24px;min-height:24px;z-index:1;overflow:hidden;--gsuiSlider-lineColor:var( --gsuiChannel-slider-color, var( --gsuiChannel-pan-color ) )}.gsuiChannel-gain{flex:1;width:6px;min-height:32px;margin-top:6px;--gsuiSlider-lineColor:var( --gsuiChannel-slider-color, var( --gsuiChannel-gain-color ) )}.gsuiChannel-gain .gsuiSlider-eventCatcher{left:-12px;right:-12px}.gsuiChannel-connect{width:100%;border:0;padding:0;outline:0;z-index:1;height:16px;min-height:16px;cursor:pointer;font-size:16px;background-color:transparent}.gsuiChannel-connectA{color:var(--gsuiChannel-connect-output-color)}.gsuiChannel-connectB{color:var(--gsuiChannel-connect-input-color)}.gsuiChannel-grip{width:100%;height:18px;display:flex;align-items:center;justify-content:center;font-size:12px;cursor:grab;opacity:.6;background-color:#0002}.gsuiMixer-panMain .gsuiChannel-grip{visibility:hidden;pointer-events:none}gsui-channels{display:flex;z-index:0;height:100%;position:relative;background-color:var(--gsui-items-bg);user-select:none;-webkit-user-select:none}.gsuiChannels-panMain{position:absolute;inset:0 auto 0 0;padding-right:3px}.gsuiChannels-panChannels{position:absolute;overflow:scroll;inset:0 0 0 calc(50px + 3px);display:grid;grid-auto-flow:column;grid-auto-columns:min-content;scrollbar-width:none}.gsuiChannels-panChannels::-webkit-scrollbar{display:none}.gsuiChannels-panChannels::after{order:2147483647;content:".";opacity:0;margin-left:16px}.gsuiChannels-addChan{position:relative;order:2147483646;display:flex;flex-direction:column;gap:1ch;align-items:center;justify-content:center;width:52px;border:0;padding:0;outline:0;font-size:18px;color:inherit;cursor:pointer;border-radius:2px;background:0 0;opacity:.4;transition:.2s opacity}.gsuiChannels-addChan:focus,.gsuiChannels-addChan:hover,.gsuiEffects-addBtn:focus,.gsuiEffects-addBtn:hover{opacity:.6}.gsuiChannels-addChan::before,.gsuiEffects-addBtn::before{content:"";inset:6px;opacity:.4;border:2px dashed;position:absolute}.gsuiChannels-addChan .gsuiIcon:first-child{font-size:24px}.gsuiChannels-addChan .gsuiIcon:last-child{font-size:14px}gsui-curves{display:block;position:relative;height:100%}.gsuiCurves-svg{position:absolute;width:100%;height:100%}.gsuiCurves-markText{fill:currentColor;font-size:10px;opacity:.2}.gsuiCurves-markBg{fill:currentColor;opacity:.03}.gsuiCurves-line{stroke:currentColor;stroke-width:2;stroke-dasharray:4;opacity:.1}.gsuiCurves-curve{fill:none;stroke:currentColor;stroke-width:3}gsui-effects{height:100%;background-color:var(--gsui-items-bg)}.gsuiEffects-list,gsui-effects{display:flex;overflow:auto;flex-direction:column}.gsuiEffects-addBtn{position:relative;order:2147483646;border:0;outline:0;width:100%;min-height:52px;color:inherit;font-size:18px;cursor:pointer;border-radius:2px;background:0 0;opacity:.4;transition:.2s opacity}.gsuiEffects-addSelect{order:2147483647;width:100%;border:0;font:inherit;color:inherit;min-height:calc(24px*2);background-color:#333;transition:.1s;transition-property:height,visibility}.gsuiEffects-addSelect option{box-sizing:border-box;padding:4px;height:24px;font-size:12px}.gsuiEffects-addSelect option:hover{background-color:#fff2}.gsuiEffects-addBtn:not(:focus)+.gsuiEffects-addSelect:not(:focus){height:0;min-height:0;visibility:hidden}.gsuiEffects-fx{background-color:var(--gsuiEffects-fx-head-bg, var( --gsui-item-bg-disabled ) )}.gsuiEffects-fx-enable{--gsuiEffects-fx-head-bg:var( --gsui-item-bg );--gsuiEffects-fx-head-name-opacity:1}.gsuiEffects-fx-head{display:flex;height:36px;box-sizing:border-box;border-bottom:2px solid #0002;font-size:12px}.gsuiEffects-fx:not(.gsuiEffects-fx-expanded)+.gsuiEffects-fx .gsuiEffects-fx-head{border-top:2px solid #fff1}.gsuiEffects-fx.gsuiEffects-fx-expanded+.gsuiEffects-fx .gsuiEffects-fx-head{border-top:2px solid #0001}.gsuiEffects-fx-expand,.gsuiEffects-fx-remove{border:0;padding:0;outline:0;color:inherit;cursor:pointer;background-color:transparent}.gsuiEffects-fx-expand{width:20px}.gsuiEffects-fx-remove{font-size:inherit}.gsuiEffects-fx-grip{display:flex;align-items:center;justify-content:center;width:16px;font-size:12px;cursor:grab;opacity:.6;background-color:#0002}.gsuiEffects-fx-expand,.gsuiEffects-fx-name{opacity:var(--gsuiEffects-fx-head-name-opacity, .5 )}.gsuiEffects-fx-expand{font-size:14px}.gsuiEffects-fx-head gsui-toggle{width:20px}.gsuiEffects-fx-name{flex:1;align-self:center;padding-left:6px}.gsuiEffects-fx-remove{width:32px;opacity:.3;transition:.1s opacity}.gsuiEffects-fx-remove:focus,.gsuiEffects-fx-remove:hover{opacity:1}.gsuiEffects-fx-content{height:0;opacity:0;overflow:hidden;background-color:var(--gsui-item-more-bg);transition:.1s;transition-property:height,opacity}.gsuiEffects-fx-expanded .gsuiEffects-fx-content{opacity:1}.gsuiEffects-fx-content>*{box-shadow:inset 0 0 20px #0000001c}gsui-fx-delay,gsui-fx-filter{box-sizing:border-box;height:100%;padding:8px}gsui-fx-delay{--gsuiFxDelay-slider:dodgerblue;--gsuiFxDelay-graph-bg:#333;display:flex;flex-direction:column;gap:8px;--gsuiSlider-lineColor:var( --gsuiFxDelay-slider )}.gsuiFxDelay-param{display:flex;align-items:center;gap:8px}.gsuiFxDelay-param::before{width:30px;font-size:12px;font-weight:700}.gsuiFxDelay-param[data-prop=time]::before{content:"time"}.gsuiFxDelay-param[data-prop=gain]::before{content:"gain"}.gsuiFxDelay-param[data-prop=pan]::before{content:"pan"}.gsuiFxDelay-param gsui-slider{flex:1;height:10px;min-width:16px}.gsuiFxDelay-param[data-prop=time] gsui-slider{--gsuiSlider-lineColor:var( --gsui-col-time )}.gsuiFxDelay-param[data-prop=gain] gsui-slider{--gsuiSlider-lineColor:var( --gsui-col-gain )}.gsuiFxDelay-param[data-prop=pan] gsui-slider{--gsuiSlider-lineColor:var( --gsui-col-pan )}.gsuiFxDelay-param-value{width:30px;font-size:13px;font-family:var(--gsui-font-number)}.gsuiFxDelay-graph{position:relative;overflow:hidden;flex:1;border-radius:6px;background-color:var(--gsuiFxDelay-graph-bg)}.gsuiFxDelay-graph-lines{position:absolute;inset:0}.gsuiFxDelay-graph-line{position:absolute;top:calc(50% - 1px);width:100%;height:2px;background-color:currentColor;opacity:.2}.gsuiFxDelay-graph-echo,.gsuiFxDelay-graph-source{position:absolute;top:50%;width:10px;height:10px;margin-top:-5px;margin-left:-5px;border-radius:50%;background-color:currentColor}gsui-fx-filter{--gsuiFxFilter-Q:#d7b;--gsuiFxFilter-gain:var( --gsui-col-gain );--gsuiFxFilter-detune:var( --gsui-col-detune );--gsuiFxFilter-frequency:#8c8;display:grid;container:gsuiFxFilter/inline-size;grid-gap:8px;grid-template:"type graph     gain Q     "1fr"type graph     gain detune"1fr".    frequency .    .     "8px/32px 1fr 8px 50px}.gsuiFxFilter-area{display:flex;flex-direction:column}.gsuiFxFilter-area-label{align-self:center;height:20px;font-size:12px;opacity:.5}.gsuiFxFilter-area-content{flex:1;position:relative}.gsuiFxFilter-areaType{grid-area:type}.gsuiFxFilter-areaGraph{grid-area:graph}.gsuiFxFilter-areaGain{grid-area:gain;--gsuiSlider-lineColor:var( --gsuiFxFilter-gain )}.gsuiFxFilter-areaQ{grid-area:Q;--gsuiSlider-lineColor:var( --gsuiFxFilter-Q )}.gsuiFxFilter-areaDetune{grid-area:detune;--gsuiSlider-lineColor:var( --gsuiFxFilter-detune )}.gsuiFxFilter-areaFrequency{grid-area:frequency;--gsuiSlider-lineColor:var( --gsuiFxFilter-frequency )}.gsuiFxFilter-areaDetune gsui-slider,.gsuiFxFilter-areaQ gsui-slider{min-height:40px}.gsuiFxFilter-areaFrequency .gsuiSlider-eventCatcher,.gsuiFxFilter-areaGain .gsuiSlider-eventCatcher{inset:-8px}.gsuiFxFilter-areaGraph .gsuiFxFilter-area-label{align-self:flex-start}.gsuiFxFilter-areaGraph .gsuiFxFilter-area-content{border-radius:4px;background-color:rgba(0,0,0,.5)}gsui-fx-filter .gsuiCurves-curve{color:currentColor;opacity:.25}.gsuiFxFilter-enable .gsuiCurves-curve{color:var(--gsuiFxFilter-frequency);opacity:1}.gsuiFxFilter-areaType .gsuiFxFilter-area-content{display:flex;overflow:hidden;border-radius:4px;flex-direction:column}.gsuiFxFilter-areaType-btn{position:relative;flex:1;border:0;outline:0;padding:0;cursor:pointer;stroke:var(--gsuiFxFilter-gain);stroke-width:1.5px;background-color:var(--gsui-slider-bg)}.gsuiFxFilter-areaType-btn:focus,.gsuiFxFilter-areaType-btn:hover{stroke-width:2px}.gsuiFxFilter-areaType-btnSelected{stroke:#222;background-color:var(--gsuiFxFilter-gain)}.gsuiFxFilter-areaType-btn svg{position:absolute;inset:0;width:100%;height:100%;fill:transparent;stroke:inherit;stroke-width:inherit;pointer-events:none}@container gsuiFxFilter (max-width: 340px){.gsuiCurves-markText{display:none}}gsui-mixer{--gsuiMixer-bg:#444;--gsuiMixer-effects-bg:#404040;--gsuiMixer-effects-border:#555;--gsuiMixer-head-border:#0002;display:flex;height:100%;background-color:var(--gsuiMixer-bg)}.gsuiMixer-channels{display:flex;flex-direction:column;flex:1;min-width:140px}.gsuiMixer-effects{z-index:1;display:flex;flex-direction:column;width:50%;min-width:200px;border-left:2px solid var(--gsuiMixer-effects-border);background-color:var(--gsuiMixer-effects-bg)}gsui-mixer .gsuiPanel-extend{z-index:2}.gsuiMixer-head{box-sizing:border-box;display:flex;align-items:center;gap:6px;height:26px;min-height:26px;padding:2px 6px 0;font-size:10px;border-bottom:2px solid var(--gsuiMixer-head-border);background-color:var(--gsui-head-bg)}.gsuiMixer-head-title{font-weight:700}.gsuiReorder-dragging{opacity:0;transition:none}:root{--gsuiDragline-color:#fff;--gsuiDragline-dotSize:8px;--gsuiDragline-dotRad:50%;--gsuiDragline-lineSize:4px}.gsuiDragline{position:absolute;max-width:0;max-height:0;color:var(--gsuiDragline-color)}.gsuiDragline-dragging,.gsuiDragline-dragging .gsuiDragline-to,.gsuiDragline-main{pointer-events:none}.gsuiDragline-main{position:relative}.gsuiDragline-line{position:absolute;bottom:0;right:0;width:0;height:0;fill:none;stroke:currentColor;stroke-width:var(--gsuiDragline-lineSize);stroke-linecap:round}.gsuiDragline-down .gsuiDragline-line{top:0;bottom:auto}.gsuiDragline-right .gsuiDragline-line{left:0;right:auto}.gsuiDragline-to{position:absolute;width:var(--gsuiDragline-dotSize);height:var(--gsuiDragline-dotSize);margin:calc(var(--gsuiDragline-dotSize)/-2);cursor:pointer;border-radius:var(--gsuiDragline-dotRad);pointer-events:all;background-color:var(--gsuiDragline-color);transition:.2s background-color}.gsuiDragline-down .gsuiDragline-to{bottom:0}.gsuiDragline-right .gsuiDragline-to{right:0}.gsuiDragline-main:not(.gsuiDragline-down) .gsuiDragline-to{top:0}.gsuiDragline-main:not(.gsuiDragline-right) .gsuiDragline-to{left:0}.gsuiDragline-drop{position:relative;max-width:0;max-height:0}.gsuiDragline-drop::before{content:"";position:absolute;width:0;height:0;margin:0;background-color:var(--gsuiDragline-color);transition:.2s all}.gsuiDragline-dropActive::before{width:var(--gsuiDragline-dotSize);height:var(--gsuiDragline-dotSize);margin:calc(var(--gsuiDragline-dotSize)/-2);cursor:pointer;border-radius:var(--gsuiDragline-dotRad)}.gsuiDragline-dropActive:hover::before{transform:scale(2)}gsui-beatlines{--gsui-deg:90deg;--gsui-bPM:4em;--gsui-sPB:.25em;pointer-events:none;background-repeat:no-repeat}gsui-beatlines[vertical]{--gsui-deg:180deg}.gsuiBeatlines-bg,gsui-beatlines{position:absolute;inset:0}.gsuiBeatlines-measures{background-image:repeating-linear-gradient(var(--gsui-deg),#0008,#0008 1px,transparent 1px,transparent calc(var(--gsui-bPM) - 1px),#0008 calc(var(--gsui-bPM) - 1px),#0008 var(--gsui-bPM))}.gsuiBeatlines-steps{background-image:repeating-linear-gradient(var(--gsui-deg),#0002,#0002 .5px,transparent .5px,transparent calc(var(--gsui-sPB) - .5px),#0002 calc(var(--gsui-sPB) - .5px),#0002 var(--gsui-sPB))}.gsuiBeatlines-beats{background-image:repeating-linear-gradient(var(--gsui-deg),#0004,#0004 .5px,transparent .5px,transparent calc(1em - .5px),#0004 calc(1em - .5px),#0004 1em)}gsui-beatlines[coloredbeats] .gsuiBeatlines-beatsBG{background-image:repeating-linear-gradient(var(--gsui-deg),#0001,#0001 1em,transparent 1em,transparent 2em)}.gsuiBlocksManager{--gsuiBlocksManager-timeline-height:32px;--gsuiBlocksManager-selection-bgColor:#b226;--gsuiBlocksManager-selection-borderColor:#f44;--gsuiBlocksManager-blockColor:rgba( var( --gsui-rgb-pattern ), .8 );--gsuiBlocksManager-blockSelectedColor:rgba( var( --gsui-rgb-patternSelected ), .8 )}.gsuiBlocksManager-selection{position:absolute;box-sizing:border-box;top:0;z-index:2;border:2px solid var(--gsuiBlocksManager-selection-borderColor);border-radius:4px;background-color:var(--gsuiBlocksManager-selection-bgColor);transition:.2s;transition-property:opacity,visibility}.gsuiBlocksManager-selection-hidden{opacity:0;visibility:hidden}.gsuiBlocksManager-block{position:absolute;z-index:1;height:100%;background-color:var(--gsuiBlocksManager-blockColor);transition:.1s;transition-property:opacity,background-color}.gsuiBlocksManager-block-selected{--gsuiBlocksManager-blockColor:var( --gsuiBlocksManager-blockSelectedColor )}.gsuiBlocksManager-block-hidden{z-index:0;opacity:.3}.gsuiBlocksManager-block-crop{position:absolute;z-index:2;width:50%;height:100%;max-width:8px;border-radius:inherit;background-color:#000;opacity:0;transition:.1s opacity}.gsuiBlocksManager-block-cropA{left:0;border-top-right-radius:0;border-bottom-right-radius:0}.gsuiBlocksManager-block-cropB{right:0;border-top-left-radius:0;border-bottom-left-radius:0}.gsuiBlocksManager-block.gsui-hover .gsuiBlocksManager-block-crop,.gsuiBlocksManager-block:hover .gsuiBlocksManager-block-crop{opacity:.12}.gsuiBlocksManager-block .gsuiBlocksManager-block-crop.gsui-hover,.gsuiBlocksManager-block .gsuiBlocksManager-block-crop:hover{opacity:.25}gsui-patternroll,gsui-pianoroll{display:flex;height:100%}gsui-patternroll gsui-track{height:var(--gsuiTimewindow-lineH)}.gsuiPatternroll-block{box-sizing:border-box;white-space:nowrap;color:var(--gsuiPatterns-pattern-color);border-radius:1px;border-top:2px solid #ffffff4f;border-bottom:2px solid #0000000d;--gsuiPatterns-pattern-color:#223}.gsui-mute .gsuiPatternroll-block{opacity:.5}.gsuiPatternroll-block-header{position:absolute;inset:3px 3px auto;box-sizing:border-box;z-index:1;display:flex;border-radius:inherit;flex-direction:column;justify-content:center;padding:0 4px;font-size:10px;font-weight:700;background-color:#fff3;pointer-events:none;user-select:none;-webkit-user-select:none}.gsuiPatternroll-block-name{overflow:hidden;text-overflow:ellipsis}.gsuiPatternroll-block-content{position:absolute;inset:18px 0 0;pointer-events:none}.gsuiPatternroll-block[data-missing] .gsuiPatternroll-block-content{display:none}.gsuiPatternroll-block-content svg{position:absolute;top:0;left:0;width:100%;height:100%;opacity:.8;fill:currentColor}.gsui-row-small .gsuiPatternroll-block-header{background-color:inherit;position:absolute;inset:0}.gsui-row-small .gsuiPatternroll-block-content,.gsuiKey-row>div{position:absolute;inset:0}.gsuiPatternroll-block-placeholder{flex:1;display:none;align-items:center;pointer-events:none;font-size:14px;opacity:.5}.gsuiPatternroll-block[data-missing] .gsuiPatternroll-block-placeholder{display:flex}.gsuiPatternroll-block-placeholderIcon{margin:0 8px}.gsuiPatternroll-block-placeholderText{overflow:hidden;text-overflow:ellipsis;user-select:none;-webkit-user-select:none}gsui-pianoroll{--gsuiDragline-dotSize:10px;--gsuiDragline-dotRad:2px;--gsuiDragline-lineSize:3px}gsui-pianoroll:focus{outline:1px solid var(--gsuiBlocksManager-blockColor)}gsui-pianoroll .gsuiTimewindow-rows,gsui-pianoroll gsui-keys{font-size:var(--gsuiTimewindow-lineH)}gsui-pianoroll .gsuiKey-row>div{font-size:var(--gsuiTimewindow-pxperbeat)}gsui-pianoroll .gsuiBlocksManager-block{border-radius:2px}gsui-pianoroll .gsuiTimewindow-panelContentDown{display:flex;align-items:center;justify-content:center}.gsuiPianoroll-slidersSelect{border:0;outline:0;font:inherit;color:inherit;cursor:pointer;font-size:11px;user-select:none;border-radius:4px;background-color:#fff2;scrollbar-width:none;opacity:.5;transition:.1s opacity}.gsuiPianoroll-slidersSelect::-webkit-scrollbar{display:none}.gsuiPianoroll-slidersSelect:focus,.gsuiPianoroll-slidersSelect:hover{opacity:1}.gsuiPianoroll-slidersSelect option{padding:1px 4px}.gsuiPianoroll-slidersSelect option::after{content:attr(data-number);margin-left:1ch;font-size:14px;font-weight:700;font-family:var(--gsui-font-number)}.gsuiPianoroll-slidersSelect option[value^=gainLFO]::after{content:"x"attr(data-number)}.gsuiPianoroll-slidersSelect option:not([data-number])::after{content:""}.gsuiPianoroll-block{--gsuiDragline-color:var( --gsuiBlocksManager-blockColor )}.gsuiPianoroll-block::after{content:attr(data-key);position:absolute;display:flex;align-items:center;justify-content:center;left:0;width:16px;max-width:100%;height:100%;color:#000;font-size:11px;font-weight:700;opacity:.4;pointer-events:none}.gsuiPianoroll-block .gsuiDragline{top:50%;right:0}.gsuiPianoroll-block .gsuiDragline-drop{top:50%;left:0}.gsuiPianoroll-block .gsuiDragline-drop::before{left:0}.gsuiPianoroll-block .gsuiDragline-dropActive::before{left:-4px}.gsuiPianoroll-block:not(:hover):not(.gsui-hover) .gsuiDragline:not(.gsuiDragline-dragging) .gsuiDragline-to{background-color:transparent}.gsuiPianoroll-block.gsui-hover .gsuiDragline:not(.gsuiDragline-linked) .gsuiDragline-to,.gsuiPianoroll-block:hover .gsuiDragline:not(.gsuiDragline-linked) .gsuiDragline-to{transform:translateX(2px)}.gsuiPianoroll-block.gsui-hover .gsuiDragline-linked .gsuiDragline-to,.gsuiPianoroll-block:hover .gsuiDragline-linked .gsuiDragline-to{transform:translateX(-2px)}:root{--gsuiKeys-blackRow-bg:#0000001a;--gsuiKeys-blackRow-hover-bg:#00000026;--gsuiKeys-whiteRow-hover-bg:#ffffff08}gsui-keys{--gsuiKeys-blackKey-gradA:#111;--gsuiKeys-blackKey-gradB:#444;--gsuiKeys-whiteKey-gradA:#888;--gsuiKeys-whiteKey-gradB:#eee;--gsuiKeys-activeKey-gradA:#353b52;--gsuiKeys-activeKey-gradB:#7886bd;--gsuiKeys-rootKey:#c143a4;--gsuiKeys-firstOctave:0;--gsuiKeys-nbOctaves:0;--gsui-gradientDeg:90deg;display:block;position:relative;height:100%;z-index:0;counter-reset:octave calc(var(--gsuiKeys-firstOctave) + var(--gsuiKeys-nbOctaves));user-select:none;-webkit-user-select:none}gsui-keys[orient=vertical]{height:calc(var(--gsuiKeys-nbOctaves)*12em)}gsui-keys[orient=horizontal]{--gsui-gradientDeg:180deg;width:calc(var(--gsuiKeys-nbOctaves)*12em)}.gsuiKey,gsui-keys{background-image:linear-gradient(var(--gsui-gradientDeg),var(--gsuiKeys-whiteKey-gradA),var(--gsuiKeys-whiteKey-gradB))}.gsuiKey .gsuiKey-row{display:none}.gsuiKey-row{position:absolute;box-sizing:border-box;width:100%;height:1em}.gsuiKeyBlack-row{background-color:var(--gsuiKeys-blackRow-bg)}.gsuiKey-row:hover{background-color:var(--gsuiKeys-whiteRow-hover-bg)}.gsuiKeyBlack-row:hover{background-color:var(--gsuiKeys-blackRow-hover-bg)}.gsuiKey-row[data-key="0"],.gsuiKey-row[data-key="5"],gsui-keys[orient=vertical] .gsuiKey[data-key="0"]:not(:last-child),gsui-keys[orient=vertical] .gsuiKey[data-key="5"]{border-bottom:1px solid #0003}gsui-keys[orient=horizontal] .gsuiKey[data-key="0"]:not(:last-child),gsui-keys[orient=horizontal] .gsuiKey[data-key="5"]{border-left:1px solid #0003}.gsuiKey,gsui-oscillator{box-sizing:border-box;position:absolute}gsui-keys[orient=vertical] .gsuiKey{inset:auto 0;top:calc(var(--gsuiKeys-key-id)*1em);height:1.5em}gsui-keys[orient=horizontal] .gsuiKey{inset:0 auto;right:calc(var(--gsuiKeys-key-id)*1em);width:1.5em}.gsuiKeyBlack{position:absolute;z-index:1;background-image:linear-gradient(var(--gsui-gradientDeg),var(--gsuiKeys-blackKey-gradA),var(--gsuiKeys-blackKey-gradB))}gsui-keys[orient=vertical] .gsuiKeyBlack{width:65%;height:1em;border-radius:0 .1em .1em 0}gsui-keys[orient=horizontal] .gsuiKeyBlack{width:1em;height:65%;border-radius:0 0 .1em .1em}.gsuiKey[data-key="0"]{filter:brightness(.9)}.gsuiKey[data-key="0"]::after{counter-increment:octave -1;content:"C"counter(octave);position:absolute;right:.25em;bottom:2px;color:#000;font-size:calc(6px + .25em);font-family:monospace}.gsuiKey-root[data-key="0"]::after{color:var(--gsuiKeys-whiteKey-gradB);padding:0 2px;border-radius:3px;background-color:var(--gsuiKeys-rootKey)}.gsuiKey-root.gsui-active::after{color:var(--gsuiKeys-rootKey);background-color:var(--gsuiKeys-whiteKey-gradB)}gsui-keys[orient=horizontal] .gsuiKey[data-key="0"]::after{left:.35em;right:auto}.gsuiKey.gsui-active{background-image:linear-gradient(var(--gsui-gradientDeg),var(--gsuiKeys-activeKey-gradA),var(--gsuiKeys-activeKey-gradB))}gsui-keys[orient=vertical] .gsuiKey[data-key="2"],gsui-keys[orient=vertical] .gsuiKey[data-key="7"],gsui-keys[orient=vertical] .gsuiKey[data-key="9"]{height:2em}gsui-keys[orient=horizontal] .gsuiKey[data-key="2"],gsui-keys[orient=horizontal] .gsuiKey[data-key="7"],gsui-keys[orient=horizontal] .gsuiKey[data-key="9"]{width:2em}.gsuiKey[data-key="0"],.gsuiKey[data-key="2"],.gsuiKey[data-key="5"],.gsuiKey[data-key="7"],.gsuiKey[data-key="9"]{margin-top:-.5em}gsui-keys[orient=horizontal] .gsuiKey[data-key="0"],gsui-keys[orient=horizontal] .gsuiKey[data-key="2"],gsui-keys[orient=horizontal] .gsuiKey[data-key="5"],gsui-keys[orient=horizontal] .gsuiKey[data-key="7"],gsui-keys[orient=horizontal] .gsuiKey[data-key="9"]{margin-top:0;margin-right:-.5em}gsui-oscillator{--gsuiOscillator-pan:var( --gsui-col-pan );--gsuiOscillator-gain:var( --gsui-col-gain );--gsuiOscillator-pan-a:#faa;--gsuiOscillator-pan-b:#aaf;--gsuiOscillator-detune:var( --gsui-col-detune );--gsuiOscillator-unison:var( --gsui-col-unison );--gsuiOscillator-grip-bg:#0002;--gsuiOscillator-wave-bg:#0006;--gsuiOscillator-wave-option:#444;--gsuiOscillator-wave-optionNative:#333;display:grid;position:relative;height:100%;min-width:260px;min-height:60px;background-color:var(--gsui-item-bg);grid-template:"grip .   .    .   .      .   .      .   .    .   .    ."6px"grip .   wave .   unison .   detune .   pan  .   gain ."1fr"grip .   .    .   .      .   .      .   .    .   .    ."6px/20px 6px 1fr 6px 32px 8px 36px 6px 36px 6px 36px 10px;container-type:inline-size;container-name:gsuiOscillator}@container gsuiOscillator (max-width: 300px){.gsuiOscillator-grip{background-color:#000!important}}.gsuiOscillator-grip{grid-area:grip;display:flex;align-items:center;justify-content:center;font-size:12px;cursor:grab;opacity:.6;background-color:var(--gsuiOscillator-grip-bg)}.gsuiOscillator-prop{display:flex;flex-direction:column;justify-content:center;gap:2px;--gsuiSlider-lineColor:currentColor}.gsuiOscillator-pan{grid-area:pan;color:var(--gsuiOscillator-pan)}.gsuiOscillator-gain{grid-area:gain;color:var(--gsuiOscillator-gain)}.gsuiOscillator-detune{grid-area:detune;color:var(--gsuiOscillator-detune)}.gsuiOscillator-sliderWrap{position:relative;box-sizing:border-box;height:32px;min-height:32px}.gsuiOscillator-prop gsui-slider:first-child .gsuiSlider-eventCatcher{bottom:-18px}.gsuiOscillator-prop gsui-slider+gsui-slider{position:absolute;overflow:hidden;border-radius:50%;top:calc(50% - 8px);left:calc(50% - 8px);width:16px;height:16px}.gsuiOscillator-prop gsui-slider+gsui-slider .gsuiSlider-eventCatcher{border-radius:50%}.gsuiOscillator-sliderValue{display:flex;align-items:center;justify-content:center;font-family:var(--gsui-font-number);font-size:12px;pointer-events:none}.gsuiOscillator-waveWrap{grid-area:wave;display:flex;border-radius:3px;background-color:var(--gsuiOscillator-wave-bg)}.gsuiOscillator-waveWrap-left{flex:1;display:flex;flex-direction:column}.gsuiOscillator-waveWrap-top{display:flex}.gsuiOscillator-wave{flex:1;position:relative}.gsuiOscillator-wave gsui-periodicwave{position:absolute}.gsuiOscillator-wave gsui-periodicwave:first-child{color:var(--gsuiOscillator-pan-a)}.gsuiOscillator-wave gsui-periodicwave:last-child{color:var(--gsuiOscillator-pan-b)}.gsuiOscillator-wave polyline{stroke-opacity:.8}.gsuiOscillator-remove{border:0;padding:0;cursor:pointer;color:inherit;opacity:.5;transition:.1s opacity}.gsuiOscillator-waveBtn{padding:0}.gsuiOscillator-waveBtn,.gsuiOscillator-waveSelect{border:0;outline:0;cursor:pointer;color:inherit;background:0 0;opacity:.5;transition:.1s opacity}.gsuiOscillator-waveBtn{width:14px;font-size:16px;text-align:center}.gsuiOscillator-remove{position:absolute;inset:0 2px auto auto;outline:0;font-size:12px;background:0 0}.gsuiOscillator-remove:focus-visible,.gsuiOscillator-remove:hover,.gsuiOscillator-waveBtn:focus-visible,.gsuiOscillator-waveBtn:hover,.gsuiOscillator-waveSelect:focus-visible,.gsuiOscillator-waveSelect:hover{opacity:1}.gsuiOscillator-waveSelect{flex:1;padding:0 0 0 6px;font-size:12px;font-family:inherit;-moz-appearance:none;-webkit-appearance:none}.gsuiOscillator-waveOpt{background-color:var(--gsuiOscillator-wave-option)}.gsuiOscillator-waveOptNative{background-color:var(--gsuiOscillator-wave-optionNative)}.gsuiOscillator-unisonGraph{overflow:hidden;display:flex;flex-direction:column;align-items:center;width:10px}.gsuiOscillator-unisonGraph-voices{display:flex;flex-direction:column;align-items:center;justify-content:space-between;margin:auto 0;width:100%;min-height:3px;pointer-events:none}.gsuiOscillator-unisonGraph-voice{height:3px;min-width:1px;border-radius:3px;background-color:var(--gsuiOscillator-unison);opacity:.75}.gsuiOscillator-unisonGraph-voice:only-child{margin:auto 0}.gsuiOscillator-unison{grid-area:unison;display:flex;gap:5px;--gsuiSlider-lineColor:var( --gsuiOscillator-unison )}.gsuiOscillator-unison gsui-slider+gsui-slider{width:6px;min-width:6px}.gsuiOscillator-unison gsui-slider .gsuiSlider-eventCatcher{inset:-3px}gsui-periodicwave,gsui-periodicwave svg{width:100%;height:100%}gsui-periodicwave polyline{stroke:currentColor;fill:none}gsui-synthesizer{display:flex;flex-direction:column;overflow:auto;position:relative;box-sizing:border-box;height:100%;scrollbar-width:thin;scrollbar-color:#ddd #222}.gsuiSynthesizer-head{display:flex;align-items:center;box-sizing:border-box;height:24px;font-size:14px;line-height:1em;user-select:none;padding-top:2px;border-bottom:2px solid #0002;background-color:var(--gsui-head-bg)}.gsuiSynthesizer-headTitle{font-size:10px;font-weight:700;line-height:24px}.gsuiSynthesizer-head gsui-toggle{align-self:normal;width:24px}.gsuiSynthesizer-label{width:36px;text-align:center;font-size:10px;opacity:.75}.gsuiSynthesizer-labelUnison{margin-left:auto;width:38px}.gsuiSynthesizer-env,.gsuiSynthesizer-lfo{height:90px;min-height:90px}.gsuiSynthesizer-headOscs{gap:6px;height:24px;padding:2px 10px 0 8px}.gsuiSynthesizer-oscList{flex:1;display:grid;grid-auto-flow:row;grid-auto-rows:min-content;counter-reset:count-osc;background-color:var(--gsui-items-bg)}gsui-synthesizer gsui-oscillator{transition:.2s filter}gsui-synthesizer gsui-oscillator:hover{filter:brightness(1.05)}gsui-synthesizer gsui-oscillator:only-of-type .gsuiOscillator-remove{display:none}.gsuiSynthesizer-newOsc{position:relative;order:2147483647;border:0;height:52px;color:inherit;font-size:18px;cursor:pointer;border-radius:2px;background:0 0;opacity:.4;transition:.2s opacity}.gsuiSynthesizer-newOsc:focus,.gsuiSynthesizer-newOsc:hover{opacity:.6}.gsuiSynthesizer-newOsc::before{position:absolute;content:"";inset:6px;opacity:.4;border:2px dashed}gsui-panel{display:flex;z-index:0;width:100%;height:100%}.gsuiPanel-extend{--w:8px;position:relative;z-index:1}.gsuiPanel-extend[data-axis=x]{min-width:var(--w);left:calc(var(--w)/-2);margin-right:calc(var(--w)*-1);cursor:ew-resize}.gsuiPanel-extend[data-axis=y]{min-height:var(--w);top:calc(var(--w)/-2);margin-bottom:calc(var(--w)*-1);cursor:ns-resize}:root{--gsuiPanels-border:#777;--gsuiPanels-extendColor:#888}.gsuiPanels-x,.gsuiPanels-y{display:flex;height:100%}.gsuiPanels-y{flex-direction:column}.gsuiPanels-x>div:not(.gsuiPanels-extend),.gsuiPanels-y>div:not(.gsuiPanels-extend){position:relative;box-sizing:border-box}.gsuiPanels-x>div+div:not(.gsuiPanels-extend){border-left:4px solid var(--gsuiPanels-border)}.gsuiPanels-y>div+div:not(.gsuiPanels-extend){border-top:4px solid var(--gsuiPanels-border)}.gsuiPanels-extend{position:absolute;top:-2px;left:0;width:100%;height:100%;transition:background-color .2s}.gsuiPanels-extend.gsui-hover,.gsuiPanels-extend:hover{background-color:var(--gsuiPanels-extendColor)}.gsuiPanels-x>div>.gsuiPanels-extend{cursor:col-resize;width:4px;margin-left:-2px}.gsuiPanels-y>div>.gsuiPanels-extend{cursor:row-resize;height:4px;margin-top:-2px}gsui-popup{--gsuiPopup-bg:#555;--gsuiPopup-btn-bg:#999;--gsuiPopup-btnOk-bg:#67a;--gsuiPopup-radius:4px;--gsuiPopup-padding:10px;--gsuiPopup-minWidth:250px;--gsuiPopup-header-bg:#333;--gsuiPopup-header-fontSize:16px;--gsuiPopup-body-fontSize:14px;--gsuiPopup-overlay-bg:#0009;display:flex;position:fixed;align-items:center;justify-content:center;inset:0;z-index:2147483647;color:#fff;background-color:var(--gsuiPopup-overlay-bg);backdrop-filter:grayscale(1) blur(2px)}gsui-popup:not(.gsuiPopup-show){visibility:hidden}.gsuiPopup-window{overflow:hidden;min-width:var(--gsuiPopup-minWidth);border-radius:var(--gsuiPopup-radius);background-color:var(--gsuiPopup-bg);outline:0;box-shadow:0 0 50px #000;transition:margin-top .2s,opacity .5s}gsui-popup:not(.gsuiPopup-show) .gsuiPopup-window{margin-top:-50px;opacity:0}.gsuiPopup-window:focus-within{box-shadow:0 0 1px 2px #69b,0 0 50px #000}#gsuiSlicer-waveDefs,.gsuiPopup-noCancel .gsuiPopup-cancel,.gsuiPopup-noText .gsuiPopup-inputText,gsui-slicer[disabled] .gsuiSlicer-currentTime,gsui-slicer[hidetimes] .gsuiSlicer-currentTime{display:none}.gsuiPopup-head{padding:var(--gsuiPopup-padding);font-size:var(--gsuiPopup-header-fontSize);background-color:var(--gsuiPopup-header-bg)}.gsuiPopup-body{font-size:var(--gsuiPopup-body-fontSize);padding:var(--gsuiPopup-padding)}.gsuiPopup-content:not(:empty)+.gsuiPopup-message,.gsuiPopup-content:not(:empty)~input{display:none}.gsuiPopup-btns input,.gsuiPopup-inputText{border:0;border-radius:4px}.gsuiPopup-btns input{padding:.6em 1.25em}.gsuiPopup-window input,.gsuiPopup-window select{outline:0}.gsuiPopup-window input:focus,.gsuiPopup-window select:focus{box-shadow:0 0 1px 2px #69b}.gsuiPopup-inputText{box-sizing:border-box;padding:8px;width:100%;font-size:14px;height:32px}.gsuiPopup-btns{margin-top:var(--gsuiPopup-padding);text-align:center}.gsuiPopup-btns input{color:#fff;font-weight:700;font-family:inherit;background-color:var(--gsuiPopup-btn-bg);cursor:pointer}.gsuiPopup-btns input+input{margin-left:var(--gsuiPopup-padding)}.gsuiPopup-btns .gsuiPopup-ok{background-color:var(--gsuiPopup-btnOk-bg)}.gsuiPopup-content a{color:inherit;text-decoration:none}.gsuiPopup-content a:not(.gsuiIcon):hover{text-decoration:underline}.gsuiPopup-content fieldset{display:flex;flex-direction:column;border:2px solid #444;border-radius:4px;margin-bottom:10px}.gsuiPopup-content input[type=checkbox],.gsuiPopup-content input[type=radio]{margin:0 8px 0 0}.gsuiPopup-content input[type=range]{min-width:0}.gsuiPopup-row{display:flex;align-items:center;font-size:14px;padding:4px;gap:6px}.gsuiPopup-row+.gsuiPopup-row{margin-top:6px}.gsuiPopup-row-title{flex:1;font-size:13px}.gsuiPopup-row-values,.gsuiPopup-row-values label{display:flex;align-items:center;font-family:var(--gsui-font-monospace);gap:.6ch}.gsuiPopup-row-values label{cursor:pointer}.gsuiScrollShadow{--gsuiScrollShadow-dist:0;--gsuiScrollShadow-x:0;--gsuiScrollShadow-y:0;z-index:1}.gsuiScrollShadow[data-dir=top]{--gsuiScrollShadow-y:1}.gsuiScrollShadow[data-dir=left]{--gsuiScrollShadow-x:1}.gsuiScrollShadow[data-dir=right]{--gsuiScrollShadow-x:-1}.gsuiScrollShadow[data-dir=bottom]{--gsuiScrollShadow-y:-1}.gsuiScrollShadow-shadowed{box-shadow:calc(var(--gsuiScrollShadow-dist)*var(--gsuiScrollShadow-x)) calc(var(--gsuiScrollShadow-dist)*var(--gsuiScrollShadow-y)) calc(var(--gsuiScrollShadow-dist)*2) #0004}gsui-slicer{--gsuiSlicer-bg:#666;--gsuiSlicer-color:#fff;--gsuiSlicer-slicers-bg:#47475c;--gsuiSlicer-source-bg:#334;--gsuiSlicer-source-wave:var( --gsui-col-pattern );--gsuiSlicer-preview-wave-border:#fff2;--gsuiSlicer-preview-wave-hl-bg:#fff1;--gsuiSlicer-slice-bg:#44c4;--gsuiSlicer-slice-hl-bg:#77f4;--gsuiSlicer-slice-border:#32325a;position:relative;display:flex;flex-direction:column;box-sizing:border-box;gap:10px;height:100%;min-width:306px;color:var(--gsuiSlicer-color);background-color:var(--gsuiSlicer-bg);user-select:none;-webkit-tap-highlight-color:transparent}.gsuiSlicer-preview,.gsuiSlicer-slices,.gsuiSlicer-source-head,.gsuiSlicer-source-sample-wrap,.gsuiSlicer-time{border:0 solid #0002;border-left-width:8px;border-right-width:8px}.gsuiSlicer-currentTime{position:absolute;z-index:1;inset:0 auto;width:2px;margin-left:-1px;background-color:var(--gsui-col-currentTimeCursor);pointer-events:none}.gsuiSlicer-source{overflow:hidden;min-height:48px;flex:.35;display:flex;flex-direction:column;background-color:var(--gsuiSlicer-source-bg)}.gsuiSlicer-source-head{display:flex;align-items:center;height:20px;font-size:11px;font-weight:700;padding:0 4px;background-color:#0004}.gsuiSlicer-source-icon{margin-right:6px;font-size:12px;opacity:.4}.gsuiSlicer-source-name{opacity:.4}.gsuiSlicer-source-name:empty::after{content:"no sample loaded...";font-style:italic;opacity:.5}.gsuiSlicer-missingBufferData .gsuiSlicer-source-name::after{content:" (buffer not ready)";font-style:italic;opacity:.5}.gsuiSlicer-source-sample-wrap{flex:1;border-bottom-width:2px}.gsuiSlicer-source-sample{position:relative;overflow:hidden;height:100%;min-height:20px}.gsuiSlicer-source-wave{position:absolute;width:100%;height:100%;fill:var(--gsuiSlicer-source-wave);pointer-events:none}.gsuiSlicer-preview,.gsuiSlicer-time{overflow:hidden;background-color:var(--gsuiSlicer-source-bg)}.gsuiSlicer-time{height:20px;min-height:20px;margin-bottom:-10px}.gsuiSlicer-preview{position:relative;flex:.4;min-height:30px;border-top-width:2px;border-bottom-width:2px}.gsuiSlicer-preview-wave{position:absolute;height:100%;fill:var(--gsuiSlicer-source-wave);border-right:1px dashed var(--gsuiSlicer-preview-wave-border);transition:background-color .5s}.gsuiSlicer-preview-wave-hl{background-color:var(--gsuiSlicer-preview-wave-hl-bg);transition:none}.gsuiSlicer-slices{flex:1;margin-top:-10px;min-height:100px;overflow:hidden;color:#000;border-bottom-width:2px;background-color:var(--gsuiSlicer-slicers-bg)}.gsuiSlicer-slices-scroll{overflow:auto;height:100%}.gsuiSlicer-slices-beatlinesWrap{position:absolute;width:100%;height:100%;pointer-events:none}.gsuiSlicer-slices-in{position:relative;height:100%}.gsuiSlicer-slices-line{position:absolute;width:100%;height:100%;opacity:.2;pointer-events:none}.gsuiSlicer-slices-line line{stroke:currentColor;stroke-width:2px;stroke-dasharray:10 5}.gsuiSlicer-slices-wrap{position:relative;height:100%;cursor:pointer;touch-action:none}.gsuiSlicer-slices-slice{position:absolute;box-sizing:border-box;bottom:0;border:0 solid var(--gsuiSlicer-slice-border);border-width:3px 1px 0;border-radius:2px 2px 0 0;background-color:var(--gsuiSlicer-slice-bg);pointer-events:none;filter:grayscale(.5) opacity(.8);transition:filter .2s,background-color .5s}.gsuiSlicer-loaded .gsuiSlicer-slices-slice{filter:none}.gsuiSlicer-slices-slice-hl{background-color:var(--gsuiSlicer-slice-hl-bg);transition:filter .2s}.gsuiSlicer-menu{display:flex;gap:6px;height:20px;justify-content:space-between;padding:0 8px 8px;font-size:14px}.gsuiSlicer-btn{display:flex;align-items:center;justify-content:center;box-sizing:border-box;gap:6px;border:0;outline:0;padding:0 6px;min-width:32px;border-radius:4px;font-size:inherit;color:inherit;cursor:pointer;white-space:nowrap;background-color:#fff2;user-select:none;opacity:.6;transition:.2s opacity}.gsuiSlicer-btn-toggle{border:2px solid #fff8}.gsuiSlicer-btn-toggle,.gsuiSlicer-btn:focus,.gsuiSlicer-btn:hover{opacity:1}.gsuiSlicer-btn-step{margin-right:auto;font-family:var(--gsui-font-number)}gsui-slider,gsui-slidergroup{display:block;position:relative;height:100%}gsui-slider{width:100%;outline:0;touch-action:none;user-select:none}gsui-slider[disabled]{cursor:not-allowed;--gsuiSlider-lineColor:#fff}gsui-slider[disabled] .gsuiSlider-lineColor,gsui-slider[disabled] .gsuiSlider-svgLineColor{opacity:.25}.gsuiLibraries-body gsui-library,.gsuiSlider-eventCatcher,.gsuiSlider-line{position:absolute;inset:0}.gsuiSlider-circular .gsuiSlider-line,.gsuiSlider-input,.gsuiSlider-linear .gsuiSlider-svg,gsui-slidergroup[currenttime="0"] .gsuiSliderGroup-currentTime{display:none}.gsuiSlider-line{overflow:hidden;border-radius:var(--gsuiSlider-lineRadius, 2px );background-color:var(--gsuiSlider-lineBgColor, #000 )}.gsuiSlider-lineColor{position:absolute;background-color:var(--gsuiSlider-lineColor, #fff )}.gsuiSlider-svg{position:absolute;width:100%;height:100%;pointer-events:none}.gsuiSlider-svgLine,.gsuiSlider-svgLineColor{fill:none;transform-origin:center}.gsuiSlider-svgLine{stroke:var(--gsuiSlider-lineBgColor, #000 )}.gsuiSlider-svgLineColor{stroke:var(--gsuiSlider-lineColor, #fff )}gsui-slidergroup{--gsuiSliderGroup-currentTime-color:var( --gsui-col-currentTimeCursor );--gsuiSliderGroup-defaultValue-color:#0004;--gsuiSliderGroup-slider-width:6px;--gsuiSliderGroup-slider-bg:#0002;--gsuiSliderGroup-slider-color:rgba( var( --gsui-rgb-pattern ), .8 );--gsuiSliderGroup-slider-color-selected:rgba( var( --gsui-rgb-patternSelected ), .8 );--gsuiSliderGroup-loop-color:#0004;overflow:hidden;z-index:0}.gsuiSliderGroup-slidersWrap{position:absolute;width:100%;top:0;bottom:0;overflow:auto;scrollbar-width:none}.gsuiSliderGroup-slidersWrap::-webkit-scrollbar{display:none}.gsuiSliderGroup-sliders{position:absolute;width:1000000px;height:100%;user-select:none}.gsuiSliderGroup-slider{position:absolute;overflow:hidden;top:0;bottom:0;cursor:pointer}.gsuiSliderGroup-slider::before{content:"";position:absolute;height:100%;width:var(--gsuiSliderGroup-slider-width);background-color:var(--gsuiSliderGroup-slider-bg)}.gsuiSliderGroup-slidersSelected .gsuiSliderGroup-slider:not(.gsuiSliderGroup-sliderSelected){pointer-events:none}.gsuiSliderGroup-sliderInner{position:absolute;width:var(--gsuiSliderGroup-slider-width);color:var(--gsuiSliderGroup-slider-color);background-color:currentColor}.gsuiSliderGroup-sliderSelected .gsuiSliderGroup-sliderInner{color:var(--gsuiSliderGroup-slider-color-selected)}.gsuiSliderGroup-sliderInner::after{content:"";position:absolute;box-sizing:border-box;width:1000000px;height:100%;border:0 solid;border-width:1px 0 0}.gsuiSliderGroup-sliderInnerDown::after{border-width:0 0 1px}.gsuiSliderGroup-currentTime,.gsuiSliderGroup-loop{position:absolute;z-index:2147483647;top:0;bottom:0;pointer-events:none}.gsuiSliderGroup-defaultValue{position:absolute;left:0;right:0;border-top:1px dotted var(--gsuiSliderGroup-defaultValue-color);pointer-events:none}.gsuiSliderGroup-currentTime{width:2px;margin-left:-1px;background-color:var(--gsuiSliderGroup-currentTime-color)}.gsuiSliderGroup-loop{background-color:transparent;transition:.2s background-color}.gsuiSliderGroup-loopA{left:0}.gsuiSliderGroup-loopB{right:0}.gsuiSliderGroup-loopOn{background-color:var(--gsuiSliderGroup-loop-color)}gsui-libraries{--gsuiLibraries-head-bg:#666;display:flex;flex-direction:column;height:100%;user-select:none}.gsuiLibraries-head{display:flex;align-items:center;gap:4px;height:24px;min-height:24px;line-height:1;padding:0 6px;font-size:11px;background-color:var(--gsuiLibraries-head-bg);user-select:none}.gsuiLibraries-head-icon,.gsuiLibraries-head-title{font-weight:700;opacity:.7}.gsuiLibraries-libBtns{display:flex;margin-left:8px;border-radius:4px;background-color:#0004;overflow:hidden}.gsuiLibraries-libBtn{display:flex;align-items:center;height:18px;border:0;outline:0;padding:1px 3px 0 6px;font:inherit;font-size:9px;font-weight:700;cursor:pointer;background-color:transparent}.gsuiLibraries-libBtn+.gsuiLibraries-libBtn{padding-left:3px}.gsuiLibraries-libBtn:last-child{padding-right:6px}gsui-libraries:not([lib=default]) .gsuiLibraries-libBtn[data-lib=default],gsui-libraries:not([lib=local]) .gsuiLibraries-libBtn[data-lib=local]{opacity:.3}.gsuiLibraries-body{position:relative;flex:1}gsui-libraries:not([lib=default]) .gsuiLibrary-default,gsui-libraries:not([lib=local]) .gsuiLibrary-local{display:none}.gsuiLibrary-body,gsui-library{display:flex;flex-direction:column}gsui-library{--gsuiLibrary-bg:#233240;--gsuiLibrary-head-bg:#666;--gsuiLibrary-sample-fav:#9af;--gsuiLibrary-sample-hover-bg:#fff1;height:100%;user-select:none}.gsuiLibrary-body{flex:1;z-index:0;position:relative;align-content:flex-start;flex-wrap:wrap;overflow:auto hidden;background-color:var(--gsuiLibrary-bg)}.gsuiLibrary-placeholder{display:none;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%;padding:0 2ch;text-align:center;font-size:12px;font-style:italic;opacity:.4}.gsuiLibrary-placeholder:only-child{display:flex}.gsuiLibrary-sep{z-index:1;box-sizing:border-box;width:80px;height:28px;padding:10px 8px 0 0;counter-reset:smpNum 0}.gsuiLibrary-sep-btn{display:flex;max-width:100%;gap:1ch;cursor:pointer;border:0;padding:4px;font-size:9px;font-weight:700;background:0 0}.gsuiLibrary-sep .gsuiIcon{opacity:.3;pointer-events:none}.gsuiLibrary-sep span{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;padding-right:.1ch;pointer-events:none}.gsuiLibrary-sep span:empty::before{content:"no name";font-style:italic;opacity:.5}.gsuiLibrary-sep-expanded .gsuiIcon{transform:rotate(90deg)}.gsuiLibrary-sample,.gsuiLibrary-sample::after{position:relative;align-items:center;pointer-events:none;opacity:0}.gsuiLibrary-sample{display:flex;overflow:hidden;width:80px;height:14px;margin-top:-14px;cursor:pointer;counter-increment:smpNum 1;transition:margin-top .3s,opacity .3s,background-color .2s}.gsuiLibrary-sample-expanded{margin-top:0;opacity:1;pointer-events:auto}.gsuiLibrary-sample-loading{animation:.2s alternate infinite gsuiLibrary-sample-loading-anim}.gsuiLibrary-sample::after{content:counter(smpNum);display:inline-flex;margin-left:auto;margin-right:5px;padding:1px 3px;border-radius:3px;font-size:9px;font-family:var(--gsui-font-monospace);background-color:var(--gsuiLibrary-bg)}.gsuiLibrary-sample-fav::after,.gsuiLibrary-sample:hover::after{opacity:1}.gsuiLibrary-sample-fav::after{color:var(--gsuiLibrary-bg);font-weight:700;background-color:var(--gsuiLibrary-sample-fav)}.gsuiLibrary-sample-wave{position:absolute;width:100%;height:100%;pointer-events:none}.gsuiLibrary-sample-svg{position:absolute;fill:currentColor;width:100%;height:100%;opacity:.2}.gsuiLibrary-sample-fav .gsuiLibrary-sample-svg{opacity:.4;fill:var(--gsuiLibrary-sample-fav)}.gsuiLibrary-sample:hover .gsuiLibrary-sample-svg{opacity:.4}.gsuiLibrary-sample-fav:hover .gsuiLibrary-sample-svg{opacity:.6}.gsuiLibrary-sample-cursor{display:none;position:absolute;left:0;width:2px;height:100%;margin-left:-1px;background-color:currentColor;transition:0s linear left;pointer-events:none}.gsuiLibrary-sample-cursor::before{position:absolute;content:"";top:0;bottom:0;right:100%;width:10px;background-image:linear-gradient(90deg,transparent,currentColor);opacity:.2}.gsuiLibrary-sample-playing .gsuiLibrary-sample-cursor{display:block}gsui-patterns{--gsuiPatterns-panel-menu-bg:#666;--gsuiPatterns-panel-btnSolid-bg:#444;--gsuiPatterns-newSlicesBtn-color:#e29d8a;--gsuiPatterns-newSynthBtn-color:#a5d6a7;--gsuiPatterns-newDrumsBtn-color:#81d4fa;--gsuiPatterns-synth-bg:#528754;--gsuiPatterns-synth-color:#222;--gsuiPatterns-synth-selected-color:#444;--gsuiPatterns-synth-expand-bg:#0000001a;--gsuiPatterns-synth-selected-bg:#66bb6a;--gsuiPatterns-synth-namehover-color:#7b7;--gsuiPatterns-synth-patterns-bg:#0006;--gsuiPatterns-synth-dest-bg:#0000001a;--gsuiPatterns-synth-placeholder-color:#fff6;--gsuiPatterns-synth-placeholder-bg:#0003;--gsuiPatterns-pattern-bg:#334;--gsuiPatterns-pattern-color:var( --gsui-col-pattern );--gsuiPatterns-pattern-selected-bg:var( --gsui-col-pattern );--gsuiPatterns-pattern-selected-color:#223;--gsuiPatterns-pattern-head-bg:#0003;--gsuiPatterns-pattern-head-selected-bg:#fff3;--gsuiPatterns-pattern-dest-bg:#fff1;--gsuiPatterns-pattern-h:42px;--gsuiPatterns-pattern-head-h:20px;--gsuiPatterns-pattern-grip-w:14px;display:block;height:100%}#gsuiPatterns-infoPopupContent label{display:flex;align-items:center;height:32px;cursor:pointer}#gsuiPatterns-infoPopupContent .gsuiIcon{width:20px;margin-left:.4ch;margin-right:.8ch}#gsuiPatterns-infoPopupContent input[name=bpm]{margin-left:8px;width:8ch}#gsuiPatterns-infoPopupContent input[name=name]{width:214px}#gsuiPatterns-infoPopupContent span+span{margin-left:8px}#gsuiPatterns-infoPopupContent input[value=loop]:not(:checked)~input[name=bpm],#gsuiPatterns-infoPopupContent input[value=loop]:not(:checked)~span:last-of-type{opacity:.4}.gsuiPatterns-panel:first-child{min-height:24px}.gsuiPatterns-panel{display:flex;flex-direction:column;min-height:28px}.gsuiPatterns-panelBuffers,.gsuiPatterns-panelDrums,.gsuiPatterns-panelSlices{height:20%}.gsuiPatterns-panelKeys{height:40%}.gsuiPatterns-panel-menu{display:flex;align-items:center;height:24px;min-height:24px;gap:4px;padding:0 6px;font-size:11px;background-color:var(--gsuiPatterns-panel-menu-bg);user-select:none}.gsuiPatterns-panel-icon,.gsuiPatterns-panel-title{line-height:1;opacity:.7}.gsuiPatterns-panel-title{font-weight:700}.gsuiPatterns-panel-menu .gsuiPatterns-btnSolid{width:16px}.gsuiPatterns-panel-list-wrap{position:relative;flex:1}.gsuiPatterns-panel-list{overflow:auto;position:absolute;inset:0}.gsuiPatterns-panel-list:empty{display:none}.gsuiPatterns-destArrow{margin:0 4px;opacity:.7;pointer-events:none}.gsuiPatterns-btnSolid{display:inline-flex;align-items:center;justify-content:center;overflow:hidden;height:14px;padding:0 4px;border:0;outline:0;cursor:pointer;border-radius:3px;line-height:1;color:inherit;font:inherit;font-weight:700;text-align:start;background-color:var(--gsuiPatterns-panel-btnSolid-bg);transition:filter .2s}.gsuiPatterns-btnSolid:focus,.gsuiPatterns-btnSolid:hover{filter:brightness(1.1)}.gsuiPatterns-btnSolid[data-action=newSlices]{color:var(--gsuiPatterns-newSlicesBtn-color)}.gsuiPatterns-btnSolid[data-action=newSynth]{color:var(--gsuiPatterns-newSynthBtn-color)}.gsuiPatterns-btnSolid[data-action=newDrums]{color:var(--gsuiPatterns-newDrumsBtn-color)}.gsuiPatterns-btnIcon{pointer-events:none}.gsuiPatterns-btnText{margin-left:4px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;pointer-events:none}.gsuiPatterns-placeholder{display:none;overflow:hidden;height:100%;padding:0 10px;text-align:center;align-items:center;justify-content:center;font-size:12px;font-weight:700;opacity:0;transition:.3s;transition-property:opacity;user-select:none}.gsuiPatterns-placeholderToCheck .gsuiPatterns-placeholder:only-child,.gsuiPatterns-placeholderToCheck:empty+.gsuiPatterns-placeholder{display:flex;opacity:.4}.gsuiPatterns-synth{display:flex;flex-direction:column;color:var(--gsuiPatterns-synth-color);border-bottom:0 solid var(--gsuiPatterns-synth-bg);background-color:var(--gsuiPatterns-synth-bg);transition:.2s;transition-property:border-bottom-color,background-color,filter}.gsuiPatterns-synth-expanded{filter:brightness(1.1);border-bottom-width:2px}.gsuiPatterns-synth-selected{--gsuiPatterns-synth-bg:var( --gsuiPatterns-synth-selected-bg );--gsuiPatterns-synth-color:var( --gsuiPatterns-synth-selected-color )}.gsuiPatterns-synth-head{display:flex;height:30px;line-height:30px;font-size:9px;user-select:none}.gsuiPatterns-synth-btn{width:14px;min-width:14px;margin:0;border:0;outline:0;padding:0;opacity:.7;color:inherit;cursor:pointer;background:0 0;transition:.1s;transition-property:background-color,opacity}.gsuiPatterns-synth-btn:focus,.gsuiPatterns-synth-btn:hover{opacity:1}.gsuiPatterns-synth:not(.gsuiPatterns-synth-selected) .gsuiPatterns-synth-btn:hover{color:var(--gsuiPatterns-synth-namehover-color)}.gsuiPatterns-synth-expand{width:14px;min-width:14px;background-color:var(--gsuiPatterns-synth-expand-bg)}.gsuiPatterns-synth-expanded .gsuiPatterns-synth-expand{opacity:1}.gsuiPatterns-synth-info,.gsuiPatterns-synth-name{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.gsuiPatterns-synth-info{flex:1;display:flex;align-items:center;padding-left:6px;font-weight:700}.gsuiPatterns-synth-name{pointer-events:none}.gsuiPatterns-synth-name:empty::before{content:"Untitled";font-style:italic;opacity:.8}.gsuiPatterns-synth-dest{background-color:var(--gsuiPatterns-synth-dest-bg)}.gsuiPatterns-synth-dest:focus,.gsuiPatterns-synth-dest:hover{color:var(--gsuiPatterns-synth-bg);background-color:var(--gsuiPatterns-panel-btnSolid-bg)}.gsuiPatterns-synth-patterns{position:relative;overflow:hidden;min-height:0;background-color:var(--gsuiPatterns-synth-patterns-bg);transition:.3s min-height}.gsuiPatterns-synth-expanded .gsuiPatterns-synth-patterns{overflow-y:auto;min-height:32px}.gsuiPatterns-synth .gsuiPatterns-pattern{margin-top:calc(var(--gsuiPatterns-pattern-h)*-1)}.gsuiPatterns-synth-expanded .gsuiPatterns-pattern{margin-top:0}.gsuiPatterns-synth .gsuiPatterns-placeholder{position:absolute;inset:0}.gsuiPatterns-pattern{overflow:hidden;position:relative;box-sizing:border-box;flex-direction:column;height:var(--gsuiPatterns-pattern-h);color:var(--gsuiPatterns-pattern-color);font-size:9px;border-bottom:2px solid transparent;background-color:var(--gsuiPatterns-pattern-bg);transition:margin-top .3s,background-color .1s}.gsuiPatterns-pattern-selected{--gsuiPatterns-pattern-bg:var( --gsuiPatterns-pattern-selected-bg );--gsuiPatterns-pattern-color:var( --gsuiPatterns-pattern-selected-color );--gsuiPatterns-pattern-head-bg:var( --gsuiPatterns-pattern-head-selected-bg )}.gsuiPatterns-pattern-grip{position:absolute;inset:0;width:calc(var(--gsuiPatterns-pattern-grip-w) - 2px);cursor:grab;text-align:center;line-height:var(--gsuiPatterns-pattern-h);background-color:var(--gsuiPatterns-pattern-head-bg)}.gsuiPatterns-pattern-btn{width:14px;border:0;outline:0;padding:0;opacity:.7;color:inherit;cursor:pointer;background:0 0;transition:.1s opacity}.gsuiPatterns-pattern-btn:focus,.gsuiPatterns-pattern-btn:hover{opacity:1}.gsuiPatterns-pattern-head{display:flex;box-sizing:border-box;position:absolute;inset:0 0 auto var(--gsuiPatterns-pattern-grip-w);height:var(--gsuiPatterns-pattern-head-h);line-height:var(--gsuiPatterns-pattern-head-h);background-color:var(--gsuiPatterns-pattern-head-bg);transition:inherit}.gsuiPatterns-pattern-info{flex:1;display:flex;align-items:center;padding:0 4px;overflow:hidden}.gsuiPatterns-pattern-btnInfo{width:1em;font-size:10px;margin-right:6px}.gsuiPatterns-pattern-name{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-weight:700}.gsuiPatterns-pattern-name:empty::after{content:"Untitled";font-style:italic;opacity:.5}.gsuiPatterns-pattern-dest{background-color:var(--gsuiPatterns-pattern-dest-bg)}.gsuiPatterns-pattern-dest:focus,.gsuiPatterns-pattern-dest:hover{color:var(--gsuiPatterns-pattern-bg);background-color:var(--gsuiPatterns-pattern-color)}.gsuiPatterns-pattern-content,.gsuiPatterns-pattern-placeholder{position:absolute;inset:var(--gsuiPatterns-pattern-head-h)0 0 var(--gsuiPatterns-pattern-grip-w);pointer-events:none}.gsuiPatterns-pattern-svg{position:absolute;inset:0;width:100%;height:100%;opacity:.8;fill:currentColor}.gsuiPatterns-pattern-placeholder{display:none;align-items:center;font-size:14px;opacity:.5}.gsuiPatterns-pattern[data-missing] .gsuiPatterns-pattern-placeholder{display:flex}.gsuiPatterns-pattern-placeholderIcon{margin:0 8px}.gsuiPatterns-pattern-placeholderText{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;user-select:none}gsui-toggle{position:relative;display:inline-flex;align-items:center;justify-content:center;font:8px"FontAwesome";outline:0;cursor:pointer;color:var(--gsui-toggle-on);transition:color .1s}gsui-toggle[off]{color:var(--gsui-toggle-off)}gsui-toggle::after,gsui-toggle::before{transition:.2s text-shadow;pointer-events:none}gsui-toggle:focus-visible::after,gsui-toggle:focus-visible::before{text-shadow:0 0 10px var(--gsui-toggle-on)}gsui-toggle::before{position:absolute;content:"";opacity:.6}gsui-toggle::after{content:"􏌒"}.gsuiTrack-row,gsui-track{transition:.2s background-color}gsui-track{box-sizing:border-box;display:flex;height:100%;border-top:2px solid #ffffff11;border-bottom:2px solid #0000003b;background-color:var(--gsui-item-bg)}.gsuiTrack-row{position:relative;z-index:0;height:var(--gsuiTimewindow-lineH)}gsui-track[mute]{border:0;background-color:var(--gsui-item-bg-disabled)}.gsuiTrack-row::before{content:"";position:absolute;inset:0;border-top:2px solid #ffffff0b;border-bottom:2px solid #00000026}.gsuiTrack-row.gsui-mute{border:0;background-color:#00000012}.gsuiTrack-row>div{position:absolute;inset:0;font-size:var(--gsuiTimewindow-pxperbeat)}.gsuiTrack-row.gsui-mute>div{top:0}gsui-track gsui-toggle{min-width:24px}.gsuiTrack-nameWrap{position:relative;flex:1}.gsuiTrack-name{box-sizing:border-box;position:absolute;inset:0;width:100%;border:0;outline:0;padding-right:10px;font-size:12px;font-weight:700;font-family:inherit;text-overflow:ellipsis;color:inherit;cursor:default;background:0 0;user-select:none}gsui-track[mute] .gsuiTrack-name{opacity:.5}.gsuiTrack-name:focus{font-weight:400}.gsuiTrack-name::placeholder{color:inherit;font-style:italic;font-weight:400;opacity:.3}.gsuiTrack-name:focus::placeholder{color:transparent}gsui-window{--gsuiWindow-bg:#444;--gsuiWindow-color:#222;--gsuiWindow-head-bg:#888;--gsuiWindow-border-color:#444;--gsuiWindow-btn-close-color:#ba5d5d88;--gsuiWindow-focused-border-color:#689acb;--gsuiWindow-radius:2px;--gsuiWindow-head-height:24px;--gsuiWindow-border-width:2px;--gsuiWindow-handler-width:4px;--gsuiWindow-title-opacity:.8;position:absolute;z-index:0;outline:0;border-radius:var(--gsuiWindow-radius);transition:.2s;transition-property:opacity,visibility}gsui-windows{display:block;height:100%;position:relative;overflow:hidden;scroll-behavior:smooth}gsui-window:not(.gsuiWindow-show){opacity:0;visibility:hidden;pointer-events:none}gsui-window:focus-within{--gsuiWindow-title-opacity:1;--gsuiWindow-border-color:var( --gsuiWindow-focused-border-color )}.gsuiWindow-maximized{--gsuiWindow-radius:0;inset:0;overflow:hidden}.gsuiWindow-handlers::before,.gsuiWindows-lowGraphics .gsuiWindow-dragging,gsui-window:not(.gsuiWindow-dragging){box-shadow:0 0 0 var(--gsuiWindow-border-width) var(--gsuiWindow-border-color)}.gsuiWindow-handlers{position:absolute;opacity:0;inset:0;margin:calc(var(--gsuiWindow-handler-width)*-1)}.gsuiWindow-handlers::before{content:"";z-index:1;position:absolute;pointer-events:none;border-radius:var(--gsuiWindow-radius);inset:var(--gsuiWindow-handler-width)}.gsuiWindow-dragging .gsuiWindow-handlers{opacity:1}.gsuiWindow-maximized .gsuiWindow-handlers,.gsuiWindow-minimized .gsuiWindow-handler{display:none}.gsuiWindow-handler{position:absolute;width:calc(var(--gsuiWindow-handler-width)*2);height:calc(var(--gsuiWindow-handler-width)*2)}.gsuiWindow-handler[data-dir=nw]{cursor:nw-resize;top:0;left:0}.gsuiWindow-handler[data-dir=ne]{cursor:ne-resize;top:0;right:0}.gsuiWindow-handler[data-dir=sw]{cursor:sw-resize;bottom:0;left:0}.gsuiWindow-handler[data-dir=se]{cursor:se-resize;bottom:0;right:0}.gsuiWindow-handler[data-dir=n]{cursor:n-resize;top:0;width:100%}.gsuiWindow-handler[data-dir=w]{cursor:w-resize;left:0;height:100%}.gsuiWindow-handler[data-dir=e]{cursor:e-resize;right:0;height:100%}.gsuiWindow-handler[data-dir=s]{cursor:s-resize;bottom:0;width:100%}.gsuiWindow-wrap{position:absolute;overflow:hidden;inset:0;border-radius:inherit}.gsuiWindow-head{display:flex;position:absolute;inset:0;height:var(--gsuiWindow-head-height);color:var(--gsuiWindow-color);background-color:var(--gsuiWindow-head-bg);user-select:none;-webkit-user-select:none}.gsuiWindow-dragging .gsuiWindow-head{cursor:move}.gsuiWindow-minimized .gsuiWindow-head{border-radius:inherit}.gsuiWindow-content{position:absolute;overflow:auto;inset:var(--gsuiWindow-head-height)0 0;background-color:var(--gsuiWindow-bg)}.gsuiWindow-minimized .gsuiWindow-content{display:none}.gsuiWindow-icon,.gsuiWindow-title{opacity:var(--gsuiWindow-title-opacity);transition:.2s opacity}.gsuiWindow-icon{border:0;padding:0;outline:0;width:24px;min-width:24px;color:inherit;cursor:inherit;font-size:12px;background:0 0}.gsuiWindow-title{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:11px;font-weight:700;line-height:var(--gsuiWindow-head-height)}.gsuiWindow-headContent{flex:1;display:flex;align-items:center;padding-left:.5em}.gsuiWindow-headBtns{height:100%;display:flex;margin-left:auto;align-items:center}.gsuiWindow-headBtn{border:0;padding:0;outline:0;width:var(--gsuiWindow-head-height);height:100%;cursor:pointer;color:inherit;font-size:10px;opacity:.6;transition:.2s;transition-property:opacity,background-color;background:0 0}.gsuiWindow-headBtn:focus-visible,.gsuiWindow-headBtn:hover{opacity:1;background-color:rgba(0,0,0,.1)}.gsuiWindow-headBtn[data-icon=close]{font-size:12px}.gsuiWindow-headBtn[data-icon=close]:focus-visible,.gsuiWindow-headBtn[data-icon=close]:hover{background-color:var(--gsuiWindow-btn-close-color)}.gsuiWindow-maximized .gsuiWindow-headBtn[data-icon=maximize],.gsuiWindow-minimized .gsuiWindow-headBtn[data-icon=minimize],gsui-window:not(.gsuiWindow-minimized):not(.gsuiWindow-maximized) .gsuiWindow-headBtn[data-icon=restore]{display:none}
</style>
</head>
<body>
<noscript>GridSound needs JavaScript to run</noscript>
<div id="splashScreen">
	<div id="splashScreen-content">
		<div id="splashScreen-title" class="TextGlitch" inert>
			<div class="TextGlitch-clip">
				<div class="TextGlitch-word">GridSound</div>
				<div class="TextGlitch-word TextGlitch-blend TextGlitch-blendA"></div>
				<div class="TextGlitch-word TextGlitch-blend TextGlitch-blendB"></div>
			</div>
			<div class="TextGlitch-clip">
				<div class="TextGlitch-word"></div>
				<div class="TextGlitch-word TextGlitch-blend TextGlitch-blendA"></div>
				<div class="TextGlitch-word TextGlitch-blend TextGlitch-blendB"></div>
			</div>
			<div class="TextGlitch-clip">
				<div class="TextGlitch-word"></div>
				<div class="TextGlitch-word TextGlitch-blend TextGlitch-blendA"></div>
				<div class="TextGlitch-word TextGlitch-blend TextGlitch-blendB"></div>
			</div>
		</div>
		<div id="splashScreen-version">0.40.2</div>
		<button id="splashScreen-start" disabled></button>
		<div id="splashScreen-form">
			<label class="splashScreen-form-row">
				<input type="checkbox" name="cookies" />
				<span>I authorize GridSound to store cookies on my device.</span>
			</label>
		</div>
	</div>
</div>
<script>function lg( a ) { return a; }</script>
<script>
"use strict";"use strict";if(navigator.serviceWorker){navigator.serviceWorker.register("serviceWorker.js").then((t=>{console.log(`Service worker ${t.installing?"installing":t.waiting?"installed":t.active?"active":""}`)}),console.log.bind(console,"Service worker registration failed"))}"use strict";if(!window.AudioContext||!window.customElements){window.top.location="https://gridsound.com/unsupported-browsers"}"use strict";class t{static url="//api.gridsound.com/";static headers=Object.freeze({"Content-Type":"application/json; charset=utf-8"});static user={};static getMe(){return t.#t("GET","getMe.php").then((s=>t.#s(s)))}static getUser(s){return t.#t("GET",`getUser.php?username=${s}`).then((({data:t})=>{t.usernameLow=t.username.toLowerCase();return t}))}static getUserCompositions(s){return t.#t("GET",`getUserCompositions.php?id=${s}`).then((({data:t})=>{t.forEach((t=>t.data=JSON.parse(t.data)));return t}))}static getComposition(s){return t.#t("GET",`getComposition.php?id=${s}`).then((({data:t})=>{t.composition.data=JSON.parse(t.composition.data);return t}))}static login(s,i){return t.#t("POST","login.php",{email:s,pass:i}).then((s=>t.#s(s)))}static signup(s,i,e){return t.#t("POST","createUser.php",{username:s,email:i,pass:e}).then((s=>t.#s(s)))}static resendConfirmationEmail(){return t.#t("POST","resendConfirmationEmail.php",{email:t.user.email})}static recoverPassword(s){return t.#t("POST","recoverPassword.php",{email:s})}static resetPassword(s,i,e){return t.#t("POST","resetPassword.php",{email:s,code:i,pass:e})}static logout(){return t.#t("POST","logout.php",{confirm:true}).then((s=>t.#i(s)))}static logoutRefresh(){return t.logout().then((()=>{setTimeout((()=>location.href=location.origin+location.pathname),500)}))}static updateMyInfo(s){return t.#t("POST","updateMyInfo.php",s).then((s=>t.#s(s)))}static saveComposition(s){return t.#t("POST","saveComposition.php",{composition:JSON.stringify(s)})}static deleteComposition(s){return t.#t("POST","deleteComposition.php",{id:s})}static#s(s){const i=s.data;i.usernameLow=i.username.toLowerCase();i.emailpublic=i.emailpublic==="1";i.emailchecked=i.emailchecked==="1";Object.assign(t.user,i);return i}static#i(s){Object.keys(t.user).forEach((s=>delete t.user[s]));return s}static#t(s,i,e){const n={method:s,headers:t.headers,credentials:"include"};if(e){n.body=JSON.stringify(e)}return fetch(t.url+i,n).then((t=>t.text())).then((t=>{try{return JSON.parse(t)}catch(s){return{ok:false,code:500,msg:t}}})).then((s=>t.#e(s)))}static#e(s){if(!s.ok){s.msg=t.errorCode[s.msg]||s.msg;throw s}return s}static errorCode={"user:not-connected":"You are not connected","query:bad-format":"The query is incomplete or corrupted","login:fail":"The email/password don't match","pass:too-short":"The password is too short","email:too-long":"The email is too long","email:not-found":"This email is not in the database","email:duplicate":"This email is already used","email:bad-format":"The email is not correct","email:not-verified":"Your email is not verified","username:too-long":"The username is too long","username:too-short":"The username is too short","username:duplicate":"This username is already taken","username:bad-format":"The username can only contains letters, digits and _","password:bad-code":"Can not change the password because the secret code and the email do not match","password:already-recovering":"A recovering email has already been sent to this address less than 1 day ago"}}"use strict";const s={effects:{}};const i={};const e=new Map;const n={};const a={};const o={};class r{static#n=Object.freeze({gs:true,txt:true,json:true});cb={};ctx=null;#a=new Map;#o=new Map;#r=new Map;#h=new j;#c=new Map;#l=new N;#u=new K({getChanInput:this.#h.o.bind(this.#h),getChanOutput:this.#h.l.bind(this.#h)});u=Object.seal({p:120,m:1,v:21,k:4,$:4,O:48e3,S:8192,D:true});#d=Object.seal({C:null,P:null,M:null,A:null,T:null,B:1});#p=Object.seal({j:[],L:0});#g=Object.seal({W:null,I:new Map,F:new Map});#m=Object.seal({K:new G,R:new Map,N:4,G:false,H:false,V:null,U:null});#f=Object.seal({_:new E,Y:{},H:false,G:false,J:null,V:null,U:null,N:0});#b=Object.seal({X:new W,H:false,G:false,V:null,U:null,N:0});#w=Object.seal({K:new G,Z:new Map,R:new Map,tt:null,st:false,G:false,it:true,et:null});#v="composition";#y="keys";#k=this.#$.bind(this);#O=1;#x=null;nt(t){return this.ot(t)}rt(t,s){return this.ot(t).get(s)}ht(){return this.#w.tt.options.saveMode}ct(t){return this.#w.tt[n.patternOpenedByType[t]]}lt(){return this.ctx}ut(){return this.#d.M}dt(){return this.#d.B}gt(){return this.#u}ft(t){return this.#u.bt(t)}wt(){return this.#c}vt(t){return this.#c.get(t)}yt(){return this.#l}kt(){return this.#h}$t(t){return this.#h.o(t)}Ot(t){return this.#h.l(t)}xt(t){return this.St(t)}Dt(t){return this.#g.F.get(this.Ct(t).url||this.Ct(t).hash)}ot(t){return t==="local"?this.#a:this.#o}Pt(){return this.#w.tt}Mt(){return this.#w.tt.name}At(){return this.#w.tt.loopA}Tt(){return this.#w.tt.loopB}Bt(){return this.#w.tt.duration}jt(){return this.#w.tt.id}Lt(){return this.#w.tt.bpm}Et(){return this.#w.tt.bpm/60}Wt(){return this.#w.tt.timedivision}It(){return+this.#w.tt.timedivision.split("/")[0]}Ft(){return+this.#w.tt.timedivision.split("/")[1]}Kt(){return this.#w.tt.blocks}zt(t){return this.#w.tt.blocks[t]}Rt(){return this.#w.tt.buffers}Ct(t){return this.#w.tt.buffers[t]}Nt(){return this.#w.tt.channels}Gt(t){return this.#w.tt.channels[t]}Ht(t){return t?this.#w.tt.slices[t]:this.#w.tt.slices}Vt(){return this.#w.tt.drumrows}Ut(t){return this.#w.tt.drumrows[t]}qt(t){return t?this.#w.tt.drums[t]:this.#w.tt.drums}_t(){return this.#w.tt.effects}Yt(t){return this.#w.tt.effects[t]}Jt(t){return t?this.#w.tt.keys[t]:this.#w.tt.keys}Xt(){return this.#w.tt.patterns}Qt(t){return this.#w.tt.patterns[t]}Zt(){return this.#w.tt.synths}ts(t){return this.#w.tt.synths[t]}ss(){return this.#w.tt.tracks}es(t){return this.#w.tt.tracks[t]}ns(t,s){return this.os(t)[s]}os(t){switch(t){case"keys":return this.Jt();case"drums":return this.qt();case"slices":return this.Ht();case"buffer":return this.Rt()}}rs(){const t=this.Kt();const s={};Object.entries(t).forEach((([t,i])=>{if(i.track in s){s[i.track][t]=i}else{s[i.track]={[t]:i}}}));return s}hs(t){const s=this.Qt(t);return s.type!=="slices"?s.duration:s.source?this.Qt(s.source).duration:this.It()}constructor(){w.cs(this,this.#w);this.#l.Dt=this.Dt.bind(this);this.#l.ls=this.$t.bind(this);this.#l.us=t=>this.ds("onstartdrum",t);this.#l.ps=t=>this.ds("onstopdrumrow",t);this.#b.X.fs(this.#l);v.cs(this,this.#m);this.bs(60);this.ws();this.vs(this.u.m)}vs(t){g.ys(this.#d,t)}ks(){return g.$s(this.#d)}Os(){m.xs(this,this.#p)}Ss(t,s){m.Ds(this,this.#p,t,s)}Cs(){return m.Ps(this.#p)}Ms(){return m.As(this,this.#p)}Ts(){return m.Bs(this,this.#p)}js(t,s){h.Ls(this,this.#g,t,s)}Es(){this.#g.I.clear();this.#g.F.clear()}Ws(){return this.#g.I.size}Is(t){return h.Fs(this,this.#g,t)}Ks(t){return h.Dt(this,this.#g,t)}zs(t){return h.Rs(this,this.#g,t)}Ns(t){return h.Gs(this,this.#g,t)}Hs(){return h.Vs(this.#g)}Us(){this.#r.clear()}St(t){return this.#r.get(t)}qs(t){b.Ls(this,this.#r,t)}_s(t){b.Ys(this,this.#r,t)}Js(t,s){return u.Xs(this.rt(t,s))}Qs(){return d.Xs(this)}Zs(){d.ti(this)}si(){return!this.#w.it}ii(t){return l.ei(this,t)}ni(){return l.ai(this)}oi(t,s){return l.ri(this,t,s)}hi(t,s){return l.ci(this,t,s)}li(t,s){return l.ui(this,t,s)}di(t){return w.pi(this,this.#w,t)}gi(){w.mi(this,this.#w)}fi(){return w.bi(this,this.#w)}wi(){w.vi(this)}yi(){return w.ki(this.#w)}$i(t){w.Oi(this,this.#w,t)}xi(){w.Si(this,this.#w)}Di(){w.Ci(this.#w)}Pi(){w.Mi(this,this.#w)}Ai(t,s){return w.Ls(this,this.#w,t,s)}Ti(t,s,i){this.#h.Ls({channels:{[t]:{[s]:i}}})}Bi(t,s,i){this.#u.ji(t,s,i)}Li(t,s){this.#c.get(t).Ls(s)}Ei(t){k.Ei(this.#f,t)}Wi(t){k.Wi(this.#f,t)}Ii(t,s,i){y.Ii(this,t,s,i)}Fi(t){y.Fi(this,t)}Ki(t){y.Ki(this,t)}zi(t,s){k.Ls(this.#f,t,s)}Ri(t){k.Ni(this,this.#f,t)}Gi(t){k.Hi(this,this.#f,t)}Vi(){return k.ki(this.#f)}Ui(t){k.Oi(this,this.#f,t)}qi(t){this.#f._.scheduler._i(t)}Yi(t,s){k.Ji(this.#f,t,s)}Xi(){k.Qi(this,this.#f)}Zi(){k.Si(this.#f)}te(){k.Ci(this.#f)}se(){k.Mi(this,this.#f)}ie(t){y.Ls(this,this.#b,t)}ee(){return y.ki(this.#b)}ne(t){y.Oi(this,this.#b,t)}ae(t,s){y.Ji(this.#b,t,s)}oe(){y.Qi(this,this.#b)}re(){y.Si(this.#b)}he(){y.Ci(this.#b)}ce(){y.Mi(this,this.#b)}le(t){v.Ls(this,this.#m,t)}ue(){return v.ki(this.#m)}de(t){v.Oi(this,this.#m,t)}pe(t,s){v.Ji(this.#m,t,s)}ge(){v.Qi(this,this.#m)}me(){v.Si(this.#m)}fe(){v.Ci(this.#m)}be(){v.Mi(this,this.#m)}we(t){this.ctx=t;this.#b.X.we(t);v.we(this.#m,t);this.#f._.we(t);this.#l.we(t);g.we(this.#d,this.u.D,this.u.S,t);U.ve();this.#h.we(t);this.#h.ye(this.ut());this.#u.we(t);this.#c.forEach(((s,i)=>{s.we(t);s.ke.disconnect();s.ke.connect(this.$t(this.ts(i).dest))}))}ws(){this.Mi();this.we(new AudioContext({sampleRate:this.u.O}))}$e(t,...s){const n=e.get(t);if(!n){console.error(`DAWCore: undefined action "${t}"`)}else{const t=i.Oe(n(this,...s));if(Array.isArray(t)){this.Ss(...t);return t[0]}if(t){this.Ai(t,i.xe(this.Pt(),t));return t}}}ds(t,...s){const i=this.cb[t];return i&&i(...s)}Se(t,s){const i=this.rt(t,s);if(i){if(this.#w.st){this.De()}return(this.rt(t,s)?Promise.resolve(i):this.ii({saveMode:t})).then((t=>this.di(t))).then((t=>this.#S(t)))}}#S(t){this.Ce("composition");this.ds("compositionOpened",t);this.#D();return t}De(){if(this.#w.st){const t=this.ot(this.ht()).get(this.jt());this.Mi();this.Xi();this.Ui(0);this.$i(0);this.#C();this.ds("compositionClosed",t);this.gi();this.Os();this.Es();if(!t.savedAt){this.#P(t)}}}Pe(t,s){if(this.#w.tt&&s===this.jt()){this.De()}this.#P(this.ot(t).get(s))}#P(t){if(t){const s=t.options.saveMode;this.ot(s).delete(t.id);if(s==="local"){c.Me(t.id)}this.ds("compositionDeleted",t)}}Ae(){const t=this.#w.et;if(this.fi()){const s=this.Pt();const i=this.jt();if(this.ht()==="local"){this.#a.set(i,s);c.Te(i,s);this.ds("compositionSavedStatus",s,true)}else{this.#w.it=false;this.ds("compositionLoading",s,true);(this.ds("compositionSavingPromise",s)||Promise.resolve(s)).finally(this.ds.bind(this,"compositionLoading",s,false)).then((t=>{this.#w.it=true;this.#o.set(i,s);this.ds("compositionSavedStatus",s,true);return t}),(i=>{this.#w.et=t;this.ds("compositionSavedStatus",s,false);throw i}))}}}Be(t){h.je(this,this.#g,t).then((s=>{this.ds("buffersDropped",s);return t})).then((t=>{const s=t.find((t=>t.name.split(".").pop().toLowerCase()in r.#n));return s&&this.hi(s)})).then((t=>t&&this.Se("local",t.id)))}Le(){return this.#v}Ee(){return this.#v==="composition"?this.Bt():this.hs(this.ct(this.#v))}We(){this.Ce(this.#v==="composition"?this.#y:"composition","-f")}Ce(t,s){switch(t){case"keys":case"drums":case"slices":if(this.ct(t)!==null){if(this.#v!==t){this.#M(t,s)}return}case"composition":if(this.#v!=="composition"){this.#M("composition",s)}}}#M(t,s){if(s==="-f"||!this.Ie()){this.Ci();this.#v=t;if(t!=="composition"){this.#y=t}this.ds("focusOn",t)}}ki(){switch(this.#v){case"keys":return this.Vi();case"drums":return this.ee();case"slices":return this.ue();case"composition":return this.yi()}}Oi(t){switch(this.#v){case"keys":this.Ui(t);break;case"drums":this.ne(t);break;case"slices":this.de(t);break;case"composition":this.$i(t);break}}Ie(){return this.#w.G||this.#f.G||this.#b.G||this.#m.G}Fe(){this.Ie()?this.Ci():this.Si()}Si(){switch(this.#v){case"keys":this.Zi();break;case"drums":this.re();break;case"slices":this.me();break;case"composition":this.xi();break}this.ds("play",this.#v)}Ci(){switch(this.#v){case"keys":this.te();break;case"drums":this.he();break;case"slices":this.fe();break;case"composition":this.Di();break}this.ds("pause",this.#v)}Mi(){switch(this.#v){case"keys":this.se();break;case"drums":this.ce();break;case"slices":this.be();break;case"composition":this.Pi();break}this.Hs();this.ds("stop",this.#v);this.ds("currentTime",this.ki(),this.#v)}Ke(t){if(t!==this.u.O){this.u.O=t;this.ws()}}bs(t){this.#O=1e3/t|0}#D(){this.#$()}#C(){clearTimeout(this.#x);cancelAnimationFrame(this.#x)}#$(){const t=this.ks();if(t){this.wi();this.ds("analyserFilled",t)}if(this.Ie()){const t=this.ki();this.ds("currentTime",t,this.#v)}this.#x=this.#O<20?requestAnimationFrame(this.#k):setTimeout(this.#k,this.#O)}}"use strict";class h{static#A=["audio/wav","audio/wave","audio/flac","audio/webm","audio/ogg","audio/mpeg","audio/mp3","audio/mp4"];static Ls(t,s,i,e){if("buffers"in i){Object.entries(i.buffers).forEach((([i,n])=>{if(!n){const t=e.buffers[i];s.I.delete(t.hash||t.url)}else if(!h.Ct(s,n)){const e=h.Rs(t,s,n);if(n.url){e.then((s=>t.ds("buffersLoaded",i,s)))}}}))}}static Ct(t,s){return t.I.get(s.hash||s.url)}static Dt(t,s,i){return s.F.has(i)?Promise.resolve(s.F.get(i)):h.Fs(t,s,i)}static Rs(t,s,i){const e={...i};s.I.set(e.hash||e.url,e);return!e.url?Promise.resolve(e):h.Fs(t,s,e.url).then((t=>{e.buffer=t;e.duration=+t.duration.toFixed(4);return e}))}static Fs(t,s,i){return fetch(`/🥁/${i}.wav`).then((t=>t.arrayBuffer())).then((s=>t.lt().decodeAudioData(s))).then((t=>{s.F.set(i,t);return t}))}static Gs(t,s,i){const e=s.F.get(i);const n=t.lt().createBufferSource();h.Vs(s);s.W=n;n.buffer=e;n.connect(t.ut());n.start();return e}static Vs(t){t.W?.stop()}static je(t,s,i){return i.then((t=>h.#T(t))).then((t=>h.#B(s.F,t))).then((s=>h.#j(t.lt(),s))).then((i=>h.#L(t,s.F,i)))}static#T(t){let s;return Promise.all(t.filter((t=>h.#A.includes(t.type))).reduce(((t,e)=>{const n=e.filepath.split("/");const a=(n.pop(),n.pop())||"";const o=i.ze(e,"array").then((t=>[i.Re(new Uint8Array(t)),t,e.name]));if(a!==s){s=a;t.push(a)}t.push(o);return t}),[]))}static#B(t,s){return s.filter((s=>!Array.isArray(s)||!t.has(s[0]))).filter(((t,s,i)=>Array.isArray(t)||Array.isArray(i[s+1])))}static#j(t,s){return Promise.all(s.map((s=>!Array.isArray(s)?s:t.decodeAudioData(s[1]).then((t=>[s[0],t,s[2]])))))}static#L(t,s,i){const e={};const n=t.ct("slices");i.forEach((i=>{if(Array.isArray(i)){const n=Object.entries(t.Rt());const a=n.find((t=>t[1].hash===i[0]));s.set(i[0],i[1]);if(a){a[1].buffer=i[1];e[a[0]]=a[1];t.ds("buffersLoaded",a[0],a[1])}}}));t._s(e);return i}}"use strict";class c{static Te(t,s){const e=i.Ne(s);p.Ge(e);localStorage.setItem(t,JSON.stringify(e))}static Me(t){localStorage.removeItem(t)}static He(t){return t in localStorage}static Ve(t){try{const s=JSON.parse(localStorage.getItem(t));return t===s.id?s:null}catch(t){return null}}static Ue(){const t=Object.keys(localStorage).reduce(((t,s)=>{const i=c.Ve(s);i&&t.push(i);return t}),[]);t.sort(((t,s)=>t.savedAt<s.savedAt));return t}}"use strict";class l{static ai(t){return Promise.all(c.Ue().map((s=>l.ui(t,s))))}static ri(t,s,i){return fetch(s).then((t=>{if(!t.ok){throw`The file is not accessible: ${s}`}return t.json()})).then((s=>l.ui(t,s,i)),(t=>{throw t}))}static ci(t,s,e){return i.ze(s,"text").then((s=>l.#E(t,s,e)))}static ui(t,s,e){const n=i.Ne(s);n.options=Object.freeze({saveMode:"local",...e});t.ot(n.options.saveMode).set(n.id,n);t.ds("compositionAdded",n);t.ds("compositionSavedStatus",n,true);return Promise.resolve(n)}static ei(t,e){const n=s.composition(t.u,i.qe());return l.ui(t,n,e)}static#E(t,s,i){return new Promise(((e,n)=>{try{const a=JSON.parse(s);l.ui(t,a,i).then(e,n)}catch(t){n(t)}}))}}"use strict";class u{static#W=null;static#I=Object.freeze({keys:4,drums:4,synths:5,tracks:3,blocks:3,buffers:3,channels:3,patterns:3,drumrows:3});static Xs(t){if(t){const s=i.Ne(t);const e=p.Ge(p._e(s));return{name:`${t.name||"untitled"}.gs`,url:u.#F(e)}}}static#F(t){const s=u.#I;const i=/^\t"(\w*)": \{$/u;const e=JSON.stringify(t,null,"\t").split("\n");let n;let a;let o;if(u.#W){URL.revokeObjectURL(u.#W)}e.forEach(((t,r)=>{const h=i.exec(t);if(h){if(o=s[h[1]]){n=new RegExp(`^\\t{${o}}`,"u");a=new RegExp(`^\\t{${o-1}}\\}`,"u")}}if(o){e[r]=e[r].replace(n,"~").replace(a,"~}")}}));return u.#W=URL.createObjectURL(new Blob([e.join("\n").replace(/\n~/gu," ")]))}}"use strict";class d{static#W=null;static ti(t){if(t.ctx instanceof OfflineAudioContext){t.Pi()}}static Xs(t){const s=t.ctx;const i=Math.ceil(t.Bt()/t.Et())||1;const e=new OfflineAudioContext(2,i*s.sampleRate|0,s.sampleRate);t.Mi();if(d.#W){URL.revokeObjectURL(d.#W)}t.we(e);t.xi();return e.startRendering().then((i=>{const e=H.Ye(i,{float32:true});const n=URL.createObjectURL(new Blob([e]));t.Pi();t.we(s);d.#W=n;return{url:n,name:`${t.Mt()||"untitled"}.wav`}}))}}"use strict";class p{static Ge(t){delete t.options;if(t.loopA==null||t.loopB==null){delete t.loopA;delete t.loopB}Object.values(t.drumrows).forEach((t=>{if(t.toggle){delete t.toggle}}));Object.values(t.tracks).forEach((t=>{if(!t.name){delete t.name}if(t.toggle){delete t.toggle}}));Object.values(t.blocks).forEach((t=>{if(!t.offset){delete t.offset}if(!t.selected){delete t.selected}if(!t.durationEdited){delete t.durationEdited}}));Object.values(t.keys).forEach((t=>{Object.values(t).forEach((t=>{if(!t.offset){delete t.offset}if(!t.selected){delete t.selected}if(t.prev==null){delete t.prev}if(t.next==null){delete t.next}}))}));return t}static _e(t){const e=Object.values(t.blocks);let n=0;if(!t.timedivision){t.timedivision=t.beatsPerMeasure&&t.beatsPerMeasure?`${t.beatsPerMeasure}/${t.stepsPerBeat}`:"4/4"}delete t.beatsPerMeasure;delete t.stepsPerBeat;if(Number.isFinite(t.loopA)&&Number.isFinite(t.loopB)){t.loopA=Math.max(0,t.loopA);t.loopB=Math.max(0,t.loopB);if(t.loopA===t.loopB){t.loopA=t.loopB=null}}else{t.loopA=t.loopB=null}t.synthOpened=t.synthOpened?`${t.synthOpened}`:null;t.patternKeysOpened=t.patternKeysOpened?`${t.patternKeysOpened}`:null;t.patternDrumsOpened=t.patternDrumsOpened?`${t.patternDrumsOpened}`:null;t.patternBufferOpened=t.patternBufferOpened?`${t.patternBufferOpened}`:null;t.patternSlicesOpened=t.patternSlicesOpened?`${t.patternSlicesOpened}`:null;delete t.patternOpened;t.buffers=t.buffers||{};Object.values(t.buffers).forEach((t=>{delete t.MIME;delete t.type}));t.slices=t.slices||{};t.drumrows=t.drumrows||{};Object.values(t.drumrows).forEach((t=>{t.toggle=t.toggle!==false;t.detune=t.detune??0}));t.drums=t.drums||{};Object.values(t.drums).forEach((t=>{Object.values(t).forEach((t=>{if("gain"in t){t.pan=t.pan??0;t.detune=t.detune??0}}))}));if(!t.channels){t.channels=s.channels();Object.values(t.synths).forEach((t=>t.dest="main"))}if((!t.savedAt||t.savedAt<157455e4)&&t.channels.main.gain>.8){t.channels.main.gain=.4}delete t.channels.main.order;t.effects=t.effects||{};Object.values(t.patterns).forEach((s=>{if(!("order"in s)){s.order=n}n=Math.max(s.order,n)+1;switch(s.type){case"keys":s.synth=s.synth||"0";break;case"buffer":s.bufferType=s.bufferType||null;if(s.bufferType==="loop"){s.bufferBpm=s.bufferBpm||null}else if(s.bufferType===null){switch(t.buffers[s.buffer].url){case"kick-00.wav":case"clap-00.wav":case"hat-00.wav":case"snare-00.wav":case"hat-open-00.wav":s.bufferType="drum";break}}break}}));Object.values(t.buffers).forEach((t=>{switch(t.url){case"kick-00.wav":t.url="1/kick-017";break;case"clap-00.wav":t.url="1/clap-013";break;case"hat-00.wav":t.url="1/hat-024";break;case"snare-00.wav":t.url="1/openhat-012";break;case"hat-open-00.wav":t.url="1/snare-018";break}}));if(!t.synths){t.synths={0:s.synth()}}Object.values(t.synths).forEach((t=>{delete t.envelopes;t.env=t.env||s.env();t.lfo=t.lfo||s.lfo();delete t.env.substain;Object.values(t.oscillators).forEach((t=>{t.detune=Math.min(Math.max(-24,Math.round(t.detune)),24);t.detunefine=Math.min(Math.max(-1,t.detunefine||0),1);t.unisonvoices=Math.min(Math.max(1,Math.round(t.unisonvoices??1)),9);t.unisondetune=Math.min(Math.max(0,t.unisondetune??0),12);t.unisonblend=Math.min(Math.max(0,t.unisonblend??0),1)}))}));Object.values(t.tracks).reduce(((t,s)=>{s.name=typeof s.name==="string"?s.name:"";s.order=typeof s.order==="number"?s.order:t;s.toggle=typeof s.toggle==="boolean"?s.toggle:true;return s.order+1}),0);e.sort(((t,s)=>t.when-s.when));t.blocks=e.reduce(((t,s,i)=>{s.offset=s.offset||0;s.selected=!!s.selected;s.durationEdited=!!s.durationEdited;t[i]=s;return t}),{});Object.values(t.keys).forEach((t=>{Object.values(t).forEach((t=>{t.pan=i.Je(t.pan,0,-1,1,2);t.gain=i.Je(t.gain,.8,0,1,2);t.lowpass=i.Je(t.lowpass,1,0,1,2);t.highpass=i.Je(t.highpass,1,0,1,2);t.selected=!!t.selected;t.gainLFOAmp=t.lfoAmp??t.lfoGainAmp??t.gainLFOAmp??1;t.gainLFOSpeed=t.lfoSpeed??t.lfoGainSpeed??t.gainLFOSpeed??1;if(typeof t.prev==="number"){t.prev+=""}if(typeof t.next==="number"){t.next+=""}t.prev=t.prev||null;t.next=t.next||null;delete t.attack;delete t.release;delete t.lfoAmp;delete t.lfoSpeed;delete t.lfoGainAmp;delete t.lfoGainSpeed;delete t.durationEdited;if(typeof t.key==="string"){t.key=12*4;console.warn(`DAWCoreCompositionFormat: the key ${t.key} should be an integer`)}}))}));return t}}"use strict";class g{static ys(t,s){t.B=s;if(t.C instanceof AudioContext){t.P.gain.value=s*s}}static we(t,s,i,e){g.#K(t);t.C=e;t.P=e.createGain();t.M=e.createGain();t.M.connect(t.P).connect(e.destination);if(e instanceof AudioContext){g.#z(t,i,s);g.ys(t,t.B)}else{g.#z(t,i,false)}}static $s(t){if(t.A){t.A.getByteFrequencyData(t.T);return t.T}}static#K(t){t.P&&t.P.disconnect();t.M&&t.M.disconnect();t.A&&t.A.disconnect();t.P=t.M=t.A=t.T=null}static#z(t,s,i){if(t.A){t.A.disconnect()}if(i){const i=t.C.createAnalyser();const e=s;t.A=i;t.T=new Uint8Array(e/2);i.fftSize=e;i.smoothingTimeConstant=0;t.M.connect(i).connect(t.P)}else{t.A=t.T=null;t.M.connect(t.P)}}}"use strict";class m{static xs(t,s){while(s.j.length){t.ds("historyDeleteAction",s.j.pop())}s.L=0}static Ds(t,s,e,n){const a=s.j;const o=i.xe(t.Pt(),e);const r={redo:e,undo:o};const h=m.#R(r,n);r.desc=h.t;r.icon=h.i;while(a.length>s.L){t.ds("historyDeleteAction",a.pop())}++s.L;r.index=a.push(r);m.#N(t,Object.freeze(r),"redo","historyAddAction")}static Ps(t){return t.j[t.L-1]||null}static As(t,s){return s.L>0?m.#N(t,s.j[--s.L],"undo","historyUndo"):false}static Bs(t,s){return s.L<s.j.length?m.#N(t,s.j[s.L++],"redo","historyRedo"):false}static#N(t,s,i,e){const n=s[i];const a=i==="undo"?s.redo:s.undo;t.ds(e,s);t.Ai(n,a);return n}static#R(t,s){const[i,e,...n]=s||[];const a=f.Xe(i,e);const[o,r]=a?a(...n):["close","undefined"];if(!a){console.error(`DAWCore: description 404 for "${i}.${e}"`)}return{i:o,t:r}}}"use strict";class f{static Xe(t,s){return f.#G.get(t)?.[s]}static#G=new Map([["cmp",{renameComposition:(t,s)=>["pen",`rename compo "${t||"untitled"}" to "${s}"`],changeTempo:(t,s)=>["clock",`new tempo ${t} (${s})`],changeLoop:(t,s)=>["loop",`change loop ${t} -> ${s}`],removeLoop:()=>["loop","remove loop"]}],["tracks",{renameTrack:(t,s)=>["pen",`rename track "${t}" -> "${s}"`],toggleTrack:(t,s)=>[s?"unmute":"mute",`${s?"unmute":"mute"} track "${t}"`],toggleSoloTrack:(t,s)=>[s?"unmute":"mute",`${s?"unmute all tracks":`mute all tracks except "${t}"`}`]}],["blocks",{addBlock:t=>["plus",`add a new ${t} block`],moveBlocks:t=>["arrows",`move ${i.Qe(t,"block")}`],selectBlocks:t=>["mouse",`select ${i.Qe(t,"block")}`],removeBlocks:t=>["erase",`remove ${i.Qe(t,"block")}`],cropEndBlocks:t=>["crop",`crop-end ${i.Qe(t,"block")}`],cropStartBlocks:t=>["crop",`crop-start ${i.Qe(t,"block")}`],unselectBlock:()=>["mouse",`unselect ${i.Qe(1,"block")}`],unselectAllBlocks:t=>["mouse",`unselect ${i.Qe(t,"block")}`],duplicateSelectedBlocks:t=>["plus",`duplicate ${i.Qe(t,"block")}`]}],["synth",{addOscillator:t=>["oscillator",`${t}: add osc`],removeOscillator:t=>["oscillator",`${t}: remove osc`],reorderOscillator:t=>["sort",`${t}: reorder oscs`],changeOscillator:(t,s,i)=>["oscillator",`${t}: change osc ${s} -> ${i}`],toggleEnv:(t,s)=>["osc-sine",`${t}: ${s?"enable":"disable"} envelope`],changeEnv:(t,s,i)=>["osc-sine",`${t}: envelope's ${s} = ${i}`],toggleLFO:(t,s)=>["osc-sine",`${t}: ${s?"enable":"disable"} LFO`],changeLFO:(t,s,i)=>["osc-sine",`${t}: LFO's ${s} = ${i}`]}],["synths",{addSynth:t=>["oscillator",`add new synth "${t}"`],renameSynth:(t,s)=>["pen",`rename synth "${t}" -> "${s}"`],removeSynth:t=>["minus",`remove synth "${t}"`],redirectSynth:(t,s)=>["redirect",`redirect synth "${t}" to chan "${s}"`]}],["channels",{addChannel:t=>["plus",`mixer: new channel "${t}"`],removeChannel:t=>["minus",`mixer: remove "${t}"`],reorderChannel:t=>["sort",`mixer: reorder "${t}"`],renameChannel:(t,s)=>["pen",`mixer: rename "${t}" -> "${s}"`],toggleChannel:(t,s)=>[s?"unmute":"mute",`mixer: ${s?"unmute":"mute"} "${t}"`],changeChannel:(t,s,i)=>["mixer",`mixer: "${t}" ${s}: ${i}`],redirectChannel:(t,s)=>["redirect",`mixer: redirect "${t}" to "${s}"`]}],["patterns",{changePatternBufferInfo:t=>["pen",`edit info of the buffer "${t}"`],addPattern:(t,s)=>["plus",`add new ${t} "${s}"`],addPatternKeys:(t,s)=>["plus",`add new keys "${t}" of synth "${s}"`],addPatternBuffer:t=>["plus",`use "${t}" from the library`],renamePattern:(t,s,i)=>["pen",`rename ${t} "${s}" -> "${i}"`],removePattern:(t,s)=>["minus",`remove ${t} "${s}"`],reorderPattern:(t,s)=>["sort",`reorder ${t} "${s}"`],clonePattern:(t,s,i)=>["clone",`clone ${t} "${i}" to "${s}"`],redirectPatternBuffer:(t,s)=>["redirect",`redirect buffer "${t}" to chan "${s}"`],redirectPatternKeys:(t,s)=>["redirect",`redirect keys "${t}" to synth "${s}"`],redirectPatternSlices:(t,s)=>["redirect",`redirect slices "${t}" to buffer "${s}"`]}],["effects",{addEffect:(t,s)=>["effects",`fx: new ${s} on ${t}`],toggleEffect:(t,s,i)=>[i?"unmute":"mute",`fx: ${i?"unmute":"mute"} ${s} of ${t}`],removeEffect:(t,s)=>["minus",`fx: remove ${s} of ${t}`],changeEffect:(t,s,i)=>["effects",`fx: change ${s}'s ${i} of ${t}`]}],["drumrows",{addDrumrow:t=>["drums",`drumrows: new "${t}"`],removeDrumrow:t=>["drums",`drumrows: remove "${t}"`],reorderDrumrow:t=>["drums",`drumrows: reorder "${t}"`],changeDrumrow:(t,s,i)=>["drums",`drumrows: "${t}" ${s}: ${i}`],changeDrumrowPattern:(t,s)=>["drums",`drumrows: "${t}" -> "${s}"`],toggleDrumrow:(t,s)=>["drums",`drumrows: ${s?"unmute":"mute"} "${t}"`],toggleSoloDrumrow:(t,s)=>["drums",`drumrows: ${s?"unmute all":`mute all except "${t}"`}`]}],["slices",{cropSlices:t=>["slices",`crop "${t}"`],changeSlices:t=>["slices",`change "${t}"'s slices`],changeSlicesDuration:(t,s)=>["slices",`"${t}"'s duration: ${s}beat`]}],["drums",{addDrums:(t,s,i)=>["drums",`drums: add ${i} "${s}" in "${t}"`],removeDrums:(t,s,i)=>["drums",`drums: remove ${i} "${s}" in "${t}"`],changeDrumsProps:(t,s,i,e)=>["drums",`drums: set ${i} to ${e} "${s}" in "${t}"`]}],["keys",{addKey:t=>["keys",`add a new key in "${t}"`],moveKeys:(t,s)=>["arrows",`keys: move ${i.Qe(s,"key")} in "${t}"`],removeKeys:(t,s)=>["erase",`keys: remove ${i.Qe(s,"key")} in "${t}"`],selectKeys:(t,s)=>["mouse",`keys: select ${i.Qe(s,"key")} in "${t}"`],cropEndKeys:(t,s)=>["crop",`keys: crop ${i.Qe(s,"key")} in "${t}"`],redirectKey:(t,s)=>["glissando",`${s?"add":"remove"} a glissando in "${t}"`],unselectKey:t=>["mouse",`keys: unselect ${i.Qe(1,"key")} in "${t}"`],unselectAllKeys:(t,s)=>["mouse",`unselect ${i.Qe(s,"key")} in "${t}"`],changeKeysProps:(t,s,e)=>["keys",`keys: change ${i.Qe(e,"key","'s")} ${s} in "${t}"`],cloneSelectedKeys:(t,s)=>["keys",`clone ${i.Qe(s,"key")} in "${t}"`]}]])}"use strict";class b{static Ls(t,s,i){if("patterns"in i||"slices"in i){const e=new Set;if("patterns"in i){Object.entries(i.patterns).forEach((([i,n])=>{if(!n){s.delete(i)}else if(t.Qt(i).type==="slices"){if("source"in n||"cropA"in n||"cropB"in n){e.add(i)}}}))}if("slices"in i){const s=Object.entries(t.Xt());Object.keys(i.slices).forEach((t=>{if(i.slices[t]){e.add(s.find((s=>s[1].slices===t))[0])}}))}e.forEach((i=>{const e=t.Qt(i).source;const n=e&&t.Dt(t.Qt(e).buffer);if(n){b.#H(s,t,i,n)}}))}}static Ys(t,s,i){const e=Object.entries(t.Xt()).reduce(((s,[i,e])=>{if(e.type==="slices"&&e.source){const n=t.Qt(e.source).buffer;if(n in s){s[n][i]=true}else{s[n]={[i]:true}}}return s}),{});Object.entries(i).forEach((([i,n])=>{if(i in e){Object.keys(e[i]).forEach((i=>b.#H(s,t,i,n.buffer)))}}))}static#H(t,s,i,e){const n=s.Qt(i);const a=I.Ze(s.lt(),e,0,1,s.Ht(n.slices));t.set(i,a)}}"use strict";class w{static cs(t,s){s.K.delayStopCallback=4;s.K.currentTime=()=>t.ctx.currentTime;s.K.ondatastart=w.#V.bind(null,t,s);s.K.ondatastop=w.#U.bind(null,s)}static pi(t,s,e){return new Promise(((n,a)=>{const o=i.Ne(e);if(p._e(o)){w.mi(t,s);n(o)}else{a()}})).then((i=>{const e=[];const n={};s.tt=i;s.st=true;w.Ls(t,s,i,{keys:{},drums:{},synths:{},blocks:{},slices:{},buffers:{},drumrows:{},channels:{},patterns:{}});Promise.allSettled(e).then((()=>{t._s(n)}));s.et=null;s.it=i.options.saveMode==="cloud"||c.He(i.id)||!i.savedAt;t.ds("compositionSavedStatus",i,s.it);return i}))}static mi(t,s){if(s.st){const i=s.K.data;s.st=false;t.gt().tn();t.kt().tn();s.K.Mi();Object.keys(i).forEach((t=>delete i[t]));t.wt().clear();t.Us();t.yt().tn();s.it=true;t.ds("compositionSavedStatus",s.tt,true);s.tt=null}}static bi(t,s){if(!s.it){s.it=true;s.et=t.Cs();s.tt.savedAt=Math.floor(Date.now()/1e3);return true}}static vi(t){const s=t.kt();const i=t.ds.bind(t,"channelAnalyserFilled");Object.keys(t.Nt()).forEach((t=>{s.sn(t);i(t,s.nn,s.an)}))}static ki(t){return t.K.rn()}static Oi(t,s,i){s.K.hn(i);t.ds("currentTime",w.ki(s),"composition")}static Si(t,s){if(!s.G){s.G=true;w.#q(t,s,w.ki(s))}}static Ci(t){if(t.G){t.G=false;t.K.Mi()}}static Mi(t,s){if(s.G){w.Ci(s);w.Oi(t,s,s.tt.loopA||0)}else{w.Oi(t,s,0)}}static Ls(t,s,e,n){const a=s.tt;const o=t.Cs();const r=o===s.et&&!!a.savedAt;i.cn(a,e);t.kt().Ls(e);t.js(e,n);t.qs(e);t.le(e);t.yt().Ls(e);t.ie(e);t.gt().Ls(e);w.#_.forEach(((i,a)=>{if(a in e||a.some?.((t=>t in e))){i(t,s,e,n)}}));if(r!==s.it){s.it=r;t.ds("compositionSavedStatus",a,r)}t.ds("compositionChanged",e,n);return e}static#q(t,s,i){const e=s.K;if(t.lt()instanceof OfflineAudioContext){e.Qi();e.ln(false);e.un(0)}else{w.#Y(s,s.tt.loopA,s.tt.loopB);e.ln(true);e.un(0,i)}}static#Y(t,s,i){if(Number.isFinite(s)){t.K.dn(s,i)}else{t.K.dn(0,t.tt.duration||t.tt.beatsPerMeasure)}}static#J(t,s,i){t.Z.forEach((([t,e])=>{if(t===s){e.Ls(i)}}))}static#X(t,s,i,e){s.R.forEach((([s,n])=>{if(s===i){n.disconnect();n.connect(t.$t(e))}}))}static#V(t,s,i,e,n,a,o){const r=s.tt;const h=e[0][1];if(r.tracks[h.track].toggle){const e=h.pattern;const c=r.patterns[e];switch(c.type){case"buffer":w.#Q(t,s,i,e,n,a,o,t.Dt(c.buffer),e);break;case"slices":w.#Q(t,s,i,e,n,a,o,t.xt(e),t.Qt(e).source);break;case"keys":{const h=new E;s.Z.set(i,[e,h]);h.scheduler._i(r.bpm);h.we(t.lt());h.Ni(t.vt(c.synth));h.Ls(r.keys[c.keys]);h.pn(n,a,o)}break;case"drums":{const h=new W;s.Z.set(i,[e,h]);h.scheduler._i(r.bpm);h.we(t.lt());h.fs(t.yt());h.Ls(r.drums[c.drums]);h.pn(n,a,o)}break}}}static#Q(t,s,i,e,n,a,o,r,h){if(r){const c=t.lt().createBufferSource();const l=t.Qt(h);const u=l.bufferBpm?r.duration/(l.duration/t.Et()):1;c.buffer=r;c.playbackRate.value=u;c.connect(t.$t(l.dest));c.start(n,a*u,o*u);s.R.set(i,[e,c])}}static#U(t,s){const i=t.R.get(s);const e=t.Z.get(s);if(i){i[1].stop();t.R.delete(s)}if(e){e[1].Mi();t.Z.delete(s)}}static#_=new Map([["bpm",(t,s,i)=>{s.K._i(i.bpm);t.wt().forEach((t=>t._i(i.bpm)));t.qi(i.bpm)}],["blocks",(t,s,i)=>{s.K.Ls(i.blocks)}],[["loopA","loopB"],(t,s)=>{if(t.Le()==="composition"){s.K.dn(s.tt.loopA||0,s.tt.loopB||s.tt.duration||s.tt.beatsPerMeasure)}}],["duration",(t,s)=>{if(t.Le()==="composition"&&s.tt.loopA===null){s.K.dn(0,s.tt.duration||s.tt.beatsPerMeasure)}}],["tracks",(t,s,i)=>{const e=t.rs();const n={};Object.entries(i.tracks).forEach((([t,s])=>{if("toggle"in s&&t in e){s.toggle?Object.assign(n,e[t]):Object.keys(e[t]).forEach((t=>n[t]=undefined))}}));s.K.Ls(n)}],["synths",(t,s,i,e)=>{Object.entries(i.synths).forEach((([i,n])=>{if(!n){t.vt(i).gn();t.wt().delete(i)}else if(!e.synths[i]){const e=new L;e.we(t.lt());e._i(s.tt.bpm);e.Ls(n);e.ke.connect(t.kt().o(n.dest));t.wt().set(i,e)}else{const s=t.vt(i);s.Ls(n);if("dest"in n){s.ke.disconnect();s.ke.connect(t.kt().o(n.dest))}}}))}],["patterns",(t,s,i)=>{Object.entries(i.patterns).forEach((([i,e])=>{if(e){if("dest"in e&&s.tt.patterns[i].type==="buffer"){w.#X(t,s,i,e.dest)}if(i===s.tt.patternKeysOpened){t.zi(e)}}}))}],["keys",(t,s,i)=>{const e=Object.entries(s.tt.patterns);const n=s.tt.patternKeysOpened;Object.entries(i.keys).forEach((([a,o])=>{e.some((([e,r])=>{if(r.keys===a){w.#J(s,e,o);if(e===n){t.zi(i.patterns&&i.patterns[e],o)}return true}}))}))}],["patternKeysOpened",(t,s,i)=>{t.Gi(i.patternKeysOpened)}],["synthOpened",(t,s,i)=>{t.Ri(i.synthOpened)}]])}"use strict";class v{static cs(t,s){s.K.ondatastart=v.#V.bind(null,s.R,t);s.K.ondatastop=v.#U.bind(null,s.R);s.K.Ls({1:{when:0,offset:0,duration:4}})}static we(t,s){t.K.currentTime=()=>s.currentTime;t.K.ln(!(s instanceof OfflineAudioContext))}static Ls(t,s,i){const e=t.ct("slices");let n;let a;if("patternSlicesOpened"in i){if(i.patternSlicesOpened){a=true}t.Ce("slices")}if("bpm"in i){s.K._i(i.bpm)}if(e){if("slices"in i){const s=t.Qt(e).slices;if(s in i.slices){n=true}}if("patterns"in i){const o=i.patterns[e];const r=t.Qt(e).source;const h=i.patterns[r];if(o&&"source"in o){n=true;a=true}if(h){if("duration"in h){a=true}}else if(r in i.patterns){if(t.Ie()){t.Mi();s.K.xs()}}}}if(n){v.#Z(s)}if(a){v.#tt(s,t.hs(e))}}static ki(t){return t.K.rn()}static Oi(t,s,i){s.K.hn(i);t.ds("currentTime",v.ki(s),"slices")}static Ji(t,s,i){t.V=s;t.U=i;t.H=true;t.K.dn(s,i)}static Qi(t,s){s.V=s.U=null;s.H=false;s.K.dn(0,s.N||t.It())}static Si(t){if(!t.K.started){const s=t.H?t.V:0;const i=t.H?t.U:t.N;t.G=true;t.K.dn(s,i);t.K.un(0,v.ki(t))}}static Ci(t){t.G=false;t.K.Mi()}static Mi(t,s){s.G=false;if(s.K.started){v.Ci(s);v.Oi(t,s,s.V||0)}else{v.Oi(t,s,0)}}static#tt(t,s){t.N=s;t.K.Ls({1:{duration:s}});if(!t.H){t.K.dn(0,s)}}static#Z(t){v.#st(t.K)}static#st(t){if(t.started){t.un(0,t.rn())}}static#V(t,s,i,e,n,a,o){const r=s.xt(s.ct("slices"));const h=s.Qt(s.ct("slices"));const c=s.Qt(h.source);if(r&&c){const e=s.lt().createBufferSource();const h=r.duration/(c.duration/s.Et());e.buffer=r;e.playbackRate.value=h;e.connect(s.$t(c.dest));e.start(n,a*h,o*h);t.set(i,e)}}static#U(t,s){const i=t.get(s);if(i){i.stop();t.delete(s)}}}"use strict";class y{static Ls(t,s,i){const e=t.ct("drums");if("bpm"in i){s.X.scheduler._i(i.bpm)}if("patternDrumsOpened"in i){y.#it(t,s,e)}if("drums"in i){if(e){const n=i.drums[t.Qt(e).drums];if(n){y.#et(s,i.patterns?.[e],n)}}}if("patterns"in i){const t=i.patterns[e];y.#et(s,t)}}static ki(t){return t.X.scheduler.rn()}static Oi(t,s,i){s.X.scheduler.hn(i);t.ds("currentTime",y.ki(s),"drums")}static Ji(t,s,i){t.V=s;t.U=i;t.H=true;t.X.scheduler.dn(s,i)}static Qi(t,s){s.V=s.U=null;s.H=false;s.X.scheduler.dn(0,s.N||t.It())}static Ii(t,s,i,e){t.yt().Ls({drumrows:{[s]:{[i]:e}}})}static Fi(t,s){t.yt().Fi(s)}static Ki(t,s){t.yt().Ki(s);t.ds("onstopdrumrow",s)}static Si(t){if(!t.G){const s=t.H?t.V:0;const i=t.H?t.U:t.N;t.G=true;t.X.scheduler.dn(s,i);t.X.scheduler.un(0,y.ki(t))}}static Ci(t){if(t.G){t.G=false;t.X.Mi()}}static Mi(t,s){if(s.G){y.Ci(s);y.Oi(t,s,s.V||0)}else{y.Oi(t,s,0)}}static#et(t,s,i){if(i){t.X.Ls(i)}if(s&&"duration"in s){t.N=s.duration;if(!t.H&&t.G){t.X.scheduler.dn(0,t.N)}}}static#it(t,s,i){const e=s.G;t.Ce("drums");if(e){t.Mi();t.Mi()}s.X.scheduler.xs();if(i){const n=t.Qt(i);y.#et(s,n,t.qt(n.drums));if(e){t.Si()}}}}"use strict";class k{static Ls(t,s,i){t._.Ls(i);if(s&&"duration"in s){t.N=s.duration;if(!t.H&&t.G){t._.scheduler.dn(0,t.N)}}}static Ni(t,s,i){const e=i?t.vt(i):null;const n=s.G;if(e!==s.J){if(n){k.Ci(s)}s.J=e;s._.Ni(e);if(n){k.Si(s)}}}static Hi(t,s,i){const e=s.G;t.Ce("keys");if(e){t.Mi();t.Mi()}s._.scheduler.xs();if(i){const n=t.Qt(i);k.Ni(t,s,n.synth);k.Ls(s,n,t.Jt(n.keys));if(e){t.Si()}}}static ki(t){return t._.scheduler.rn()}static Oi(t,s,i){s._.scheduler.hn(i);t.ds("currentTime",k.ki(s),"keys")}static Ji(t,s,i){t.V=s;t.U=i;t.H=true;t._.scheduler.dn(s,i)}static Qi(t,s){s.V=s.U=null;s.H=false;s._.scheduler.dn(0,s.N||t.It())}static Ei(t,i){if(!(i in t.Y)){t.Y[i]=t.J.mn([[null,s.key({key:i})]],t._.scheduler.currentTime(),0,Infinity)}}static Wi(t,s){if(t.Y[s]){t.J.fn(t.Y[s]);delete t.Y[s]}}static Si(t){if(!t.G){const s=t.H?t.V:0;const i=t.H?t.U:t.N;t.G=true;t._.scheduler.dn(s,i);t._.scheduler.un(0,k.ki(t))}}static Ci(t){if(t.G){t.G=false;t._.Mi()}}static Mi(t,s){if(s.G){k.Ci(s);k.Oi(t,s,s.V||0)}else{k.Oi(t,s,0)}}}"use strict";i.bn=(t,s,e)=>{if(i.wn(e)){if(s in t){i.vn(t[s],e)}else{t[s]=e}}return t};"use strict";i.Je=(t,s,i,e,n)=>{const a=Number.isFinite(+t)?Math.max(i,Math.min(t,e)):s;return typeof n==="number"?+a.toFixed(2):+a};"use strict";i.xe=(t,s)=>{if(i.yn(t)&&i.yn(s)){return Object.freeze(Object.entries(s).reduce(((s,[e,n])=>{if(t[e]!==n){s[e]=i.xe(t[e],n)}return s}),{}))}return t};"use strict";i.kn=(t,s,i,e,n)=>{if(n){Object.entries(n).forEach((([a,o])=>{if(!o){if(a in t){e(a,n)}}else if(a in t){i(a,o,n)}else{s(a,o,n)}}))}};"use strict";i.vn=(t,s)=>{if(s){Object.entries(s).forEach((([s,e])=>{if(!i.yn(e)){t[s]=e}else if(!i.yn(t[s])){t[s]=i.$n(e)}else{i.vn(t[s],e)}}))}return t};"use strict";i.$n=t=>{if(i.yn(t)){return Object.entries(t).reduce(((t,[s,e])=>{t[s]=i.$n(e);return t}),{})}return t};"use strict";i.Oe=t=>{if(i.yn(t)){Object.freeze(t);Object.values(t).forEach(i.Oe)}return t};"use strict";i.cn=(t,s)=>{if(s){Object.entries(s).forEach((([s,e])=>{if(t[s]!==e){if(e===undefined){delete t[s]}else if(!i.yn(e)){t[s]=e}else if(!i.yn(t[s])){t[s]=i.Ne(e)}else{i.cn(t[s],e)}}}))}return t};"use strict";i.ze=(t,s)=>new Promise((i=>{const e=new FileReader;e.onload=t=>i(t.target.result);switch(s){case"text":e.readAsText(t);break;case"array":e.readAsArrayBuffer(t);break}}));"use strict";i.Re=t=>{const s=new Uint8Array(19);const i=`${t.length}`.padStart(9,"0");let e=0;let n=0;for(const i of t){s[n]+=i;if(++n>=19){n=0}if(++e>=1e6){break}}return`1-${i}-${Array.from(s).map((t=>t.toString(16).padStart(2,"0"))).join("")}`};"use strict";i.On=t=>{for(const s in t){return false}return true};"use strict";i.wn=t=>!i.On(t);"use strict";i.yn=t=>t!==null&&typeof t==="object";"use strict";i.Ne=t=>JSON.parse(JSON.stringify(t));"use strict";i.xn=(t,s)=>{const e={};t.forEach((t=>e[t]=i.Sn));Object.assign(Object.seal(e),s);return Object.freeze(e)};"use strict";i.Sn=()=>{};i.Dn=t=>!t||t===i.Sn;"use strict";i.Cn=(...t)=>{const s=t.map(i.Pn).reduce(((t,s)=>{t[0]*=s[0];t[1]*=s[1];return t}),[1,1]);return i.Mn(...s)};"use strict";i.Mn=(t,s)=>t>s?-1+s/t:t<s?1-t/s:0;"use strict";i.Pn=t=>t<0?[1,1+t]:t>0?[1-t,1]:[1,1];"use strict";i.Qe=(t,s,i)=>{const e=s[s.length-1]==="s"?s:`${s}${t>1?"s":""}`;const n=i!=="'s"?e:`${e}'${e[e.length-1]==="s"?"":"s"}`;return`${t} ${n}`};"use strict";i.An=t=>t?t.trim().replace(/\s+/gu," "):"";"use strict";i.Tn=(t,s)=>{const e=i.An(t);if(s.indexOf(e)>-1){const t=/-\d+$/u.test(e)?e.substr(0,e.lastIndexOf("-")).trim():e;const i=new RegExp(`^${t}-(\\d+)$`,"u");const n=s.reduce(((t,s)=>{const e=i.exec(s);return e?Math.max(t,+e[1]):t}),1);return`${t}-${n+1}`}return e};"use strict";i.qe=()=>{const t=crypto.getRandomValues(new Uint8Array(36));const s=t.reduce(((t,s)=>{t.push((s%16).toString(16));return t}),[]);s[14]="4";s[19]=(8+t[19]%4).toString(16);s[8]=s[13]=s[18]=s[23]="-";return s.join("")};"use strict";s.composition=(t,i)=>{const e={};const n=t.k;const a=t.$;for(let i=0;i<t.v;++i){e[i]=s.track({order:i})}return{id:i,name:"",bpm:t.p,stepsPerBeat:n,beatsPerMeasure:a,duration:a,loopA:false,loopB:false,synthOpened:"0",patternKeysOpened:"0",patternDrumsOpened:"1",patternSlicesOpened:null,patternBufferOpened:null,buffers:{0:{duration:.1529,url:"kick-017"},1:{duration:.256,url:"clap-013"},2:{duration:.0357,url:"hat-024"},3:{duration:.7,url:"openhat-012"},4:{duration:.1151,url:"snare-018"}},patterns:{0:{order:0,type:"keys",name:"keys",keys:"0",synth:"0",duration:a},1:{order:0,type:"drums",name:"drums",drums:"0",duration:a},2:{order:0,type:"buffer",dest:"1",buffer:"0",duration:1,name:"kick-017",bufferType:"drum"},3:{order:1,type:"buffer",dest:"1",buffer:"1",duration:1,name:"clap-013",bufferType:"drum"},4:{order:2,type:"buffer",dest:"1",buffer:"2",duration:1,name:"hat-024",bufferType:"drum"},5:{order:3,type:"buffer",dest:"1",buffer:"3",duration:1,name:"openhat-012",bufferType:"drum"},6:{order:4,type:"buffer",dest:"1",buffer:"4",duration:1,name:"snare-018",bufferType:"drum"}},channels:s.channels(),tracks:e,blocks:{0:s.block({pattern:"0",track:"0",duration:a}),1:s.block({pattern:"1",track:"1",duration:a})},synths:{0:s.synth({dest:"2"})},drumrows:{0:s.drumrow({order:0,pattern:"2"}),1:s.drumrow({order:1,pattern:"3"}),2:s.drumrow({order:2,pattern:"4"}),3:s.drumrow({order:3,pattern:"5"}),4:s.drumrow({order:4,pattern:"6"})},slices:{},drums:{0:{}},keys:{0:{}}}};"use strict";s.block=t=>Object.assign(Object.seal({pattern:null,duration:0,durationEdited:false,selected:false,offset:0,when:0,track:null}),t);"use strict";s.channel=t=>Object.assign(Object.seal({order:0,toggle:true,name:"chan",dest:"main",gain:1,pan:0}),t);"use strict";s.channelMain=t=>Object.assign(Object.seal({toggle:true,name:"main",gain:.4,pan:0}),t);"use strict";s.channels=()=>({main:s.channelMain(),1:s.channel({order:0,name:"drums"}),2:s.channel({order:1,name:"synth"}),3:s.channel({order:2,name:"chan 3"}),4:s.channel({order:3,name:"chan 4"})});"use strict";s.drum=t=>Object.assign(Object.seal({when:0,row:null,detune:0,gain:.8,pan:0}),t);"use strict";s.drumcut=t=>Object.assign(Object.seal({when:0,row:null}),t);"use strict";s.drumrow=t=>Object.assign(Object.seal({order:0,toggle:true,pattern:null,detune:0,gain:1,pan:0}),t);"use strict";s.effects.delay=t=>Object.assign(Object.seal({time:.5,gain:.5,pan:-.5}),t);"use strict";s.effects.filter=t=>Object.assign(Object.seal({type:"lowpass",Q:5,gain:-20,detune:0,frequency:500}),t);"use strict";s.env=t=>Object.assign(Object.seal({toggle:true,attack:.04,hold:0,decay:.08,sustain:.75,release:.25}),t);"use strict";s.key=t=>Object.assign(Object.seal({prev:null,next:null,key:57,when:0,duration:1,gain:.8,gainLFOAmp:1,gainLFOSpeed:1,pan:0,highpass:1,lowpass:1,selected:false}),t);"use strict";s.lfo=t=>Object.assign(Object.seal({toggle:false,type:"sine",delay:0,attack:1,speed:1,amp:1}),t);"use strict";s.oscillator=t=>Object.assign(Object.seal({order:0,type:"sine",pan:0,gain:1,detune:0,detunefine:0,unisonvoices:1,unisondetune:.2,unisonblend:.33}),t);"use strict";s.synth=t=>Object.assign(Object.seal({name:"synth",dest:"main",env:s.env(),lfo:s.lfo(),oscillators:{0:s.oscillator({gain:.75}),1:s.oscillator({order:1,gain:.2,detune:-24})}}),t);"use strict";s.track=t=>Object.assign(Object.seal({name:"",order:0,toggle:true}),t);"use strict";a.blocks=class{on=null;data={};#nt=i.kn.bind(null,this.data,this.#at.bind(this),this.#ot.bind(this),this.#rt.bind(this));constructor(t){this.on=i.xn(["addBlock","removeBlock","changeBlockProp","updateBlockViewBox"],t.dataCallbacks);Object.freeze(this)}clear(){Object.keys(this.data).forEach(this.#rt,this)}change(t){this.#nt(t.blocks)}#at(t,s){const i={...s};this.data[t]=i;this.on.addBlock(t,i);this.#ot(t,i)}#rt(t){delete this.data[t];this.on.removeBlock(t)}#ot(t,s){const i=this.data[t];const e=this.on.changeBlockProp.bind(null,t);this.#ht(i,e,"when",s.when);this.#ht(i,e,"duration",s.duration);this.#ht(i,e,"offset",s.offset);this.#ht(i,e,"track",s.track);this.#ht(i,e,"selected",s.selected);if("offset"in s||"duration"in s){this.on.updateBlockViewBox(t,i)}}#ht(t,s,i,e){if(e!==undefined){t[i]=e;s(i,e)}}};Object.freeze(a.blocks);"use strict";a.drumrows=class{on=null;data=Object.freeze({patterns:{},drumrows:{}});#ct=i.kn.bind(null,this.data.drumrows,this.#lt.bind(this),this.#ut.bind(this),this.#dt.bind(this));#pt=i.kn.bind(null,this.data.patterns,this.#gt.bind(this),this.#mt.bind(this),this.#ft.bind(this));constructor(t){this.on=i.xn(["addDrumrow","removeDrumrow","changeDrumrow"],t.dataCallbacks);Object.freeze(this)}change({patterns:t,drumrows:s}){if(t){this.#pt(t)}if(s){this.#ct(s)}}clear(){Object.keys(this.data.patterns).forEach((t=>delete this.data.patterns[t]));Object.keys(this.data.drumrows).forEach(this.#dt,this)}#gt(t,{type:s,name:i,dest:e,buffer:n,duration:a}){if(s==="buffer"){const s=Object.seal({name:i,dest:e,buffer:n,duration:a});this.data.patterns[t]=s;this.#mt(t,s)}}#mt(t,{name:s,duration:i,dest:e}){if(s!==undefined||i!==undefined||e!==undefined){const n=this.data.patterns[t];const a=Object.entries(this.data.drumrows).filter((s=>s[1].pattern===t));this.#bt(n,a,"name",s);this.#bt(n,a,"dest",e);this.#bt(n,a,"duration",i)}}#bt(t,s,i,e){if(e!==undefined){t[i]=e;s.forEach((t=>this.on.changeDrumrow(t[0],i,e)))}}#ft(t){delete this.data.patterns[t]}#lt(t,s){const i=Object.seal({...s});this.data.drumrows[t]=i;this.on.addDrumrow(t,i);this.#wt(t,i)}#dt(t){delete this.data.drumrows[t];this.on.removeDrumrow(t)}#ut(t,s){const i=this.data.drumrows[t];Object.assign(i,s);this.#wt(t,s)}#wt(t,s){const i=this.data.patterns[s.pattern];this.#vt(t,"order",s.order);this.#vt(t,"toggle",s.toggle);this.#vt(t,"detune",s.detune);this.#vt(t,"pan",s.pan);this.#vt(t,"gain",s.gain);this.#vt(t,"pattern",s.pattern);this.#vt(t,"name",s.pattern&&i.name);this.#vt(t,"duration",s.pattern&&i.duration)}#vt(t,s,i){if(i!==undefined){this.on.changeDrumrow(t,s,i)}}};Object.freeze(a.drumrows);"use strict";a.drums=class{on=null;data={};#yt=i.kn.bind(null,this.data,this.#kt.bind(this),this.#$t.bind(this),this.#Ot.bind(this));constructor(t){this.on=i.xn(["addDrum","removeDrum","changeDrum","addDrumcut","removeDrumcut"],t.dataCallbacks);Object.freeze(this)}change(t){this.#yt(t)}clear(){Object.keys(this.data).forEach(this.#Ot,this)}#kt(t,s){const i={...s};this.data[t]=i;if("gain"in i){this.on.addDrum(t,i);this.#$t(t,i)}else{this.on.addDrumcut(t,i)}}#Ot(t){const s="gain"in this.data[t]?this.on.removeDrum:this.on.removeDrumcut;delete this.data[t];s(t)}#$t(t,s){this.#xt(t,"detune",s.detune);this.#xt(t,"gain",s.gain);this.#xt(t,"pan",s.pan)}#xt(t,s,i){if(i!==undefined){this.data[t][s]=i;this.on.changeDrum(t,s,i)}}};Object.freeze(a.drums);"use strict";a.effects=class{on=null;data={};#St=i.kn.bind(null,this.data,this.#Dt.bind(this),this.#Ct.bind(this),this.#Pt.bind(this));values=Object.seal({destFilter:null,resetting:false});constructor(t){this.on=i.xn(["changeBPM","changeTimedivision","addEffect","removeEffect","changeEffect","connectEffectTo","changeEffectData"],t.dataCallbacks);Object.freeze(this)}clear(){Object.keys(this.data).forEach((t=>this.#Pt(t)))}reset(){const t=Object.entries(this.data);this.values.resetting=true;t.forEach((t=>this.#Pt(t[0])));this.values.resetting=false;t.forEach((t=>this.#Dt(t[0],t[1])))}change(t){if(t.bpm){this.on.changeBPM(t.bpm)}if(t.timedivision){this.on.changeTimedivision(t.timedivision)}if(t.effects){this.#St(t.effects)}}setDestFilter(t){const s=this.values.destFilter;if(t!==s){this.values.destFilter=t;Object.entries(this.data).forEach((([i,e])=>{if(e.dest===s){this.#Mt(i)}else if(e.dest===t){this.#At(i,e)}}))}}#Dt(t,s,e){const n=Object.seal(i.Ne(s));this.data[t]=n;if(this.#Tt(n)){this.#At(t,n,e)}}#At(t,s,e){this.on.addEffect(t,s);this.on.changeEffect(t,"toggle",s.toggle);this.on.changeEffect(t,"order",s.order);this.on.changeEffectData(t,s.data);if(!i.Dn(this.on.connectEffectTo)){const[i,n]=this.#Bt(t,e);this.on.connectEffectTo(s.dest,t,n);this.on.connectEffectTo(s.dest,i,t)}}#Pt(t,s){const i=this.data[t];if(this.#Tt(i)){this.#Mt(t,s)}delete this.data[t]}#Mt(t,s){if(!this.values.resetting&&!i.Dn(this.on.connectEffectTo)){const[i,e]=this.#Bt(t,s);this.on.connectEffectTo(this.data[t].dest,i,e)}this.on.removeEffect(t)}#Ct(t,s,e){const n=this.data[t];const a=this.#Tt(n);if("toggle"in s){n.toggle=s.toggle;if(a){this.on.changeEffect(t,"toggle",s.toggle)}}if("data"in s){i.cn(n.data,s.data);if(a){this.on.changeEffectData(t,s.data)}}if("order"in s){if(a&&!i.Dn(this.on.connectEffectTo)){const[s,i]=this.#Bt(t,e);this.on.connectEffectTo(n.dest,s,i)}n.order=s.order;if(a){this.on.changeEffect(t,"order",s.order);if(!i.Dn(this.on.connectEffectTo)){const[s,i]=this.#Bt(t,e);this.on.connectEffectTo(n.dest,s,t);this.on.connectEffectTo(n.dest,t,i)}}}}#Tt(t){return!this.values.destFilter||t.dest===this.values.destFilter}#Bt(t,s={}){const{dest:i,order:e}=this.data[t];let n=null;let a=null;let o=-Infinity;let r=Infinity;Object.entries(this.data).forEach((([h,c])=>{if(h!==t&&c.dest===i){const t=(s[h]||c).order;if(o<t&&t<e){n=h;o=t}if(e<t&&t<r){a=h;r=t}}}));return[n,a]}};Object.freeze(a.effects);"use strict";a.keys=class{on=null;data={};#jt=i.kn.bind(null,this.data,this.#Lt.bind(this),this.#Et.bind(this),this.#Wt.bind(this));static#It=Object.freeze(["key","when","duration","gain","gainLFOAmp","gainLFOSpeed","pan","lowpass","highpass","selected","prev","next"]);constructor(t){this.on=i.xn(["addKey","removeKey","changeKeyProp"],t.dataCallbacks);Object.freeze(this)}clear(){Object.keys(this.data).forEach(this.#Wt,this)}change(t){this.#jt(t)}#Lt(t,s){const i={...s};this.data[t]=i;this.on.addKey(t,i);this.#Et(t,i)}#Wt(t){delete this.data[t];this.on.removeKey(t)}#Et(t,s){a.keys.#It.forEach(a.keys.#ht.bind(null,this.data[t],this.on.changeKeyProp.bind(null,t),s))}static#ht(t,s,i,e){const n=i[e];if(n!==undefined){t[e]=n;s(e,n)}}};Object.freeze(a.keys);"use strict";a.mixer=class{on=null;data=Object.freeze({channels:{},effects:{}});#Ft=i.kn.bind(null,this.data.channels,this.#Kt.bind(this),this.#zt.bind(this),this.#Rt.bind(this));#St=i.kn.bind(null,this.data.effects,this.#Dt.bind(this),this.#Ct.bind(this),this.#Pt.bind(this));constructor(t){this.on=i.xn(["addChannel","removeChannel","toggleChannel","renameChannel","reorderChannel","redirectChannel","changePanChannel","changeGainChannel","addEffect","updateEffect","removeEffect"],t.dataCallbacks);Object.freeze(this)}clear(){Object.keys(this.data.effects).forEach((t=>this.#Pt(t)));Object.keys(this.data.channels).forEach((t=>{if(t!=="main"){this.#Rt(t)}}))}recall(){const t=Object.entries(this.data.channels);t.forEach((t=>this.#Rt(t[0])));t.forEach((t=>this.#Kt(t[0],t[1])))}change(t){this.#Ft(t.channels);this.#St(t.effects)}#Kt(t,s){this.data.channels[t]={};this.on.addChannel(t,s);this.#zt(t,s)}#Rt(t){delete this.data.channels[t];this.on.removeChannel(t)}#zt(t,s){Object.assign(this.data.channels[t],s);this.#Nt(t,s.name,this.on.renameChannel);this.#Nt(t,s.order,this.on.reorderChannel);this.#Nt(t,s.toggle,this.on.toggleChannel);this.#Nt(t,s.dest,this.on.redirectChannel);this.#Nt(t,s.pan,this.on.changePanChannel);this.#Nt(t,s.gain,this.on.changeGainChannel)}#Nt(t,s,i){if(s!==undefined){i(t,s)}}#Dt(t,s){this.data.effects[t]={};this.on.addEffect(s.dest,t,s);this.#Ct(t,s)}#Pt(t){const s=this.data.effects[t].dest;delete this.data.effects[t];if(s in this.data.channels){this.on.removeEffect(s,t)}}#Ct(t,s){i.vn(this.data.effects[t],s);this.on.updateEffect(this.data.effects[t].dest,t,s)}};Object.freeze(a.mixer);"use strict";a.synth=class{on=null;data=Object.seal({name:"",env:Object.seal(s.env()),lfo:Object.seal(s.lfo()),oscillators:{}});#Gt=i.kn.bind(null,this.data.oscillators,this.#Ht.bind(this),this.#Vt.bind(this),this.#Ut.bind(this));constructor(t){this.on=i.xn(["addOsc","removeOsc","changeOsc","changeOscProp","updateOscWave","changeLFO","changeLFOProp","updateLFOWave","changeEnv","changeEnvProp","updateEnvWave"],t.dataCallbacks);Object.freeze(this)}clear(){Object.keys(this.data.oscillators).forEach(this.#Ut,this)}recall(){const t=Object.entries(this.data.oscillators);t.forEach((t=>this.on.removeOsc(t[0])));t.forEach((t=>this.on.addOsc(t[0],t[1])))}change(t){if("name"in t){this.data.name=t.name}if(t.env){this.#qt(t.env)}if(t.lfo){this.#_t(t.lfo)}if(t.oscillators){this.#Gt(t.oscillators)}}#Ht(t,s){const i={...s};this.data.oscillators[t]=i;this.on.addOsc(t,i);this.#Vt(t,i)}#Ut(t){delete this.data.oscillators[t];this.on.removeOsc(t)}#Vt(t,s){const i=this.data.oscillators[t];const e=this.on.changeOscProp.bind(null,t);this.#ht(i,e,"order",s.order);this.#ht(i,e,"type",s.type);this.#ht(i,e,"pan",s.pan);this.#ht(i,e,"gain",s.gain);this.#ht(i,e,"detune",s.detune);this.#ht(i,e,"detunefine",s.detunefine);this.#ht(i,e,"unisonvoices",s.unisonvoices);this.#ht(i,e,"unisondetune",s.unisondetune);this.#ht(i,e,"unisonblend",s.unisonblend);this.on.updateOscWave(t);this.on.changeOsc(t,s)}#qt(t){const s=this.data.env;const i=this.on.changeEnvProp;this.#ht(s,i,"toggle",t.toggle);this.#ht(s,i,"attack",t.attack);this.#ht(s,i,"hold",t.hold);this.#ht(s,i,"decay",t.decay);this.#ht(s,i,"sustain",t.sustain);this.#ht(s,i,"release",t.release);this.on.updateEnvWave();this.on.changeEnv(t)}#_t(t){const s=this.data.lfo;const i=this.on.changeLFOProp;this.#ht(s,i,"toggle",t.toggle);this.#ht(s,i,"type",t.type);this.#ht(s,i,"delay",t.delay);this.#ht(s,i,"attack",t.attack);this.#ht(s,i,"speed",t.speed);this.#ht(s,i,"amp",t.amp);this.on.updateLFOWave();this.on.changeLFO(t)}#ht(t,s,i,e){if(e!==undefined){t[i]=e;s(i,e)}}};Object.freeze(a.synth);"use strict";a.tracks=class{on=null;data={};#Yt=i.kn.bind(null,this.data,this.#Jt.bind(this),this.#Xt.bind(this),this.#Qt.bind(this));constructor(t){this.on=i.xn(["addTrack","removeTrack","toggleTrack","renameTrack","reorderTrack"],t.dataCallbacks);Object.freeze(this)}change(t){this.#Yt(t.tracks)}clear(){Object.keys(this.data).forEach(this.#Qt,this)}#Jt(t,s){this.data[t]={...s};this.on.addTrack(t);this.#Xt(t,s)}#Qt(t){delete this.data[t];this.on.removeTrack(t)}#Xt(t,s){this.#Zt(t,"toggle",s.toggle,this.on.toggleTrack);this.#Zt(t,"name",s.name,this.on.renameTrack);this.#Zt(t,"order",s.order,this.on.reorderTrack)}#Zt(t,s,i,e){if(i!==undefined){this.data[t][s]=i;e(t,i)}}};Object.freeze(a.drums);"use strict";a.slicer=class{data={};#ts=null;#ss=null;#is=null;#es=i.kn.bind(null,this.data,this.#ns.bind(this),this.#as.bind(this),this.#os.bind(this));constructor(t){this.on=i.xn(["disabled","timedivision","setBuffer","renameBuffer","removeBuffer","changeDuration","addSlice","removeSlice","changeSlice"],t.dataCallbacks);Object.freeze(this)}getPatternId(){return this.#ss}setDAWCore(t){this.#ts=t}clear(){this.#ss=this.#is=null;this.on.disabled(true);this.on.removeBuffer();this.on.changeDuration(4);Object.keys(this.data).forEach(this.#os,this)}change(t){const s=this.#ts;if(t.timedivision){this.on.timedivision(t.timedivision)}if("patternSlicesOpened"in t){const i=t.patternSlicesOpened;if(!i){this.clear()}else{const t=s.Qt(i);this.#ss=i;this.#is=t.slices;Object.keys(this.data).forEach(this.#os,this);this.#rs(t.source,s);this.#es(s.Ht(this.#is));this.on.disabled(false)}}else if(this.#ss){const i=t.patterns?.[this.#ss];if(i&&"source"in i){this.#rs(i.source,s)}else{this.#hs(t,s)}this.#es(t.slices?.[this.#is])}}#hs(t,s){const i=t.patterns?.[s.Qt(this.#ss).source]?.duration;if(i){this.on.changeDuration(i)}}#rs(t,s){if(t){const i=s.Qt(t);const e=s.Dt(i.buffer);this.on.setBuffer(e);this.on.renameBuffer(i.name);this.on.changeDuration(i.duration)}else{this.on.removeBuffer()}}#ns(t,s){const i={...s};this.data[t]=i;this.on.addSlice(t,i)}#os(t){delete this.data[t];this.on.removeSlice(t)}#as(t,s){Object.assign(this.data[t],s);this.on.changeSlice(t,s)}};Object.freeze(a.slicer);"use strict";n.patternOpenedByType=Object.freeze({synth:"synthOpened",keys:"patternKeysOpened",drums:"patternDrumsOpened",slices:"patternSlicesOpened",buffer:"patternBufferOpened"});"use strict";n.calcNewDuration=(t,s)=>{const i=s.blocks||{};const e=s.timedivision?s.timedivision.split("/")[0]:t.It();const n=Object.entries(t.Kt()).reduce(((t,[s,e])=>{const n=i[s];if(n||!(s in i)){const s=n?.when??e.when;const i=n?.duration??e.duration;return Math.max(t,s+i)}return t}),0);const a=Object.entries(i).reduce(((s,[i,e])=>e&&!t.zt(i)?Math.max(s,e.when+e.duration):s),n);return Math.ceil(a/e)*e};"use strict";n.calcNewKeysDuration=(t,s,i)=>{const e=t.It();const n=t.Jt(s);const a=Object.entries(n).reduce(((t,[s,e])=>{const n=i[s];if(n||!(s in i)){const s=n?.when??e.when;const i=n?.duration??e.duration;return Math.max(t,s+i)}return t}),0);const o=Object.entries(i).reduce(((t,[s,i])=>i&&!n[s]?Math.max(t,i.when+i.duration):t),a);return Math.max(1,Math.ceil(o/e))*e};"use strict";n.createUniqueName=(t,s)=>i.Tn(s,Object.values(t).map((t=>t.name)));"use strict";n.getDrumrowName=(t,s)=>t.Qt(t.Ut(s).pattern).name;"use strict";n.getNextIdOf=t=>{const s=Object.keys(t).reduce(((t,s)=>Math.max(t,+s||0)),0);return`${s+1}`};"use strict";n.getNextOrderOf=t=>Object.values(t).reduce(((t,s)=>Math.max(t,s.order)),-1)+1;"use strict";n.toggleSolo=(t,s)=>{const i=Object.entries(s);const e=i.some((s=>s[0]!==t&&s[1].toggle===true));const n=i.reduce(((s,[i,n])=>{const a=i===t;if(a&&!n.toggle||!a&&n.toggle===e){s[i]={toggle:!n.toggle}}return s}),{});return[!e,n]};"use strict";n.updatePatternDuration=(t,s,e,a)=>{if(a!==t.Qt(e).duration){const o=Object.entries(t.Kt()).reduce(((t,[s,i])=>{if(i.pattern===e&&!i.durationEdited){t[s]={duration:a}}return t}),{});i.vn(s,{patterns:{[e]:{duration:a}}});i.bn(s,"blocks",o);if(i.wn(o)){const i=n.calcNewDuration(t,s);if(i!==t.Bt()){s.duration=i}}}};"use strict";e.set("addBlock",((t,i,e,a)=>{const o=n.getNextIdOf(t.Kt());const r=s.block({pattern:i,when:e,track:a,duration:t.hs(i)});const h={blocks:{[o]:r}};const c=n.calcNewDuration(t,h);if(c!==t.Bt()){h.duration=c}return[h,["blocks","addBlock",t.Qt(i).name]]}));"use strict";e.set("addChannel",(t=>{const i=t.Nt();const e=n.getNextIdOf(i);const a=n.getNextOrderOf(i);const o=`chan ${e}`;const r=s.channel({order:a,name:o});return[{channels:{[e]:r}},["channels","addChannel",o]]}));"use strict";e.set("addDrumcuts",((t,s,i,n,a)=>e._addDrums("drumcut",true,s,i,n,a,t)));"use strict";e.set("addDrumrow",((t,i)=>{const e=t.Qt(i);if(e.type==="buffer"){const a=t.Vt();const o=n.getNextIdOf(a);const r=n.getNextOrderOf(a);const h=s.drumrow({pattern:i,order:r});return[{drumrows:{[o]:h}},["drumrows","addDrumrow",e.name]]}}));"use strict";e.set("addDrums",((t,s,i,n,a)=>e._addDrums("drum",true,s,i,n,a,t)));e._addDrums=(t,i,e,a,o,r,h)=>{const c=1/h.Ft();const l=Math.round(Math.min(o,r)/c);const u=Math.round(Math.max(o,r)/c);const d=h.Qt(e);const p=h.qt(d.drums);const g=h.Ut(a).pattern;const m=h.Qt(g);const f=Object.entries(p);const b=f.reduce(((s,[i,e])=>{if(e.row===a&&t==="drum"==="gain"in e){s.set(Math.round(e.when/c),i)}return s}),new Map);const w={};const v=+n.getNextIdOf(p);const y=s[t];let k=0;let $=d.duration;for(let t=l;t<=u;++t){const s=b.get(t);if(s){if(!i){w[s]=undefined;++k}}else if(i){const s=t*c;$=Math.max($,s+.001);w[v+k]=y({when:s,row:a});++k}}if(k>0&&!i){$=f.reduce(((t,[s,i])=>s in w?t:Math.max(t,i.when+.001)),0)}if(k>0){const t=h.It();const s=Math.max(1,Math.ceil($/t))*t;const a={drums:{[d.drums]:w}};n.updatePatternDuration(h,a,e,s);return[a,["drums",i?"addDrums":"removeDrums",d.name,m.name,k]]}};"use strict";e.set("addEffect",((t,i,e)=>{const a=t._t();const o=Object.values(a).filter((t=>t.dest===i));const r=n.getNextIdOf(a);const h={dest:i,type:e,toggle:true,order:n.getNextOrderOf(o),data:s.effects[e]()};return[{effects:{[r]:h}},["effects","addEffect",t.Gt(i).name,e]]}));"use strict";e.set("addKey",((t,i,e,a,o)=>{const r=t.Qt(i);const h=t.Jt(r.keys);const c=n.getNextIdOf(h);const l={[c]:s.key({key:e,when:a,duration:o})};const u=n.calcNewKeysDuration(t,r.keys,l);const d={keys:{[r.keys]:l}};Object.entries(h).reduce(((t,[s,i])=>{if(i.selected&&!(s in t)){t[s]={selected:false}}return t}),l);n.updatePatternDuration(t,d,i,u);return[d,["keys","addKey",r.name]]}));"use strict";e.set("addOscillator",((t,i)=>{const e=t.ts(i).oscillators;const a=n.getNextIdOf(e);const o=s.oscillator();o.order=n.getNextOrderOf(e);return[{synths:{[i]:{oscillators:{[a]:o}}}},["synth","addOscillator",t.ts(i).name]]}));"use strict";e.set("addPatternBuffer",((t,s,i,e)=>{const a=t.Rt();const o=Object.values(a);const[r,h]=i.split(":");const c=!o.find((t=>t.url===r||t.hash===r));if(c){const i=t.Xt();const o=t.Nt();const c=n.getNextIdOf(i);const l=n.getNextIdOf(a);const u=Object.values(i).reduce(((t,s)=>s.type!=="buffer"?t:Math.max(t,s.order)),-1)+1;const d=s==="default"&&Object.entries(o).find((([t,s])=>s.name==="drums"))?.[0];const p=d||"main";const g={duration:e.duration};const m={order:u,dest:p,type:"buffer",buffer:l,duration:Math.ceil(e.duration*t.Et()),name:h};if(s==="default"){m.bufferType="drum";g.url=r}else{g.hash=r;t.zs({...g,buffer:e})}return[{buffers:{[l]:g},patterns:{[c]:m}},["patterns","addPatternBuffer",h]]}}));"use strict";e.set("addPatternDrums",(t=>{const s=t.Xt();const i=n.getNextIdOf(t.qt());const e=n.getNextIdOf(s);const a=n.createUniqueName(t.Xt(),"drums");const o=Object.values(s).reduce(((t,s)=>s.type!=="drums"?t:Math.max(t,s.order)),-1)+1;const r={drums:{[i]:{}},patterns:{[e]:{order:o,type:"drums",name:a,drums:i,duration:t.It()}},patternDrumsOpened:e};return[r,["patterns","addPattern","drums",a]]}));"use strict";e.set("addPatternKeys",((t,s)=>{const i=t.Xt();const e=n.getNextIdOf(t.Jt());const a=n.getNextIdOf(i);const o=n.createUniqueName(t.Xt(),"keys");const r=t.ts(s).name;const h=Object.values(i).reduce(((t,i)=>i.synth!==s?t:Math.max(t,i.order)),-1)+1;const c={keys:{[e]:{}},patterns:{[a]:{order:h,type:"keys",name:o,keys:e,synth:s,duration:t.It()}},patternKeysOpened:a};if(s!==t.ct("synth")){c.synthOpened=s}return[c,["patterns","addPatternKeys",o,r]]}));"use strict";e.set("addPatternSlices",(t=>{const s=t.Xt();const i=n.getNextIdOf(t.Ht());const e=n.getNextIdOf(s);const a=n.createUniqueName(t.Xt(),"slices");const o=Object.values(s).reduce(((t,s)=>s.type!=="slices"?t:Math.max(t,s.order)),-1)+1;const r={slices:{[i]:{0:{x:0,y:0,w:.25},1:{x:.25,y:.25,w:.25},2:{x:.5,y:.5,w:.25},3:{x:.75,y:.75,w:.25}}},patterns:{[e]:{order:o,type:"slices",name:a,slices:i,source:null}},patternSlicesOpened:e};return[r,["patterns","addPattern","slices",a]]}));"use strict";e.set("addSynth",(t=>{const i=n.getNextIdOf(t.Zt());const e=n.createUniqueName(t.Zt(),"synth");const a={synths:{[i]:s.synth({name:e})},synthOpened:i};if(t.ct("keys")!=null){a.patternKeysOpened=null}return[a,["synths","addSynth",e]]}));"use strict";e.set("changeChannel",((t,s,i,e)=>[{channels:{[s]:{[i]:e}}},["channels","changeChannel",t.Gt(s).name,i,e]]));"use strict";e.set("changeDrumrow",((t,s,i,e)=>{const a=n.getDrumrowName(t,s);return[{drumrows:{[s]:{[i]:e}}},["drumrows","changeDrumrow",a,i,e]]}));"use strict";e.set("changeDrumrowPattern",((t,s,i)=>{const e=t.Ut(s);const a=t.Qt(i);if(e.pattern!==i&&a.type==="buffer"){const e=n.getDrumrowName(t,s);return[{drumrows:{[s]:{pattern:i}}},["drumrows","changeDrumrowPattern",e,a.name]]}}));"use strict";e.set("changeDrumsProps",((t,s,i,e)=>{const a=t.Qt(s);const o=t.qt(a.drums)[e[0][0]].row;const r=n.getDrumrowName(t,o);const h=e.reduce(((t,[s,e])=>{t[s]={[i]:e};return t}),{});return[{drums:{[a.drums]:h}},["drums","changeDrumsProps",a.name,r,i,e.length]]}));"use strict";e.set("changeEffect",((t,s,i,e)=>{const n=t.Yt(s);return[{effects:{[s]:{data:{[i]:e}}}},["effects","changeEffect",t.Gt(n.dest).name,n.type,i]]}));"use strict";e.set("changeEnv",((t,s,i,e)=>[{synths:{[s]:{env:{[i]:e}}}},["synth","changeEnv",t.ts(s).name,i,e]]));"use strict";e.set("changeKeysProps",((t,s,i,e)=>{const n=t.Qt(s);const a=e.reduce(((t,[s,e])=>{t[s]={[i]:e};return t}),{});return[{keys:{[n.keys]:a}},["keys","changeKeysProps",n.name,i,e.length]]}));"use strict";e.set("changeLFO",((t,s,i,e)=>[{synths:{[s]:{lfo:{[i]:e}}}},["synth","changeLFO",t.ts(s).name,i,e]]));"use strict";e.set("changeLoop",((t,s,i)=>Number.isFinite(s)?[{loopA:s,loopB:i},["cmp","changeLoop",s,i]]:[{loopA:null,loopB:null},["cmp","removeLoop"]]));"use strict";e.set("changeOscillator",((t,s,i,e,n)=>[{synths:{[s]:{oscillators:{[i]:{[e]:n}}}}},["synth","changeOscillator",t.ts(s).name,e,n]]));"use strict";e.set("changePatternBufferInfo",((t,s,{name:e,type:a,bpm:o})=>{const r=t.Qt(s);const h={};const c={};if(e!==r.name){c.name=e}if(a!==r.bufferType){c.bufferType=a;if(r.bufferType==="loop"){c.bufferBpm=undefined}}if(o!==r.bufferBpm&&a==="loop"){c.bufferBpm=o}if("bufferBpm"in c){const i=t.Ct(r.buffer).duration;const e=c.bufferBpm?Math.round(i*(c.bufferBpm/60)):Math.ceil(i*t.Et());n.updatePatternDuration(t,h,s,e);Object.entries(t.Xt()).filter((t=>t[1].type==="slices"&&t[1].source===s)).forEach((s=>n.updatePatternDuration(t,h,s[0],e)))}if(i.wn(c)){i.vn(h,{patterns:{[s]:c}})}if(i.wn(h)){return[h,["patterns","changePatternBufferInfo",e||r.name]]}}));"use strict";e.set("changePatternSlices",((t,s,i,e)=>{const a={};let o;switch(i){case"cropA":case"cropB":o="cropSlices";a.patterns={[s]:{[i]:e}};break;case"duration":o="changeSlicesDuration";n.updatePatternDuration(t,a,s,e);break;case"slices":o="changeSlices";a.slices={[t.Qt(s).slices]:e};break}return[a,["slices",o,t.Qt(s).name,e]]}));"use strict";e.set("changeTempo",((t,s,e)=>{const a=e!==t.Wt();const o=s!==t.Lt();if(a||o){const r={};const h={};const c=Object.entries(t.Xt());if(a){const t=e.split("/")[0];r.timedivision=e;c.forEach((([s,i])=>{if(i.type==="keys"||i.type==="drums"){const e=Math.max(1,Math.ceil(i.duration/t))*t;if(e!==i.duration){h[s]={duration:e}}}}))}if(o){r.bpm=s;c.forEach((([i,e])=>{if(e.type==="buffer"&&!e.bufferBpm){const n=t.Ct(e.buffer).duration;const a=Math.ceil(n*(s/60));if(a!==e.duration){h[i]={duration:a}}}}))}if(i.wn(h)){const s={};r.patterns=h;Object.entries(t.Kt()).forEach((([t,i])=>{const e=h[i.pattern];if(e&&!i.durationEdited){s[t]={duration:e.duration}}}));i.bn(r,"blocks",s);if(i.wn(s)){const s=n.calcNewDuration(t,r);if(s!==t.Bt()){r.duration=s}}}return[r,["cmp","changeTempo",s,e]]}}));"use strict";e.set("clonePattern",((t,s)=>{const a=t.Qt(s);const o=a.type;const r={...a};const h=n.getNextIdOf(t.Xt());const c={patterns:{[h]:r}};r.name=n.createUniqueName(t.Xt(),a.name);++r.order;if(o!=="buffer"){const s=i.Ne(t.ns(o,a[o]));const l=n.getNextIdOf(t.os(o));r[o]=l;c[o]={[l]:s};c[n.patternOpenedByType[o]]=h;Object.entries(t.Xt()).filter(e.clonePattern_filterFn[o].bind(null,r)).forEach((([t,s])=>c.patterns[t]={order:s.order+1}))}return[c,["patterns","clonePattern",r.type,r.name,a.name]]}));e.clonePattern_filterFn=Object.freeze({keys:(t,[,s])=>s.type==="keys"&&s.order>=t.order&&s.synth===t.synth,drums:(t,[,s])=>s.type==="drums"&&s.order>=t.order,slices:(t,[,s])=>s.type==="slices"&&s.order>=t.order});"use strict";e.set("cloneSelectedKeys",((t,s,i,e)=>{const a=t.Qt(s);const o=t.Jt(a.keys);const r=n.getNextIdOf(o);const h={};const c={keys:{[a.keys]:h}};const l=i.reduce(((t,s,i)=>{const n=`${r+i}`;const a={...o[s]};a.when+=e;a.prev=a.next=null;h[s]={selected:false};h[n]=a;t.set(s,n);return t}),new Map);const u=n.calcNewKeysDuration(t,a.keys,h);i.forEach((t=>{const s=o[t].next;if(l.has(s)){const i=l.get(t);const e=l.get(s);h[i].next=e;h[e].prev=i}}));n.updatePatternDuration(t,c,s,u);return[c,["keys","cloneSelectedKeys",a.name,i.length]]}));"use strict";e.set("closePattern",((t,s)=>{if(t.ct(s)){return{[n.patternOpenedByType[s]]:null}}}));"use strict";e.set("cropEndBlocks",((t,s,i)=>{const e=s.reduce(((s,e)=>{s[e]={duration:t.zt(e).duration+i,durationEdited:true};return s}),{});const a={blocks:e};const o=n.calcNewDuration(t,a);if(o!==t.Bt()){a.duration=o}return[a,["blocks","cropEndBlocks",s.length]]}));"use strict";e.set("cropEndKeys",((t,s,i,e)=>{const a=t.Qt(s);const o=t.Jt(a.keys);const r=i.reduce(((t,s)=>{const i=o[s];const n=i.attack+i.release;const a=i.duration+e;const r={duration:a};t[s]=r;if(a<n){r.attack=+(i.attack/n*a).toFixed(3);r.release=+(i.release/n*a).toFixed(3)}return t}),{});const h={keys:{[a.keys]:r}};const c=n.calcNewKeysDuration(t,a.keys,r);n.updatePatternDuration(t,h,s,c);return[h,["keys","cropEndKeys",a.name,i.length]]}));"use strict";e.set("cropStartBlocks",((t,s,i)=>{const e=s.reduce(((s,e)=>{const n=t.zt(e);s[e]={when:n.when+i,offset:n.offset+i,duration:n.duration-i,durationEdited:true};return s}),{});return[{blocks:e},["blocks","cropStartBlocks",s.length]]}));"use strict";e.set("duplicateSelectedBlocks",((t,s)=>{const i=Object.entries(t.Kt()).filter((t=>t[1].selected));const e=+n.getNextIdOf(t.Kt());const a=i.reduce(((t,[i,n],a)=>{const o={...n};o.when+=s;t[i]={selected:false};t[e+a]=o;return t}),{});const o={blocks:a};const r=n.calcNewDuration(t,o);if(r!==t.Bt()){o.duration=r}return[o,["blocks","duplicateSelectedBlocks",i.length]]}));"use strict";e.set("moveBlocks",((t,s,i,e)=>{const a={};const o={blocks:a};const r=Object.entries(t.ss()).sort(((t,s)=>t[1].order<s[1].order));s.forEach((s=>{const n=t.zt(s);const o={};a[s]=o;if(i){o.when=n.when+i}if(e){o.track=r[r.findIndex((t=>t[0]===n.track))+e][0]}}));if(i){const s=n.calcNewDuration(t,o);if(s!==t.Bt()){o.duration=s}}return[o,["blocks","moveBlocks",s.length]]}));"use strict";e.set("moveKeys",((t,s,i,e,a)=>{const o=t.Qt(s);const r=t.Jt(o.keys);const h=i.reduce(((t,s)=>{const i=r[s];const n={};t[s]=n;if(e){n.when=i.when+e}if(a){n.key=i.key-a}return t}),{});const c={keys:{[o.keys]:h}};if(e){const i=n.calcNewKeysDuration(t,o.keys,h);n.updatePatternDuration(t,c,s,i)}return[c,["keys","moveKeys",o.name,i.length]]}));"use strict";e.set("openPattern",((t,s)=>{const i=t.Qt(s);if(s!==t.ct(i.type)&&i.type!=="buffer"){const e={[n.patternOpenedByType[i.type]]:s};if(i.type==="keys"&&i.synth!==t.ct("synth")){e.synthOpened=i.synth}return e}}));"use strict";e.set("openSynth",((t,s)=>{if(s!==t.ct("synth")){const i=Object.entries(t.Xt()).find((t=>t[1].synth===s));const e=i?i[0]:null;const n={synthOpened:s};if(e!==t.ct("keys")){n.patternKeysOpened=e}return n}}));"use strict";e.set("redirectChannel",((t,s,i)=>{if(s!=="main"&&s!==i){return[{channels:{[s]:{dest:i}}},["channels","redirectChannel",t.Gt(s).name,t.Gt(i).name]]}}));"use strict";e.set("redirectKey",((t,s,i,e)=>{const n=t.Qt(s);const a=t.Jt(n.keys)[i];const o={};if(e){o[i]={next:e};o[e]={prev:i};if(a.next){o[a.next]={prev:null}}}else{o[i]={next:null};o[a.next]={prev:null}}return[{keys:{[n.keys]:o}},["keys","redirectKey",n.name,!!e]]}));"use strict";e.set("redirectPatternBuffer",((t,s,i)=>[{patterns:{[s]:{dest:i}}},["patterns","redirectPatternBuffer",t.Qt(s).name,t.Gt(i).name]]));"use strict";e.set("redirectPatternKeys",((t,s,i,e)=>{const n={patterns:e};if(s===t.ct("keys")){n.synthOpened=i}return[n,["patterns","redirectPatternKeys",t.Qt(s).name,t.ts(i).name]]}));"use strict";e.set("redirectPatternSlices",((t,s,i)=>{if(i!==t.Qt(s).source){return[{patterns:{[s]:{source:i}}},["patterns","redirectPatternSlices",t.Qt(s).name,t.Qt(i).name]]}}));"use strict";e.set("redirectSynth",((t,s,i)=>[{synths:{[s]:{dest:i}}},["synths","redirectSynth",t.ts(s).name,t.Gt(i).name]]));"use strict";e.set("removeBlocks",((t,s)=>{const i=s.reduce(((t,s)=>{t[s]=undefined;return t}),{});const e={blocks:i};const a=n.calcNewDuration(t,e);let o=0;Object.entries(t.Kt()).forEach((([t,s])=>{if(s.selected&&!(t in i)){++o;i[t]={selected:false}}}));if(a!==t.Bt()){e.duration=a}return[e,s.length?["blocks","removeBlocks",s.length]:["blocks","unselectAllBlocks",o]]}));"use strict";e.set("removeChannel",((t,s)=>{if(s!=="main"){const n=e.removeChannel_redirect;const a={dest:"main"};const o=n(s,t.Nt(),{[s]:undefined},a);const r=n(s,t.Xt(),{},a);const h=n(s,t._t(),{},undefined);const c=n(s,t.Zt(),{},a);const l={channels:o};i.bn(l,"synths",c);i.bn(l,"effects",h);i.bn(l,"patterns",r);return[l,["channels","removeChannel",t.Gt(s).name]]}}));e.removeChannel_redirect=(t,s,i,e)=>Object.entries(s).reduce(((s,i)=>{if(i[1].dest===t){s[i[0]]=e}return s}),i);"use strict";e.set("removeDrumcuts",((t,s,i,n,a)=>e._addDrums("drumcut",false,s,i,n,a,t)));"use strict";e.set("removeDrumrow",((t,s)=>{const i=n.getDrumrowName(t,s);return[e._removeDrumrow({},s,t),["drumrows","removeDrumrow",i]]}));e._removeDrumrow=(t,s,e)=>{const a=e.It();const o=Object.entries(e.Kt());const r=Object.entries(e.Xt());const h={};const c={};const l={};t.drumrows=t.drumrows||{};t.drumrows[s]=undefined;r.forEach((([n,r])=>{if(r.type==="drums"){const u={};const d=Object.entries(e.qt(r.drums)).reduce(((i,[e,{row:n,when:a}])=>{if(n===s){u[e]=undefined}return n in t.drumrows?i:Math.max(i,a+.001)}),0);if(i.wn(u)){const t=Math.max(1,Math.ceil(d/a))*a;h[r.drums]=u;if(t!==r.duration){l[n]={duration:t};o.forEach((([s,i])=>{if(i.pattern===n&&!i.durationEdited){c[s]={duration:t}}}))}}}}));i.bn(t,"drums",h);i.bn(t,"blocks",c);i.bn(t,"patterns",l);if(i.wn(c)){const s=n.calcNewDuration(e,t);if(s!==e.Bt()){t.duration=s}}return t};"use strict";e.set("removeDrums",((t,s,i,n,a)=>e._addDrums("drum",false,s,i,n,a,t)));"use strict";e.set("removeEffect",((t,s)=>{const i=t.Yt(s);return[{effects:{[s]:undefined}},["effects","removeEffect",t.Gt(i.dest).name,i.type]]}));"use strict";e.set("removeKeys",((t,s,i)=>{const e=t.Qt(s);const a=t.Jt(e.keys);const o=i.reduce(((t,s)=>{const{prev:i,next:e}=a[s];t[s]=undefined;if(i!==null){const s=t[i];if(!(i in t)||s!==undefined){s?s.next=null:t[i]={next:null}}}if(e!==null){const s=t[e];if(!(e in t)||s!==undefined){s?s.prev=null:t[e]={prev:null}}}return t}),{});const r={keys:{[e.keys]:o}};const h=n.calcNewKeysDuration(t,e.keys,o);const c=Object.entries(a).reduce(((t,[s,i])=>{if(i.selected&&!(s in o)){o[s]={selected:false};return t+1}return t}),0);n.updatePatternDuration(t,r,s,h);return[r,i.length?["keys","removeKeys",e.name,i.length]:["keys","unselectAllKeys",e.name,c]]}));"use strict";e.set("removeOscillator",((t,s,i)=>[{synths:{[s]:{oscillators:{[i]:undefined}}}},["synth","removeOscillator",t.ts(s).name]]));"use strict";e.set("removePattern",((t,s)=>{const a=t.Qt(s);const o=a.type;const r={patterns:{[s]:undefined}};const h=Object.entries(t.Kt()).reduce(((t,[i,e])=>{if(e.pattern===s){t[i]=undefined}return t}),{});if(o==="buffer"){Object.entries(t.Vt()).forEach((n=>{if(n[1].pattern===s){i.vn(r,e._removeDrumrow(r,n[0],t))}}));Object.entries(t.Xt()).forEach((t=>{if(t[1].type==="slices"&&t[1].source===s){r.patterns[t[0]]={source:null}}}));r.buffers={[a.buffer]:undefined}}else{r[o]={[a[o]]:undefined}}if(i.wn(h)){const i=Object.values(t.Kt()).reduce(((t,i)=>i.pattern===s?t:Math.max(t,i.when+i.duration)),0);const e=t.It();const n=Math.max(1,Math.ceil(i/e))*e;r.blocks=h;if(n!==t.Bt()){r.duration=n}}if(s===t.ct(o)){const i=Object.entries(t.Xt()).find((([t,i])=>t!==s&&i.type===o&&i.synth===a.synth));r[n.patternOpenedByType[o]]=i?i[0]:null}return[r,["patterns","removePattern",a.type,a.name]]}));"use strict";e.set("removeSynth",((t,s)=>{const e={};const n={};const a={};const o=Object.entries(t.Kt());const r=Object.entries(t.Xt());const h={synths:{[s]:undefined}};r.forEach((([t,i])=>{if(i.synth===s){e[i.keys]=a[t]=undefined;o.forEach((([s,i])=>{if(i.pattern===t){n[s]=undefined}}))}}));i.bn(h,"keys",e);i.bn(h,"patterns",a);i.bn(h,"blocks",n);if(s===t.ct("synth")){if(!Object.keys(t.Zt()).some((t=>{if(t!==s){h.synthOpened=t;if(!r.some((([s,i])=>{if(i.synth===t){h.patternKeysOpened=s;return true}}))){h.patternKeysOpened=null}return true}}))){h.synthOpened=null}}return[h,["synths","removeSynth",t.ts(s).name]]}));"use strict";e.set("renameChannel",((t,s,e)=>{const n=i.An(e);const a=t.Gt(s);if(s!=="main"&&n&&n!==a.name){return[{channels:{[s]:{name:n}}},["channels","renameChannel",a.name,n]]}}));"use strict";e.set("renameComposition",((t,s)=>{const e=i.An(s);const n=t.Mt();if(e&&e!==n){return[{name:e},["cmp","renameComposition",n,e]]}}));"use strict";e.set("renamePattern",((t,s,e)=>{const n=i.An(e);const a=t.Qt(s);if(n&&n!==a.name){return[{patterns:{[s]:{name:n}}},["patterns","renamePattern",a.type,a.name,n]]}}));"use strict";e.set("renameSynth",((t,s,e)=>{const n=i.An(e);const a=t.ts(s);if(n&&n!==a.name){return[{synths:{[s]:{name:n}}},["synths","renameSynth",a.name,n]]}}));"use strict";e.set("renameTrack",((t,s,e)=>{const n=i.An(e);const a=t.es(s);if(n!==a.name){return[{tracks:{[s]:{name:n}}},["tracks","renameTrack",a.name,n]]}}));"use strict";e.set("reorderChannel",((t,s,i)=>[{channels:i},["channels","reorderChannel",t.Gt(s).name]]));"use strict";e.set("reorderDrumrow",((t,s,i)=>{const e=n.getDrumrowName(t,s);return[{drumrows:i},["drumrows","reorderDrumrow",e]]}));"use strict";e.set("reorderOscillator",((t,s,i)=>[{synths:{[s]:{oscillators:i}}},["synth","reorderOscillator",t.ts(s).name]]));"use strict";e.set("reorderPattern",((t,s,i)=>{const e=t.Qt(s);return[{patterns:i},["patterns","reorderPattern",e.type,e.name]]}));"use strict";e.set("selectBlocks",((t,s)=>{const i=s.reduce(((t,s)=>{t[s]={selected:true};return t}),{});return[{blocks:i},["blocks","selectBlocks",s.length]]}));"use strict";e.set("selectKeys",((t,s,i)=>{const e=t.Qt(s);const n=i.reduce(((t,s)=>{t[s]={selected:true};return t}),{});return[{keys:{[e.keys]:n}},["keys","selectKeys",e.name,i.length]]}));"use strict";e.set("toggleChannel",((t,s)=>{const i=t.Gt(s);const e=!i.toggle;return[{channels:{[s]:{toggle:e}}},["channels","toggleChannel",i.name,e]]}));"use strict";e.set("toggleDrumrow",((t,s)=>{const i=n.getDrumrowName(t,s);const e=!t.Ut(s).toggle;return[{drumrows:{[s]:{toggle:e}}},["drumrows","toggleDrumrow",i,e]]}));"use strict";e.set("toggleEffect",((t,s)=>{const i=t.Yt(s);const e=!i.toggle;return[{effects:{[s]:{toggle:e}}},["effects","toggleEffect",t.Gt(i.dest).name,i.type,e]]}));"use strict";e.set("toggleEnv",((t,s)=>{const i=!t.ts(s).env.toggle;return[{synths:{[s]:{env:{toggle:i}}}},["synth","toggleEnv",t.ts(s).name,i]]}));"use strict";e.set("toggleLFO",((t,s)=>{const i=!t.ts(s).lfo.toggle;return[{synths:{[s]:{lfo:{toggle:i}}}},["synth","toggleLFO",t.ts(s).name,i]]}));"use strict";e.set("toggleSoloDrumrow",((t,s)=>{const i=n.getDrumrowName(t,s);const[e,a]=n.toggleSolo(s,t.Vt());return[{drumrows:a},["drumrows","toggleSoloDrumrow",i,e]]}));"use strict";e.set("toggleSoloTrack",((t,s)=>{const[i,e]=n.toggleSolo(s,t.ss());return[{tracks:e},["tracks","toggleSoloTrack",t.es(s).name,i]]}));"use strict";e.set("toggleTrack",((t,s)=>{const i=t.es(s);const e=!i.toggle;return[{tracks:{[s]:{toggle:e}}},["tracks","toggleTrack",i.name,e]]}));"use strict";e.set("unselectAllBlocks",(t=>{let s=0;const i=Object.entries(t.Kt()).reduce(((t,[i,e])=>{if(e.selected){++s;t[i]={selected:false}}return t}),{});return[{blocks:i},["blocks","unselectAllBlocks",s]]}));"use strict";e.set("unselectAllKeys",((t,s)=>{let i=0;const e=t.Qt(s);const n=Object.entries(t.Jt(e.keys)).reduce(((t,[s,e])=>{if(e.selected){++i;t[s]={selected:false}}return t}),{});return[{keys:{[e.keys]:n}},["keys","unselectAllKeys",e.name,i]]}));"use strict";e.set("unselectBlock",((t,s)=>[{blocks:{[s]:{selected:false}}},["blocks","unselectBlock"]]));"use strict";e.set("unselectKey",((t,s,i)=>{const e=t.Qt(s);return[{keys:{[e.keys]:{[i]:{selected:false}}}},["keys","unselectKey",e.name]]}));"use strict";class ${#ts=new r;#cs=new D;#ls=new C;#us=new Y;#ds=null;rootElement=Q.Bn("gsui-daw",{version:"0.0.0",volume:this.#ts.dt(),uirate:+localStorage.getItem("uiRefreshRate")||"auto",samplerate:this.#ts.u.O,timelinenumbering:localStorage.getItem("uiTimeNumbering")||"1",windowslowgraphics:!!+(localStorage.getItem("gsuiWindows.lowGraphics")||"0")});#ps=null;#gs=[[true,false,"o",()=>this.rootElement.showOpenPopup()],[true,false,"s",()=>this.#ts.Ae()],[true,true,"n",()=>this.#ms()],[true,false,"z",()=>this.#ts.Ms()],[true,false,"Z",()=>this.#ts.Ts()],[false,false," ",()=>this.#ts.Ie()?this.#ts.Mi():this.#ts.Si()]];#fs=Object.seal({synth:null,drums:null,mixer:null,slicer:null,piano:null,main:null});#bs=Object.seal({synth:M,drums:O,mixer:x,slicer:A,piano:P,main:S});static#A=["audio/wav","audio/wave","audio/flac","audio/webm","audio/ogg","audio/mpeg","audio/mp3","audio/mp4"];static#n={gs:true,txt:true,json:true};static jn="$specialProp";constructor(){Object.seal(this);this.#ws();this.#vs();this.#ys();this.#ks();this.#$s();this.#Os();this.#xs()}#ws(){document.body.append(this.rootElement,Q.Ln("gsui-daw-window-main"),Q.Ln("gsui-daw-window-piano"),Q.Ln("gsui-daw-window-drums"),Q.Ln("gsui-daw-window-synth"),Q.Ln("gsui-daw-window-mixer"),Q.Ln("gsui-daw-window-slicer"));this.#ds=this.rootElement.querySelector("gsui-windows");this.#ts.bs(+localStorage.getItem("uiRefreshRate")||60);Q.En(this.#ds,"lowgraphics",!!+(localStorage.getItem("gsuiWindows.lowGraphics")||"0"));Q.En(this.rootElement.clock,"mode",localStorage.getItem("gsuiClock.display")||"second");nt.numbering(localStorage.getItem("uiTimeNumbering")||"1");Tt.numbering(localStorage.getItem("uiTimeNumbering")||"1");this.#ps=Q.Wn(document.body,{drumsName:"[data-target=drums]",synthName:"[data-target=synth]",slicesName:"[data-target=slices]",pianorollName:"[data-target=pianoroll]",synthChannelBtn:"[data-target=synthChannel]",synthChannelBtnText:"[data-target=synthChannel] span"})}#$s(){this.#ls.setDAWCore(this.#ts);this.#cs.setDAWCore(this.#ts);this.rootElement.querySelector(".gsuiDAW-patterns").append(this.#ls.rootElement);this.rootElement.querySelector(".gsuiDAW-libraries").append(this.#cs.rootElement);this.#ps.synthName.onclick=this.#Ss.bind(this,"Rename synthesizer","renameSynth","synth");this.#ps.drumsName.onclick=this.#Ss.bind(this,"Rename pattern","renamePattern","drums");this.#ps.slicesName.onclick=this.#Ss.bind(this,"Rename pattern","renamePattern","slices");this.#ps.pianorollName.onclick=this.#Ss.bind(this,"Rename pattern","renamePattern","keys");this.#ps.synthChannelBtn.onclick=this.#Ds.bind(this);this.#ls.setLibraries(this.#cs);this.#ds.Fn("main").In();this.#ds.Fn("mixer").In();U.Kn(gswaPeriodicWavesList).forEach(((t,s)=>$t.addWave(s,t.real,t.imag)))}#Os(){window.onblur=()=>this.#fs.piano?.getUIKeys().midiReleaseAllKeys();window.onkeyup=this.#Cs.bind(this);window.onkeydown=this.#Ps.bind(this);window.onbeforeunload=this.#Ms.bind(this);this.rootElement.ondragover=()=>false;this.rootElement.oncontextmenu=()=>location.host==="localhost"?undefined:false;this.rootElement.addEventListener("wheel",$.#As,{passive:false});this.rootElement.addEventListener("drop",this.#Ts.bind(this));this.#ts.cb.focusOn=this.#Bs.bind(this);this.#ts.cb.currentTime=(t,s)=>{const i=this.#js(s);Q.En(this.rootElement,"currenttime",t);if(i){Q.En(i,"currenttime",t)}};this.#ts.cb.buffersLoaded=(t,s)=>this.#Ls(t,s);this.#ts.cb.buffersDropped=t=>this.#cs.addLocalSamples(t);this.#ts.cb.compositionAdded=t=>this.rootElement.addComposition(t);this.#ts.cb.compositionOpened=t=>{Q.En(this.rootElement,"currentcomposition",`${t.options.saveMode}:${t.id}`);this.#ls.rootElement.expandSynth(t.synthOpened,true);this.#Es(t.name)};this.#ts.cb.compositionClosed=this.#Ws.bind(this);this.#ts.cb.compositionChanged=this.#Is.bind(this);this.#ts.cb.compositionDeleted=t=>this.rootElement.deleteComposition(t);this.#ts.cb.compositionLoading=(t,s)=>Q.En(this.rootElement,"saving",s);this.#ts.cb.compositionSavedStatus=(t,s)=>{Q.En(this.rootElement,"saved",s);this.#Es(t.name)};this.#ts.cb.compositionSavingPromise=this.#Fs.bind(this);this.#ts.cb.historyUndo=()=>this.rootElement.undo();this.#ts.cb.historyRedo=()=>this.rootElement.redo();this.#ts.cb.historyAddAction=t=>this.rootElement.stackAction(t.icon,t.desc);this.#ts.cb.onstartdrum=t=>this.#fs.drums?.onstartdrum(t);this.#ts.cb.onstopdrumrow=t=>this.#fs.drums?.onstopdrumrow(t);this.#ts.cb.analyserFilled=t=>this.rootElement.updateSpectrum(t);this.#ts.cb.channelAnalyserFilled=(t,s,i)=>this.#fs.mixer?.updateAudioData(t,s,i);this.#ts.cb.pause=this.#ts.cb.stop=()=>Q.En(this.rootElement,"playing",false);this.#ts.cb.play=()=>Q.En(this.rootElement,"playing",true);this.rootElement.onSubmitLogin=(s,i)=>{Q.En(this.rootElement,"logging",true);Q.En(this.rootElement,"errauth",false);return t.login(s,i).then((s=>{this.#Ks(s);return t.getUserCompositions(s.id)})).then((t=>{const s={saveMode:"cloud"};t.forEach((t=>this.#ts.li(t.data,s)))})).catch((t=>{Q.En(this.rootElement,"errauth",t.msg);throw t})).finally((()=>Q.En(this.rootElement,"logging",false)))};this.rootElement.onSubmitOpen=(t,s)=>{if(t||s[0]){return(t?this.#ts.oi(t):this.#ts.hi(s[0])).then((t=>this.#ts.Se("local",t.id)))}};this.rootElement.onExportJSON=(t,s)=>this.#ts.Js(t,s);Q.zn(this.rootElement,{gsuiDAW:{switchCompositionLocation:t=>{const[s,i]=t.args;s==="local"?this.#zs(s,i):this.#Rs(s,i)},settings:t=>{const s=t.args[0];this.#ts.bs(s.uiRate==="auto"?60:s.uiRate);this.#ts.Ke(s.sampleRate);Q.En(this.#ds,"lowgraphics",s.windowsLowGraphics);nt.numbering(s.timelineNumbering);Tt.numbering(s.timelineNumbering);localStorage.setItem("uiRefreshRate",s.uiRate);localStorage.setItem("gsuiWindows.lowGraphics",+s.windowsLowGraphics);localStorage.setItem("uiTimeNumbering",s.timelineNumbering);Q.En(this.rootElement,"uirate",s.uiRate);Q.En(this.rootElement,"samplerate",s.sampleRate);Q.En(this.rootElement,"timelinenumbering",s.timelineNumbering);Q.En(this.rootElement,"windowslowgraphics",s.windowsLowGraphics)},changeDisplayClock(t){const s=t.args[0];localStorage.setItem("gsuiClock.display",s)},export:()=>{const t=this.#ts.Bt()*60/this.#ts.Lt();const s=setInterval((()=>{Q.En(this.rootElement,"exporting",this.#ts.lt().currentTime/t)}),100);this.#ts.Qs().then((t=>{clearInterval(s);Q.En(this.rootElement,"exporting",1);this.rootElement.readyToDownload(t.url,t.name)}))},abortExport:()=>this.#ts.Zs(),save:()=>this.#ts.Ae(),open:t=>this.#Ns(...t.args),delete:t=>this.#Gs(...t.args),tempo:t=>{const s=t.args[0];this.#ts.$e("changeTempo",s.bpm,s.timedivision)},logout:()=>{Q.En(this.rootElement,"logging",true);t.logout().finally((()=>Q.En(this.rootElement,"logging",false))).then((()=>{Q.En(this.rootElement,"logged",false);Q.En(this.rootElement,"useravatar",false);Q.En(this.rootElement,"username",false);this.#ts.nt("cloud").forEach((t=>this.#ts.Pe("cloud",t.id)));if(!this.#ts.Pt()){this.#ms()}}))},localNewCmp:()=>this.#ms(),cloudNewCmp:()=>this.#Hs(),openWindow:t=>this.#ds.Fn(t.args[0]).In(),closeWindow:t=>this.#ds.Fn(t.args[0]).Rn(),focusSwitch:()=>this.#ts.We(),volume:t=>this.#ts.vs(t.args[0]),rename:t=>this.#ts.$e("renameComposition",t.args[0]),currentTimeLive:t=>{const s=this.#js();if(s){Q.En(s.timeline,"currenttime-preview",t.args[0])}},currentTime:t=>{const s=this.#js();let i;if(s){i=Q.Nn(s.timeline,"currenttime-preview");Q.En(s.timeline,"currenttime-preview",null)}this.#ts.Oi(+(i||t.args[0]))},play:()=>this.#ts.Fe(),stop:()=>{this.#ts.Mi();this.#cs.stop();if(this.#fs.piano&&document.activeElement===this.#fs.piano.rootElement){this.#ts.Ce("keys","-f")}if(this.#fs.drums&&document.activeElement===this.#fs.drums.rootElement){this.#ts.Ce("drums","-f")}if(this.#fs.slicer&&document.activeElement===this.#fs.slicer.rootElement){this.#ts.Ce("slices","-f")}if(this.#fs.main&&document.activeElement===this.#fs.main.rootElement){this.#ts.Ce("composition","-f")}},reset:()=>this.#ts.ws(),undo:()=>this.#ts.Ms(),redo:()=>this.#ts.Ts(),redoN:t=>{let s=t.args[0];if(s<0){while(s++<0){this.#ts.Ms()}}else{while(s-- >0){this.#ts.Ts()}}}}})}#ys(){this.#ds.onopen=this.#Vs.bind(this);this.#ds.onclose=this.#Us.bind(this);this.#qs("mixer",20,20,266,200,460,300,"mixer","mixer");this.#qs("main",500,20,380,180,600,360,"music","composition");this.#qs("synth",20,340,340,220,460,460,"oscillator","synth");this.#qs("piano",500,400,380,180,600,400,"keys","pianoroll");this.#qs("drums",70,450,380,180,600,400,"drums","drums");this.#qs("slicer",160,140,306,250,420,360,"slices","slicer")}#qs(t,s,i,e,n,a,o,r,h){const c=this.#ds.Fn(t);Q.En(c,{x:s,y:i,w:a,h:o,wmin:e,hmin:n,icon:r,title:h})}#vs(){document.querySelectorAll("div[data-window]").forEach((t=>{const s=this.#ds.Gn(t.dataset.window);const i=s.querySelector(".gsuiWindow-content");const e=Array.from(t.children);t.remove();t.classList.forEach((t=>i.classList.add(t)));if(e.length){const t=e[0];if(t.classList.contains("gsuiDAW-winMenu")){e.shift();s.Hn(...t.children)}}}))}#Vs(t){const s=t.dataset.id;const i=new this.#bs[s];const e=this.#ts.Pt();this.#fs[s]=i;i.setDAWCore(this.#ts);t.Vn(i.rootElement);if(s==="main"){i.rootElement.onfocus=()=>this.#ts.Ce("composition");i.setSVGForms(this.#ls.svgForms)}else if(s==="piano"){i.rootElement.onfocus=()=>this.#ts.Ce("keys");i.rootElement.octaves(1,7);this.#_s()}else if(s==="drums"){i.rootElement.onfocus=()=>this.#ts.Ce("drums");i.setWaveforms(this.#ls.svgForms.bufferHD)}else if(s==="slicer"){i.rootElement.onfocus=()=>this.#ts.Ce("slices")}if(e){i.change(e)}this.rootElement.toggleWindow(s,true)}#Us(t){switch(t.dataset.id){case"piano":this.#ts.$e("closePattern","keys");break;case"drums":this.#ts.$e("closePattern","drums");break;case"slicer":this.#ts.$e("closePattern","slices");break}this.rootElement.toggleWindow(t.dataset.id,false);this.#fs[t.dataset.id].clear();this.#fs[t.dataset.id]=null}getDAWCore(){return this.#ts}newComposition(){this.#ms()}#Bs(t){const s=this.#ts.ki();const i=this.#js(t);const e=t==="composition";Q.En(this.rootElement,"focus",e?"up":"down");Q.En(this.rootElement,"duration",this.#ts.Ee());Q.En(this.rootElement,"currenttime",s);this.#fs.piano?.rootElement.classList.toggle("selected",t==="keys");this.#fs.drums?.rootElement.classList.toggle("selected",t==="drums");this.#fs.slicer?.rootElement.classList.toggle("selected",t==="slices");this.#fs.main?.rootElement.classList.toggle("selected",e);i?.focus({preventScroll:true})}#js(t=this.#ts.Le()){switch(t){default:return null;case"keys":return this.#fs.piano?.rootElement;case"drums":return this.#fs.drums?.rootElement;case"slices":return this.#fs.slicer?.rootElement;case"composition":return this.#fs.main?.rootElement}}#Ps(t){if(!this.#Ys(t)&&!t.ctrlKey&&!t.altKey&&!t.shiftKey){this.#Js(true,t)}}#Cs(t){this.#Js(false,t)}#Js(t,s){const i=this.#fs.piano?.getUIKeys();if(i){const e=i.getMidiKeyFromKeyboard(s);if(e!==false){t?i.midiKeyDown(e):i.midiKeyUp(e);return true}}}#Ys(t){return this.#gs.some((([s,i,e,n])=>{if(e===t.key&&(!i||t.altKey)&&s===(t.ctrlKey||t.altKey)){n();t.preventDefault();return true}}))}#ms(){(!this.#ts.si()?this.#ts.ii():Q.Un.confirm("Warning","Are you sure you want to discard unsaved works").then((t=>t&&this.#ts.ii()))).then((t=>t&&this.#ts.Se("local",t.id)))}#Hs(){if(!t.user.id){Q.Un.alert("Error","You can not create a new composition in the <b>cloud</b><br/>without being connected")}else{(!this.#ts.si()?this.#ts.ii({saveMode:"cloud"}):Q.Un.confirm("Warning","Are you sure you want to discard unsaved works").then((t=>t&&this.#ts.ii({saveMode:"cloud"})))).then((t=>t&&this.#ts.Se("cloud",t.id)))}}#Ms(){if(this.#ts.si()){return"Data unsaved"}}#Ns(t,s){if(this.#ts.si()){Q.Un.confirm("Warning","Are you sure you want to discard unsaved works").then((i=>i&&this.#ts.Se(t,s)))}else{this.#ts.Se(t,s)}}#Gs(s,i){const e=this.#ts.rt(s,i);Q.Un.confirm("Warning",`Are you sure you want to delete "${e.name}" ? (no undo possible)`,"Delete").then((e=>{if(e){(s==="cloud"?t.deleteComposition(i):Promise.resolve()).catch((t=>{if(t.code!==404){Q.Un.alert(`Error ${t.code}`,"An error happened while deleting "+"your composition&nbsp;:<br/>"+`<code>${t.msg||t}</code>`);throw t}})).then((()=>{if(i===this.#ts.jt()){this.#ms()}this.#ts.Pe(s,i)}))}}))}static#As(t){if(t.ctrlKey){t.preventDefault()}}#Ss(t,s,i,e){const n=this.#ts.ct(i);if(n){Q.Un.prompt(t,"",e.currentTarget.textContent,"Rename").then((t=>this.#ts.$e(s,n,t)))}}#Ds(){const t=this.#ts.ct("synth");if(t){ot.openSelectChannelPopup(this.#ts.ts(t).dest).then((s=>s&&this.#ts.$e("redirectSynth",t,s)))}}#Ts(t){t.preventDefault();this.#ts.Be(Q.qn(t.dataTransfer.items))}#Xs(t,s){const i=t==="local"?"cloud":"local";const e=this.#ts.rt(t,s);const n=this.#ts.rt(i,s);return!n?Promise.resolve(e):Q.Un.confirm("Warning","Are you sure you want to overwrite "+`the <b>${i}</b> composition <i>${n.name||"Untitled"}</i>&nbsp;?`).then((t=>{if(t){return e}throw undefined}))}#Rs(t,s){this.#Xs(t,s).then((t=>this.#ts.li(t,{saveMode:"local"}))).then((t=>c.Te(t.id,t)))}#zs(s,i){if(t.user.id){this.#Xs(s,i).then((t=>this.#Fs(t))).then((t=>this.#ts.li(t,{saveMode:"cloud"})))}else{Q.Un.alert("Error","You need to be connected to your account before uploading your composition")}}#Fs(s){return t.saveComposition(s).then((()=>s),(t=>{Q.Un.alert(`Error ${t.code}`,"An error happened while saving your composition&nbsp;:<br/>"+`<code>${t.msg||t}</code>`);throw t}))}#xs(){Q.En(this.rootElement,"logging",true);return t.getMe().then((s=>{this.#Ks(s);return t.getUserCompositions(s.id)})).then((t=>{const s={saveMode:"cloud"};t.forEach((t=>this.#ts.li(t.data,s)))})).catch((t=>{if(t.code!==401){throw t}})).finally((()=>Q.En(this.rootElement,"logging",false)))}#Ks(t){Q.En(this.rootElement,"useravatar",t.avatar);Q.En(this.rootElement,"username",t.username);Q.En(this.rootElement,"logged",true);return t}#Es(t){const s=t||"GridSound";document.title=this.#ts.si()?`*${s}`:s}#Ws(t){this.#Is({bpm:t.bpm,name:t.name,duration:t.duration},{});Q.En(this.rootElement,"currentcomposition",false);Q.En(this.#cs.rootElement,"lib","default");this.#fs.synth?.clear();this.#fs.mixer?.clear();this.#fs.drums?.clear();this.#fs.piano?.clear();this.#fs.main?.clear();this.#ps.drumsName.textContent=this.#ps.synthName.textContent=this.#ps.pianorollName.textContent="";this.#ls.clear();this.#cs.clear()}#Is(t){console.log("change",t);this.#ls.change(t);this.#fs.synth?.change(t);this.#fs.drums?.change(t);this.#fs.mixer?.change(t);this.#fs.slicer?.change(t);this.#fs.piano?.change(t);this.#fs.main?.change(t);$.#Qs.forEach(((s,i)=>{if(i in t){s.call(this,t)}}))}static#Qs=new Map([["channels",function(t){const s=t.channels[this.#ts.ts(this.#ts.ct("synth")).dest];if(s&&"name"in s){this.#ps.synthChannelBtnText.textContent=s.name}}],["synths",function(t){const s=t.synths[this.#ts.ct("synth")];if(s){if("name"in s){this.#ps.synthName.textContent=s.name}if("dest"in s){this.#ps.synthChannelBtnText.textContent=this.#ts.Gt(s.dest).name}}}],["patterns",function(t){Object.entries(t.patterns).forEach((t=>this.#Zs(...t)))}],["timedivision",function(t){Q.En(this.rootElement,"timedivision",t.timedivision)}],["bpm",function({bpm:t}){Q.En(this.rootElement,"bpm",t);this.rootElement.updateComposition(this.#ts.Pt())}],["name",function({name:t}){this.#Es(t);this.rootElement.updateComposition(this.#ts.Pt());Q.En(this.rootElement,"name",t)}],["duration",function({duration:t}){if(this.#ts.Le()==="composition"){Q.En(this.rootElement,"duration",t)}this.rootElement.updateComposition(this.#ts.Pt())}],["patternSlicesOpened",function(t){if(t.patternSlicesOpened){const s=this.#ts.Qt(t.patternSlicesOpened);this.#ps.slicesName.textContent=s.name;this.#ds.Fn("slicer").In();if(this.#ts.Le()==="slices"){Q.En(this.rootElement,"duration",this.#ts.Qt(s.source)?.duration??this.#ts.It())}}else{this.#ps.slicesName.textContent=""}}],["patternDrumsOpened",function(t){if(t.patternDrumsOpened){const s=this.#ts.Qt(t.patternDrumsOpened);this.#ps.drumsName.textContent=s.name;this.#ds.Fn("drums").In();if(this.#ts.Le()==="drums"){Q.En(this.rootElement,"duration",s.duration)}}else{this.#ps.drumsName.textContent=""}}],["synthOpened",function(t){if(t.synthOpened){const s=this.#ts.ts(t.synthOpened);this.#ps.synthName.textContent=s.name;this.#ps.synthChannelBtnText.textContent=this.#ts.Gt(this.#ts.ts(t.synthOpened).dest).name;this.#ds.Fn("synth").In()}else{this.#ps.synthName.textContent="";this.#ps.synthChannelBtnText.textContent=""}}],["patternKeysOpened",function({patternKeysOpened:t}){if(t){const s=this.#ts.Qt(t);this.#ps.pianorollName.textContent=s.name;if(this.#ts.Le()==="keys"){Q.En(this.rootElement,"duration",s.duration)}this.#ds.Fn("piano").In()}else{this.#ps.pianorollName.textContent=""}}]]);#Zs(t,s){if(s){if("duration"in s){const i=this.#ts.Le();if(i!=="composition"&&t===this.#ts.ct(i)){Q.En(this.rootElement,"duration",s.duration)}}if("name"in s){const i=s.name;this.#fs.main?.rootElement.getBlocks().forEach((s=>{if(s.dataset.pattern===t){s.querySelector(".gsuiPatternroll-block-name").textContent=i}}));if(t===this.#ts.ct("slices")){this.#ps.slicesName.textContent=i}if(t===this.#ts.ct("keys")){this.#ps.pianorollName.textContent=i}if(t===this.#ts.ct("drums")){this.#ps.drumsName.textContent=i}}}}#Ls(t,s){const i=this.#ts.Qt(this.#ts.ct("slices"));const e=i?.source&&this.#ts.Qt(i.source).buffer;if(e===t){this.#fs.slicer?.rootElement.setBuffer(s.buffer)}this.#ls.bufferLoaded(t,s.buffer);this.#fs.main?.rootElement.getBlocks().forEach(((s,i)=>{const e=this.#ts.zt(i);const n=this.#ts.Qt(e.pattern);if(n.type==="buffer"&&n.buffer===t){const t=n.bufferBpm||this.#ts.Lt();Q.En(s,"data-missing",false);this.#ls.svgForms.buffer.setSVGViewbox(s._gsuiSVGform,e.offset,e.duration,t/60)}}))}#ks(){navigator.requestMIDIAccess({sysex:true}).then((t=>this.#ti(t,true)),(t=>this.#si(t,true)))}#_s(){this.#us._n(this.#fs.piano.getUIKeys())}#ti(t,s=false){if(s===false){console.log("GSLogs: Sysex is not allowed. Some features of your devices may be disabled.")}this.#us.Yn(t)}#si(t,s=false){if(s===true){navigator.requestMIDIAccess().then(onMIDISuccess,onMIDIFailure)}else{console.log("GSLogs: Failed to get MIDI access - "+t);console.log("GSLogs: MIDI devices are disabled")}}}Object.freeze($);"use strict";class O{#ts=null;#ii=null;#ss=null;#ei=null;rootElement=Q.Bn("gsui-drums");timeline=this.rootElement.timeline;#ni=this.rootElement.drumrows;#ai=new a.drums({dataCallbacks:{addDrum:(t,s)=>this.rootElement.addDrum(t,s),addDrumcut:(t,s)=>this.rootElement.addDrumcut(t,s),changeDrum:(t,s,i)=>this.rootElement.changeDrum(t,s,i),removeDrum:t=>this.rootElement.removeDrum(t),removeDrumcut:t=>this.rootElement.removeDrumcut(t)}});#oi=new a.drumrows({dataCallbacks:{addDrumrow:t=>{this.#ni.add(t,this.rootElement.createDrumrow(t));this.#ri(t,"gain")},removeDrumrow:t=>this.#ni.remove(t),changeDrumrow:(t,s,i)=>{switch(s){default:this.#ni.change(t,s,i);break;case"pattern":this.#ni.change(t,s,this.#ei.createSVG(i));break;case"duration":{const i=this.#ts.Ut(t).pattern;const e=this.#ts.Qt(i).buffer;this.#ni.change(t,s,this.#ts.Ct(e).duration)}break}}}});constructor(){Object.seal(this);Q.zn(this.rootElement,{gsuiDrumrows:{change:t=>{this.#ts.$e(...t.args)},propFilter:t=>{this.#ri(...t.args)},propFilters:t=>{this.#hi(...t.args)},liveStopDrum:t=>{this.#ts.Ki(...t.args)},liveStartDrum:t=>{this.#ts.Fi(...t.args)},liveChangeDrumrow:t=>{this.#ts.Ii(...t.args)}},gsuiDrums:{change:t=>{const[s,...i]=t.args;this.#ts.$e(s,this.#ss,...i)}},gsuiTimeline:{changeCurrentTime:t=>{this.#ts.ne(t.args[0])},changeLoop:t=>{const[s,i]=t.args;s!==false?this.#ts.ae(s,i):this.#ts.oe()}},gsuiSliderGroup:{change:t=>{this.#ts.$e("changeDrumsProps",this.#ss,...t.args)},input:t=>{this.#ni.setDrumPropValue(t.args[0],t.args[2],t.args[3])},inputEnd:t=>{this.#ni.removeDrumPropValue(...t.args)}}});Q.En(this.rootElement,"disabled",true)}setDAWCore(t){this.#ts=t}selectPattern(t){if(t!==this.#ss){this.#ss=t;this.#ii=null;this.#ai.clear();Q.En(this.rootElement,"disabled",!t);if(t){const s=this.#ts.Qt(t);const i=this.#ts.qt(s.drums);this.#ii=s.drums;this.#ai.change(i)}}}setWaveforms(t){this.#ei=t}onstartdrum(t){this.#ni.playRow(t)}onstopdrumrow(t){this.#ni.stopRow(t)}change(t){const s=t.drums&&t.drums[this.#ii];this.#oi.change(t);if(t.drumrows){this.rootElement.drumrows.reorderDrumrows(t.drumrows)}if("timedivision"in t){this.rootElement.timedivision(t.timedivision)}if(s){this.#ai.change(s)}if("patternDrumsOpened"in t){this.selectPattern(t.patternDrumsOpened)}}clear(){this.selectPattern(null);this.#oi.clear();this.#ts.oe()}#ri(t,s){const i=Object.entries(this.#ts.qt(this.#ii)).filter((([,s])=>s.row===t&&"gain"in s)).map((([t,i])=>[t,i[s]]));this.#ni.setPropFilter(t,s);this.rootElement.setPropValues(t,s,i)}#hi(t){Object.keys(this.#ts.Vt()).forEach((s=>this.#ri(s,t)))}}Object.freeze(O);"use strict";class x{#ts=null;rootElement=Q.Bn("gsui-mixer");#ci=this.rootElement.getChannels();#li=this.rootElement.getEffects();#ui="main";#di=new a.mixer({dataCallbacks:{addChannel:(t,s)=>this.#ci.addChannel(t,s),removeChannel:t=>this.#ci.removeChannel(t),renameChannel:(t,s)=>this.#ci.renameChannel(t,s),redirectChannel:(t,s)=>this.#ci.redirectChannel(t,s),toggleChannel:(t,s)=>this.#ci.toggleChannel(t,s),reorderChannel:(t,s)=>this.#ci.reorderChannel(t,s),changePanChannel:(t,s)=>this.#ci.changePanChannel(t,s),changeGainChannel:(t,s)=>this.#ci.changeGainChannel(t,s),addEffect:(t,s,i)=>this.#ci.Gt(t).Jn(s,i),updateEffect:(t,s,i)=>this.#ci.Gt(t).Xn(s,i),removeEffect:(t,s)=>this.#ci.Gt(t).Qn(s)}});#pi=new a.effects({dataCallbacks:{changeTimedivision:t=>Q.En(this.#li,"timedivision",t),addEffect:(t,s)=>this.#li.Jn(t,s),removeEffect:t=>this.#li.Qn(t),changeEffect:(t,s,i)=>this.#li.Zn(t,s,i),changeEffectData:(t,s)=>this.#gi(t,s)}});constructor(){Object.seal(this);this.#ci.oninput=this.#mi.bind(this);this.#ci.onchange=this.#fi.bind(this);this.#ci.onselectChan=this.#bi.bind(this);this.#ci.onselectEffect=this.#wi.bind(this);this.#li.ta=(t,s,i,...e)=>{if(s==="filter"&&i==="curve"){return this.#ts.ft(t)?.sa?.(e[0])}};Q.zn(this.rootElement,{gsuiEffects:{liveChangeEffect:t=>{this.#ts.Bi(...t.args)},addEffect:t=>{t.args.unshift(this.#ui);this.#ts.$e("addEffect",...t.args)},default:t=>{this.#ts.$e(t.eventName,...t.args)}}});this.#pi.setDestFilter("main")}setDAWCore(t){this.#ts=t}clear(){this.#pi.clear();this.#di.clear();this.#ci.selectChannel("main")}change(t){this.#pi.change(t);this.#di.change(t);if(t.effects){this.#li.ia(t.effects)}if(t.channels){this.#ci.reorderChannels(t.channels)}}updateAudioData(t,s,i){this.#ci.updateAudioData(t,s,i)}#mi(t,s,i){this.#ts.Ti(t,s,i)}#fi(t,...s){this.#ts.$e(t,...s)}#bi(t){this.#ui=t;this.#pi.setDestFilter(t)}#wi(t,s){this.#li.ea(s)}#gi(t,s){const i=this.#li.na(t).uiFx;Object.entries(s).forEach((t=>Q.En(i,...t)));i.aa?.()}}Object.freeze(x);"use strict";class S{#ts=null;#vi=null;rootElement=Q.Bn("gsui-patternroll");timeline=this.rootElement.timeline;#yi=new a.tracks({dataCallbacks:{addTrack:t=>this.rootElement.addTrack(t),removeTrack:t=>this.rootElement.removeTrack(t),toggleTrack:(t,s)=>this.rootElement.toggleTrack(t,s),renameTrack:(t,s)=>this.rootElement.renameTrack(t,s),reorderTrack:(t,s)=>this.rootElement.reorderTrack(t,s)}});#ki=new a.blocks({dataCallbacks:{addBlock:(t,s)=>{const i=this.#ts.Qt(s.pattern);const e=i.type==="buffer"?!!this.#ts.Dt(i.buffer):true;this.rootElement.addBlock(t,s,{dataReady:e})},removeBlock:t=>this.rootElement.removeBlock(t),changeBlockProp:(t,s,i)=>this.rootElement.changeBlockProp(t,s,i),updateBlockViewBox:(t,s)=>this.rootElement.updateBlockViewBox(t,s)}});constructor(){Object.seal(this);this.rootElement.setData(this.#ki.data);this.rootElement.setCallbacks({onchange:this.#fi.bind(this),onaddBlock:this.#$i.bind(this),oneditBlock:this.#Oi.bind(this)});this.rootElement.addEventListener("gsuiEvents",this.#xi.bind(this))}setDAWCore(t){this.#ts=t}setSVGForms(t){this.#vi=t}change(t){this.#yi.change(t);this.#ki.change(t);if("loopA"in t||"loopB"in t){this.rootElement.loop(this.#ts.At(),this.#ts.Tt())}if("timedivision"in t){this.rootElement.timedivision(t.timedivision)}if("patterns"in t){Object.entries(t.patterns).forEach((([t,s])=>{if(s&&"bufferBpm"in s){this.#mt(t)}}))}}clear(){this.#ki.clear();this.#yi.clear()}#xi(t){const s=t.detail;switch(s.component){case"gsuiTracklist":this.#ts.$e(s.eventName,...s.args);break;case"gsuiTimeline":switch(s.eventName){case"changeLoop":this.#ts.$e("changeLoop",...s.args);break;case"changeCurrentTime":this.#ts.$i(s.args[0]);break}break}t.stopPropagation()}#mt(t){this.rootElement.getBlocks().forEach((s=>{if(s.dataset.pattern===t){this.rootElement.updateBlockViewBox(s.dataset.id,this.#ki.data[s.dataset.id])}}))}#fi(t,...s){switch(t){case"add":this.#ts.$e("addBlock",...s);break;case"move":this.#ts.$e("moveBlocks",...s);break;case"cropEnd":this.#ts.$e("cropEndBlocks",...s);break;case"cropStart":this.#ts.$e("cropStartBlocks",...s);break;case"duplicate":this.#ts.$e("duplicateSelectedBlocks",...s);break;case"deletion":this.#ts.$e("removeBlocks",...s);break;case"selection":this.#ts.$e("selectBlocks",...s);break;case"unselection":this.#ts.$e("unselectAllBlocks",...s);break;case"unselectionOne":this.#ts.$e("unselectBlock",...s);break}}#Oi(t,s,i){if(i._gsuiSVGform){const t=this.#ts.Qt(s.pattern);const e=t.bufferBpm||this.#ts.Lt();this.#vi[t.type].setSVGViewbox(i._gsuiSVGform,s.offset,s.duration,e/60)}}#$i(t,s,i){const e=this.#ts.Qt(s.pattern);const n=this.#vi[e.type];const a=n.createSVG(s.pattern);i._gsuiSVGform=a;i.children[3].append(a);n.setSVGViewbox(a,s.offset,s.duration,this.#ts.Et());i.ondblclick=()=>this.#ts.$e("openPattern",s.pattern);i.querySelector(".gsuiPatternroll-block-name").textContent=e.name}}Object.freeze(S);"use strict";class D{rootElement=null;#ts=null;constructor(){this.rootElement=Q.Bn("gsui-libraries");this.rootElement.getLibrary("default").setLibrary(gsuiLibrarySamples);Q.En(this.rootElement.getLibrary("local"),"name","local");Q.En(this.rootElement.getLibrary("default"),"name","default");Q.zn(this.rootElement,{gsuiLibrary:{loadSample:(t,s)=>{const i=Q.Nn(s,"name");this.#Si(i,t.args[0]).then((()=>this.#Di(i,t.args[0])))},playSample:(t,s)=>{this.#Di(Q.Nn(s,"name"),t.args[0])},stopSample:()=>{this.#ts.Hs();this.stop()}}})}setDAWCore(t){this.#ts=t}addLocalSamples(t){if(t.length>0){this.rootElement.getLibrary("local").setLibrary(t.map((t=>Array.isArray(t)?[t[0],Nt.getPointsFromBuffer(40,10,t[1]),t[2]]:t)));Q.En(this.rootElement,"lib","local")}}stop(){this.rootElement.getLibrary("default").stopSample();this.rootElement.getLibrary("local").stopSample()}clear(){this.stop();this.rootElement.getLibrary("default").unloadSamples();this.rootElement.getLibrary("local").clear()}oa(t,s){this.rootElement.getLibrary("default").bookmarkSample(t,s);this.rootElement.getLibrary("local").bookmarkSample(t,s)}#Si(t,s){switch(t){case"local":this.rootElement.getLibrary("local").readySample(s);return Promise.resolve();case"default":this.rootElement.getLibrary("default").loadSample(s);return this.#ts.Is(s).then((t=>{this.rootElement.getLibrary("default").readySample(s);return t}))}}#Di(t,s){const i=this.#ts.Ns(s);this.rootElement.getLibrary(t).playSample(s,i.duration)}}Object.freeze(D);"use strict";class C{#ts=null;#Ci=null;#Pi=null;#Mi=null;#pt=null;#Ai=null;constructor(){const t=Q.Bn("gsui-patterns");const s=Object.freeze({keys:new Ht,drums:new Vt,buffer:new Gt,bufferHD:new Gt,slices:new Ut});t.onpatternDataTransfer=t=>t.dataset.id;t.onchange=(t,...s)=>{if(e.has(t)){const i=this.#ts;if(t==="removePattern"&&i.Ie()){const t=s[0];const e=i.Qt(t).type;if(e===i.Le()&&t===i.ct(e)){i.Mi()}}i.$e(t,...s)}else{console.log("GSPatterns.onchange",t,...s)}};Q.zn(t,{gsuiPatterns:{libraryBufferDropped:t=>{const[s,i]=t.args;const[e,n]=i.split(":");this.#ts.Ks(e).then((t=>{const e=this.#ts.$e("addPatternBuffer",s,i,t);const n=e&&Object.entries(e.buffers)[0];if(n){this.#ts.ds("buffersLoaded",n[0],{...n[1],buffer:t})}}))}}});this.data=Object.freeze({synths:{},patterns:{},channels:{}});this.rootElement=t;this.svgForms=s;this.#Pi=t;this.#Mi=i.kn.bind(null,this.data.synths,this.#Ti.bind(this),this.#Bi.bind(this),this.#ji.bind(this));this.#pt=i.kn.bind(null,this.data.patterns,this.#Li.bind(this),this.#mt.bind(this),this.#ft.bind(this));this.#Ai=i.kn.bind(null,this.data.channels,this.#Ei.bind(this),this.#zt.bind(this),this.#Rt.bind(this));Object.seal(this);s.bufferHD.hdMode(true);s.bufferHD.setDefaultViewbox(260,48)}setDAWCore(t){this.#ts=t}setLibraries(t){this.#Ci=t}clear(){Object.keys(this.data.patterns).forEach(this.#ft,this);Object.keys(this.data.synths).forEach(this.#ji,this);this.svgForms.keys.empty();this.svgForms.drums.empty();this.svgForms.slices.empty();this.svgForms.buffer.empty();this.svgForms.bufferHD.empty()}bufferLoaded(t,s){const i=Object.entries(this.#ts.Xt());const e=i.reduce(((t,[s,i])=>{t[i.buffer]=s;return t}),{});this.svgForms.buffer.update(e[t],s);this.svgForms.bufferHD.update(e[t],s);this.#Pi.changePattern(e[t],"data-missing",false)}change(t){this.#Mi(t.synths);this.#pt(t.patterns);this.#Ai(t.channels);if(t.keys||t.drums||t.slices||t.drumrows||t.patterns){Object.entries(this.#ts.Xt()).forEach((([s,i])=>{const e=t.patterns?.[s];if(i.type==="drums"&&(e?.duration||t.drums?.[i.drums]||t.drumrows)||i.type==="keys"&&(e?.duration||t.keys?.[i.keys])||i.type==="slices"&&(e?.source||t.patterns?.[i.source]?.duration||t.slices?.[i.slices])){this.#Wi(s)}}))}if(t.patterns){this.#Pi.reorderPatterns(t.patterns)}if("patternSlicesOpened"in t){this.#Pi.selectPattern("slices",t.patternSlicesOpened)}if("patternDrumsOpened"in t){this.#Pi.selectPattern("drums",t.patternDrumsOpened)}if("patternKeysOpened"in t){this.#Pi.selectPattern("keys",t.patternKeysOpened)}if("synthOpened"in t){this.#Pi.selectSynth(t.synthOpened)}}#Wi(t){const s=this.#ts;const i=s.Qt(t);const e=this.#Pi.getPattern(t);if(e){const n=i.type;const a=s.hs(t);switch(n){case"keys":this.svgForms.keys.update(t,s.Jt(i.keys),a);break;case"slices":this.svgForms.slices.update(t,s.Ht(i.slices),a);break;case"drums":this.svgForms.drums.update(t,s.qt(i.drums),s.Vt(),a,s.Ft());break;case"buffer":{const s=this.#ts.Dt(i.buffer);if(s){this.svgForms.buffer.update(t,s);this.svgForms.bufferHD.update(t,s)}}break}if(n!=="buffer"){this.svgForms[n].setSVGViewbox(e.querySelector("svg"),0,a)}}}#Ti(t,s){this.data.synths[t]=i.Ne(s);this.#Pi.addSynth(t);this.#Bi(t,s)}#Bi(t,s){const i=this.data.synths[t];Object.entries(s).forEach((([s,e])=>{i[s]=e;this.#Pi.changeSynth(t,s,e)}));if("dest"in s){this.#Pi.changeSynth(t,"destName",this.#ts.Gt(s.dest).name)}}#ji(t){delete this.data.synths[t];this.#Pi.deleteSynth(t)}#Li(t,s){const e=s.type==="buffer";const n=e&&this.#ts.Dt(s.buffer);const a=this.svgForms[e?"bufferHD":s.type];this.data.patterns[t]=i.Ne(s);a.add(t);if(e){const i=this.#ts.Ct(s.buffer);const e=i.url||i.hash;this.svgForms.buffer.add(t);if(n){this.svgForms.buffer.update(t,n);a.update(t,n)}this.data.patterns[t].bufferHash=e;this.#Ci.oa(e,true)}this.#Pi.addPattern(t,s);this.#mt(t,s);this.#Pi.appendPatternSVG(t,a.createSVG(t));if(e&&!n){this.#Pi.changePattern(t,"data-missing",true)}}#mt(t,s){const i=this.data.patterns[t];Object.entries(s).forEach((([s,e])=>{i[s]=e;this.#Pi.changePattern(t,s,e)}));if("dest"in s){this.#Pi.changePattern(t,"destName",this.#ts.Gt(s.dest).name)}}#ft(t){const s=this.data.patterns[t];delete this.data.patterns[t];this.svgForms[s.type].delete(t);if(s.type==="buffer"){this.svgForms.bufferHD.delete(t);this.#Ci.oa(s.bufferHash,false)}this.#Pi.deletePattern(t)}#Ei(t,s){this.data.channels[t]=s.name}#zt(t,s){if("name"in s){this.#Pi.updateChannel(t,s.name)}}#Rt(t){delete this.data.channels[t]}}Object.freeze(C);"use strict";class P{#ts=null;#Ii=null;#ss=null;rootElement=new bt;timeline=this.rootElement.timeline;#Fi=new a.keys({dataCallbacks:{addKey:(t,s)=>this.rootElement.addKey(t,s),removeKey:t=>this.rootElement.removeKey(t),changeKeyProp:(t,s,i)=>this.rootElement.changeKeyProp(t,s,i)}});constructor(){Object.seal(this);Q.zn(this.rootElement,{gsuiPianoroll:{changeKeysProps:t=>{this.#ts.$e("changeKeysProps",this.#ss,...t.args)}},gsuiTimeline:{changeCurrentTime:t=>{this.#ts.Ui(t.args[0])},changeLoop:t=>{t.args[0]!==false?this.#ts.Yi(...t.args):this.#ts.Xi()}},gsuiKeys:{keyUp:t=>{this.#ts.Wi(t.args[0])},keyDown:t=>{this.#ts.Ei(t.args[0])}}});this.rootElement.setData(this.#Fi.data);this.rootElement.setCallbacks({onchange:this.#fi.bind(this)});Q.En(this.rootElement,"disabled",true)}setDAWCore(t){this.#ts=t}selectPattern(t){if(t!==this.#ss){this.#ss=t;this.#Ii=null;this.#Fi.clear();this.rootElement.reset();Q.En(this.rootElement,"disabled",!t);if(t){const s=this.#ts.Qt(t);const i=this.#ts.Jt(s.keys);this.#Ii=s.keys;this.#Fi.change(i);this.rootElement.scrollToKeys()}}}change(t){if("timedivision"in t){this.rootElement.timedivision(t.timedivision)}if("patternKeysOpened"in t){this.selectPattern(t.patternKeysOpened)}else{const s=t.keys&&t.keys[this.#Ii];if(s){this.#Fi.change(s)}}}clear(){this.selectPattern(null);this.#Fi.clear();this.#ts.Xi()}getUIKeys(){return this.rootElement.uiKeys}#fi(t,...s){switch(t){case"add":this.#ts.$e("addKey",this.#ss,...s);break;case"move":this.#ts.$e("moveKeys",this.#ss,...s);break;case"clone":this.#ts.$e("cloneSelectedKeys",this.#ss,...s);break;case"remove":this.#ts.$e("removeKeys",this.#ss,...s);break;case"cropEnd":this.#ts.$e("cropEndKeys",this.#ss,...s);break;case"redirect":this.#ts.$e("redirectKey",this.#ss,...s);break;case"selection":this.#ts.$e("selectKeys",this.#ss,...s);break;case"unselection":this.#ts.$e("unselectAllKeys",this.#ss,...s);break;case"unselectionOne":this.#ts.$e("unselectKey",this.#ss,...s);break}}}Object.freeze(P);"use strict";class M{#ts=null;#Ki=null;rootElement=Q.Bn("gsui-synthesizer");#zi=new a.synth({dataCallbacks:{addOsc:(t,s)=>this.rootElement.addOscillator(t,s),removeOsc:t=>this.rootElement.removeOscillator(t),changeEnvProp:(t,s)=>this.rootElement.changeEnvProp(t,s),changeLFOProp:(t,s)=>this.rootElement.changeLFOProp(t,s),changeOscProp:(t,s,i)=>Q.En(this.rootElement.getOscillator(t),s,i),updateEnvWave:()=>this.rootElement.env.updateWave(),updateLFOWave:()=>this.rootElement.lfo.updateWave(),updateOscWave:t=>this.rootElement.getOscillator(t).updateWave()}});constructor(){Object.seal(this);this.rootElement.setWaveList(gswaPeriodicWavesList.map((t=>t[0])));this.rootElement.addEventListener("gsuiEvents",(t=>{const s=t.detail;const i=s.args;const e=this.#Ki;const n=this.#ts;switch(s.component){case"gsuiEnvelope":switch(s.eventName){case"change":n.$e("changeEnv",e,...i);break}break;case"gsuiLFO":switch(s.eventName){case"change":n.$e("changeLFO",e,...i);break;case"liveChange":n.Li(e,{lfo:{[i[0]]:i[1]}});break}break;case"gsuiSynthesizer":switch(s.eventName){case"toggleEnv":n.$e("toggleEnv",e);break;case"toggleLFO":n.$e("toggleLFO",e);break;case"addOscillator":n.$e("addOscillator",e);break;case"reorderOscillator":n.$e("reorderOscillator",e,i[0]);break}break;case"gsuiOscillator":{const a=t.target.dataset.id;switch(s.eventName){case"remove":n.$e("removeOscillator",e,a);break;case"change":n.$e("changeOscillator",e,a,...i);break;case"liveChange":n.Li(e,{oscillators:{[a]:{[i[0]]:i[1]}}});break}}break}t.stopPropagation()}))}setDAWCore(t){this.#ts=t}selectSynth(t){if(t!==this.#Ki){this.#Ki=t;this.#zi.clear();if(t){this.#zi.change(this.#ts.ts(t))}}}change(t){const s=this.#ts;const i=t.synths&&t.synths[this.#Ki];if(t.timedivision){Q.En(this.rootElement.env,"timedivision",t.timedivision);Q.En(this.rootElement.lfo,"timedivision",t.timedivision)}if(i){this.#zi.change(i);if(i.oscillators){this.rootElement.reorderOscillators(i.oscillators)}}if("synthOpened"in t){this.selectSynth(t.synthOpened)}}clear(){this.#zi.clear()}}Object.freeze(M);"use strict";class A{rootElement=Q.Bn("gsui-slicer");#ts=null;#Ri=new a.slicer({dataCallbacks:{disabled:t=>Q.En(this.rootElement,"disabled",t),timedivision:t=>Q.En(this.rootElement,"timedivision",t),setBuffer:t=>this.rootElement.setBuffer(t),renameBuffer:t=>this.rootElement.setBufferName(t),removeBuffer:()=>{this.rootElement.removeBuffer();Q.En(this.rootElement,"duration",this.#ts.It())},changeDuration:t=>Q.En(this.rootElement,"duration",t),addSlice:(t,s)=>this.rootElement.addSlice(t,s),changeSlice:(t,s)=>this.rootElement.changeSlice(t,s),removeSlice:t=>this.rootElement.removeSlice(t)}});constructor(){Object.seal(this);Q.zn(this.rootElement,{gsuiSlicer:{dropBuffer:t=>{this.#ts.$e("redirectPatternSlices",this.#Ri.getPatternId(),t.args[0])},changeProp:t=>{this.#ts.$e("changePatternSlices",this.#Ri.getPatternId(),...t.args)}},gsuiTimeline:{changeCurrentTime:t=>{this.#ts.de(t.args[0])},changeLoop:t=>{t.args[0]!==false?this.#ts.pe(...t.args):this.#ts.ge()}}})}setDAWCore(t){this.#ts=t;this.#Ri.setDAWCore(t)}change(t){this.#Ri.change(t)}clear(){this.#Ri.clear()}}Object.freeze(A);"use strict";class T{#Ni=null;#Gi=null;#Hi=null;#Vi=null;#Ui=null;#qi=Object.seal({toggle:false,when:0,whenStop:0,offset:0,type:"",delay:0,attack:0,absoluteAmp:0,absoluteSpeed:0,amp:0,speed:0,variations:[]});constructor(t,s){this.#Ni=t;this.#Gi=s;Object.seal(this)}pn(t){const s=this.#qi;s.toggle=t.toggle||false;s.when=t.when||this.#Ni.currentTime;s.whenStop=t.whenStop?Math.max(t.when+t.delay+t.attack+.1,t.whenStop):0;s.offset=t.offset||0;s.type=t.type||"sine";s.delay=t.delay||0;s.attack=t.attack||0;s.amp="amp"in t?t.amp:1;s.speed="speed"in t?t.speed:1;s.absoluteAmp="absoluteAmp"in t?t.absoluteAmp:1;s.absoluteSpeed="absoluteSpeed"in t?t.absoluteSpeed:4;s.variations=t.variations||[];if(s.toggle&&!this.#Hi){this.#q()}}ra(){if(this.#Hi){this.#_i(0);this.#Hi.disconnect();this.#Vi.disconnect();this.#Ui.disconnect();this.#Hi=this.#Vi=this.#Ui=null}}Ls(t){Object.assign(this.#qi,t);if(this.#qi.toggle){if(!this.#Hi){this.#q()}else{this.#N(t)}}else if(this.#Hi){this.ra()}}#q(){const t=this.#qi;const s=this.#Ni.createOscillator();const i=this.#Ni.createGain();const e=this.#Ni.createGain();this.#Hi=s;this.#Vi=i;this.#Ui=e;this.#Yi();this.#Ji();this.#Xi();this.#Qi();s.connect(e).connect(i).connect(this.#Gi);s.start(t.when+t.delay-t.offset);if(t.whenStop>0){this.#_i(t.whenStop)}}#_i(t){this.#Hi.frequency.cancelScheduledValues(t);this.#Vi.gain.cancelScheduledValues(t);this.#Ui.gain.cancelScheduledValues(t);this.#Hi.stop(t)}#N(t){if("type"in t){this.#Yi()}if("absoluteSpeed"in t){this.#Hi.frequency.cancelScheduledValues(0);this.#Qi()}if("absoluteAmp"in t){this.#Vi.gain.cancelScheduledValues(0);this.#Xi()}if("when"in t||"offset"in t||"delay"in t||"attack"in t){this.#Ui.gain.cancelScheduledValues(0);this.#Ji()}}#Yi(){this.#Hi.type=this.#qi.type}#Ji(){const t=this.#qi;const s=this.#Ni.currentTime;const i=t.when+t.delay-t.offset;const e=Math.abs(t.absoluteAmp);if(s<=i&&t.attack>0){this.#Ui.gain.setValueAtTime(0,s);this.#Ui.gain.setValueCurveAtTime(new Float32Array([0,e]),i,t.attack)}else{this.#Ui.gain.setValueAtTime(e,s)}}#Xi(){T.#Zi(this.#qi,"absoluteAmp","amp",this.#Vi.gain,this.#Ni.currentTime)}#Qi(){T.#Zi(this.#qi,"absoluteSpeed","speed",this.#Hi.frequency,this.#Ni.currentTime)}static#Zi(t,s,i,e,n){const a=t[s];let o=false;t.variations.forEach((s=>{const r=t.when-t.offset+s.when;const h=s.duration;if(r>n&&h>0){const t=s[i];if(!o){o=true;e.setValueAtTime(a*t[0],n)}e.setValueCurveAtTime(new Float32Array([a*t[0],a*t[1]]),r,h)}}));if(!o){e.setValueAtTime(a*t[i],n)}}}Object.freeze(T);"use strict";class B{ctx=null;node=null;data=Object.seal({toggle:false,when:0,duration:0,...B.#te});static#te=Object.freeze({attack:.01,hold:0,decay:.01,sustain:1,release:.01});constructor(t){Object.seal(this);this.ctx=t;this.node=t.createGain()}pn(t){const s=this.data;const i=B.#te;Object.assign(s,t);s.attack=Math.max(i.attack,s.attack);s.decay=Math.max(i.decay,s.decay);s.release=Math.max(i.release,s.release);this.#q()}ra(){this.#_i()}#q(){const t=this.data;const s=this.ctx.currentTime;const i=this.node.gain;const e=t.when;const n=t.duration;const a=t.toggle?t:B.#te;const o=B.#te.attack;const r=a.attack;const h=a.hold;const c=a.decay;const l=a.sustain;const u=a.release;i.cancelScheduledValues(0);i.setValueAtTime(0,s);if(n>=r+h+c){if(s<=e){this.#se(1,e,r)}else if(s<e+r){this.#se(1,s,e+r-s)}else if(s<e+r+h){this.#se(1,s,o)}else if(s<e+r+h+c){this.#se(l,s,e+r+h+c-s)}else if(s<e+n-o){this.#se(l,s,o)}if(s<e+r+h&&l<1){i.setValueCurveAtTime(new Float32Array([1,l]),e+r+h,c)}}else if(s<=e){this.#se(l,e,n)}else if(s<=e+n){this.#se(l,s,e+n-s)}else{this.#se(l,s,o)}if(Number.isFinite(n)){if(s<=e+n){this.#ie(l,e+n,u)}else if(s<e+n+u){this.#ie(l,s+o,e+n+u-s)}else{this.#ie(l,s+o,o)}}}#se(t,s,i){this.node.gain.setValueCurveAtTime(new Float32Array([0,t]),s,i)}#ie(t,s,i){this.node.gain.setValueCurveAtTime(new Float32Array([t,0]),s,i)}#_i(){const t=this.data;const s=this.ctx.currentTime;const i=this.node.gain;i.cancelScheduledValues(0);if(Number.isFinite(t.duration)){i.setValueAtTime(0,s)}else{i.setValueAtTime(t.sustain,s);i.setValueCurveAtTime(new Float32Array([t.sustain,0]),s,t.release)}}}Object.freeze(B);"use strict";class j{static fftSize=4096;ctx=null;connectedTo=null;nn=new Uint8Array(j.fftSize/2);an=new Uint8Array(j.fftSize/2);#ee={};#ne=new a.mixer({dataCallbacks:{addChannel:this.#ae.bind(this),removeChannel:this.#oe.bind(this),toggleChannel:this.#re.bind(this),redirectChannel:this.#he.bind(this),changePanChannel:this.#ce.bind(this),changeGainChannel:this.#le.bind(this)}});constructor(){Object.seal(this)}we(t){this.ha();this.ctx=t;if("main"in this.#ne.data.channels){this.#ne.recall()}else{this.#ne.change({channels:{main:{toggle:true,name:"main",gain:1,pan:0}}})}}Ls(t){this.#ne.change(t)}tn(){this.#ne.clear();this.#ne.change({channels:{main:{toggle:true,name:"main",gain:1,pan:0}}})}ye(t){this.ha();this.#ee.main.output.connect(t);this.connectedTo=t}ha(){if(this.#ee.main){this.#ee.main.output.disconnect();this.connectedTo=null}}o(t){return this.#ee[t]?.input}l(t){return this.#ee[t]?.pan.getInput()}sn(t){const s=this.#ee[t];s.analyserL.getByteFrequencyData(this.nn);s.analyserR.getByteFrequencyData(this.an)}#ae(t){const s=this.ctx;const i=new V(s);const e=s.createGain();const n=s.createGain();const a=s.createGain();const o=s.createChannelSplitter(2);const r=s.createAnalyser();const h=s.createAnalyser();r.fftSize=h.fftSize=j.fftSize;r.smoothingTimeConstant=h.smoothingTimeConstant=0;n.connect(i.getInput());i.connect(e);e.connect(a);e.connect(o);o.connect(r,0);o.connect(h,1);this.#ee[t]={input:n,pan:i,gain:e,output:a,splitter:o,analyserL:r,analyserR:h,analyserData:new Uint8Array(r.frequencyBinCount)};Object.entries(this.#ne.data.channels).forEach((s=>{if(s[1].dest===t){this.#he(s[0],t)}}))}#he(t,s){this.#ee[t].output.disconnect();if(s in this.#ne.data.channels){this.#ee[t].output.connect(this.o(s))}}#re(t,s){this.#ee[t].gain.gain.setValueAtTime(s?this.#ne.data.channels[t].gain:0,this.ctx.currentTime)}#ce(t,s){this.#ee[t].pan.setValueAtTime(s,this.ctx.currentTime)}#le(t,s){if(this.#ne.data.channels[t].toggle){this.#ee[t].gain.gain.setValueAtTime(s,this.ctx.currentTime)}}#oe(t){const s=this.#ee[t];s.pan.disconnect();s.gain.disconnect();s.input.disconnect();s.output.disconnect();s.splitter.disconnect();delete this.#ee[t]}}"use strict";class L{static#ue=Object.freeze(["sine","triangle","sawtooth","square"]);static#de=0;C=null;ke=null;#pe=24e3;#qi=s.synth();#Gt=i.kn.bind(null,this.#qi.oscillators,this.#Ht.bind(this),this.#ge.bind(this),this.#me.bind(this));#fe=1;#be=new Map;constructor(){Object.seal(this)}static#we(t){return 440*2**((t-57)/12)}we(t){const s=Object.entries(this.#qi.oscillators);this.gn();this.C=t;this.#pe=t.sampleRate/2;this.ke=t.createGain();s.forEach((t=>this.#me(t[0])));s.forEach((t=>this.#Ht(...t)))}_i(t){this.#fe=t/60}Ls(t){if(t.oscillators){this.#Gt(t.oscillators)}if(t.env){this.#ve(t.env)}if(t.lfo){this.#ye(t.lfo)}i.cn(this.#qi,t)}#me(t){this.#be.forEach((s=>{this.#ke(s.oscNodes.get(t));s.oscNodes.delete(t)}))}#Ht(t,s){this.#be.forEach((i=>i.oscNodes.set(t,this.#$e(i,s,0,this.#qi.env))))}#ge(t,s){const i=this.C.currentTime;const e=Object.entries(s);const n=this.#qi.oscillators[t];this.#be.forEach((s=>{const a=s.oscNodes.get(t);e.forEach((([t,e])=>{switch(t){case"type":this.#Oe(n,a,"type",e,i,0);break;case"pan":a.panNode.pan.setValueAtTime(e,i);break;case"gain":a.gainNode.gain.setValueAtTime(e,i);break;case"detune":this.#Oe(n,a,"detune",(e+n.detunefine)*100,i,0);break;case"detunefine":this.#Oe(n,a,"detune",(n.detune+e)*100,i,0);break;case"unisondetune":this.#Oe(n,a,"unisondetune",s.midi,i,0);break;case"unisonblend":this.#Oe(n,a,"unisonblend",e,i,0);break}}))}))}#ve(t){this.#be.forEach((s=>{const i={...t};if("hold"in i){i.hold/=this.#fe}if("decay"in i){i.decay/=this.#fe}if("attack"in i){i.attack/=this.#fe}if("release"in i){i.release/=this.#fe}s.gainEnvNode.pn(i)}))}#ye(t){const s={...t};if("delay"in s){s.delay/=this.#fe}if("attack"in s){s.attack/=this.#fe}if("amp"in s){s.absoluteAmp=s.amp;delete s.amp}if("speed"in s){s.absoluteSpeed=s.speed*this.#fe;delete s.speed}this.#be.forEach((t=>t.gainLFO.Ls(s)))}mn(t,s,i,e){const n=t.filter((([,t])=>(t.when+t.duration)/this.#fe>=i));const a=t[0][1].when;const o=n[0][1].when;const r=o-a;const h=i-r/this.#fe;return this.#xe(n,s,h,e)}#xe(t,s,i,e){const n=++L.#de;const a=t[0][1];const o=t[t.length-1][1];const r=a.when;const h=s-i;const c=this.C;const l=this.#fe;const u=this.#qi.env;const d=this.#qi.lfo;const p=this.#qi.oscillators;const g=[];const m=c.createGain();const f=Object.freeze({when:s,off:i,dur:e,pan:a.pan,midi:a.key,gain:a.gain,lowpass:a.lowpass,highpass:a.highpass,attack:a.attack/l||.005,release:o.release/l||.005,variations:[],oscNodes:new Map,gainEnvNode:new B(c),gainLFO:new T(c,m.gain),gainLFOtarget:m,gainNode:c.createGain(),panNode:c.createStereoPanner(),lowpassNode:c.createBiquadFilter(),highpassNode:c.createBiquadFilter()});if(t.length>1){t.reduce(((t,[,s])=>{if(t){const i=t.when-r;const e=(i+t.duration)/l;const n=(s.when-r)/l-e;f.variations.push({when:e,duration:n,pan:[t.pan,s.pan],midi:[t.key,s.key],gain:[t.gain,s.gain],lowpass:[this.#Se(t.lowpass),this.#Se(s.lowpass)],highpass:[this.#De(t.highpass),this.#De(s.highpass)]});g.push({when:e,duration:n,amp:[t.gainLFOAmp,s.gainLFOAmp],speed:[t.gainLFOSpeed,s.gainLFOSpeed]})}return s}),null)}f.lowpassNode.type="lowpass";f.highpassNode.type="highpass";f.panNode.pan.setValueAtTime(f.pan,h);f.gainNode.gain.setValueAtTime(f.gain,h);f.lowpassNode.frequency.setValueAtTime(this.#Se(f.lowpass),h);f.highpassNode.frequency.setValueAtTime(this.#De(f.highpass),h);f.gainEnvNode.pn({toggle:u.toggle,when:s-i,duration:e+i,attack:u.attack/l,hold:u.hold/l,decay:u.decay/l,sustain:u.sustain,release:u.release/l});f.gainLFO.pn({toggle:d.toggle,when:s,whenStop:Number.isFinite(e)?s+e+u.release/l:0,offset:i,type:d.type,delay:d.delay/l,attack:d.attack/l,absoluteAmp:d.amp,absoluteSpeed:d.speed*l,amp:a.gainLFOAmp,speed:a.gainLFOSpeed,variations:g});Object.entries(p).forEach((([t,s],i)=>f.oscNodes.set(t,this.#$e(f,s,i,u))));this.#Ce(f);f.gainLFOtarget.connect(f.gainEnvNode.node).connect(f.gainNode).connect(f.panNode).connect(f.lowpassNode).connect(f.highpassNode).connect(this.ke);this.#be.set(n,f);return n}gn(){this.#be.forEach(((t,s)=>this.fn(s)))}fn(t){const s=this.#be.get(t);if(s){if(Number.isFinite(s.dur)){this.#Pe(t)}else{s.gainEnvNode.ra();setTimeout(this.#Pe.bind(this,t),(this.#qi.env.release+.1)/this.#fe*1e3)}}else{console.error("gswaSynth: stopKey id invalid",t)}}#Pe(t){const s=this.#be.get(t);s.oscNodes.forEach(this.#ke,this);s.gainLFO.ra();s.gainEnvNode.ra();this.#be.delete(t)}#Se(t){return this.#Me(t,this.#pe,2)}#De(t){return this.#Me(1-t,this.#pe,3)}#Me(t,s,i){return i===0?t:Math.expm1(t)**i/(Math.E-1)**i*s}#Ce(t){t.variations.forEach((s=>{const i=t.when-t.off+s.when;const e=s.duration;if(i>this.C.currentTime&&e>0){t.oscNodes.forEach(((t,n)=>this.#Oe(this.#qi.oscillators[n],t,"frequency",s.midi,i,e)));t.panNode.pan.setValueCurveAtTime(new Float32Array(s.pan),i,e);t.gainNode.gain.setValueCurveAtTime(new Float32Array(s.gain),i,e);t.lowpassNode.frequency.setValueCurveAtTime(new Float32Array(s.lowpass),i,e);t.highpassNode.frequency.setValueCurveAtTime(new Float32Array(s.highpass),i,e)}}))}#$e(t,s,i,e){const n=this.C.currentTime;const a=[];const o=this.C.createStereoPanner();const r=this.C.createGain();const h=Object.freeze({uniNodes:a,panNode:o,gainNode:r});for(let t=0;t<s.unisonvoices;++t){a.push([this.C.createOscillator(),this.C.createGain()])}this.#Oe(s,h,"type",s.type,n,0);this.#Oe(s,h,"detune",(s.detune+s.detunefine)*100,n,0);this.#Oe(s,h,"frequency",t.midi,n,0);this.#Oe(s,h,"unisonblend",s.unisonblend,n,0);o.pan.setValueAtTime(s.pan,n);r.gain.setValueAtTime(s.gain,n);a.forEach((([s,i])=>s.connect(i).connect(o).connect(r).connect(t.gainLFOtarget)));a.forEach((s=>s[0].start(t.when+1e-4*(i+t.midi/4))));if(Number.isFinite(t.dur)){a.forEach((s=>s[0].stop(t.when+t.dur+e.release/this.#fe)))}return h}#ke(t){t.uniNodes.forEach((t=>t[0].stop()))}#Oe(t,s,i,e,n,a){const o=s.uniNodes;switch(i){case"type":o.forEach((t=>this.#Ae(t[0],e)));break;case"detune":o.forEach((t=>t[0].detune.setValueAtTime(e,n)));break;case"frequency":a?o.forEach(((s,i)=>s[0].frequency.setValueCurveAtTime(L.#Te(t,e,i),n,a))):o.forEach(((s,i)=>s[0].frequency.setValueAtTime(L.#Te(t,e,i),n)));break;case"unisondetune":o.forEach(((s,i)=>{s[0].frequency.cancelScheduledValues(0);s[0].frequency.setValueAtTime(L.#Te(t,e,i),n)}));break;case"unisonblend":o.forEach(((s,i)=>s[1].gain.setValueAtTime(L.#Be(t,e,i),n)));break}}#Ae(t,s){if(L.#ue.indexOf(s)>-1){t.type=s}else{t.setPeriodicWave(U.Ve(this.C,s))}}static#Te(t,s,i){const e=t.unisonvoices>1?t.unisondetune/-2+i*(t.unisondetune/(t.unisonvoices-1)):0;if(typeof s==="number"){return L.#we(s+e)}return new Float32Array([L.#we(s[0]+e),L.#we(s[1]+e)])}static#Be(t,s,i){const e=1/t.unisonvoices;const n=t.unisonvoices%2===0;const a=Math.floor(t.unisonvoices/2);const o=e+(1-s)*(1-e);const r=e+(1-s)*(.5-e);const h=(1-(n?r*2:o))/(t.unisonvoices-1-n);return i===a?n?r:o:i===a-1?n?r:h:h}}Object.freeze(L);"use strict";class E{scheduler=new G;#je=null;#be=new Map;constructor(){Object.seal(this);this.scheduler.delayStopCallback=4;this.scheduler.ondatastart=this.#Le.bind(this);this.scheduler.ondatastop=this.#Ee.bind(this)}we(t){this.scheduler.currentTime=()=>t.currentTime;this.scheduler.ln(!(t instanceof OfflineAudioContext))}Ni(t){this.#je=t}Ls(t){this.scheduler.Ls(t)}pn(t,s,i){this.scheduler.pn(t,s,i)}Mi(){this.scheduler.Mi()}#Le(t,s,i,e,n){this.#be.set(t,this.#je.mn(s,i,e,n))}#Ee(t){this.#je.fn(this.#be.get(t));this.#be.delete(t)}}"use strict";class W{scheduler=new G;#We=null;#Ie=new Map;constructor(){Object.seal(this);this.scheduler.ondatastart=this.#Fe.bind(this);this.scheduler.ondatastop=this.#Ke.bind(this);this.scheduler.ondatapropchange=this.#ze.bind(this)}we(t){this.scheduler.currentTime=()=>t.currentTime;this.scheduler.ln(!(t instanceof OfflineAudioContext))}fs(t){this.#We=t}Ls(t){const s=i.$n(t);Object.values(s).forEach((t=>{if(t&&"when"in t){t.duration=this.#We.ca(t.row)}}));this.scheduler.Ls(s)}pn(t,s,i){this.scheduler.pn(t,s,i)}Mi(){this.scheduler.Mi()}#Fe(t,[[,s]],i,e){if("gain"in s){this.#Ie.set(t,this.#We.la(s,i,e,s.duration))}else{this.#We.ua(s,i)}}#Ke(t){this.#We.da(this.#Ie.get(t));this.#Ie.delete(t)}#ze(t,s,i){this.#We.pa(t,s,i)}}"use strict";class I{static Ze(t,s,i,e,n){const a=i*s.length|0;const o=(e-i)*s.length|0;const r=t.createBuffer(s.numberOfChannels,o,t.sampleRate);Object.values(n).forEach((i=>{const e={att:t.sampleRate*.01,rel:t.sampleRate*.01,srcInd:a+(i.x-(i.x-i.y))*o|0,dstInd:i.x*o|0,cpyLen:i.w*o|0};for(let t=0;t<s.numberOfChannels;++t){e.srcArr=s.getChannelData(t);e.dstArr=r.getChannelData(t);I.#Re(e)}}));return r}static#Re({srcArr:t,srcInd:s,dstArr:i,dstInd:e,cpyLen:n,att:a,rel:o}){for(let r=0;r<n;++r){i[e+r]=s+r<t.length?t[s+r]*I.#Ne(r,n,a,o):0}}static#Ne(t,s,i,e){return t<s/2?Math.min(t,i)/i:Math.min(s-1-t,e)/e}}"use strict";class F{static#Ge=[];static#He=0;static#Ve=20;static ga(){F.#He=F.#Ge.length=0}static ma(){const t=Date.now();const s=F.#He;F.#He=t;if(s){const i=6e4/(t-s);const e=F.#Ge;const n=e.length?e[e.length-1]:0;if(n&&(i<n/1.5||i>n*1.5)){e.length=0}else{if(e.unshift(i)>F.#Ve){e.length=F.#Ve}return+(e.reduce(((t,s)=>t+s),0)/e.length).toFixed(2)}}return 0}}"use strict";class K{ctx=null;#Ue=60;#qe=new Map;#_e=null;#Ye=null;#Je=new a.effects({dataCallbacks:{changeBPM:t=>{this.#Ue=t;this.#qe.forEach((s=>s._i?.(t)))},addEffect:this.#Dt.bind(this),removeEffect:this.#Xe.bind(this),changeEffect:this.#Qe.bind(this),connectEffectTo:this.#Ze.bind(this),changeEffectData:(t,s)=>this.bt(t).Ls(s)}});constructor(t){Object.seal(this);this.#_e=t.getChanInput;this.#Ye=t.getChanOutput}bt(t){return this.#qe.get(t)}we(t){this.ctx=t;this.#Je.reset()}Ls(t){this.#Je.change(t)}tn(){this.#Je.clear()}ji(t,s,i){this.bt(t).fa(s,i)}#Dt(t,i){const e=K.#tn(i.type);this.#qe.set(t,e);e.we(this.ctx);e._i?.(this.#Ue);e.Ls(s.effects[i.type]())}static#tn(t){switch(t){case"delay":return new z;case"filter":return new R}}#Xe(t){this.bt(t).ba().disconnect();this.#qe.delete(t)}#Qe(t,s,i){if(s==="toggle"){this.bt(t).wa(i)}}#Ze(t,s,i){const e=i?this.bt(i).va():this.#Ye(t);const n=s?this.bt(s).ba():this.#_e(t);if(n){n.disconnect();n.connect(e)}}}Object.freeze(K);"use strict";class z{#Ni=null;#fe=1;#sn=null;#in=null;#en=null;#nn=null;#an=null;#on=null;#rn=null;#hn=null;#cn=false;#qi=s.effects.delay();constructor(){Object.seal(this)}va(){return this.#sn}ba(){return this.#in}_i(t){this.#fe=t/60;this.#ln("time",this.#qi.time)}we(t){if(this.#Ni){this.#sn.disconnect();this.#in.disconnect();this.#en.disconnect()}this.#Ni=t;this.#sn=t.createGain();this.#in=t.createGain();this.#an=t.createGain();this.#on=t.createGain();this.#rn=t.createStereoPanner();this.#hn=t.createStereoPanner();this.#en=t.createDelay(20);this.#nn=t.createDelay(20);this.wa(this.#cn);this.Ls(this.#qi)}wa(t){this.#cn=t;if(this.#Ni){if(t){this.#sn.disconnect();this.#sn.connect(this.#an).connect(this.#rn).connect(this.#en).connect(this.#on).connect(this.#hn).connect(this.#nn).connect(this.#an);this.#sn.connect(this.#in);this.#en.connect(this.#in);this.#nn.connect(this.#in)}else{this.#en.disconnect();this.#nn.disconnect();this.#sn.connect(this.#in)}}}Ls(t){"time"in t&&this.#ln("time",t.time);"gain"in t&&this.#ln("gain",t.gain);"pan"in t&&this.#ln("pan",t.pan)}fa(t,s){this.#ln(t,s)}#ln(t,s){this.#qi[t]=s;switch(t){case"time":this.#en.delayTime.setValueAtTime(s/this.#fe,this.#Ni.currentTime);this.#nn.delayTime.setValueAtTime(s/this.#fe,this.#Ni.currentTime);break;case"gain":this.#an.gain.setValueAtTime(s,this.#Ni.currentTime);this.#on.gain.setValueAtTime(s,this.#Ni.currentTime);break;case"pan":this.#rn.pan.setValueAtTime(s,this.#Ni.currentTime);this.#hn.pan.setValueAtTime(-s,this.#Ni.currentTime);break}}}Object.freeze(z);"use strict";class R{#Ni=null;#sn=null;#in=null;#un=null;#cn=false;#dn=-1;#pn=null;#gn=null;#mn=null;#qi=s.effects.filter();constructor(){Object.seal(this)}va(){return this.#sn}ba(){return this.#in}we(t){if(this.#Ni){this.#sn.disconnect();this.#in.disconnect();this.#un.disconnect()}this.#Ni=t;this.#sn=t.createGain();this.#in=t.createGain();this.#un=t.createBiquadFilter();this.wa(this.#cn);this.Ls(this.#qi)}wa(t){this.#cn=t;if(this.#Ni){if(t){this.#sn.disconnect();this.#sn.connect(this.#un);this.#un.connect(this.#in)}else{this.#un.disconnect();this.#sn.connect(this.#in)}}}Ls(t){Object.assign(this.#qi,t);"type"in t&&this.#fn(t.type);"Q"in t&&this.#ln("Q",t.Q);"gain"in t&&this.#ln("gain",t.gain);"detune"in t&&this.#ln("detune",t.detune);"frequency"in t&&this.#ln("frequency",t.frequency)}fa(t,s){this.#ln(t,s)}sa(t){this.#bn(t);this.#un.getFrequencyResponse(this.#pn,this.#gn,this.#mn);return this.#gn}#fn(t){this.#un.type=t}#ln(t,s){this.#un[t].setValueAtTime(s,this.#Ni.currentTime)}#bn(t){if(t!==this.#dn){const s=this.#Ni.sampleRate/2;const i=new Float32Array(t);this.#dn=t;this.#pn=i;this.#gn=new Float32Array(t);this.#mn=new Float32Array(t);for(let e=0;e<t;++e){i[e]=s*2**(e/t*11-11)}}}}Object.freeze(R);"use strict";class N{static#de=0;us=null;ps=null;Dt=i.Sn;ls=i.Sn;#Ni=null;#Ie=new Map;#Je=new a.drumrows({dataCallbacks:{addDrumrow:i.Sn,removeDrumrow:this.#wn.bind(this),changeDrumrow:this.#vn.bind(this)}});constructor(){Object.seal(this)}we(t){this.ya();this.#Ni=t}Ls(t){this.#Je.change(t)}tn(){this.#Je.clear()}ca(t){const s=this.#Je.data;return s.patterns[s.drumrows[t].pattern].duration}Fi(t){const s={row:t,detune:0,gain:1,pan:0};return this.#yn(s,this.#Ni.currentTime,0,null,true)}Ki(t){this.#Ie.forEach(((s,i)=>{if(s.rowId===t){this.da(i,"-f")}}))}ua(t,s){const i=.001;const e=s-i;this.#Ie.forEach((n=>{if(n.absn&&n.rowId===t.row&&n.when<e&&s<n.endAt){n.endAt=s;n.gainCut.gain.setValueCurveAtTime(new Float32Array([1,0]),e,i);n.absn.stop(s+i);if(this.ps){const t=this.ps.bind(null,n.rowId);const s=e-this.#Ni.currentTime;n.startDrumcutTimeoutId=setTimeout(t,s*1e3)}}}))}la(t,s,i,e){return this.#yn(t,s,i,e,false)}#yn(t,s,e,n,a){const o=this.#Je.data;const r=t.row;const h=o.drumrows[r];const c=o.patterns[h.pattern];const l=this.Dt(c.buffer);const u=n!==null?n:l?l.duration:0;const d=++N.#de;const p={rowId:r,live:a,when:s,dur:u,endAt:s+u,pan:t.pan,gain:t.gain,detune:t.detune};if(l){const n=this.#Ni.createBufferSource();const a=this.#Ni.createGain();const o=this.#Ni.createGain();const d=this.#Ni.createStereoPanner();const g=this.ls(c.dest);p.absn=n;p.gainCut=o;p.gainRow=a;p.panRow=d;n.buffer=l;n.detune.setValueAtTime((h.detune+t.detune)*100,this.#Ni.currentTime);a.gain.setValueAtTime(h.toggle?h.gain*t.gain:0,this.#Ni.currentTime);d.pan.setValueAtTime(i.Cn(h.pan,t.pan),this.#Ni.currentTime);n.connect(o).connect(a).connect(d).connect(g);n.start(s,e,u);if(this.us){const t=(s-this.#Ni.currentTime)*1e3;p.startDrumTimeoutId=setTimeout((()=>this.us(r)),t)}}this.#Ie.set(d,p);this.#Ie.forEach(((t,s)=>{if(t.when+t.dur<=this.#Ni.currentTime){this.#kn(s,t)}}));return d}ya(){this.#Ie.forEach(((t,s)=>this.da(s,"-f")))}da(t,s){const i=this.#Ie.get(t);if(i&&(s==="-f"||i.when+i.dur<=this.#Ni.currentTime||i.when>=this.#Ni.currentTime)){this.#kn(t,i)}}#kn(t,s){this.#Ie.delete(t);clearTimeout(s.startDrumTimeoutId);clearTimeout(s.startDrumcutTimeoutId);if(s.absn){s.absn.stop();s.gainCut.disconnect();s.gainRow.disconnect();s.panRow.disconnect();if(this.onstopdrum){this.onstopdrum(s.rowId,t)}}}pa(t,s,e){const n=this.#Ie.get(+t);if(n){const t=this.#Je.data.drumrows[n.rowId];switch(s){case"detune":n.detune=e;n.absn.detune.setValueAtTime((e+t.detune)*100,this.#Ni.currentTime);break;case"gain":n.gain=e;n.gainRow.gain.setValueAtTime(t.toggle?e*t.gain:0,this.#Ni.currentTime);break;case"pan":n.pan=e;n.panRow.pan.setValueAtTime(i.Cn(e,t.pan),this.#Ni.currentTime);break}}}#wn(t){this.#Ie.forEach(((s,i)=>{if(s.rowId===t){this.da(i,"-f")}}))}#vn(t,s,e){const n=this.#Je.data.drumrows[t];switch(s){case"toggle":this.#$n(t,(t=>{t.gainRow.gain.setValueAtTime(e?n.gain:0,this.#Ni.currentTime)}));break;case"dest":this.#$n(t,(t=>{t.gainRow.disconnect();t.gainRow.connect(this.ls(e))}));break;case"detune":this.#$n(t,(t=>{t.absn.detune.setValueAtTime((e+t.detune)*100,this.#Ni.currentTime)}));break;case"gain":this.#$n(t,(t=>{t.gainRow.gain.setValueAtTime(e*t.gain,this.#Ni.currentTime)}));break;case"pan":this.#$n(t,(t=>{t.panRow.pan.setValueAtTime(i.Cn(e,t.pan),this.#Ni.currentTime)}));break}}#$n(t,s){this.#Ie.forEach((i=>{if(i.rowId===t&&i.absn){s(i)}}))}}Object.freeze(N);"use strict";class G{static#de=0;data={};bpm=60;bps=1;loopA=null;loopB=null;looping=false;loopDuration=0;isStreaming=true;started=false;duration=0;delayStopCallback=0;currentTime=i.Sn;ondatastart=i.Sn;ondatastop=i.Sn;ondatapropchange=i.Sn;onended=i.Sn;#On=0;#xn=0;#Sn=0;#Dn=0;#Cn=null;#Pn=[];#Mn={};#An={};#Tn=null;#Bn=this.#jn.bind(this);#Je=i.kn.bind(null,this.data,this.#Ln.bind(this),this.#En.bind(this),this.#Wn.bind(this));constructor(){Object.seal(this)}_i(t){if(this.bpm!==t){const s=this.bpm/t;const i=this.#In()*s;this.bpm=t;this.bps=t/60;this.duration*=s;if(this.looping){this.loopA*=s;this.loopB*=s;this.loopDuration=this.loopB-this.loopA;this.#Fn(this.loopB>i?i:this.loopA)}else{this.#Fn(i)}}}xs(){this.#Pn.forEach((t=>this.#Wn(t[0])));this.Qi()}dn(t,s){return this.#Y(t/this.bps,s/this.bps)}#Y(t,s){const i=this.started&&this.#In();this.looping=true;this.loopA=Math.min(t,s);this.loopB=Math.max(t,s);this.loopDuration=this.loopB-this.loopA;if(this.started){this.#Fn(this.loopB>i?i:this.loopA)}}Qi(){if(this.looping){const t=this.#In();this.looping=false;this.#Fn(t)}}hn(t){this.#Fn(t/this.bps)}#Fn(t){this.#xn=t;this.started&&this.pn(0,t)}rn(){return this.#In()*this.bps}#In(){return this.started?this.#Kn(this.currentTime()):this.#xn}#Kn(t){let s=this.#xn+t-this.#Sn;if(this.looping&&s>this.loopB-.001){s=this.loopA+(s-this.loopA)%this.loopDuration;if(s>this.loopB-.001){s=this.loopA}}return s}ln(t=true){this.isStreaming=t}un(t,s=0,i){return this.pn(t,s/this.bps,Number.isFinite(i)?i/this.bps:i)}pn(t,s=0,i){const e=this.currentTime();if(this.started){this.Mi()}this.started=true;this.#Dn=Number.isFinite(i);this.#Sn=Math.max(e,t);this.#xn=s;this.#On=this.#Dn?i:this.duration-s;if(this.isStreaming&&!this.looping){this.#Cn=setTimeout(this.onended.bind(this),this.#On*1e3)}this.isStreaming?this.#zn():this.#Rn()}Mi(){if(this.started){this.#xn=this.#In();this.started=false;clearTimeout(this.#Cn);this.#Nn();Object.keys(this.#An).forEach(this.#Gn,this)}}#Hn(){return this.looping?this.loopB:this.#xn+this.#On}#Vn(){const t=Object.values(this.data).reduce(G.#Un,0)/this.bps;if(t!==this.duration){this.duration=t;if(this.started&&!this.#Dn){this.#On=t}if(this.looping||!this.#Dn){clearTimeout(this.#Cn)}if(this.started&&this.isStreaming&&!this.looping){this.#Cn=setTimeout(this.onended.bind(this),(t-this.#xn-this.currentTime()+this.#Sn)*1e3)}}}static#Un(t,s){return Math.max(t,s.when+s.duration)}#Rn(){const t=this.#Sn;const s=this.#xn;const i=s+this.#On;this.#Pn.forEach((e=>this.#qn(t,s,i,i,...e)))}#zn(){if(!this.#Tn){this.#Tn=setInterval(this.#Bn,100);this.#jn()}}#Nn(){if(this.#Tn){clearInterval(this.#Tn);this.#Tn=null}}#jn(){const t=this.currentTime();const s=this.delayStopCallback/this.bps;let i;Object.entries(this.#Mn).forEach((([i,e])=>{if(e.whenEnd+s<t){delete this.#Mn[i];delete this.#An[e.blockId].started[i];this.ondatastop(i)}}));this.#Pn.forEach((t=>{if(this.#_n(t[0])){i=true}}));if(!this.looping&&!i){this.#Nn()}}#Gn(t){const s=this.#An[t];Object.keys(s.started).forEach((t=>{this.ondatastop(t);delete this.#Mn[t];delete s.started[t]}));s.scheduledUntil=0}#_n(t){if(this.started){const s=this.currentTime();const i=s+1;const e=this.#An[t];let n=Math.max(s,e.scheduledUntil||0);if(n<i){const s=this.#Hn();const a=this.data[t];do{const i=this.#Kn(n);const e=Math.min(i+1,s);n+=this.#qn(n,i,e,s,t,a)}while(this.looping&&n<i);e.scheduledUntil=n}return e.scheduledUntil<=this.#Sn+this.#On}}#qn(t,s,i,e,n,a){if(a.prev==null){const o=this.bps;const r=[];let h=a.when/o;let c=a.offset/o;let l=0;for(let t=n,s=a;s;){r.push([t,s]);l=s.when/o-h+s.duration/o;t=s.next;s=t!=null?this.data[t]:null}if(s<=h+l&&h<i){const i=this.#Sn;if(h+l>e){l-=h+l-e}if(h<s){c+=s-h;l-=s-h;h=s}h=t+h-s;if(h<i){c+=i-h;l-=i-h;h=i}if(l>1e-6){const t=`${++G.#de}`;this.#An[n].started[t]=this.#Mn[t]={block:a,blockId:n,when:h,whenEnd:h+l};this.ondatastart(t,r,h,c,l)}return e-s}}return i-s}Ls(t){this.#Je(t);this.#Pn=Object.entries(this.data).sort(((t,s)=>t[1].when-s[1].when))}#Wn(t){if(!(t in this.data)){console.warn("gswaScheduler: data delete unknown id",t)}else{delete this.data[t];if(this.started){this.#Gn(t)}delete this.#An[t];this.#Vn()}}#Ln(t,s){this.#An[t]={started:{},scheduledUntil:0};this.data[t]={when:0,offset:0,duration:0,...s};this.#Vn();this.#_n(t)}#En(t,s){let i=this.data[t];let e=t;Object.assign(i,s);this.#Vn();while(i.prev){e=i.prev;i=this.data[e]}this.#Gn(e);this.#_n(e)}}Object.freeze(G);"use strict";class H{static Ye(t,s){const i=t.numberOfChannels;const e=t.sampleRate;const n=s&&s.float32?3:1;const a=n===3?32:16;const o=a/8;const r=i*o;const h=i===2?H.#Yn(t.getChannelData(0),t.getChannelData(1)):t.getChannelData(0);const c=h.length*o;const l=new ArrayBuffer(44+c);const u=new DataView(l);H.#Jn(u,0,"RIFF");u.setUint32(4,36+c,true);H.#Jn(u,8,"WAVE");H.#Jn(u,12,"fmt ");u.setUint32(16,16,true);u.setUint16(20,n,true);u.setUint16(22,i,true);u.setUint32(24,e,true);u.setUint32(28,e*r,true);u.setUint16(32,r,true);u.setUint16(34,a,true);H.#Jn(u,36,"data");u.setUint32(40,c,true);(n===1?H.#Xn:H.#Qn)(u,44,h);return l}static#Yn(t,s){const i=t.length+s.length;const e=new Float32Array(i);for(let n=0,a=0;n<i;++a){e[n++]=t[a];e[n++]=s[a]}return e}static#Jn(t,s,i){for(let e=0;e<i.length;++e){t.setUint8(s+e,i.charCodeAt(e))}}static#Xn(t,s,i){for(let e=0;e<i.length;++e){const n=Math.max(-1,Math.min(i[e],1));t.setInt16(s+e*2,n<0?n*32768:n*32767,true)}}static#Qn(t,s,i){for(let e=0;e<i.length;++e){t.setFloat32(s+e*4,i[e],true)}}}"use strict";class V{#Zn=null;#ta=null;#sa=null;#ia=null;constructor(t){Object.freeze(this);this.#Zn=t.createChannelSplitter(2);this.#ta=t.createGain();this.#sa=t.createGain();this.#ia=t.createChannelMerger(2);this.#Zn.connect(this.#ta,0);this.#Zn.connect(this.#sa,1);this.#ta.connect(this.#ia,0,0);this.#sa.connect(this.#ia,0,1)}connect(...t){return this.#ia.connect(...t)}disconnect(...t){return this.#ia.disconnect(...t)}getInput(){return this.#Zn}getValue(){return this.#sa.gain.value-this.#ta.gain.value}setValueAtTime(t,s){this.#ta.gain.setValueAtTime(Math.min(1-t,1),s);this.#sa.gain.setValueAtTime(Math.min(1+t,1),s)}}"use strict";class U{static ka=new Map;static#ea=new Map;static ve(){U.#ea.clear()}static Ve(t,s){let i=U.#ea.get(s);if(!i){const e=U.ka.get(s);i=t.createPeriodicWave(e.real,e.imag);U.#ea.set(s,i)}return i}static Kn(t){t.forEach((([t,s])=>{const i=s.imag||s.real.map((()=>0));const e=s.real||s.imag.map((()=>0));e[0]=i[0]=0;U.ka.set(t,Object.freeze({real:new Float32Array(e),imag:new Float32Array(i)}))}));return U.ka}}"use strict";const q=144;const _=128;class Y{#na=null;#aa=new Map;#oa=new Map;Yn(t){this.sysexEnabled=t.sysexEnabled;t.onstatechange=this.#ra.bind(this);this.#ha(t)}_n(t){this.#na=t}#ha(t){for(const s of t.inputs){s[1].open()}for(const s of t.outputs){s[1].open()}}#ra(t){if(t.port.state==="connected"&&t.port.connection==="open"){this.#ca(t.port,t.currentTarget.sysexEnabled)}else if(t.port.state==="disconnected"){this.#la(t.port)}}#ca(t,s){if(t.type==="input"&&!this.#aa.has(t.id)){const i=new J(t.id,t.name,t,s);this.#aa.set(t.id,i);this.$a(i)}else if(t.type==="output"&&!this.#oa.has(t.id)){const i=new X(t.id,t.name,t,s);this.#oa.set(t.id,i)}}#la(t){const s=t.type==="input"?this.#aa:this.#oa;s.delete(t.id)}$a(t){t.Oa(this.#ua.bind(this));t.xa(this.#da.bind(this))}Sa(t){t.Da(this.#ua.bind(this));t.Ca(this.#da.bind(this))}#da(t){this.#na?.midiKeyUp(t[1])}#ua(t){this.#na?.midiKeyDown(t[1])}#pa(){console.log("Inputs");for(const[t,s]of this.#aa){console.log("ID : ",t);console.log("Name : ",s.name)}console.log("Outputs");for(const[t,s]of this.#oa){console.log("ID : ",t);console.log("Name : ",s.name)}}}"use strict";class J{constructor(t,s,i,e){this.portID=t;this.name=s;this.input=i;this.sysexEnabled=e;this.input.onmidimessage=this.#ga.bind(this);this.listeners={onNoteOn:[],onNoteOff:[]}}va(){return this.input}Oa(t){this.listeners.onNoteOn.push(t)}xa(t){this.listeners.onNoteOff.push(t)}#ga(t){if(!this.sysexEnabled&&t.data.length!==3){console.log("GSLog : Invalid midi event")}else if(this.#ma(t.data[0],t.data[2])){this.listeners.onNoteOn.forEach((s=>s(t.data)))}else if(this.#fa(t.data[0],t.data[2])){this.listeners.onNoteOff.forEach((s=>s(t.data)))}}#ma(t,s){return t===q&&s!==0}#fa(t,s){return t===_||s===0}}"use strict";class X{constructor(t,s,i,e){this.portID=t;this.name=s;this.output=i;this.sysexEnabled=e}ba(){return this.output}#ba(t){this.output.send(t)}#wa(t,s){s.send(t)}}"use strict";class Q{static Sn(){}static Un=document.createElement("gsui-popup");static Pa=document.createElement("gsui-dragshield");static Ma(t){return 1-Math.sqrt(1-Math.pow(t,2))}static Aa(t){return Math.sqrt(1-Math.pow(t-1,2))}static Ta(t,s,i){return s<i?Math.max(s,Math.min(t||0,i)):Math.max(i,Math.min(t||0,s))}static Ba(t,s){let i=true;const e=Object.entries(s).reduce(((s,[e,n])=>{const a=t[e];const o=a===n?undefined:typeof n!=="object"||n===null?n:typeof a!=="object"||a===null?Object.freeze(JSON.parse(JSON.stringify(n))):Q.Ba(a,n);if(o!==undefined){i=false;s[e]=o}return s}),{});Object.keys(t).forEach((t=>{if(!(t in s)){i=false;e[t]=undefined}}));return i?undefined:Object.freeze(e)}static ja(t){return new Promise((s=>{const i=Q.Bn("script",{src:t,type:"text/javascript"});i.onload=s;document.head.append(i)}))}static Wn(t,s){return typeof s==="string"?Q.#va(t,s):Object.seal(Array.isArray(s)?Q.#ya(t,s):Q.#ka(t,s))}static#ya(t,s){return s.map((s=>Q.Wn(t,s)))}static#ka(t,s){if(s){const i=Object.entries(s);i.forEach((s=>s[1]=Q.Wn(t,s[1])));return Object.fromEntries(i)}}static#va(t,s){if(Array.isArray(t)){let i;Array.prototype.find.call(t,(t=>i=Q.#$a(t,s)));return i||null}return Q.#$a(t,s)}static#$a(t,s){return t.matches(s)?t:t.querySelector(s)}static La(t,s,i,...e){t.dispatchEvent(new CustomEvent("gsuiEvents",{bubbles:true,detail:{component:s,eventName:i,args:e}}))}static zn(t,s){t.addEventListener("gsuiEvents",(t=>{const i=t.detail;const e=s[i.component]||s.default;const n=e&&(e[i.eventName]||e.default);if(n&&n(i,t.target,t)!==true){t.stopPropagation();t.stopImmediatePropagation()}}))}static#Oa=new Map;static Ea(t,s){Q.#Oa.set(t,s)}static Wa(t){return Q.#Oa.has(t)}static Ln(t,...s){return Q.#Oa.get(t)(...s)}static Bn(t,s,...i){return Q.#xa("http://www.w3.org/1999/xhtml",t,s,i)}static Ia(t,s,...i){return Q.#xa("http://www.w3.org/2000/svg",t,s,i)}static#xa(t,s,i,e){const n=document.createElementNS(t,s);Q.En(n,i);n.append(...e.flat(1).filter((t=>Boolean(t)||Number.isFinite(t))));return n}static En(t,s,i){if(typeof s==="string"){Q.#Sa(t,s,i)}else if(s){Object.entries(s).forEach((s=>Q.#Sa(t,...s)))}}static Fa(t,s,i){Q.#Sa(t,s,i);return Q.Nn(t,s)}static#Sa(t,s,i){i!==false&&i!==null&&i!==undefined?t.setAttribute(s,i===true?"":i):t.removeAttribute(s)}static Ka(t,s){return t.hasAttribute(s)}static Nn(t,s){return t.getAttribute(s)}static za(t,s){const i=t.getAttribute(s);const e=+i;if(Number.isNaN(e)){console.error(`GSUI.$getAttributeNum: ${s} is NaN (${i})`)}return e}static Ra(t,s){if(Q.#Da.has(t)){Q.#Da.get(t).push(s)}else{Q.#Da.set(t,[s])}Q.#Ca.observe(t)}static Na(t,s){const i=Q.#Da.get(t);const e=i?.indexOf(s);if(e>-1){Q.#Ca.unobserve(t);i.splice(e,1);if(i.length===0){Q.#Da.delete(t)}}}static#Da=new Map;static#Ca=new ResizeObserver((t=>{t.forEach((t=>{Q.#Da.get(t.target).forEach((s=>s(t.contentRect.width,t.contentRect.height)))}))}));static Ga(t){while(t.lastChild){t.lastChild.remove()}}static Ha(){window.getSelection().removeAllRanges()}static Va(t,s){Object.entries(s).forEach((([s,i])=>{t.hasAttribute(s)?t.attributeChangedCallback?.(s,null,t.getAttribute(s)):Q.#Sa(t,s,i)}))}static qn(t){const s=[];return new Promise((i=>{const e=[];for(const i of t){const t=i.webkitGetAsEntry();if(t){e.push(Q.#Pa(s,t))}}Promise.all(e).then((()=>i(s)))}))}static#Pa(t,s,i=""){return new Promise((e=>{if(s.isFile){s.file((s=>{s.filepath=i+s.name;t.push(s);e(s)}))}else if(s.isDirectory){const n=s.createReader();n.readEntries((n=>{const a=[];for(let e of n){a.push(Q.#Pa(t,e,i+s.name+"/"))}e(Promise.all(a))}))}}))}}document.body.prepend(Q.Pa,Q.Un);"use strict";Q.Ea("gsui-daw",(()=>[Q.Bn("div",{class:"gsuiDAW-head"},Q.Bn("div",{class:"gsuiDAW-area gsuiDAW-areaUser"},Q.Bn("span",{class:"gsuiDAW-title"},"GridSound"),Q.Bn("a",{class:"gsuiDAW-btn","data-action":"profile",href:true,title:"Cloud profile",target:"_blank",rel:"noopener"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"login","data-icon":"profile",title:"Login to GridSound"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"logout","data-icon":"logout",title:"Logout"}),Q.Bn("div",{class:"gsuiDAW-cmps"},Q.Bn("button",{class:"gsuiDAW-btn gsuiDAW-dropdown-btn gsuiDAW-btnColor gsuiIcon","data-action":"cmps","data-icon":"musics",title:"Create cloud/local compositions"}),Q.Ln("gsui-daw-cmps"),Q.Bn("div",{class:"gsuiDAW-dropdown-backdrop"}))),Q.Bn("div",{class:"gsuiDAW-area gsuiDAW-areaSave gsuiDAW-btns"},Q.Bn("button",{class:"gsuiDAW-btn gsuiDAW-btnColor gsuiDAW-currCmp-saveBtn gsuiIcon","data-action":"cmp-save",title:"Save composition"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiDAW-currCmp-editBtn","data-action":"cmp-rename",title:"Edit composition's title"},Q.Bn("i",{class:"gsuiDAW-currCmp-localIcon gsuiIcon"}),Q.Bn("span",{class:"gsuiDAW-currCmp-name"}),Q.Bn("i",{class:"gsuiDAW-currCmp-editIcon gsuiIcon","data-icon":"pen"}),Q.Bn("span",{class:"gsuiDAW-currCmp-dur"}))),Q.Bn("div",{class:"gsuiDAW-area gsuiDAW-areaCtrl"},Q.Bn("div",{class:"gsuiDAW-volume",title:"Main app volume (this will not affect the rendering)"},Q.Bn("gsui-slider",{"data-action":"volume",type:"linear-y",min:0,max:1,step:.01,"mousemove-size":150})),Q.Bn("div",{class:"gsuiDAW-btns gsuiDAW-playPauseStop"},Q.Bn("button",{class:"gsuiDAW-btn gsuiDAW-focusBtn","data-action":"focusSwitch","data-dir":"up",title:"Toggle focus between the composition and piano windows"},Q.Bn("span"),Q.Bn("span")),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"play","data-icon":"play"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"stop","data-icon":"stop"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"reset","data-icon":"sync",title:"Restart the audio engine"})),Q.Bn("gsui-clock"),Q.Bn("button",{class:"gsuiDAW-btn gsuiDAW-tempo","data-action":"tempo",title:"Edit the time signature and BPM"},Q.Bn("div",{class:"gsuiDAW-tempo-timeDivision"},Q.Bn("span",{class:"gsuiDAW-tempo-beatsPerMeasure"}),Q.Bn("span",{class:"gsuiDAW-tempo-stepsPerBeat"})),Q.Bn("span",{class:"gsuiDAW-tempo-bpm"}))),Q.Bn("div",{class:"gsuiDAW-area gsuiDAW-areaTime"},Q.Bn("gsui-slider",{"data-action":"currentTime",type:"linear-x",min:0,step:.01})),Q.Bn("div",{class:"gsuiDAW-area gsuiDAW-areaHist"},Q.Bn("div",{class:"gsuiDAW-btns gsuiDAW-history"},Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"undo","data-icon":"undo",title:"Undo the previous action"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"redo","data-icon":"redo",title:"Redo the last action"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiDAW-dropdown-btn gsuiIcon","data-action":"undoMore","data-icon":"caret-down",title:"Show the actions list"}),Q.Ln("gsui-daw-history"),Q.Bn("div",{class:"gsuiDAW-dropdown-backdrop"})),Q.Bn("gsui-spectrum"),Q.Bn("button",{class:"gsuiDAW-btn gsuiDAW-btnBg gsuiDAW-btnColor gsuiIcon","data-action":"export","data-icon":"export",title:"Export the composition"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiDAW-btnBg gsuiIcon","data-action":"settings","data-icon":"settings",title:"Settings"})),Q.Bn("div",{class:"gsuiDAW-area gsuiDAW-areaWins gsuiDAW-btns"},Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"window","data-icon":"folder-tree","data-win":"patterns",title:"Open/close the patterns panel","data-open":true}),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"window","data-icon":"mixer","data-win":"mixer",title:"Open/close the mixer window"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"window","data-icon":"music","data-win":"main",title:"Open/close the composition window"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"window","data-icon":"oscillator","data-win":"synth",title:"Open/close the synthesizer window"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"window","data-icon":"drums","data-win":"drums",title:"Open/close the drums window"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"window","data-icon":"keys","data-win":"piano",title:"Open/close the piano window"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiIcon","data-action":"window","data-icon":"slices","data-win":"slicer",title:"Open/close the slices window"})),Q.Bn("div",{class:"gsuiDAW-area gsuiDAW-areaHelp"},Q.Bn("a",{class:"gsuiDAW-btn gsuiDAW-btnBg gsuiIcon","data-action":"help","data-icon":"help",title:"Help",href:"https://github.com/gridsound/daw/wiki/help",target:"_blank",rel:"noopener"}),Q.Bn("button",{class:"gsuiDAW-btn gsuiDAW-btnBg gsuiIcon gsuiDAW-btnColor","data-action":"about","data-icon":"about",title:"About"})),Q.Bn("div",{class:"gsuiDAW-area gsuiDAW-areaVers"},Q.Bn("a",{class:"gsuiDAW-btn gsuiDAW-version","data-action":"version",title:"Access older versions",href:"https://github.com/gridsound/daw/wiki/versions",target:"_blank",rel:"noopener"}),Q.Bn("a",{class:"gsuiDAW-btn gsuiDAW-changelog gsuiIcon","data-icon":"changelog",title:"Changelog",href:"https://github.com/gridsound/daw/wiki/changelog",target:"_blank",rel:"noopener"}))),Q.Bn("gsui-panel",{class:"gsuiDAW-body"},Q.Bn("div",{class:"gsuiDAW-resources"},Q.Bn("div",{class:"gsuiDAW-libraries"}),Q.Bn("div",{class:"gsuiDAW-patterns"})),Q.Bn("gsui-windows",{class:"gsuiDAW-windows"}))]));Q.Ea("gsui-daw-cmps",(()=>Q.Bn("div",{class:"gsuiDAW-dropdown",tabindex:0},Q.Bn("div",{class:"gsuiDAW-dropdown-head","data-list":"local"},Q.Bn("i",{class:"gsuiDAW-dropdown-icon gsuiIcon","data-icon":"local"}),Q.Bn("span",{class:"gsuiDAW-dropdown-title"},"local"),Q.Ln("gsui-daw-cmps-btn",{action:"localNewCmp",icon:"plus",text:"new",title:"Create a new composition on this computer"}),Q.Ln("gsui-daw-cmps-btn",{action:"localOpenCmp",icon:"folder-open",text:"open",title:"Open a composition on this computer"})),Q.Bn("div",{class:"gsuiDAW-dropdown-head","data-list":"cloud"},Q.Bn("i",{class:"gsuiDAW-dropdown-icon gsuiIcon","data-icon":"cloud"}),Q.Bn("span",{class:"gsuiDAW-dropdown-title"},"cloud"),Q.Ln("gsui-daw-cmps-btn",{action:"cloudNewCmp",icon:"plus",text:"new",title:"Create a new composition on your cloud profile"})),Q.Bn("div",{class:"gsuiDAW-dropdown-list","data-list":"local"},Q.Bn("div",{class:"gsuiDAW-dropdown-placeholder"},Q.Bn("span",null,"there is no local composition here"))),Q.Bn("div",{class:"gsuiDAW-dropdown-list","data-list":"cloud"},Q.Bn("div",{class:"gsuiDAW-dropdown-placeholder"},Q.Bn("span",null,"you don't have any cloud composition yet"),Q.Bn("span",null,"you are not connected"))))));Q.Ea("gsui-daw-cmps-btn",(({action:t,title:s,icon:i,text:e})=>Q.Bn("button",{class:"gsuiDAW-cmps-btn","data-action":t,title:s},Q.Bn("i",{class:"gsuiDAW-cmps-btn-icon gsuiIcon","data-icon":i}),Q.Bn("span",{class:"gsuiDAW-cmps-btn-text"},e))));Q.Ea("gsui-daw-cmp",(({id:t,saveMode:s})=>Q.Bn("div",{class:"gsuiDAW-cmp","data-id":t,draggable:"true",tabindex:0},Q.Bn("button",{class:"gsuiDAW-cmp-btn gsuiIcon","data-action":"cmp-save","data-icon":s==="local"?"save":"upload"}),Q.Bn("a",{href:true,class:"gsuiDAW-cmp-info","data-action":"cmp-open"},Q.Bn("div",{class:"gsuiDAW-cmp-name"}),Q.Bn("div",null,Q.Bn("span",{class:"gsuiDAW-cmp-duration-wrap"},Q.Bn("i",{class:"gsuiIcon","data-icon":"clock"}),Q.Bn("span",{class:"gsuiDAW-cmp-duration"})),Q.Bn("span",{class:"gsuiDAW-cmp-bpm-wrap"},Q.Bn("i",{class:"gsuiIcon","data-icon":"speed"}),Q.Bn("span",{class:"gsuiDAW-cmp-bpm"})))),Q.Bn("a",{href:true,class:"gsuiDAW-cmp-btn gsuiDAW-cmp-btn-light gsuiIcon","data-action":"cmp-json","data-icon":"file-export",title:"Export to JSON file"}),Q.Bn("button",{class:"gsuiDAW-cmp-btn gsuiDAW-cmp-btn-light gsuiIcon","data-action":"cmp-delete","data-icon":"minus-oct",title:"Delete"}))));Q.Ea("gsui-daw-history",(()=>Q.Bn("div",{class:"gsuiDAW-dropdown",tabindex:0},Q.Bn("div",{class:"gsuiDAW-dropdown-head"},Q.Bn("i",{class:"gsuiDAW-dropdown-icon gsuiIcon","data-icon":"history"}),Q.Bn("span",{class:"gsuiDAW-dropdown-title"},"history")),Q.Bn("div",{class:"gsuiDAW-dropdown-list"},Q.Bn("div",{class:"gsuiDAW-dropdown-placeholder"},Q.Bn("span",null,"there is nothing to undo"))))));Q.Ea("gsui-daw-history-action",(({icon:t,desc:s,index:i})=>Q.Bn("div",{class:"gsuiDAW-history-action","data-action":"historyAction","data-index":i},Q.Bn("i",{class:"gsuiDAW-history-action-icon gsuiIcon","data-icon":t}),Q.Bn("span",{class:"gsuiDAW-history-action-text"},s))));"use strict";Q.Ea("gsui-daw-window-main",(()=>Q.Bn("div",{"data-window":"main"})));Q.Ea("gsui-daw-window-piano",(()=>Q.Bn("div",{"data-window":"piano"},Q.Bn("div",{class:"gsuiDAW-winMenu"},Q.Bn("button",{class:"gsuiDAW-winBtn","data-target":"pianoroll"})))));Q.Ea("gsui-daw-window-synth",(()=>Q.Bn("div",{"data-window":"synth"},Q.Bn("div",{class:"gsuiDAW-winMenu"},Q.Bn("button",{class:"gsuiDAW-winBtn","data-target":"synth"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"arrow-right"}),Q.Bn("button",{class:"gsuiDAW-winBtn","data-target":"synthChannel"},Q.Bn("i",{class:"gsuiIcon","data-icon":"mixer"}),Q.Bn("span"))))));Q.Ea("gsui-daw-window-mixer",(()=>Q.Bn("div",{"data-window":"mixer"})));Q.Ea("gsui-daw-window-effects",(()=>Q.Bn("div",{"data-window":"effects"},Q.Bn("div",{class:"gsuiDAW-winMenu"},Q.Bn("button",{class:"gsuiDAW-winBtn","data-target":"channel"})))));Q.Ea("gsui-daw-window-drums",(()=>Q.Bn("div",{"data-window":"drums"},Q.Bn("div",{class:"gsuiDAW-winMenu"},Q.Bn("button",{class:"gsuiDAW-winBtn","data-target":"drums"})))));Q.Ea("gsui-daw-window-slicer",(()=>Q.Bn("div",{"data-window":"slicer"},Q.Bn("div",{class:"gsuiDAW-winMenu"},Q.Bn("button",{class:"gsuiDAW-winBtn","data-target":"slices"})))));"use strict";Q.Ea("gsui-daw-popup-auth",(()=>Q.Bn("div",{id:"authPopupContent",class:"gsuiDAW-popup-auth"},Q.Bn("fieldset",null,Q.Bn("legend",null,"Sign in"),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},Q.Bn("span",null,"Username"),Q.Bn("br"),Q.Bn("small",null,"(or email)")),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("input",{class:"gsuiPopup-inputText",required:true,name:"email",type:"text"}))),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},"Password"),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("input",{class:"gsuiPopup-inputText",required:true,name:"password",type:"password"}))),Q.Bn("div",{class:"gsuiDAW-popup-auth-error"})),Q.Bn("a",{target:"_blank",rel:"noopener",href:"https://gridsound.com/#/forgotPassword"},"Forgot password ?"),Q.Bn("br"),Q.Bn("a",{target:"_blank",rel:"noopener",href:"https://gridsound.com/#/auth"},"Create a new account"))));"use strict";Q.Ea("gsui-daw-popup-open",(()=>Q.Bn("div",{class:"gsuiDAW-popup-open"},Q.Bn("fieldset",null,Q.Bn("legend",null,"Open and load a new composition"),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},"With an URL"),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("input",{class:"gsuiPopup-inputText",name:"url",type:"url",placeholder:"https://"}))),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},"With a local file",Q.Bn("br"),Q.Bn("small",null,"(Please notice that you can also drop a file into the app)")),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("input",{name:"file",type:"file"})))))));"use strict";Q.Ea("gsui-daw-popup-about",(()=>Q.Bn("div",{class:"gsuiDAW-popup-about"},Q.Bn("div",{class:"gsuiDAW-popup-about-head"},Q.Bn("span",{class:"gsuiDAW-popup-about-title"},"GridSound"),Q.Bn("span",{class:"gsuiDAW-popup-about-versionNum"}),Q.Bn("i",{class:"gsuiIcon"}),Q.Bn("button",{class:"gsuiDAW-popup-about-versionCheck",type:"button"},"check the version")),Q.Bn("div",null,"GridSound is a ",Q.Bn("b",null,"work-in-progress")," free browser-based digital audio workstation following the ",Q.Bn("a",{target:"_blank",rel:"noopener",href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API"},"Web Audio API"),"."),Q.Bn("div",null,"You can create an account (by clicking ",Q.Bn("i",{class:"gsuiIcon","data-icon":"profile"}),") and start uploading your compositions online ",Q.Bn("i",{class:"gsuiIcon","data-icon":"cloud"})),Q.Bn("div",{class:"gsuiDAW-popup-about-links"},Q.Bn("a",{target:"_blank",rel:"noopener",title:"GitHub",class:"gsuiIcon gsuiIconB","data-icon":"github",href:"https://github.com/gridsound"}),Q.Bn("a",{target:"_blank",rel:"noopener",title:"Twitter",class:"gsuiIcon gsuiIconB","data-icon":"twitter",href:"https://twitter.com/gridsound"}),Q.Bn("a",{target:"_blank",rel:"noopener",title:"YouTube",class:"gsuiIcon gsuiIconB","data-icon":"youtube",href:"https://youtube.com/@gridsound"}),Q.Bn("a",{target:"_blank",rel:"noopener",title:"Facebook",class:"gsuiIcon gsuiIconB","data-icon":"facebook",href:"https://facebook.com/gridsound"}),Q.Bn("a",{target:"_blank",rel:"noopener",title:"CodePen",class:"gsuiIcon gsuiIconB","data-icon":"codepen",href:"https://codepen.io/gridsound"}),Q.Bn("a",{target:"_blank",rel:"noopener",title:"Discord",class:"gsuiIcon gsuiIconB","data-icon":"discord",href:"https://discord.gg/NUYxHAg"})))));"use strict";Q.Ea("gsui-daw-popup-tempo",(()=>Q.Bn("div",{class:"gsuiDAW-popup-tempo"},Q.Bn("fieldset",null,Q.Bn("legend",null,"Time division / BPM"),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},"Beats per measure"),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("input",{class:"gsuiPopup-inputText",name:"beatsPerMeasure",type:"number",min:1,max:16}))),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},"Steps per beat"),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("input",{class:"gsuiPopup-inputText",name:"stepsPerBeat",type:"number",min:1,max:16}))),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},"BPM (Beats Per Minute)"),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("input",{class:"gsuiPopup-inputText",name:"bpm",type:"number",min:1,max:999.99,step:.01}),Q.Bn("a",{class:"gsuiDAW-bpmTap gsuiIcon","data-icon":"tint"})))))));"use strict";Q.Ea("gsui-daw-popup-export",(()=>Q.Bn("div",{class:"gsuiDAW-popup-export"},Q.Bn("fieldset",null,Q.Bn("legend",null,"Render the current composition"),Q.Bn("div",{class:"gsuiDAW-popup-export-wrap"},Q.Bn("a",{href:true,class:"gsuiDAW-popup-export-btn","data-status":0},Q.Bn("span",{class:"gsuiDAW-popup-export-btn0"},Q.Bn("span",null,"Render"),Q.Bn("i",{class:"gsuiIcon","data-icon":"render"})),Q.Bn("span",{class:"gsuiDAW-popup-export-btn1"},Q.Bn("span",null,"Rendering..."),Q.Bn("i",{class:"gsuiIcon","data-spin":"on"})),Q.Bn("span",{class:"gsuiDAW-popup-export-btn2"},Q.Bn("span",null,"Download WAV file"),Q.Bn("i",{class:"gsuiIcon","data-icon":"export"}))),Q.Bn("progress",{class:"gsuiDAW-popup-export-progress",value:"",max:1}))))));"use strict";Q.Ea("gsui-daw-popup-settings",(()=>Q.Bn("div",{class:"gsuiDAW-popup-settings"},Q.Bn("fieldset",null,Q.Bn("legend",null,"Audio"),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},"Feedback sample rate"),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("select",{name:"sampleRate"},Q.Bn("option",{value:8e3},"8 kHz"),Q.Bn("option",{value:11025},"11.025 kHz"),Q.Bn("option",{value:12e3},"12 kHz"),Q.Bn("option",{value:22050},"22.05 kHz"),Q.Bn("option",{value:24e3},"24 kHz"),Q.Bn("option",{value:44100},"44.1 kHz"),Q.Bn("option",{value:48e3,style:"font-weight:bold"},"48 kHz"),Q.Bn("option",{value:88200},"88.2 kHz"),Q.Bn("option",{value:96e3},"96 kHz"))))),Q.Bn("fieldset",null,Q.Bn("legend",null,"UI refresh rate"),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},"Auto"),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("label",null,Q.Bn("input",{name:"uiRate",type:"radio",value:"auto"}),Q.Bn("span",{class:"gsuiDAW-uiRateFps"},60)))),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},"Manual"),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("label",null,Q.Bn("input",{name:"uiRate",type:"radio",value:"manual"}),Q.Bn("span",{class:"gsuiDAW-uiRateFps"},40)),Q.Bn("input",{name:"uiRateFPS",type:"range",step:1,min:5,max:40,value:40})))),Q.Bn("fieldset",null,Q.Bn("legend",null,"Windows"),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},"Move/resize mode"),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("label",null,Q.Bn("input",{name:"windowsLowGraphics",type:"checkbox"}),Q.Bn("span",null,"low graphic"))))),Q.Bn("fieldset",null,Q.Bn("legend",null,"Timeline"),Q.Bn("div",{class:"gsuiPopup-row"},Q.Bn("div",{class:"gsuiPopup-row-title"},"Numbering measures starting at"),Q.Bn("div",{class:"gsuiPopup-row-values"},Q.Bn("select",{name:"timelineNumbering"},Q.Bn("option",{value:0},0),Q.Bn("option",{value:1},1))))))));"use strict";class Z extends HTMLElement{onSubmitLogin=Q.Sn;onSubmitOpen=Q.Sn;onExportJSON=Q.Sn;#Ma={local:new Map,cloud:new Map};#Aa=null;#Ta="local";#Ba=-1;#ja=null;#La=Q.La.bind(null,this,"gsuiDAW");#Ea=Q.Ln("gsui-daw");#Wa=false;#ps=Q.Wn(this.#Ea,{head:".gsuiDAW-head",bpm:".gsuiDAW-tempo-bpm",bPM:".gsuiDAW-tempo-beatsPerMeasure",sPB:".gsuiDAW-tempo-stepsPerBeat",cmpName:".gsuiDAW-currCmp-name",cmpSave:".gsuiDAW-currCmp-saveBtn",cmpIcon:".gsuiDAW-currCmp-localIcon",cmpDuration:".gsuiDAW-currCmp-dur",play:"[data-action='play']",vers:".gsuiDAW-version",clock:"gsui-clock",spectrum:"gsui-spectrum",volume:".gsuiDAW-volume gsui-slider",currentTime:".gsuiDAW-areaTime gsui-slider",userAvatar:"[data-action='profile']",login:"[data-action='login']",logout:"[data-action='logout']",cmpsLocalList:".gsuiDAW-dropdown-list[data-list='local']",cmpsCloudList:".gsuiDAW-dropdown-list[data-list='cloud']",historyList:".gsuiDAW-history .gsuiDAW-dropdown-list",patternsPanel:".gsuiDAW-resources",winBtns:{patterns:"[data-win='patterns']",mixer:"[data-win='mixer']",main:"[data-win='main']",synth:"[data-win='synth']",drums:"[data-win='drums']",piano:"[data-win='piano']",slicer:"[data-win='slicer']",effects:"[data-win='effects']"}});#Ia={auth:Q.Wn(Q.Ln("gsui-daw-popup-auth"),{root:".gsuiDAW-popup-auth",error:".gsuiDAW-popup-auth-error"}),open:Q.Wn(Q.Ln("gsui-daw-popup-open"),{root:".gsuiDAW-popup-open",inputOpenURL:"[name='url']",inputOpenFile:"[name='file']"}),tempo:Q.Wn(Q.Ln("gsui-daw-popup-tempo"),{root:".gsuiDAW-popup-tempo",beatsPerMeasure:"[name='beatsPerMeasure']",stepsPerBeat:"[name='stepsPerBeat']",bpm:"[name='bpm']",bpmTap:".gsuiDAW-bpmTap"}),about:Q.Wn(Q.Ln("gsui-daw-popup-about"),{root:".gsuiDAW-popup-about",version:".gsuiDAW-popup-about-versionNum",versionIcon:".gsuiDAW-popup-about-head .gsuiIcon",versionCheck:".gsuiDAW-popup-about-versionCheck"}),export:Q.Wn(Q.Ln("gsui-daw-popup-export"),{root:".gsuiDAW-popup-export",button:".gsuiDAW-popup-export-btn",progress:".gsuiDAW-popup-export-progress"}),settings:Q.Wn(Q.Ln("gsui-daw-popup-settings"),{root:".gsuiDAW-popup-settings",sampleRate:"[name='sampleRate']",uiRateRadio:{auto:"[name='uiRate'][value='auto']",manual:"[name='uiRate'][value='manual']"},uiRateManualFPS:"[name='uiRate'][value='manual'] + .gsuiDAW-uiRateFps",uiRateManualRange:"[name='uiRateFPS']",windowsLowGraphics:"[name='windowsLowGraphics']",timelineNumbering:"[name='timelineNumbering']"})};constructor(){super();this.clock=this.#ps.clock;this.spectrum=this.#ps.spectrum;Object.seal(this);this.clock.onchangeDisplay=t=>this.#La("changeDisplayClock",t);this.spectrum.setResolution(140);this.#ja=this.#ps.historyList.getElementsByClassName("gsuiDAW-history-action");this.#ps.head.onclick=this.#Fa.bind(this);this.#ps.cmpsCloudList.ondragstart=Z.#Ka.bind(null,"cloud");this.#ps.cmpsLocalList.ondragstart=Z.#Ka.bind(null,"local");this.#ps.cmpsCloudList.ondragover=this.#ps.cmpsLocalList.ondragover=t=>t.preventDefault();this.#ps.cmpsCloudList.ondrop=this.#ps.cmpsLocalList.ondrop=this.#za.bind(this);this.#Ia.about.versionCheck.onclick=()=>{const t=this.#Ia.about.versionIcon.dataset;t.icon="none";t.spin="on";fetch(`https://gridsound.com/daw/VERSION?${Math.random()}`).then((t=>t.text()),Q.Sn).then((s=>{t.spin="";t.icon=s===Q.Nn(this,"version")?"check":"warning"}))};this.#Ia.tempo.bpmTap.onclick=()=>this.#Ia.tempo.bpm.value=F.ma();this.#Ia.settings.uiRateManualRange.onmousedown=()=>this.#Ia.settings.uiRateRadio.manual.checked=true;this.#Ia.settings.uiRateManualRange.oninput=t=>{this.#Ia.settings.uiRateManualFPS.textContent=t.target.value.padStart(2,"0")};this.#Ia.export.button.onclick=t=>{const s=t.currentTarget.dataset;if(s.status!=="2"){t.preventDefault()}if(s.status==="0"){s.status="1";this.#La("export")}};Q.zn(this.#ps.volume,{gsuiSlider:{input:t=>this.#La("volume",t.args[0]),inputStart:Q.Sn,inputEnd:Q.Sn,change:Q.Sn}});Q.zn(this.#ps.currentTime,{gsuiSlider:{inputStart:t=>{this.#Wa=true;this.#ps.clock.setTime(t.args[0])},inputEnd:()=>{this.#Wa=false},input:t=>{this.#ps.clock.setTime(t.args[0]);this.#La("currentTimeLive",t.args[0])},change:t=>{this.#La("currentTime",t.args[0])}}})}connectedCallback(){if(this.#Ea){this.append(...this.#Ea);this.#Ea=null;Q.Va(this,{saved:true,uirate:"auto",timelinenumbering:0,bpm:60,name:"",duration:10,timedivision:"1/1",currenttime:0,maxtime:1,volume:1,version:"0.0.0"})}}static get observedAttributes(){return["bpm","currentcomposition","currenttime","duration","errauth","exporting","logging","maxtime","name","playing","saving","timedivision","timelinenumbering","useravatar","username","version","volume"]}attributeChangedCallback(t,s,i){if(!this.#Ea&&s!==i){switch(t){case"currentcomposition":i?this.#Ra(...i.split(":")):this.#Na();break;case"errauth":this.#Ia.auth.error.textContent=i;break;case"exporting":this.#Ia.export.progress.value=i;break;case"logging":this.#ps.login.dataset.spin=this.#ps.logout.dataset.spin=i!==null?"on":"";break;case"username":Q.En(this.#ps.userAvatar,"href",i&&`https://gridsound.com/#/u/${i}`);break;case"name":this.#ps.cmpName.textContent=i;break;case"playing":this.#ps.play.dataset.icon=i!==null?"pause":"play";break;case"saving":this.#Ma[this.#Ta].get(this.#Aa).save.dataset.spin=this.#ps.cmpSave.dataset.spin=i!==null?"on":"";break;case"duration":this.#Vn();break;case"timelinenumbering":nt.numbering(i);break;case"bpm":Q.En(this.#ps.clock,"bpm",i);this.#ps.bpm.textContent=i;this.#Vn();break;case"timedivision":Q.En(this.#ps.clock,"timedivision",i);this.#ps.bPM.textContent=i.split("/")[0];this.#ps.sPB.textContent=i.split("/")[1];break;case"volume":this.#ps.volume.setValue(i);break;case"currenttime":if(!this.#Wa){this.#ps.clock.setTime(i);this.#ps.currentTime.setValue(i)}break;case"maxtime":Q.En(this.#ps.currentTime,"max",i);break;case"useravatar":this.#ps.userAvatar.style.backgroundImage=i?`url("${i}")`:"";break;case"version":this.#ps.vers.textContent=i;this.#Ia.about.version.textContent=i;break}}}updateSpectrum(t){this.#ps.spectrum.draw(t)}#Na(){this.#Aa=null;this.#Ta="local";this.querySelector(".gsuiDAW-cmp-loaded")?.classList?.remove("gsuiDAW-cmp-loaded")}#Ra(t,s){const i=this.#Ma[t].get(s);this.#Na();if(i){this.#Aa=s;this.#Ta=t;i.root.classList.add("gsuiDAW-cmp-loaded");i.root.parentNode.prepend(i.root);i.root.parentNode.scrollTop=0;Q.En(this.#ps.cmpIcon,"data-icon",t==="local"?"local":"cloud");Q.En(this.#ps.cmpSave,"data-icon",t==="local"?"save":"upload")}}#Vn(){const t=Q.za(this,"duration");const[s,i]=nt.parseBeatsToSeconds(t,Q.za(this,"bpm"));this.#ps.cmpDuration.textContent=`${s}:${i}`;Q.En(this.#ps.currentTime,"max",t)}showOpenPopup(){this.#Ia.open.inputOpenFile.value=this.#Ia.open.inputOpenURL.value="";Q.Un.custom({title:"Open",element:this.#Ia.open.root,submit:t=>this.onSubmitOpen(t.url,t.file)})}clearCompositions(){this.#Ma.local.forEach((t=>t.root.remove()));this.#Ma.cloud.forEach((t=>t.root.remove()))}addComposition(t){const s=t.options.saveMode;if(s==="local"&&this.#Ma.local.has(t.id)||s==="cloud"&&this.#Ma.cloud.has(t.id)){this.updateComposition(t)}else{const i=Q.Ln("gsui-daw-cmp",{id:t.id,saveMode:s});const e=Q.Wn(i,{root:".gsuiDAW-cmp",bpm:".gsuiDAW-cmp-bpm",name:".gsuiDAW-cmp-name",save:"[data-action='cmp-save']",duration:".gsuiDAW-cmp-duration"});this.#Ma[s].set(t.id,e);this.updateComposition(t);(s==="local"?this.#ps.cmpsLocalList:this.#ps.cmpsCloudList).append(i);if(`${s}:${t.id}`===Q.Nn(this,"currentcomposition")){this.#Ra(s,t.id)}}}updateComposition(t){const s=this.#Ma[t.options.saveMode].get(t.id);const[i,e]=nt.parseBeatsToSeconds(t.duration,t.bpm);s.bpm.textContent=t.bpm;s.name.textContent=t.name;s.duration.textContent=`${i}:${e}`}deleteComposition(t){const s=this.#Ma[t.options.saveMode];const i=s.get(t.id);if(i){i.root.remove();s.delete(t.id)}}readyToDownload(t,s){Q.En(this.#Ia.export.button,"href",t);Q.En(this.#Ia.export.button,"download",s);Q.En(this.#Ia.export.button,"data-status",2)}static#Ka(t,s){const i=s.target.closest(".gsuiDAW-cmp");s.dataTransfer.setData("text/plain",`${t}:${i.dataset.id}`)}#za(t){const[s,i]=t.dataTransfer.getData("text/plain").split(":");if(s!==t.currentTarget.dataset.list){this.#La("switchCompositionLocation",s,i)}}toggleWindow(t,s){Q.En(this.#ps.winBtns[t],"data-open",s);if(t==="patterns"){const t=this.#ps.patternsPanel;t.style.setProperty("--gsuiDAW-panel-margin",s?"0":`-${getComputedStyle(t).width}`);t.classList.toggle("gsuiDAW-resources-closed",!s)}}clearHistory(){Array.from(this.#ja).forEach((t=>t.remove()));this.#Ba=-1}stackAction(t,s){Array.from(this.#ja).forEach((t=>"undone"in t.dataset&&t.remove()));this.#ps.historyList.append(Q.Ln("gsui-daw-history-action",{icon:t,desc:s,index:this.#ja.length}));this.#ps.historyList.scroll(0,Number.MAX_SAFE_INTEGER);this.#Ba=this.#ja.length-1}undo(){if(this.#Ba>=0){Q.En(this.#ja[this.#Ba--],"data-undone",true)}}redo(){if(this.#Ba<this.#ja.length-1){Q.En(this.#ja[++this.#Ba],"data-undone",false)}}#Fa(t){const s=t.target.dataset;switch(s.action){case"logout":case"localNewCmp":case"cloudNewCmp":case"focusSwitch":case"play":case"stop":case"reset":case"undo":case"redo":this.#La(s.action);break;case"cmp-save":this.#La("save");break;case"cmp-open":t.preventDefault();this.#La("open",this.#ps.cmpsLocalList.contains(t.target.parentNode)?"local":"cloud",t.target.parentNode.dataset.id);break;case"cmp-json":{const s=this.onExportJSON(this.#ps.cmpsLocalList.contains(t.target.parentNode)?"local":"cloud",t.target.parentNode.dataset.id);if(s){Q.En(t.target,"href",s.url);Q.En(t.target,"download",s.name)}else{t.preventDefault()}}break;case"cmp-delete":this.#La("delete",this.#ps.cmpsLocalList.contains(t.target.parentNode)?"local":"cloud",t.target.parentNode.dataset.id);break;case"cmp-rename":Q.Un.prompt("Composition's title","",Q.Nn(this,"name"),"Rename").then((t=>t&&t!==Q.Nn(this,"name")&&this.#La("rename",t)));break;case"login":Q.Un.custom({ok:"Sign in",title:"Authentication",element:this.#Ia.auth.root,submit:t=>this.onSubmitLogin(t.email,t.password)}).then((()=>{this.#Ia.auth.root.querySelectorAll("input").forEach((t=>t.value=""))}));break;case"localOpenCmp":this.showOpenPopup();break;case"window":if(s.win!=="patterns"){this.#La(s.open===undefined?"openWindow":"closeWindow",s.win)}else{this.toggleWindow("patterns",s.open!=="")}break;case"historyAction":if(s.index-this.#Ba){this.#La("redoN",s.index-this.#Ba)}break;case"about":Q.Un.custom({title:"About",element:this.#Ia.about.root});break;case"export":Q.En(this,"exporting",0);Q.En(this.#Ia.export.button,"href","");Q.En(this.#Ia.export.button,"download","");Q.En(this.#Ia.export.button,"data-status",0);Q.Un.custom({title:"Export",element:this.#Ia.export.root}).then((()=>this.#La("abortExport")));break;case"tempo":this.#Ia.tempo.beatsPerMeasure.value=+Q.Nn(this,"timedivision").split("/")[0];this.#Ia.tempo.stepsPerBeat.value=+Q.Nn(this,"timedivision").split("/")[1];this.#Ia.tempo.bpm.value=Q.za(this,"bpm");Q.Un.custom({title:"Tempo",element:this.#Ia.tempo.root}).then((t=>{if(t){t.timedivision=`${t.beatsPerMeasure}/${t.stepsPerBeat}`;delete t.beatsPerMeasure;delete t.stepsPerBeat;if(t.timedivision!==Q.Nn(this,"timedivision")||t.bpm!==Q.za(this,"bpm")){this.#La("tempo",t)}}}));break;case"settings":this.#Ia.settings.sampleRate.value=Q.za(this,"samplerate");this.#Ia.settings.timelineNumbering.value=Q.za(this,"timelinenumbering");this.#Ia.settings.windowsLowGraphics.checked=Q.Nn(this,"windowslowgraphics")==="";this.#Ia.settings.uiRateRadio[Q.Nn(this,"uirate")==="auto"?"auto":"manual"].checked=true;if(Q.Nn(this,"uirate")!=="auto"){this.#Ia.settings.uiRateManualFPS.textContent=Q.Nn(this,"uirate").padStart(2,"0");this.#Ia.settings.uiRateManualRange.value=Q.Nn(this,"uirate")}Q.Un.custom({title:"Settings",element:this.#Ia.settings.root}).then((t=>{if(t){if(t.uiRate==="manual"){t.uiRate=t.uiRateFPS}delete t.uiRateFPS;if(t.uiRate!==Q.Nn(this,"uirate")&&t.uiRate!==Q.za(this,"uirate")||t.sampleRate!==Q.za(this,"samplerate")||t.timelineNumbering!==Q.za(this,"timelinenumbering")||t.windowsLowGraphics!==(Q.Nn(this,"windowslowgraphics")==="")){this.#La("settings",t)}}}));break;case"cmps":case"help":case"undoMore":case"changelog":break;default:s.action&&console.log("untracked action:",s.action);break}}}Object.seal(Z);customElements.define("gsui-daw",Z);"use strict";class tt extends HTMLElement{show(t){if(t){this.style.cursor=t}this.classList.add("gsuiDragshield-show")}hide(){this.style.cursor="";this.classList.remove("gsuiDragshield-show")}}Object.freeze(tt);customElements.define("gsui-dragshield",tt);"use strict";class st extends HTMLElement{#Ga=Q.Ia("polyline",{class:"gsuiEnvelopeGraph-mainLine"});#Ha=Q.Ia("polyline",{class:"gsuiEnvelopeGraph-line"});#Va=Q.Ia("polyline",{class:"gsuiEnvelopeGraph-line"});#Ua=Q.Ia("svg",{preserveAspectRatio:"none"},this.#Ga,this.#Ha,this.#Va);#qa=0;#_a=0;constructor(){super();this.attack=.25;this.hold=.25;this.decay=.25;this.sustain=.8;this.release=1;this.duration=4;Object.seal(this)}connectedCallback(){if(!this.firstChild){this.append(this.#Ua);this.resized()}}resized(){const t=this.getBoundingClientRect();const s=~~t.width;const i=~~t.height;this.#qa=s;this.#_a=i;Q.En(this.#Ua,"viewBox",`0 0 ${s} ${i}`);this.draw()}draw(){if(this.firstChild){const t=st.#Ya(this.#qa,this.#_a,this.duration,this.attack,this.hold,this.decay,this.sustain,this.release);Q.En(this.#Ha,"points",t.slice(0,8).join(" "));Q.En(this.#Va,"points",t.slice(-4).join(" "));Q.En(this.#Ga,"points",t.join(" "))}}static#Ya(t,s,i,e,n,a,o,r){const h=i!=="auto"?i:e+n+a+1+r;const c=t/h;const l=c*e;const u=l+c*n;const d=u+c*a;const p=d+c*(i==="auto"?1:i-e-n-a-r);const g=p+c*r;const m=s*(1-o);return[0,s,l,2,u,2,d,m+2,p,m+2,g,s]}}Object.freeze(st);customElements.define("gsui-envelope-graph",st);"use strict";Q.Ea("gsui-envelope",(()=>[[["attack","attack","att",0,1,.01],["hold","hold","hold",0,1,.01],["decay","decay","dec",0,1,.01],["sustain","sustain","sus",0,1,.01],["release","release","rel",0,4,.01]].map((([t,s,i,e,n,a])=>Q.Bn("div",{class:`gsuiEnvelope-prop gsuiEnvelope-${t}`,title:s},Q.Bn("div",{class:"gsuiEnvelope-propLabel"},Q.Bn("span",null,i),Q.Bn("div",{class:"gsuiEnvelope-propValue"})),Q.Bn("div",{class:"gsuiEnvelope-propContent"},Q.Bn("gsui-slider",{type:"linear-x",disabled:true,min:e,max:n,step:a,"mousemove-size":"800","data-prop":t}))))),Q.Bn("div",{class:"gsuiEnvelope-graph"},Q.Bn("gsui-beatlines",{coloredbeats:""}),Q.Bn("gsui-envelope-graph"))].flat(1)));"use strict";class it extends HTMLElement{#Ja=4;#Xa=300;#La=Q.La.bind(null,this,"gsuiEnvelope");#Qa=this.#Za.bind(this);#Ea=Q.Ln("gsui-envelope");#ps=Q.Wn(this.#Ea,{beatlines:"gsui-beatlines",graph:"gsui-envelope-graph",sliders:{attack:[".gsuiEnvelope-attack  gsui-slider",".gsuiEnvelope-attack  .gsuiEnvelope-propValue"],hold:[".gsuiEnvelope-hold    gsui-slider",".gsuiEnvelope-hold    .gsuiEnvelope-propValue"],decay:[".gsuiEnvelope-decay   gsui-slider",".gsuiEnvelope-decay   .gsuiEnvelope-propValue"],sustain:[".gsuiEnvelope-sustain gsui-slider",".gsuiEnvelope-sustain .gsuiEnvelope-propValue"],release:[".gsuiEnvelope-release gsui-slider",".gsuiEnvelope-release .gsuiEnvelope-propValue"]}});constructor(){super();Object.seal(this);Q.zn(this,{gsuiSlider:{inputStart:Q.Sn,inputEnd:Q.Sn,input:(t,s)=>{this.#to(s.dataset.prop,t.args[0])},change:(t,s)=>{this.#so(s.dataset.prop,t.args[0])}}})}connectedCallback(){if(this.#Ea){this.append(...this.#Ea);this.#Ea=null;Q.Va(this,{toggle:false,timedivision:"4/4",attack:.1,hold:.1,decay:.1,sustain:.8,release:1});this.updateWave()}Q.Ra(this,this.#Qa)}disconnectedCallback(){Q.Na(this,this.#Qa)}static get observedAttributes(){return["toggle","attack","hold","decay","sustain","release"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"toggle":this.#io(i!==null);break;case"timedivision":this.#eo(i);break;case"attack":case"hold":case"decay":case"sustain":case"release":this.#ln(t,+i);break}}}updateWave(t,s){const i=this.#ps.graph;i.attack=t==="attack"?s:Q.za(this,"attack");i.hold=t==="hold"?s:Q.za(this,"hold");i.decay=t==="decay"?s:Q.za(this,"decay");i.sustain=t==="sustain"?s:Q.za(this,"sustain");i.release=t==="release"?s:Q.za(this,"release");i.duration=this.#Ja=Math.max(i.attack+i.hold+i.decay+.5+i.release,2);i.draw();this.#no()}#io(t){Q.En(this.#ps.sliders.attack[0],"disabled",!t);Q.En(this.#ps.sliders.hold[0],"disabled",!t);Q.En(this.#ps.sliders.decay[0],"disabled",!t);Q.En(this.#ps.sliders.sustain[0],"disabled",!t);Q.En(this.#ps.sliders.release[0],"disabled",!t)}#eo(t){Q.En(this.#ps.beatlines,"timedivision",t);this.updateWave()}#ln(t,s){const[i,e]=this.#ps.sliders[t];i.setValue(s);e.textContent=s.toFixed(2)}#no(){Q.En(this.#ps.beatlines,"pxperbeat",this.#Xa/this.#Ja)}#Za(){this.#Xa=this.#ps.beatlines.getBoundingClientRect().width;this.#no();this.#ps.graph.resized()}#to(t,s){this.#ps.sliders[t][1].textContent=s.toFixed(2);this.updateWave(t,s);this.#La("liveChange",t,s)}#so(t,s){Q.En(this,t,s);this.#La("change",t,s)}}Object.freeze(it);customElements.define("gsui-envelope",it);"use strict";Q.Ea("gsui-lfo",(()=>[Q.Bn("div",{class:"gsuiLFO-graph"},Q.Bn("div",{class:"gsuiLFO-wave"},Q.Bn("gsui-beatlines",{coloredbeats:""}),Q.Bn("gsui-periodicwave")),Q.Bn("div",{class:"gsuiLFO-ampSigns"},Q.Bn("label",{class:"gsuiLFO-btn gsuiLFO-ampSign"},Q.Bn("input",{class:"gsuiLFO-btnInput gsuiLFO-ampSignRadio",name:"gsuiLFO-ampSign",type:"radio",value:"1"}),Q.Bn("i",{class:"gsuiLFO-btnIcon gsuiLFO-ampSignIcon gsuiIcon","data-icon":"caret-up"})),Q.Bn("label",{class:"gsuiLFO-btn gsuiLFO-ampSign"},Q.Bn("input",{class:"gsuiLFO-btnInput gsuiLFO-ampSignRadio",name:"gsuiLFO-ampSign",type:"radio",value:"-1"}),Q.Bn("i",{class:"gsuiLFO-btnIcon gsuiLFO-ampSignIcon gsuiIcon","data-icon":"caret-down"})))),[["delay","delay","del",0,4,.03125],["attack","attack","att",0,4,.03125],["speed","speed","spd",.25,18,.125],["amp","amplitude","amp",.001,1,.001]].map((([t,s,i,e,n,a])=>Q.Bn("div",{class:`gsuiLFO-prop gsuiLFO-${t}`,title:s},Q.Bn("div",{class:"gsuiLFO-propLabel"},Q.Bn("span",null,i),Q.Bn("div",{class:"gsuiLFO-propValue"})),Q.Bn("div",{class:"gsuiLFO-propContent"},Q.Bn("gsui-slider",{type:"linear-x",disabled:true,min:e,max:n,step:a,"mousemove-size":"800","data-prop":t}))))),Q.Bn("div",{class:"gsuiLFO-prop gsuiLFO-type"},Q.Bn("div",{class:"gsuiLFO-propLabel"},"wave"),Q.Bn("div",{class:"gsuiLFO-propContent"},[["sine","M 1 5 C 1 4 1 1 4 1 C 7 1 7 4 7 5 C 7 6 7 9 10 9 C 13 9 13 6 13 5"],["triangle","M 1 5 L 4 1 L 10 9 L 13 5"],["sawtooth","M 1 5 L 7 1 L 7 9 L 13 5"],["square","M 1 5 L 1 1 L 7 1 L 7 9 L 13 9 L 13 5"]].map((([t,s])=>Q.Bn("label",{class:"gsuiLFO-btn gsuiLFO-typeBtn",title:t},Q.Bn("input",{class:"gsuiLFO-btnInput gsuiLFO-typeRadio",name:"gsuiLFO-type",type:"radio",value:t}),Q.Ia("svg",{class:"gsuiLFO-btnIcon gsuiLFO-typeSVG",viewBox:"0 0 14 10"},Q.Ia("path",{d:s})))))))].flat(1)));"use strict";class et extends HTMLElement{#Ja=4;#Xa=300;#pe=24e3;#La=Q.La.bind(null,this,"gsuiLFO");#Qa=this.#Za.bind(this);#Ea=Q.Ln("gsui-lfo");#ps=Q.Wn(this.#Ea,{title:".gsuiLFO-title",beatlines:"gsui-beatlines",wave:"gsui-periodicwave",sliders:{delay:[".gsuiLFO-delay       gsui-slider",".gsuiLFO-delay       .gsuiLFO-propValue"],attack:[".gsuiLFO-attack      gsui-slider",".gsuiLFO-attack      .gsuiLFO-propValue"],speed:[".gsuiLFO-speed       gsui-slider",".gsuiLFO-speed       .gsuiLFO-propValue"],amp:[".gsuiLFO-amp         gsui-slider",".gsuiLFO-amp         .gsuiLFO-propValue"],lowpassfreq:[".gsuiLFO-lowpassfreq gsui-slider",".gsuiLFO-lowpassfreq .gsuiLFO-propValue"]}});constructor(){super();Object.seal(this);this.onchange=this.#ao.bind(this);Q.zn(this,{gsuiSlider:{inputStart:Q.Sn,inputEnd:Q.Sn,input:(t,s)=>{this.#to(s.dataset.prop,t.args[0])},change:(t,s)=>{this.#so(s.dataset.prop,t.args[0])}}})}connectedCallback(){if(this.#Ea){this.append(...this.#Ea);this.#Ea=null;Q.Va(this,{toggle:false,timedivision:"4/4",type:"sine",delay:0,attack:1,speed:1,amp:1});this.updateWave()}Q.Ra(this,this.#Qa)}disconnectedCallback(){Q.Na(this,this.#Qa)}static get observedAttributes(){return["toggle","timedivision","type","delay","attack","speed","amp","lowpassfreq"]}attributeChangedCallback(t,s,i){if(!this.#Ea&&s!==i){const e=+i;switch(t){case"timedivision":Q.En(this.#ps.beatlines,"timedivision",i);break;case"toggle":this.#io(i!==null);break;case"type":this.#fn(i);break;case"delay":case"attack":case"speed":case"lowpassfreq":this.#ln(t,e);break;case"amp":if(e>0!==s>0){this.#oo(e)}this.#ln("amp",Math.abs(e));break}}}updateWave(t,s){const i=this.#ps.wave;const e=+Q.Nn(this,"timedivision").split("/")[0];i.type=Q.Nn(this,"type");i.delay=t==="delay"?s:Q.za(this,"delay");i.attack=t==="attack"?s:Q.za(this,"attack");i.frequency=t==="speed"?s:Q.za(this,"speed");i.amplitude=t==="amp"?s:Q.za(this,"amp");i.duration=this.#Ja=Math.max(i.delay+i.attack+2,e);i.draw();i.style.opacity=Math.min(6/i.frequency,1);this.#no()}#io(t){this.querySelectorAll(".gsuiLFO-typeRadio").forEach((s=>Q.En(s,"disabled",!t)));Q.En(this.#ps.sliders.delay[0],"disabled",!t);Q.En(this.#ps.sliders.attack[0],"disabled",!t);Q.En(this.#ps.sliders.speed[0],"disabled",!t);Q.En(this.#ps.sliders.amp[0],"disabled",!t)}#fn(t){this.#ps.wave.type=t;this.querySelector(`.gsuiLFO-typeRadio[value="${t}"]`).checked=true}#oo(t){this.querySelector(`.gsuiLFO-ampSignRadio[value="${Math.sign(t)||1}"]`).checked=true}#ln(t,s){const i=this.#ps.sliders[t];if(i){i[0].setValue(s);i[1].textContent=et.#ro(t,s)}}#no(){Q.En(this.#ps.beatlines,"pxPerBeat",this.#Xa/this.#Ja)}static#ro(t,s){return s.toFixed(2)}#Za(){this.#Xa=this.#ps.beatlines.getBoundingClientRect().width;this.#no();this.#ps.wave.resized()}#ao(t){switch(t.target.name){case"gsuiLFO-type":Q.En(this,"type",t.target.value);this.updateWave();this.#La("change","type",t.target.value);break;case"gsuiLFO-ampSign":Q.En(this,"amp",-Q.za(this,"amp"));this.updateWave();this.#La("change","amp",Q.za(this,"amp"));break}}#to(t,s){const i=t!=="amp"?s:s*Math.sign(Q.za(this,"amp"));this.#ps.sliders[t][1].textContent=et.#ro(t,s);this.updateWave(t,i);this.#La("liveChange",t,i)}#so(t,s){const i=t==="amp"?s*Math.sign(Q.za(this,"amp")):s;Q.En(this,t,i);this.#La("change",t,i)}}Object.freeze(et);customElements.define("gsui-lfo",et);"use strict";Q.Ea("gsui-clock",(()=>[Q.Bn("div",{class:"gsuiClock-relative",inert:true},Q.Bn("div",{class:"gsuiClock-absolute"},Q.Bn("div",{class:"gsuiClock-a"},"0"),Q.Bn("div",{class:"gsuiClock-b"},"00"),Q.Bn("div",{class:"gsuiClock-c"},"000"),Q.Bn("span",{class:"gsuiClock-modeText"}))),Q.Bn("button",{class:"gsuiClock-modes"},Q.Bn("div",{class:"gsuiClock-mode gsuiClock-beat"}),Q.Bn("div",{class:"gsuiClock-mode gsuiClock-second"}))]));"use strict";class nt extends HTMLElement{#ho=4;#co=4;#lo=0;#uo=-1;#do=false;#po=[-1,-1,-1];#Ea=Q.Ln("gsui-clock");#ps=Q.Wn(this.#Ea,{wrapRel:".gsuiClock-relative",modes:".gsuiClock-modes",nodes:[".gsuiClock-a",".gsuiClock-b",".gsuiClock-c"]});constructor(){super();this.onchangeDisplay=Q.Sn;Object.seal(this);this.#ps.modes.onclick=this.#go.bind(this)}connectedCallback(){this.#do=true;if(this.#Ea){this.append(...this.#Ea);this.#Ea=null;Q.Va(this,{mode:"second",bpm:60,timedivision:"4/4"})}this.#mo()}disconnectedCallback(){this.#do=false}static get observedAttributes(){return["mode","bpm","timedivision"]}attributeChangedCallback(t,s,i){if(!this.#Ea&&s!==i){switch(t){case"mode":case"bpm":this.resetTime();break;case"timedivision":{const t=i.split("/");this.#ho=+t[0];this.#co=+t[1];this.resetTime()}break}}}static numberingOff=1;static numbering(t){nt.numberingOff=+t;document.querySelectorAll("gsui-clock").forEach((t=>t.resetTime()))}static parseBeatsToSeconds(t,s){const i=t/(s/60);return[`${i/60|0}`,`${i%60|0}`.padStart(2,"0"),`${i*1e3%1e3|0}`.padStart(3,"0")]}static parseBeatsToBeats(t,s,i){const e=Math.floor(t/s);const n=Math.floor((t-e*s)*i);const a=t*i-Math.floor(t*i);return[`${e+nt.numberingOff}`,`${n+nt.numberingOff}`.padStart(2,"0"),`${a*1e3%1e3|0}`.padStart(3,"0")]}setTime(t){const[s,i,e]=Q.Nn(this,"mode")==="second"?nt.parseBeatsToSeconds(t,Q.za(this,"bpm")||60):nt.parseBeatsToBeats(t,this.#ho,this.#co);this.#lo=t;this.#fo(0,s);this.#fo(1,i);this.#fo(2,e);if(this.#do&&s.length!==this.#uo){this.#uo=s.length;this.#mo()}}resetTime(){this.setTime(this.#lo)}#fo(t,s){if(s!==this.#po[t]){this.#ps.nodes[t].textContent=this.#po[t]=s}}#mo(){const t=this.#ps.nodes[0].textContent.length;this.#ps.wrapRel.style.width=this.#ps.wrapRel.style.minWidth=`${4.5+t*.7}ch`}#go(){const t=Q.Nn(this,"mode")==="second"?"beat":"second";Q.En(this,"mode",t);this.onchangeDisplay(t)}}Object.seal(nt);customElements.define("gsui-clock",nt);"use strict";Q.Ea("gsui-channel",(()=>[Q.Bn("button",{class:"gsuiChannel-nameWrap"},Q.Bn("span",{class:"gsuiChannel-name"})),Q.Bn("button",{class:"gsuiChannel-headBtn gsuiChannel-rename gsuiIcon","data-icon":"pen",title:"Rename the channel"}),Q.Bn("button",{class:"gsuiChannel-headBtn gsuiChannel-delete gsuiIcon","data-icon":"close",title:"Remove the channel"}),Q.Bn("div",{class:"gsuiChannel-analyser"},Q.Bn("gsui-analyser"),Q.Bn("div",{class:"gsuiChannel-effects"})),Q.Bn("gsui-toggle"),Q.Bn("div",{class:"gsuiChannel-pan"},Q.Bn("gsui-slider",{type:"circular",min:-1,max:1,step:.02,"mousemove-size":800,"stroke-width":3,"data-prop":"pan"})),Q.Bn("div",{class:"gsuiChannel-gain"},Q.Bn("gsui-slider",{type:"linear-y",min:0,max:1,step:.01,"mousemove-size":400,"data-prop":"gain"})),Q.Bn("button",{class:"gsuiChannel-connect"},Q.Bn("i",{class:"gsuiChannel-connectA gsuiIcon","data-icon":"caret-up"}),Q.Bn("i",{class:"gsuiChannel-connectB gsuiIcon","data-icon":"caret-up"})),Q.Bn("div",{class:"gsuiChannel-grip gsuiIcon","data-icon":"grip-h"})]));Q.Ea("gsui-channel-effect",((t,s)=>Q.Bn("button",{class:"gsuiChannel-effect gsuiChannel-effect-enable","data-id":t},Q.Bn("span",{class:"gsuiChannel-effect-name"},s))));"use strict";class at extends HTMLElement{#La=Q.La.bind(null,this,"gsuiChannel");#Ea=Q.Ln("gsui-channel");#ps=Q.Wn(this.#Ea,{toggle:"gsui-toggle",nameWrap:".gsuiChannel-nameWrap",name:".gsuiChannel-name",analyser:"gsui-analyser",effects:".gsuiChannel-effects",pan:".gsuiChannel-pan gsui-slider",gain:".gsuiChannel-gain gsui-slider",connecta:".gsuiChannel-connectA",connectb:".gsuiChannel-connectB"});analyser=this.#ps.analyser;constructor(){super();Object.seal(this);this.#ps.nameWrap.onclick=this.#ps.analyser.onclick=()=>{this.#La("selectChannel")};this.#ps.effects.onclick=t=>{if(t.target.dataset.id){this.#La("selectChannel");this.#La("selectEffect",t.target.dataset.id)}};Q.zn(this,{gsuiToggle:{toggle:t=>{Q.En(this,"muted",!t.args[0]);this.#La("toggle",t.args[0])},toggleSolo:()=>{Q.En(this,"muted",false);this.#La("toggleSolo")}},gsuiSlider:{inputStart:Q.Sn,inputEnd:Q.Sn,input:(t,s)=>{this.#La("liveChange",s.dataset.prop,t.args[0])},change:(t,s)=>{this.#La("change",s.dataset.prop,t.args[0])}}})}connectedCallback(){if(!this.firstChild){this.append(...this.#Ea);this.#Ea=null;Q.En(this,"draggable","true");Q.Va(this,{name:"chan",pan:0,gain:1,connecta:"down"})}}static get observedAttributes(){return["name","muted","pan","gain","connecta","connectb"]}attributeChangedCallback(t,s,i){if(!this.#Ea&&s!==i){switch(t){case"name":this.#ps.name.textContent=i;break;case"muted":Q.En(this.#ps.toggle,"off",i!==null);break;case"pan":case"gain":this.#ps[t].setValue(i);break;case"connecta":case"connectb":this.#ps[t].dataset.icon=i?`caret-${i}`:"";break}}}Jn(t,s){this.#ps.effects.append(Q.Ln("gsui-channel-effect",t,s.type))}Qn(t){this.#bo(t).remove()}Xn(t,s){if("order"in s){this.#bo(t).style.order=s.order}if("toggle"in s){this.#bo(t).classList.toggle("gsuiChannel-effect-enable",s.toggle)}}#bo(t){return this.#ps.effects.querySelector(`[data-id="${t}"]`)}}Object.freeze(at);customElements.define("gsui-channel",at);"use strict";Q.Ea("gsui-channels",(()=>[Q.Bn("div",{class:"gsuiChannels-panMain"}),Q.Bn("div",{class:"gsuiChannels-panChannels"},Q.Bn("button",{class:"gsuiChannels-addChan",title:"Add a channel"},Q.Bn("i",{class:"gsuiIcon","data-icon":"channels"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"plus"})))]));Q.Ea("gsui-channels-selectPopup",(()=>Q.Bn("div",null,Q.Bn("fieldset",null,Q.Bn("legend",null,"Select a channel"),Q.Bn("select",{name:"channel",size:8})))));"use strict";class ot extends HTMLElement{oninput=null;onchange=null;onselectChan=null;onselectEffect=null;#ee={};#wo=null;#vo=10;#yo=50;#Qa=this.#Za.bind(this);#Ea=Q.Ln("gsui-channels");#ps=Q.Wn(this.#Ea,{pmain:".gsuiChannels-panMain",pchans:".gsuiChannels-panChannels",addBtn:".gsuiChannels-addChan"});static#ko=Q.Ln("gsui-channels-selectPopup");static#$o=ot.#ko.querySelector("select");constructor(){super();Object.seal(this);this.#ps.addBtn.onclick=()=>this.onchange("addChannel");Q.zn(this,{gsuiChannel:{selectChannel:(t,s)=>this.selectChannel(s.dataset.id),selectEffect:(t,s)=>this.onselectEffect(s.dataset.id,t.args[0]),liveChange:(t,s)=>this.oninput(s.dataset.id,...t.args),change:(t,s)=>this.onchange("changeChannel",s.dataset.id,...t.args),toggle:(t,s)=>this.onchange("toggleChannel",s.dataset.id)}});new dt({rootElement:this,direction:"row",dataTransferType:"channel",itemSelector:"gsui-channel",handleSelector:".gsuiChannel-grip",parentSelector:".gsuiChannels-panChannels",onchange:t=>{this.onchange("reorderChannel",t.dataset.id,dt.listComputeOrderChange(this.#ps.pchans,{}))}})}connectedCallback(){if(!this.firstChild){this.append(...this.#Ea);this.#Ea=null}Q.Ra(this,this.#Qa)}disconnectedCallback(){Q.Na(this,this.#Qa)}#Za(){const t=Object.values(this.#ee);if(t.length){const{width:s,height:i}=t[0].analyser.getBoundingClientRect();this.#vo=s;this.#yo=i;t.forEach((t=>t.analyser.setResolution(s,i)))}}updateAudioData(t,s,i){this.#ee[t].analyser.draw(s,i)}selectChannel(t){const s=this.#ee[t];const i=this.#ee[this.#wo];i&&Q.En(i,"selected",false);Q.En(s,"selected",true);this.#wo=t;this.#Oo();this.onselectChan?.(t)}static openSelectChannelPopup(t){return new Promise((s=>{ot.#$o.value=t;Q.Un.custom({title:"Channels",element:ot.#ko,submit(i){s(i.channel!==t?i.channel:null)}})}))}Gt(t){return this.#ee[t]}addChannel(t){const s=Q.Bn("gsui-channel",{"data-id":t});const i=t=>s.querySelector(`.gsuiChannel-${t}`);(t==="main"?this.#ps.pmain:this.#ps.pchans).append(s);ot.#$o.append(Q.Bn("option",{value:t},name));this.#ee[t]=s;i("delete").onclick=()=>this.onchange("removeChannel",t);i("connect").onclick=()=>this.onchange("redirectChannel",this.#wo,t);i("rename").onclick=()=>{Q.Un.prompt("Rename channel","",Q.Nn(this.#ee[t],"name")).then((s=>this.onchange("renameChannel",t,s)))};s.analyser.setResolution(this.#vo,this.#yo);if(this.#wo){this.#Oo()}else if(t==="main"){this.selectChannel(t)}}removeChannel(t){const s=this.#ee[t];if(t===this.#wo){const t=this.#xo(s,"nextElementSibling");if(t){this.selectChannel(t.dataset.id)}else{const t=this.#xo(s,"previousElementSibling");this.selectChannel(t?t.dataset.id:"main")}}delete this.#ee[t];s.remove();ot.#$o.querySelector(`option[value="${t}"]`).remove()}toggleChannel(t,s){Q.En(this.#ee[t],"muted",!s)}changePanChannel(t,s){Q.En(this.#ee[t],"pan",s)}changeGainChannel(t,s){Q.En(this.#ee[t],"gain",s)}renameChannel(t,s){Q.En(this.#ee[t],"name",s);ot.#$o.querySelector(`option[value="${t}"]`).textContent=s}reorderChannel(t,s){this.#ee[t].dataset.order=s}reorderChannels(t){dt.listReorder(this.#ps.pchans,t)}redirectChannel(t,s){this.#ee[t].dataset.dest=s;this.#Oo()}#xo(t,s){const i=t[s];return i&&"id"in i.dataset?i:null}#Oo(){const t=this.#wo;if(t){const s=this.#ee[t];const i=s.dataset.dest;let e=false;Object.entries(this.#ee).forEach((([s,n])=>{const a=s===i;const o=n.dataset.dest===t;Q.En(n,"connecta",a?"up":"");Q.En(n,"connectb",o?"down":"");e=e||o}));Q.En(s,"connecta",t!=="main"?"down":"");Q.En(s,"connectb",e?"up":"")}}}Object.freeze(ot);customElements.define("gsui-channels",ot);"use strict";Q.Ea("gsui-curves",(()=>Q.Ia("svg",{class:"gsuiCurves-svg",preserveAspectRatio:"none"},Q.Ia("line",{class:"gsuiCurves-line","shape-rendering":"crispEdges"}),Q.Ia("g",{class:"gsuiCurves-marks"}),Q.Ia("g",{class:"gsuiCurves-curves"}))));"use strict";class rt extends HTMLElement{#So=Object.seal([0,0]);#Do=new Map;#Co=Object.seal({nyquist:24e3,nbBands:8});#Ea=Q.Ln("gsui-curves");#ps=Q.Wn(this.#Ea,{svg:"svg",line:".gsuiCurves-line",marks:".gsuiCurves-marks",curves:".gsuiCurves-curves"});constructor(){super();Object.freeze(this)}connectedCallback(){if(this.#Ea){this.append(this.#Ea);this.#Ea=null}}resized(){const t=this.#ps.svg.getBoundingClientRect();const s=t.width;const i=t.height;this.#So[0]=s;this.#So[1]=i;Q.En(this.#ps.svg,"viewBox",`0 0 ${s} ${i}`);this.redraw()}options(t){Object.assign(this.#Co,t);if("nbBands"in t||"nyquist"in t){this.#Po()}}setCurve(t,s){const i=this.#ps.curves.querySelector(`[data-id="${t}"]`);if(s){this.#Do.set(t,s);if(i){Q.En(i,"d",this.#Mo(s))}else{this.#Ao(t,s)}}else{this.#Do.delete(t);i.remove()}}redraw(){this.#Po();this.#To();this.#Do.forEach(((t,s)=>{Q.En(this.#ps.curves.querySelector(`[data-id="${s}"]`),"d",this.#Mo(t))}))}getWidth(){return this.#So[0]}#To(){const[t,s]=this.#So;Q.En(this.#ps.line,{x1:0,x2:t,y1:s/2,y2:s/2})}#Po(){const[t,s]=this.#So;const i=this.#Co.nbBands;const e=this.#Co.nyquist;const n=[];const a=[];for(let o=0;o<i;++o){const r=o/i*t|0;const h=Math.round(e*2**(o/i*11-11));a.push(Q.Ia("text",{class:"gsuiCurves-markText",x:r+3,y:14},h<1e3?h:`${(h/1e3).toFixed(1)}k`));if(o%2===0){n.push(Q.Ia("rect",{class:"gsuiCurves-markBg",x:r,y:0,width:t/i|0,height:s,"shape-rendering":"crispEdges"}))}}Q.Ga(this.#ps.marks);this.#ps.marks.append(...n,...a)}#Ao(t,s){this.#ps.curves.append(Q.Ia("path",{class:"gsuiCurves-curve","data-id":t,d:this.#Mo(s)}))}#Mo(t){const s=this.#So[0];const i=t.length;const e=[`M 0 ${this.#Bo(t[0])} `];for(let n=1;n<i;++n){e.push(`L ${n/i*s|0} ${this.#Bo(t[n])} `)}return e.join("")}#Bo(t){const s=this.#So[1];const i=20*Math.log(Math.max(t,1e-4))/Math.LN10;return s/2-i*(s/100)}}Object.freeze(rt);customElements.define("gsui-curves",rt);"use strict";Q.Ea("gsui-effects",(()=>[Q.Bn("button",{class:"gsuiEffects-addBtn",title:"Add an effect"},Q.Bn("i",{class:"gsuiIcon","data-icon":"add-effect"})),Q.Bn("select",{class:"gsuiEffects-addSelect",size:2},Q.Bn("option",{value:"delay"},"Delay (echo)"),Q.Bn("option",{value:"filter"},"Filter"))]));Q.Ea("gsui-effects-fx",(()=>Q.Bn("div",{class:"gsuiEffects-fx",draggable:"true"},Q.Bn("div",{class:"gsuiEffects-fx-head"},Q.Bn("div",{class:"gsuiEffects-fx-grip gsuiIcon","data-icon":"grip-v"}),Q.Bn("button",{class:"gsuiEffects-fx-expand gsuiIcon","data-icon":"caret-right"}),Q.Bn("gsui-toggle",{title:"Toggle this effect"}),Q.Bn("span",{class:"gsuiEffects-fx-name"}),Q.Bn("button",{class:"gsuiEffects-fx-remove gsuiIcon","data-icon":"close",title:"Delete this effect"})),Q.Bn("div",{class:"gsuiEffects-fx-content"}))));"use strict";class ht extends HTMLElement{ta=Q.Sn;#jo=new Map;#La=Q.La.bind(null,this,"gsuiEffects");#Ea=Q.Ln("gsui-effects");#ps=Q.Wn(this.#Ea,{addBtn:".gsuiEffects-addBtn",addSelect:".gsuiEffects-addSelect"});static#Lo=Object.freeze({delay:{cmp:"gsui-fx-delay",name:"Delay",height:140},filter:{cmp:"gsui-fx-filter",name:"Filter",height:160}});constructor(){super();Object.seal(this);this.#ps.addBtn.onclick=()=>this.#ps.addSelect.value="";this.#ps.addSelect.onchange=this.#Eo.bind(this);this.#ps.addSelect.onkeydown=()=>false;new dt({rootElement:this,direction:"column",dataTransferType:"effect",itemSelector:".gsuiEffects-fx",handleSelector:".gsuiEffects-fx-grip",parentSelector:"gsui-effects"});Q.zn(this,{gsuiToggle:{toggle:(t,s)=>{this.#La("toggleEffect",s.parentNode.parentNode.dataset.id)}},default:{liveChange:(t,s)=>{t.args.unshift(s.dataset.id);t.component="gsuiEffects";t.eventName="liveChangeEffect";return true},changeProp:(t,s)=>{t.args.unshift(s.dataset.id);t.component="gsuiEffects";t.eventName="changeEffect";return true}}})}connectedCallback(){if(!this.firstChild){this.append(...this.#Ea);this.#Ea=null}}static get observedAttributes(){return["timedivision"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"timedivision":this.#jo.forEach((t=>Q.En(t.content.firstChild,"timedivision",i)));break}}}na(t){return this.#jo.get(t)}ea(t){const s=this.#jo.get(t).root;this.Ua(t,!s.classList.contains("gsuiEffects-fx-expanded"))}Ua(t,s){const i=this.#jo.get(t);const e=i.root.dataset.type;i.root.classList.toggle("gsuiEffects-fx-expanded",s);i.expand.dataset.icon=s?"caret-down":"caret-right";i.content.style.height=`${s?ht.#Lo[e].height:0}px`}Jn(t,s){const i=Q.Ln("gsui-effects-fx");const e=i.querySelector(".gsuiEffects-fx-name");const n=i.querySelector(".gsuiEffects-fx-expand");const a=i.querySelector(".gsuiEffects-fx-remove");const o=i.querySelector(".gsuiEffects-fx-content");const r=ht.#Lo[s.type];const h=Q.Bn(r.cmp);const c=Object.seal({uiFx:h,root:i,expand:n,content:o});n.onclick=()=>this.ea(t);a.onclick=()=>this.#La("removeEffect",t);if("ta"in h){h.ta=this.ta.bind(null,t,s.type)}i.dataset.id=h.dataset.id=t;i.dataset.type=s.type;Q.En(h,"timedivision",Q.Nn(this,"timedivision"));e.textContent=r.name;o.append(h);this.#jo.set(t,c);this.append(i)}Qn(t){this.#jo.get(t).root.remove();this.#jo.delete(t)}Zn(t,s,i){switch(s){case"toggle":this.#io(t,i);break;case"order":this.#jo.get(t).root.dataset.order=i;break}}ia(t){dt.listReorder(this,t)}#io(t,s){const i=this.#jo.get(t);i.root.classList.toggle("gsuiEffects-fx-enable",s);i.uiFx.wa(s)}#Eo(){const t=this.#ps.addSelect.value;this.#ps.addSelect.blur();this.#ps.addSelect.value="";this.#La("addEffect",t)}}Object.freeze(ht);customElements.define("gsui-effects",ht);"use strict";Q.Ea("gsui-fx-delay",(()=>[Q.Bn("div",{class:"gsuiFxDelay-param","data-prop":"time"},Q.Bn("gsui-slider",{type:"linear-x",step:.01,min:0,max:2}),Q.Bn("span",{class:"gsuiFxDelay-param-value"})),Q.Bn("div",{class:"gsuiFxDelay-param","data-prop":"gain"},Q.Bn("gsui-slider",{type:"linear-x",step:.01,min:0,max:.95}),Q.Bn("span",{class:"gsuiFxDelay-param-value"})),Q.Bn("div",{class:"gsuiFxDelay-param","data-prop":"pan"},Q.Bn("gsui-slider",{type:"linear-x",step:.01,min:-1,max:1}),Q.Bn("span",{class:"gsuiFxDelay-param-value"})),Q.Bn("div",{class:"gsuiFxDelay-graph"},Q.Bn("div",{class:"gsuiFxDelay-graph-lines"},Q.Bn("gsui-beatlines",{timedivision:"4/4"}),Q.Bn("div",{class:"gsuiFxDelay-graph-line"}),Q.Bn("div",{class:"gsuiFxDelay-graph-source"})),Array.from({length:20},((t,s)=>Q.Bn("div",{class:"gsuiFxDelay-graph-echo"}))))]));"use strict";class ct extends HTMLElement{#La=Q.La.bind(null,this,"gsuiFxDelay");#Qa=this.#Za.bind(this);#Ea=Q.Ln("gsui-fx-delay");#Wo=0;#ps=Q.Wn(this.#Ea,{beatlines:"gsui-beatlines",sliders:{time:"[data-prop='time'] gsui-slider",gain:"[data-prop='gain'] gsui-slider",pan:"[data-prop='pan'] gsui-slider"},values:{time:"[data-prop='time'] .gsuiFxDelay-param-value",gain:"[data-prop='gain'] .gsuiFxDelay-param-value",pan:"[data-prop='pan'] .gsuiFxDelay-param-value"}});#Io=this.getElementsByClassName("gsuiFxDelay-graph-echo");constructor(){super();Object.seal(this);Q.zn(this,{gsuiSlider:{inputStart:Q.Sn,inputEnd:Q.Sn,input:(t,s)=>{this.#Fo(s.parentNode.dataset.prop,t.args[0])},change:(t,s)=>{this.#La("changeProp",s.parentNode.dataset.prop,t.args[0])}}})}connectedCallback(){if(this.#Ea){this.append(...this.#Ea);this.#Ea=null;Q.Va(this,{timedivision:"4/4",time:.25,gain:.7,pan:-.2});this.#no();this.#Ko()}Q.Ra(this,this.#Qa)}disconnectedCallback(){Q.Na(this,this.#Qa)}static get observedAttributes(){return["timedivision","time","gain","pan"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"timedivision":Q.En(this.#ps.beatlines,"timedivision",i);this.#no();break;case"time":case"gain":case"pan":this.#ps.sliders[t].setValue(+i);this.#ps.values[t].textContent=(+i).toFixed(2);this.#Ko();break}}}wa(t){this.classList.toggle("gsuiFxDelay-enable",t)}#Za(){this.#Wo=this.#ps.beatlines.getBoundingClientRect().width;this.#no()}#no(){const t=Q.Nn(this,"timedivision").split("/")[0];Q.En(this.#ps.beatlines,"pxperbeat",this.#Wo/t)}#Fo(t,s){Q.En(this,t,s);this.#La("liveChange",t,s)}#Ko(){const t=Q.za(this,"time")/4;const s=Q.za(this,"gain");const i=Q.za(this,"pan");Array.from(this.#Io).forEach(((e,n)=>{const a=n+1;const o=s**a;const r=n%2===0?-i:i;e.style.display=o>.01?"block":"none";e.style.opacity=o;e.style.left=`${a*t*100}%`;e.style.top=`${(r/2+.5)*100}%`}))}}Object.freeze(ct);customElements.define("gsui-fx-delay",ct);"use strict";Q.Ea("gsui-fx-filter",(()=>[Q.Bn("div",{class:"gsuiFxFilter-area gsuiFxFilter-areaType"},Q.Bn("span",{class:"gsuiFxFilter-area-label"},"type"),Q.Bn("div",{class:"gsuiFxFilter-area-content"},Q.Ln("gsui-fx-filter-type","lowpass","M 1 4 L 12 4 L 15 8"),Q.Ln("gsui-fx-filter-type","highpass","M 1 8 L 4 4 L 15 4"),Q.Ln("gsui-fx-filter-type","bandpass","M 1 8 L 8 4 L 15 8"),Q.Ln("gsui-fx-filter-type","lowshelf","M 1 8 L 4 8 L 6 4 L 15 4"),Q.Ln("gsui-fx-filter-type","highshelf","M 1 4 L 10 4 L 12 8 L 15 8"),Q.Ln("gsui-fx-filter-type","peaking","M 1 8 L 7 8 L 8 4 L 9 8 L 15 8"),Q.Ln("gsui-fx-filter-type","notch","M 1 4 L 7 4 L 8 8 L 9 4 L 15 4"),Q.Ln("gsui-fx-filter-type","allpass","M 1 6 L 15 6"))),Q.Bn("div",{class:"gsuiFxFilter-area gsuiFxFilter-areaGraph"},Q.Bn("span",{class:"gsuiFxFilter-area-label"},"frequency"),Q.Bn("div",{class:"gsuiFxFilter-area-content"},Q.Bn("gsui-curves"))),Q.Bn("div",{class:"gsuiFxFilter-area gsuiFxFilter-areaFrequency"},Q.Bn("div",{class:"gsuiFxFilter-area-content"},Q.Bn("gsui-slider",{type:"linear-x",min:0,max:1,step:1e-4,"data-prop":"frequency"}))),Q.Bn("div",{class:"gsuiFxFilter-area gsuiFxFilter-areaGain"},Q.Bn("span",{class:"gsuiFxFilter-area-label"},"gain"),Q.Bn("div",{class:"gsuiFxFilter-area-content"},Q.Bn("gsui-slider",{type:"linear-y",min:-50,max:50,step:.1,"mousemove-size":400,"data-prop":"gain"}))),Q.Bn("div",{class:"gsuiFxFilter-area gsuiFxFilter-areaQ"},Q.Bn("span",{class:"gsuiFxFilter-area-label"},"Q"),Q.Bn("div",{class:"gsuiFxFilter-area-content"},Q.Bn("gsui-slider",{type:"circular",min:.001,max:25,step:.001,"mousemove-size":400,"data-prop":"Q"}))),Q.Bn("div",{class:"gsuiFxFilter-area gsuiFxFilter-areaDetune"},Q.Bn("span",{class:"gsuiFxFilter-area-label"},"detune"),Q.Bn("div",{class:"gsuiFxFilter-area-content"},Q.Bn("gsui-slider",{type:"circular",min:-1200,max:1200,step:10,"mousemove-size":400,"data-prop":"detune"})))]));Q.Ea("gsui-fx-filter-type",((t,s)=>Q.Bn("button",{class:"gsuiFxFilter-areaType-btn","data-type":t,title:t},Q.Ia("svg",{viewBox:"0 0 16 12"},Q.Ia("path",{d:s})))));"use strict";class lt extends HTMLElement{ta=Q.Sn;#pe=24e3;#do=false;#zo="lowpass";#Qa=this.#Za.bind(this);#Ro={Q:t=>t,gain:t=>t,detune:t=>t,frequency:t=>this.#pe*2**(t*11-11)};#La=Q.La.bind(null,this,"gsuiFxFilter");#Ea=Q.Ln("gsui-fx-filter");#ps=Q.Wn(this.#Ea,{type:".gsuiFxFilter-areaType .gsuiFxFilter-area-content",graph:".gsuiFxFilter-areaGraph .gsuiFxFilter-area-content",curves:"gsui-curves",sliders:{Q:".gsuiFxFilter-areaQ gsui-slider",gain:".gsuiFxFilter-areaGain gsui-slider",detune:".gsuiFxFilter-areaDetune gsui-slider",frequency:".gsuiFxFilter-areaFrequency gsui-slider"}});static typeGainQ=Object.freeze({lowpass:Object.freeze({gain:false,q:true}),highpass:Object.freeze({gain:false,q:true}),bandpass:Object.freeze({gain:false,q:true}),lowshelf:Object.freeze({gain:true,q:false}),highshelf:Object.freeze({gain:true,q:false}),peaking:Object.freeze({gain:true,q:true}),notch:Object.freeze({gain:false,q:true}),allpass:Object.freeze({gain:false,q:true})});constructor(){super();Object.seal(this);this.#ps.type.onclick=this.#No.bind(this);Q.zn(this,{gsuiSlider:{inputStart:Q.Sn,inputEnd:Q.Sn,input:(t,s)=>{this.#Fo(s.dataset.prop,this.#Ro[s.dataset.prop](t.args[0]))},change:(t,s)=>{this.#La("changeProp",s.dataset.prop,this.#Ro[s.dataset.prop](t.args[0]))}}});this.#ps.graph.append(this.#ps.curves)}connectedCallback(){this.#do=true;if(this.#Ea){this.append(...this.#Ea);this.#Ea=null;this.#Za();this.aa()}Q.Ra(this,this.#Qa)}disconnectedCallback(){this.#do=false;Q.Na(this,this.#Qa)}static get observedAttributes(){return["type","frequency","q","gain","detune"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"type":{const t=lt.typeGainQ[i];this.#Go(this.#zo,false);this.#Go(i,true);this.#zo=i;Q.En(this.#ps.sliders.Q,"disabled",!t.q);Q.En(this.#ps.sliders.gain,"disabled",!t.gain)}break;case"q":this.#ps.sliders.Q.setValue(+i);break;case"gain":case"detune":this.#ps.sliders[t].setValue(+i);break;case"frequency":this.#ps.sliders.frequency.setValue((Math.log2(i/this.#pe)+11)/11);break}}}wa(t){this.classList.toggle("gsuiFxFilter-enable",t);setTimeout((()=>this.aa()),150)}aa(){if(this.#do){const t=this.ta("curve",this.#ps.curves.getWidth());if(t){this.#ps.curves.setCurve("0",t)}}}#Go(t,s){this.#ps.type.querySelector(`[data-type="${t}"]`).classList.toggle("gsuiFxFilter-areaType-btnSelected",s)}#Za(){this.#ps.curves.resized()}#Fo(t,s){this.#La("liveChange",t,s);this.aa()}#No(t){const s=t.target.dataset.type;if(s&&!t.target.classList.contains("gsuiFxFilter-areaType-btnSelected")){this.#La("changeProp","type",s)}}}Object.freeze(lt);customElements.define("gsui-fx-filter",lt);"use strict";Q.Ea("gsui-mixer",(()=>Q.Bn("gsui-panel",{},Q.Bn("div",{class:"gsuiMixer-channels"},Q.Bn("div",{class:"gsuiMixer-head",inert:true},Q.Bn("i",{class:"gsuiMixer-head-icon gsuiIcon","data-icon":"channels"}),Q.Bn("span",{class:"gsuiMixer-head-title"},"channels")),Q.Bn("gsui-channels")),Q.Bn("div",{class:"gsuiMixer-effects"},Q.Bn("div",{class:"gsuiMixer-head",inert:true},Q.Bn("i",{class:"gsuiMixer-head-icon gsuiIcon","data-icon":"effects"}),Q.Bn("span",{class:"gsuiMixer-head-title"},"effects")),Q.Bn("gsui-effects")))));"use strict";class ut extends HTMLElement{#Ea=Q.Ln("gsui-mixer");#ps=Q.Wn(this.#Ea,{channels:"gsui-channels",effects:"gsui-effects"});constructor(){super();Object.seal(this)}connectedCallback(){if(!this.firstChild){this.append(this.#Ea);this.#Ea=null;new Ct({scrolledElem:this.querySelector(".gsuiChannels-panChannels"),leftShadow:this.querySelector(".gsuiChannels-panMain"),rightShadow:this.querySelector(".gsuiMixer-effects")});new Ct({scrolledElem:this.#ps.effects,topShadow:this.querySelector(".gsuiMixer-effects .gsuiMixer-head")})}}getChannels(){return this.#ps.channels}getEffects(){return this.#ps.effects}}Object.freeze(ut);customElements.define("gsui-mixer",ut);"use strict";class dt{constructor(t={}){const s=t.rootElement;this.rootElement=s;this._dirRow=t.direction!=="column";this._onchange=t.onchange??(()=>console.warn("gsuiReorder: no onchange set"));this._dataTransfer=t.dataTransfer??(()=>"");this._dataTransferType=t.dataTransferType??"text";this._itemSelector=t.itemSelector??"";this._handleSelector=t.handleSelector??"";this._parentSelector=t.parentSelector??"";this._preventDefault=t.preventDefault??true;this._elClicked=this._elDragged=this._elDragover=this._itemDragover=this._parentDragover=this._elShadowParent=this._elShadowDragged=this._elDraggedParent=null;this._shadowClass="";this._indDragged=0;this._droppedInside=false;this._ondrop=this._ondrop.bind(this);this._dragoverTime=0;Object.seal(this);s.addEventListener("mousedown",this._onmousedown.bind(this),{passive:true});s.addEventListener("dragstart",this._ondragstart.bind(this),{passive:false});s.addEventListener("dragover",this._ondragover.bind(this),{passive:true});s.addEventListener("dragend",this._ondragend.bind(this),{passive:true})}setShadowElement(t){this._elShadowParent=t}setShadowChildClass(t){this._shadowClass=`.${t}`}_getIndex(t){return Array.prototype.indexOf.call(t.parentNode.children,t)}_getShadowChild(t){return this._elShadowParent.querySelector(`${this._shadowClass}[data-id="${t}"]`)}_onmousedown(t){this._elClicked=t.target}_ondragstart(t){if(this._elClicked&&this._elClicked.matches(this._handleSelector)){const s=t.target;const i=s.dataset.id;document.addEventListener("drop",this._ondrop);this._elClicked=null;this._elDragged=s;this._elDraggedParent=s.parentNode;if(this._elShadowParent){this._elShadowDragged=this._getShadowChild(i)}this._indDragged=this._getIndex(s);t.dataTransfer.effectAllowed="move";t.dataTransfer.setData(this._dataTransferType,this._dataTransfer(s));setTimeout((()=>{this._elDragged.classList.add("gsuiReorder-dragging");if(this._elShadowDragged){this._elShadowDragged.classList.add("gsuiReorder-dragging")}}),20)}else if(this._preventDefault){t.preventDefault()}}_ondragover(t){const s=Date.now();if(this._elDragged&&s-this._dragoverTime>60){const i=t.target;const e=this._elDragged;const n=i===this._elDragover?this._itemDragover:i.closest(`${this._parentSelector} ${this._itemSelector}`);this._dragoverTime=s;if(!n){const t=i===this._elDragover?this._parentDragover:i.closest(this._parentSelector);this._parentDragover=t;if(t&&t.lastElementChild!==e){t.append(e);if(this._elShadowDragged){this._elShadowParent.append(this._elShadowDragged)}}}else{const s=n.getBoundingClientRect();if(this._dirRow&&t.clientX<s.left+s.width/2||!this._dirRow&&t.clientY<s.top+s.height/2){if(n.previousElementSibling!==e){n.before(e);if(this._elShadowDragged){this._getShadowChild(n.dataset.id).before(this._elShadowDragged)}}}else if(n.nextElementSibling!==e){n.after(e);if(this._elShadowDragged){this._getShadowChild(n.dataset.id).after(this._elShadowDragged)}}}this._elDragover=i;this._itemDragover=n}}_ondrop(t){this._droppedInside=this._elDragged&&t.target.closest(this._parentSelector)}_ondragend(){if(this._elDragged){const t=this._elDragged;const s=this._indDragged;const i=this._elDraggedParent;this._elDragged=this._elDragover=this._itemDragover=null;t.classList.remove("gsuiReorder-dragging");if(this._elShadowDragged){this._elShadowDragged.classList.remove("gsuiReorder-dragging")}document.removeEventListener("drop",this._ondrop);if(this._droppedInside){const e=this._getIndex(t);this._droppedInside=false;if(e!==s||t.parentNode!==i){this._onchange(t,s,e,i,t.parentNode)}}else{t.remove();s===0?i.prepend(t):i.children[s-1].after(t)}}}}"use strict";dt.listReorder=(t,s)=>{const i=!s||Object.values(s).some((t=>t&&"order"in t));if(i){const s=Array.prototype.filter.call(t.children,(t=>"order"in t.dataset)).sort(((t,s)=>t.dataset.order-s.dataset.order));t.append(...s)}};"use strict";dt.listComputeOrderChange=(t,s)=>{let i=0;Array.prototype.forEach.call(t.children,(t=>{const e=t.dataset;if("id"in e&&"order"in e){if(+e.order!==i){const t=s[e.id];if(t){t.order=i}else if(!(e.id in s)){s[e.id]={order:i}}}++i}}));return s};"use strict";Q.Ea("gsui-dragline",(()=>Q.Bn("div",{class:"gsuiDragline"},Q.Bn("div",{class:"gsuiDragline-main"},Q.Ia("svg",{class:"gsuiDragline-line"},Q.Ia("polyline")),Q.Bn("div",{class:"gsuiDragline-to"})))));"use strict";class pt{onchange=Q.Sn;rootElement=Q.Ln("gsui-dragline");getDropAreas=null;#Ho=null;#Vo=null;#Uo=null;#qo=null;#_o=null;#ps=Q.Wn(this.rootElement,{main:".gsuiDragline-main",svg:".gsuiDragline-line",polyline:".gsuiDragline-line polyline",to:".gsuiDragline-to"});constructor(){Object.seal(this);this.#ps.to.onmousedown=this.#Yo.bind(this)}linkTo(t){const s=t||null;if(s!==this.#Ho){this.#Ho=s;this.rootElement.classList.toggle("gsuiDragline-linked",!!s);s?this.redraw():this.#Jo()}}redraw(){if(this.#Ho){const t=this.#Ho.getBoundingClientRect();this.#Xo(t.left,t.top)}}#Xo(t,s){const i=this.#ps.main.classList;const e=this.#ps.main.style;const n=this.#ps.svg.style;const a=this.rootElement.getBoundingClientRect();const o=t-a.left;const r=s-a.top;const h=Math.abs(o);const c=Math.abs(r);const l=Math.max(h,c);const u=l*2;i.toggle("gsuiDragline-down",r>0);i.toggle("gsuiDragline-right",o>0);e.top=`${Math.min(r,0)}px`;e.left=`${Math.min(o,0)}px`;e.width=`${h}px`;e.height=`${c}px`;n.width=n.height=`${u}px`;n.margin=`${-l}px`;Q.En(this.#ps.svg,"viewBox",`0 0 ${u} ${u}`);Q.En(this.#ps.polyline,"points",`${l},${l} ${l+o},${l+r}`)}#Jo(){const t=this.#ps.main.style;const s=this.#ps.svg.style;t.top=t.left=t.width=t.height=s.width=s.height=s.margin="0px"}#Qo(){this.#Zo();if(this.#Ho){this.redraw()}else{this.#Jo()}}#Zo(){this.rootElement.classList.remove("gsuiDragline-dragging");this.#Vo.forEach((t=>{t.classList.remove("gsuiDragline-dropActive");delete t.onmouseup}));document.removeEventListener("mousemove",this.#_o);document.removeEventListener("mouseup",this.#qo);document.removeEventListener("keydown",this.#Uo)}#Yo(t){if(t.button===0){this.#Vo=this.getDropAreas();this.#Vo.forEach((t=>{t.onmouseup=this.#tr.bind(this);t.classList.add("gsuiDragline-dropActive")}));this.rootElement.classList.add("gsuiDragline-dragging");this.#_o=this.#sr.bind(this);this.#qo=this.#ir.bind(this);this.#Uo=this.#Ps.bind(this);document.addEventListener("mousemove",this.#_o);document.addEventListener("mouseup",this.#qo);document.addEventListener("keydown",this.#Uo);this.#sr(t)}}#Ps(t){if(t.key==="Escape"){this.#Qo()}}#tr(t){const s=t.currentTarget;if(s!==this.#Ho){this.onchange(s,this.#Ho);this.#Ho=s}this.#Zo();this.redraw();return false}#ir(){if(this.#Ho){this.onchange(null,this.#Ho);this.#Ho=null}this.#Qo()}#sr(t){this.#Xo(t.pageX,t.pageY)}}"use strict";Q.Ea("gsui-beatlines",(()=>[Q.Bn("div",{class:"gsuiBeatlines-bg gsuiBeatlines-measures"}),Q.Bn("div",{class:"gsuiBeatlines-bg gsuiBeatlines-beats"}),Q.Bn("div",{class:"gsuiBeatlines-bg gsuiBeatlines-steps"}),Q.Bn("div",{class:"gsuiBeatlines-bg gsuiBeatlines-beatsBG"})]));"use strict";class gt extends HTMLElement{connectedCallback(){if(!this.firstChild){this.append(...Q.Ln("gsui-beatlines"));Q.Va(this,{timedivision:"4/4",coloredbeats:true,pxperbeat:10})}}static get observedAttributes(){return["timedivision","pxperbeat"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"timedivision":this.style.setProperty("--gsui-bPM",`${i.split("/")[0]}em`);this.style.setProperty("--gsui-sPB",`${1/i.split("/")[1]}em`);break;case"pxperbeat":this.style.fontSize=`${i}px`;this.style.opacity=Math.min(i/48,1);break}}}}Object.freeze(gt);customElements.define("gsui-beatlines",gt);"use strict";class mt{static#er=Object.freeze({move:mt.#nr,cropA:mt.#ar,cropB:mt.#or});static#rr=Object.freeze({crop:mt.#hr,move:mt.#cr,deletion:mt.#lr,selection1:mt.#ur,selection2:mt.#dr});static#pr=Object.freeze({moving:mt.#gr,deleting:mt.#mr,"cropping-a":mt.#fr,"cropping-b":mt.#br,"selecting-1":mt.#wr,"selecting-2":mt.#vr});rootElement=null;timeline=null;#qi=null;#yr=null;#kr=10;#$r=10;#Or=null;#xr=new Map;#Sr=new Map;#Dr=new Map;#Cr=null;#Pr=null;#Mr="";#Ar=null;#Tr=null;#Br=null;#jr=0;#Lr=0;#Er=0;#Wr=0;#Ir=0;#Fr=0;#Kr=0;#zr=0;#Rr=null;#Nr=null;#Gr=Infinity;#Hr=Infinity;#Vr=-Infinity;#Ur=-Infinity;#qr=this.#sr.bind(this);#_r=this.#ir.bind(this);constructor(t){Object.seal(this);this.rootElement=t.rootElement;this.timeline=t.timeline;this.#yr=t;this.#yr.oneditBlock=t.oneditBlock||Q.Sn;this.#Or=t.blockDOMChange;this.#Cr=t.selectionElement;this.#Pr=t.rootElement.getElementsByClassName("gsui-row");t.rootElement.onkeydown=this.#Ps.bind(this)}getOpts(){return this.#yr}setData(t){this.#qi=t}setFontSize(t){this.#kr=t}setPxPerBeat(t){this.#$r=t}getFontSize(){return this.#kr}getPxPerBeat(){return this.#$r}getRows(){return this.#Pr}getBlocks(){return this.#xr}getSelectedBlocks(){return this.#Dr}#Yr(){return this.#Pr[0].getBoundingClientRect()}getRowByIndex(t){return this.#Pr[t]}getRowIndexByRow(t){return Array.prototype.indexOf.call(this.#Pr,t)}getRowIndexByPageY(t){const s=Math.floor((t-this.#Yr().top)/this.#kr);return Math.max(0,Math.min(s,this.#Pr.length-1))}getWhenByPageX(t){return Math.max(0,(t-this.#Yr().left)/this.#$r)}roundBeat(t){return Math.max(0,this.timeline.beatFloor(t))}#Jr(t){return t.classList.contains("gsuiBlocksManager-block")}#Xr(t){if(this.#Jr(t)){return t}else if(this.#Jr(t.parentNode)){return t.parentNode}else if(this.#Jr(t.parentNode.parentNode)){return t.parentNode.parentNode}}#Qr(t){if(t.classList.contains("gsuiBlocksManager-block-selected")){this.#Dr.forEach(((t,s)=>this.#Sr.set(s,t)))}else{this.#Sr.set(t.dataset.id,t)}return this.#Sr}#Zr(){return 1/this.timeline.stepsPerBeat*Q.za(this.timeline,"step")}#Ps(t){const s=this.#Sr;switch(t.key){case"Delete":case"Backspace":if(this.#Dr.size){this.#Dr.forEach(((t,i)=>s.set(i,t)));this.#Mr="deleting";this.#ir()}break;case"b":if(t.ctrlKey||t.altKey){if(this.#Dr.size){let t=Infinity;let i=0;s.clear();this.#Dr.forEach(((e,n)=>{const a=this.#qi[n];t=Math.min(t,a.when);i=Math.max(i,a.when+a.duration);s.set(n,e)}));i=this.timeline.beatCeil(i)-t;this.#yr.managercallDuplicating(s,i);s.clear()}t.preventDefault();t.stopPropagation()}break;case"a":case"d":if(t.ctrlKey||t.altKey){if(t.key==="d"){if(this.#Dr.size>0){this.#yr.managercallUnselecting()}}else if(this.#xr.size>this.#Dr.size){const t=[];this.#xr.forEach(((s,i)=>{if(!this.#qi[i].selected){t.push(i)}}));this.#yr.managercallSelecting(t)}t.preventDefault();t.stopPropagation()}break}}onmousedown(t){const s=this.#Xr(t.currentTarget);Q.Ha();this.#Tr=s;this.#Br=t.target;if(t.button===2){this.#Ar=mt.#rr.deletion;this.#Mr="deleting";if(s){this.#Or(s,"deleted",true);this.#Sr.set(s.dataset.id,s)}}else if(t.button===0){const i=this.getWhenByPageX(t.pageX);this.#jr=t.pageX;this.#Lr=t.pageY;this.#Er=this.roundBeat(i);this.#zr=this.#Zr();if(t.shiftKey){this.#Ar=mt.#rr.selection1;this.#Mr="selecting-1";this.#Wr=this.getRowIndexByPageY(t.pageY)}else if(s){const i=mt.#er[t.target.dataset.action];if(i){const e=this.#Qr(s);s.classList.add("gsui-hover");t.target.classList.add("gsui-hover");i.call(this,this.#qi,e,s,t)}}}document.addEventListener("mousemove",this.#qr);document.addEventListener("mouseup",this.#_r)}static#nr(t,s,i,e){this.#Ar=mt.#rr.move;this.#Mr="moving";this.#Wr=this.getRowIndexByPageY(e.pageY);s.forEach(((s,i)=>{const e=this.getRowIndexByRow(s.parentNode.parentNode);this.#Gr=Math.min(this.#Gr,t[i].when);this.#Hr=Math.min(this.#Hr,e);this.#Ur=Math.max(this.#Ur,e)}));this.#Gr*=-1;this.#Hr*=-1;this.#Ur=this.#Pr.length-1-this.#Ur}static#ar(t,s){this.#Ar=mt.#rr.crop;this.#Mr="cropping-a";this.#Gr=this.#Vr=Infinity;s.forEach(((s,i)=>{const e=t[i];this.#Gr=Math.min(this.#Gr,e.offset);this.#Vr=Math.min(this.#Vr,e.duration)}));this.#Gr*=-1;this.#Vr=Math.max(0,this.#Vr-this.#zr)}static#or(t,s){this.#Ar=mt.#rr.crop;this.#Mr="cropping-b";this.#Gr=this.#Vr=Infinity;s.forEach(((s,i)=>{this.#Gr=Math.min(this.#Gr,t[i].duration)}));this.#Gr=-Math.max(0,this.#Gr-this.#zr)}#sr(t){if(this.#Ar){if(t.type==="mousemove"){this.#Ir=t.pageX;this.#Fr=t.pageY}const s=this.getWhenByPageX(this.#Ir);this.#Kr=this.roundBeat(s);this.#Ar(t)}}static#hr(){const t=this.#Mr==="cropping-b";const s=this.#zr*Math.round((this.#Kr-this.#Er)/this.#zr);const i=Math.max(this.#Gr,Math.min(s,this.#Vr));if(i!==this.#Rr){this.#Rr=i;this.#Sr.forEach(((s,e)=>{const n={...this.#qi[e]};if(t){n.duration+=i}else{n.when+=i;n.offset+=i;n.duration-=i;this.#Or(s,"when",n.when)}this.#Or(s,"duration",n.duration);this.#yr.oneditBlock(e,n,s)}))}}static#cr(){const t=Math.max(this.#Gr,Math.round((this.#Kr-this.#Er)/this.#zr)*this.#zr);const s=Math.max(this.#Hr,Math.min(this.#Ur,this.getRowIndexByPageY(this.#Fr)-this.#Wr));if(t!==this.#Rr){this.#Rr=t;this.#Sr.forEach(((s,i)=>this.#Or(s,"when",this.#qi[i].when+t)))}if(s!==this.#Nr){this.#Nr=s;this.#Sr.forEach((t=>this.#Or(t,"row",s)))}}static#lr(t){const s=this.#Xr(t.target);if(s&&!this.#Sr.has(s.dataset.id)){this.#Or(s,"deleted",true);this.#Sr.set(s.dataset.id,s)}}static#ur(){if(Math.abs(this.#Ir-this.#jr)>6||Math.abs(this.#Fr-this.#Lr)>6){this.#Mr="selecting-2";this.#Cr.classList.remove("gsuiBlocksManager-selection-hidden");this.#Ar=mt.#rr.selection2;this.#Ar()}}static#dr(){const t=this.#kr;const s=this.#Cr.style;const i=this.getRowIndexByPageY(this.#Fr);const e=Math.min(this.#Er,this.#Kr);const n=this.#Zr()+Math.abs(this.#Er-this.#Kr);const a=Math.min(this.#Wr,i);const o=Math.max(this.#Wr,i);const r=this.getRowByIndex(a);const h=this.getRowByIndex(o);const c=Object.entries(this.#qi).reduce(((t,[s,i])=>{if(!this.#Dr.has(s)&&i.when<e+n&&i.when+i.duration>e){const i=this.#xr.get(s);const e=r.compareDocumentPosition(i);const n=h.compareDocumentPosition(i);if(e&Node.DOCUMENT_POSITION_CONTAINED_BY||n&Node.DOCUMENT_POSITION_CONTAINED_BY||e&Node.DOCUMENT_POSITION_FOLLOWING&&n&Node.DOCUMENT_POSITION_PRECEDING){this.#Or(i,"selected",true);t.set(s,i)}}return t}),new Map);s.top=`${a*t}px`;s.left=`${e*this.#$r}px`;s.width=`${n*this.#$r}px`;s.height=`${(o-a+1)*t}px`;this.#Sr.forEach(((t,s)=>this.#Or(t,"selected",c.has(s))));this.#Sr=c}#ir(){if(this.#Mr){mt.#pr[this.#Mr].call(this,this.#Sr,this.#Tr)}if(this.#Tr){this.#Tr.classList.remove("gsui-hover");this.#Br.classList.remove("gsui-hover")}this.#Mr="";this.#Ar=this.#Tr=this.#Br=null;this.#Rr=this.#Nr=null;this.#Gr=this.#Hr=Infinity;this.#Vr=this.#Ur=-Infinity;this.#Sr.clear();document.removeEventListener("mousemove",this.#qr);document.removeEventListener("mouseup",this.#_r)}static#gr(t){if(this.#Nr||Math.abs(this.#Rr)>1e-6){this.#yr.managercallMoving(t,this.#Rr,this.#Nr)}}static#mr(t){if(t.size||this.#Dr.size){this.#yr.managercallDeleting(t)}}static#fr(t){if(Math.abs(this.#Rr)>1e-6){this.#yr.managercallCroppingA(t,this.#Rr)}}static#br(t){if(Math.abs(this.#Rr)>1e-6){this.#yr.managercallCroppingB(t,this.#Rr)}}static#wr(t,s){if(s){s.classList.contains("gsuiBlocksManager-block-selected")?this.#yr.managercallUnselectingOne(s.dataset.id):this.#yr.managercallSelecting([s.dataset.id])}}static#vr(t){this.#Cr.classList.add("gsuiBlocksManager-selection-hidden");if(t.size){this.#yr.managercallSelecting(Array.from(t.keys()))}}}Object.freeze(mt);"use strict";Q.Ea("gsui-patternroll-block",(()=>Q.Bn("div",{class:"gsuiBlocksManager-block gsuiPatternroll-block","data-action":"move"},Q.Bn("div",{class:"gsuiBlocksManager-block-crop gsuiBlocksManager-block-cropA","data-action":"cropA"}),Q.Bn("div",{class:"gsuiBlocksManager-block-crop gsuiBlocksManager-block-cropB","data-action":"cropB"}),Q.Bn("div",{class:"gsuiPatternroll-block-header"},Q.Bn("span",{class:"gsuiPatternroll-block-name"})),Q.Bn("div",{class:"gsuiPatternroll-block-content"}),Q.Bn("div",{class:"gsuiPatternroll-block-placeholder"},Q.Bn("i",{class:"gsuiPatternroll-block-placeholderIcon gsuiIcon","data-icon":"file-corrupt"}),Q.Bn("span",{class:"gsuiPatternroll-block-placeholderText"},"missing data")))));"use strict";class ft extends HTMLElement{#th=new Map;#sh=Q.Bn("gsui-tracklist");#ih=Q.Bn("div",{class:"gsuiBlocksManager-selection gsuiBlocksManager-selection-hidden"});#eh=Q.Bn("gsui-timewindow",{panelsize:90,panelsizemin:24,panelsizemax:160,lineheight:40,lineheightmin:20,lineheightmax:68,pxperbeat:32,pxperbeatmin:8,pxperbeatmax:160});#nh=new mt({rootElement:this,selectionElement:this.#ih,timeline:this.#eh.timeline,blockDOMChange:this.#Or.bind(this),managercallMoving:(t,s,i)=>this.onchange("move",Array.from(t.keys()),s,i),managercallDeleting:t=>this.onchange("deletion",Array.from(t.keys())),managercallSelecting:t=>this.onchange("selection",t),managercallUnselecting:()=>this.onchange("unselection"),managercallUnselectingOne:t=>this.onchange("unselectionOne",t),managercallDuplicating:(t,s)=>this.onchange("duplicate",s),managercallCroppingA:(t,s)=>this.onchange("cropStart",Array.from(t.keys()),s),managercallCroppingB:(t,s)=>this.onchange("cropEnd",Array.from(t.keys()),s)});constructor(){super();this.timeline=this.#eh.timeline;this.onchange=this.onaddBlock=this.oneditBlock=null;Object.seal(this);Q.zn(this,{gsuiTimewindow:{pxperbeat:t=>this.#ah(t.args[0]),lineheight:t=>this.#oh(t.args[0])}});this.#ah(32);this.#oh(40)}connectedCallback(){if(!this.firstChild){this.classList.add("gsuiBlocksManager");Q.En(this,"tabindex",-1);this.append(this.#eh);this.#eh.querySelector(".gsuiTimewindow-panelContent").append(this.#sh);this.#eh.querySelector(".gsuiTimewindow-mainContent").append(this.#ih);this.#eh.querySelector(".gsuiTimewindow-rows").ondrop=this.#rh.bind(this);this.#eh.querySelector("gsui-beatlines").removeAttribute("coloredbeats")}}static get observedAttributes(){return["currenttime"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"currenttime":Q.En(this.#eh,"currenttime",i);break}}}addTrack(t){const s=this.#sh.addTrack(t);const i=s.rowElement;i.classList.toggle("gsui-row-small",this.#nh.getFontSize()<=44);i.onmousedown=this.#hh.bind(this);this.#th.set(i.dataset.id,i);this.#eh.querySelector(".gsuiTimewindow-rows").append(i)}removeTrack(t){this.#sh.removeTrack(t)}toggleTrack(t,s){Q.En(this.#sh.getTrack(t),"mute",!s)}renameTrack(t,s){Q.En(this.#sh.getTrack(t),"name",s)}reorderTrack(t,s){Q.En(this.#sh.getTrack(t),"order",s)}addBlock(t,s,{dataReady:i}){const e=Q.Ln("gsui-patternroll-block");e.dataset.id=t;e.dataset.pattern=s.pattern;e.onmousedown=this.#ch.bind(this,t);Q.En(e,"data-missing",!i);this.#nh.getBlocks().set(t,e);this.onaddBlock(t,s,e)}removeBlock(t){this.#nh.getBlocks().get(t).remove();this.#nh.getBlocks().delete(t);this.#nh.getSelectedBlocks().delete(t)}changeBlockProp(t,s,i){const e=this.#nh.getBlocks().get(t);this.#Or(e,s,i);if(s==="track"){e.dataset.track=i}else if(s==="selected"){i?this.#nh.getSelectedBlocks().set(t,e):this.#nh.getSelectedBlocks().delete(t)}}updateBlockViewBox(t,s){this.oneditBlock(t,s,this.#nh.getBlocks().get(t))}setData(t){this.#nh.setData(t)}setCallbacks(t){this.onchange=t.onchange;this.onaddBlock=t.onaddBlock;this.oneditBlock=t.oneditBlock;this.#nh.getOpts().oneditBlock=t.oneditBlock}getBlocks(){return this.#nh.getBlocks()}timedivision(t){Q.En(this.#eh,"timedivision",t)}loop(t,s){Q.En(this.#eh,"loop",Number.isFinite(t)&&`${t}-${s}`)}#Or(t,s,i){switch(s){case"when":t.style.left=`${i}em`;break;case"duration":t.style.width=`${i}em`;break;case"deleted":t.classList.toggle("gsuiBlocksManager-block-hidden",!!i);break;case"selected":t.classList.toggle("gsuiBlocksManager-block-selected",!!i);break;case"row":this.#Or(t,"track",this.#lh(t.dataset.track,i));break;case"track":{const s=this.#uh(i);s&&s.firstElementChild.append(t)}break}}#uh(t){return this.#th.get(t)}#lh(t,s){const i=this.#uh(t);const e=this.#nh.getRowIndexByRow(i)+s;return this.#nh.getRowByIndex(e).dataset.id}#ah(t){this.#nh.setPxPerBeat(t)}#oh(t){this.#nh.setFontSize(t);Array.from(this.#nh.getRows()).forEach((s=>s.classList.toggle("gsui-row-small",t<=44)))}#hh(t){this.#nh.onmousedown(t);if(t.button===0&&!t.shiftKey&&this.#nh.getSelectedBlocks().size){this.onchange("unselection")}}#ch(t,s){s.stopPropagation();this.#nh.onmousedown(s)}#rh(t){const s=t.dataTransfer.getData("pattern-buffer")||t.dataTransfer.getData("pattern-slices")||t.dataTransfer.getData("pattern-drums")||t.dataTransfer.getData("pattern-keys");if(s){const i=this.#nh.roundBeat(this.#nh.getWhenByPageX(t.pageX));const e=this.#nh.getRowByIndex(this.#nh.getRowIndexByPageY(t.pageY)).dataset.id;this.onchange("add",s,i,e)}}}Object.freeze(ft);customElements.define("gsui-patternroll",ft);"use strict";Q.Ea("gsui-pianoroll-block",(()=>Q.Bn("div",{class:"gsuiBlocksManager-block gsuiPianoroll-block","data-action":"move"},Q.Bn("div",{class:"gsuiDragline-drop"}),Q.Bn("div",{class:"gsuiBlocksManager-block-crop gsuiBlocksManager-block-cropB","data-action":"cropB"}))));"use strict";class bt extends HTMLElement{#dh={};#ph=1;#gh=Q.Bn("gsui-slidergroup",{beatlines:""});#ih=Q.Bn("div",{class:"gsuiBlocksManager-selection gsuiBlocksManager-selection-hidden"});#mh=Q.Bn("select",{class:"gsuiPianoroll-slidersSelect",size:6},Q.Bn("option",{value:"gain",selected:""},"gain"),Q.Bn("option",{value:"pan"},"pan"),Q.Bn("option",{value:"lowpass"},"lowpass"),Q.Bn("option",{value:"highpass"},"highpass"),Q.Bn("option",{value:"gainLFOSpeed"},"gain.lfo.speed"),Q.Bn("option",{value:"gainLFOAmp"},"gain.lfo.amp"));#eh=Q.Bn("gsui-timewindow",{panelsize:100,panelsizemin:100,panelsizemax:130,lineheight:20,lineheightmin:12,lineheightmax:32,pxperbeat:64,pxperbeatmin:20,pxperbeatmax:200,downpanel:"",downpanelsize:120,downpanelsizemin:120,downpanelsizemax:160});#nh=new mt({rootElement:this,selectionElement:this.#ih,timeline:this.#eh.timeline,blockDOMChange:this.#Or.bind(this),managercallDuplicating:(t,s)=>this.onchange("clone",Array.from(t.keys()),s),managercallSelecting:t=>this.onchange("selection",t),managercallUnselecting:()=>this.onchange("unselection"),managercallUnselectingOne:t=>this.onchange("unselectionOne",t),managercallMoving:(t,s,i)=>this.onchange("move",Array.from(t.keys()),s,i),managercallCroppingB:(t,s)=>this.onchange("cropEnd",Array.from(t.keys()),s),managercallDeleting:t=>this.onchange("remove",Array.from(t.keys()))});constructor(){super();this.timeline=this.#eh.timeline;this.uiKeys=Q.Bn("gsui-keys");this.onchange=null;Object.seal(this);Q.zn(this,{gsuiTimewindow:{pxperbeat:t=>this.#ah(t.args[0]),lineheight:t=>this.#oh(t.args[0])},gsuiTimeline:{inputLoop:t=>this.#fh(false,...t.args),changeLoop:t=>this.#fh(true,...t.args),changeCurrentTime:t=>this.#bh(t.args[0])},gsuiSliderGroup:{input:t=>this.#wh(t.args[1]),inputEnd:()=>this.#vh(),change:t=>this.#yh(t)}});this.#mh.onchange=this.#kh.bind(this);this.#ah(64);this.#oh(20);this.#kh();this.reset()}connectedCallback(){if(!this.firstChild){this.classList.add("gsuiBlocksManager");Q.En(this,"tabindex",-1);this.append(this.#eh);this.#eh.querySelector(".gsuiTimewindow-panelContent").append(this.uiKeys);this.#eh.querySelector(".gsuiTimewindow-panelContentDown").prepend(this.#mh);this.#eh.querySelector(".gsuiTimewindow-contentDown").prepend(this.#gh);this.#eh.querySelector(".gsuiTimewindow-mainContent").append(this.#ih);this.scrollToMiddle()}}static get observedAttributes(){return["disabled","currenttime"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"disabled":Q.En(this.#eh,"disabled",i);break;case"currenttime":Q.En(this.#eh,"currenttime",i);Q.En(this.#gh,"currenttime",i);break}}}reset(){this.#ph=1}setData(t){this.#nh.setData(t)}setCallbacks(t){this.onchange=t.onchange}timedivision(t){Q.En(this.#eh,"timedivision",t);Q.En(this.#gh,"timedivision",t)}loop(t,s){Q.En(this.#eh,"loop",Number.isFinite(t)&&`${t}-${s}`);Q.En(this.#gh,"loopa",t);Q.En(this.#gh,"loopb",s)}scrollToMiddle(){this.#eh.scrollTop=this.#eh.querySelector(".gsuiTimewindow-rows").clientHeight/2}scrollToKeys(){const t=this.#eh.querySelector(".gsuiBlocksManager-block");if(t){const s=+t.dataset.keyNote;const i=+this.#eh.querySelector(".gsui-row").dataset.midi;this.#eh.scrollTop=(i-s-3.5)*Q.za(this.#eh,"lineheight")}}octaves(t,s){const i=this.uiKeys.octaves(t,s);Object.keys(this.#dh).forEach((t=>delete this.#dh[t]));i.forEach((t=>{const s=+t.dataset.midi;t.onmousedown=this.#hh.bind(this,s);this.#dh[s]=t}));this.#eh.querySelector(".gsuiTimewindow-rows").append(...i);this.#eh.querySelector(".gsuiTimewindow-rows").style.height=`${i.length}em`;this.scrollToMiddle();this.reset()}addKey(t,s){const i=Q.Ln("gsui-pianoroll-block");const e=new pt;i.dataset.id=t;i.onmousedown=this.#ch.bind(this,t);e.onchange=this.#$h.bind(this,t);i._dragline=e;i._draglineDrop=i.querySelector(".gsuiDragline-drop");i.append(e.rootElement);e.getDropAreas=this.#Oh.bind(this,t);this.#nh.getBlocks().set(t,i);s.selected?this.#nh.getSelectedBlocks().set(t,i):this.#nh.getSelectedBlocks().delete(t);this.#gh.set(t,s.when,s.duration,s[this.#mh.value]);this.#Or(i,"key",s.key);this.#Or(i,"when",s.when);this.#Or(i,"duration",s.duration);this.#Or(i,"selected",s.selected);this.#Or(i,"pan",s.pan);this.#Or(i,"gain",s.gain);this.#Or(i,"lowpass",s.lowpass);this.#Or(i,"highpass",s.highpass);this.#Or(i,"gainLFOSpeed",s.gainLFOSpeed);this.#Or(i,"gainLFOAmp",s.gainLFOAmp);this.#Or(i,"prev",s.prev);this.#Or(i,"next",s.next)}removeKey(t){const s=this.#nh.getBlocks().get(t);const i=this.#nh.getBlocks().get(s.dataset.prev);s.remove();if(i){i._dragline.linkTo(null)}this.#nh.getBlocks().delete(t);this.#nh.getSelectedBlocks().delete(t);this.#gh.delete(t)}changeKeyProp(t,s,i){const e=this.#nh.getBlocks().get(t);this.#Or(e,s,i);if(i===null){delete e.dataset[s]}else{e.dataset[s==="key"?"keyNote":s]=i}if(s==="selected"){i?this.#nh.getSelectedBlocks().set(t,e):this.#nh.getSelectedBlocks().delete(t)}}#Or(t,s,i){switch(s){case"when":t.style.left=`${i}em`;this.#gh.setProp(t.dataset.id,"when",i);this.#xh(t);break;case"duration":t.style.width=`${i}em`;this.#gh.setProp(t.dataset.id,"duration",i);this.#ph=i;this.#xh(t);break;case"deleted":t.classList.toggle("gsuiBlocksManager-block-hidden",!!i);break;case"selected":t.classList.toggle("gsuiBlocksManager-block-selected",!!i);this.#gh.setProp(t.dataset.id,"selected",!!i);break;case"row":this.#Or(t,"key",t.dataset.keyNote-i);break;case"key":{const s=this.#Sh(i);t.dataset.key=yt.keyNames.en[s.dataset.key];s.firstElementChild.append(t);this.#xh(t)}break;case"prev":{const s=this.#nh.getBlocks().get(i);t.classList.toggle("gsuiPianoroll-block-prevLinked",!!i);s&&s._dragline.linkTo(t._draglineDrop)}break;case"next":{const s=this.#nh.getBlocks().get(i);t.classList.toggle("gsuiPianoroll-block-nextLinked",!!i);t._dragline.linkTo(s&&s._draglineDrop)}break;case"pan":case"gain":case"lowpass":case"highpass":this.#Dh(s,t,i);break;case"gainLFOAmp":case"gainLFOSpeed":this.#Dh(s,t,bt.#Ch(i));break}}#Dh(t,s,i){if(this.#mh.value===t){this.#gh.setProp(s.dataset.id,"value",i)}}#xh(t){const s=this.#nh.getBlocks().get(t.dataset.prev);t._dragline.redraw();s&&s._dragline.redraw()}#Sh(t){return this.#dh[t]}#ah(t){this.#nh.setPxPerBeat(t);this.#nh.getBlocks().forEach((t=>t._dragline.redraw()));Q.En(this.#gh,"pxperbeat",t)}#oh(t){this.#nh.setFontSize(t);Array.from(this.#nh.getRows()).forEach((s=>s.classList.toggle("gsui-row-small",t<=44)));this.#nh.getBlocks().forEach((t=>t._dragline.redraw()))}#bh(t){Q.En(this.#gh,"currenttime",t);return true}#fh(t,s,i){Q.En(this.#gh,"loopa",s);Q.En(this.#gh,"loopb",i);return t}#wh(t){const s=this.#mh.value;Array.prototype.find.call(this.#mh.children,(t=>t.value===s)).dataset.number=(s.startsWith("gainLFO")?bt.#Ph(t):t).toFixed(2)}#vh(){const t=this.#mh.value;delete Array.prototype.find.call(this.#mh.children,(s=>s.value===t)).dataset.number}#yh(t){const s=this.#mh.value;t.component="gsuiPianoroll";t.eventName="changeKeysProps";if(s.startsWith("gainLFO")){t.args[0].forEach((t=>t[1]=bt.#Ph(t[1])))}t.args.unshift(s);return true}static#Ph(t){switch(t){case 6:return 4;case 5:return 3.5;case 4:return 3;case 3:return 2.5;case 2:return 2;case 1:return 1.5;default:return 1;case-1:return.75;case-2:return.5;case-3:return.4;case-4:return.3333;case-5:return.2857;case-6:return.25}}static#Ch(t){if(t>=4){return 6}if(t>=3.5){return 5}if(t>=3){return 4}if(t>=2.5){return 3}if(t>=2){return 2}if(t>=1.5){return 1}if(t>=1){return 0}if(t>=.75){return-1}if(t>=.5){return-2}if(t>=.4){return-3}if(t>=.3333){return-4}if(t>=.2857){return-5}if(t>=.25){return-6}}#ch(t,s){const i=s.currentTarget._dragline.rootElement;s.stopPropagation();if(!i.contains(s.target)){this.#nh.onmousedown(s)}}#hh(t,s){this.#nh.onmousedown(s);if(s.button===0&&!s.shiftKey){const i=this.#nh.roundBeat(this.#nh.getWhenByPageX(s.pageX));this.onchange("add",t,i,this.#ph)}}#kh(){const t=this.#mh.value;const s=this.#gh;switch(t){case"pan":s.options({min:-1,max:1,def:0,step:.05});break;case"gain":s.options({min:0,max:1,def:.8,step:.025});break;case"lowpass":s.options({min:0,max:1,def:1,step:.025,exp:3});break;case"highpass":s.options({min:0,max:1,def:1,step:.025,exp:3});break;case"gainLFOAmp":s.options({min:-6,max:6,def:0,step:1});break;case"gainLFOSpeed":s.options({min:-6,max:6,def:0,step:1});break}this.#nh.getBlocks().forEach(((s,i)=>{const e=+s.dataset[t];const n=t.startsWith("gainLFO")?bt.#Ch(e):e;this.#gh.setProp(i,"value",n)}))}#Oh(t){const s=this.#nh.getBlocks().get(t).dataset;const i=+s.when+ +s.duration;const e=[];this.#nh.getBlocks().forEach((s=>{const n=s.dataset;if(+n.when>=i&&(n.prev===undefined||n.prev===t)){e.push(s.firstElementChild)}}));return e}#$h(t,s){this.onchange("redirect",t,s?s.parentNode.dataset.id:null)}}Object.freeze(bt);customElements.define("gsui-pianoroll",bt);"use strict";Q.Ea("gsui-drumrows",(()=>[Q.Bn("div",{class:"gsuiDrumrows-drop"},Q.Bn("div",{class:"gsuiDrumrows-dropIn"},Q.Bn("i",{class:"gsuiIcon","data-icon":"arrow-dropdown"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"arrow-dropdown"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"arrow-dropdown"})))]));Q.Ea("gsui-drumrow",(()=>Q.Bn("form",{class:"gsuiDrumrow",draggable:"true"},Q.Bn("div",{class:"gsuiDrumrow-grip"},Q.Bn("i",{class:"gsuiIcon","data-icon":"grip-v"})),Q.Bn("div",{class:"gsuiDrumrow-main"},Q.Bn("gsui-toggle",{title:"Toggle the drumrow (right click for solo)"}),Q.Bn("button",{type:"button",class:"gsuiIcon gsuiDrumrow-btnProps","data-action":"props","data-icon":"drumprops",title:"Expand props panel"}),Q.Bn("button",{type:"button",class:"gsuiIcon gsuiDrumrow-btnDelete","data-action":"delete","data-icon":"close",title:"Remove the drumrow"}),Q.Bn("span",{class:"gsuiDrumrow-name"}),Q.Bn("div",{class:"gsuiDrumrow-waveWrap"}),Q.Bn("div",{class:"gsuiDrumrow-detune",title:"pitch"},Q.Bn("gsui-slider",{type:"linear-y",min:-12,max:12,step:1,"mousemove-size":400,"data-prop":"detune"})),Q.Bn("div",{class:"gsuiDrumrow-pan",title:"pan"},Q.Bn("gsui-slider",{type:"linear-y",min:-1,max:1,step:.02,"mousemove-size":400,"data-prop":"pan"})),Q.Bn("div",{class:"gsuiDrumrow-gain",title:"gain"},Q.Bn("gsui-slider",{type:"linear-y",min:0,max:1,step:.01,"mousemove-size":400,"data-prop":"gain"}))),Q.Bn("div",{class:"gsuiDrumrow-props"},Q.Bn("label",{class:"gsuiDrumrow-prop gsuiDrumrow-propDetune",tabindex:0},Q.Bn("input",{class:"gsuiDrumrow-propRadio",type:"radio",name:"prop",value:"detune"},"pitch"),Q.Bn("span",{class:"gsuiDrumrow-propSpan"},"pitch")),Q.Bn("label",{class:"gsuiDrumrow-prop gsuiDrumrow-propPan",tabindex:0},Q.Bn("input",{class:"gsuiDrumrow-propRadio",type:"radio",name:"prop",value:"pan"},"pan"),Q.Bn("span",{class:"gsuiDrumrow-propSpan"},"pan")),Q.Bn("label",{class:"gsuiDrumrow-prop gsuiDrumrow-propGain",tabindex:0},Q.Bn("input",{class:"gsuiDrumrow-propRadio",type:"radio",name:"prop",value:"gain"},"gain"),Q.Bn("span",{class:"gsuiDrumrow-propSpan"},"gain"))),Q.Bn("div",{class:"gsuiDrumrows-drop"},Q.Bn("div",{class:"gsuiDrumrows-dropIn"},Q.Bn("i",{class:"gsuiIcon","data-icon":"arrow-dropdown"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"arrow-dropdown"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"arrow-dropdown"}))))));"use strict";class wt extends HTMLElement{#Mh=new Map;#Ah=new Map;#Th=null;#Bh=null;#jh=null;#Lh=null;#La=Q.La.bind(null,this,"gsuiDrumrows");#Eh=new dt({rootElement:this,direction:"column",dataTransferType:"drumrow",itemSelector:".gsuiDrumrow",handleSelector:".gsuiDrumrow-grip",parentSelector:"gsui-drumrows",onchange:this.#Wh.bind(this)});constructor(){super();Object.seal(this);this.ondrop=this.#Ih.bind(this);this.onclick=this.#Fh.bind(this);this.onchange=this.#Kh.bind(this);this.ondragover=this.#zh.bind(this);this.ondragstart=t=>t.stopPropagation();this.onmousedown=this.#Rh.bind(this);this.oncontextmenu=this.#Nh.bind(this);this.onanimationend=this.#Gh.bind(this);Q.zn(this,{gsuiToggle:{toggle:(t,s)=>{const i=s.parentNode.parentNode.dataset.id;this.#io(i,t.args[0]);this.#La("change","toggleDrumrow",i,t.args[0])},toggleSolo:(t,s)=>{const i=s.parentNode.parentNode.dataset.id;this.#io(i,true);this.#La("change","toggleSoloDrumrow",i)}}})}connectedCallback(){if(!this.firstChild){this.append(...Q.Ln("gsui-drumrows"))}}setLinesParent(t,s){this.#jh=t;this.#Eh.setShadowElement(t);this.#Eh.setShadowChildClass(s)}reorderDrumrows(t){dt.listReorder(this,t);dt.listReorder(this.#jh,t)}playRow(t){this.#Mh.get(t).root.querySelector(".gsuiDrumrow-waveWrap").append(Q.Bn("div",{class:"gsuiDrumrow-startCursor"}))}stopRow(t){this.#Mh.get(t).root.querySelectorAll(".gsuiDrumrow-startCursor").forEach((t=>t.remove()))}setPropFilter(t,s){this.#Mh.get(t).root.querySelector(`.gsuiDrumrow-propRadio[value="${s}"]`).checked=true}setDrumPropValue(t,s,i){const e=this.#Hh(t,s);const n=s==="detune"?i:i.toFixed(2);const a=s!=="gain"?`${i>0?"+":""}${n}`:n;e.classList.add("gsuiDrumrow-propSpanValue");e.textContent=a}removeDrumPropValue(t,s){const i=this.#Hh(t,s);i.classList.remove("gsuiDrumrow-propSpanValue");i.textContent=s==="detune"?"pitch":s}add(t,s){const i=Q.Wn(Q.Ln("gsui-drumrow"),{root:".gsuiDrumrow",name:".gsuiDrumrow-name",toggle:"gsui-toggle",detune:".gsuiDrumrow-detune gsui-slider",gain:".gsuiDrumrow-gain gsui-slider",pan:".gsuiDrumrow-pan gsui-slider"});i.root.dataset.id=s.dataset.id=t;this.#Mh.set(t,i);this.#Ah.set(t,s);this.append(i.root);this.#jh.append(s);Q.zn(i.root,{gsuiSlider:{change:(s,i)=>this.#Vh(t,i.dataset.prop,s.args[0]),input:(s,i)=>{this.#Uh(t,i.dataset.prop,s.args[0]);this.#La("liveChangeDrumrow",t,i.dataset.prop,s.args[0])},inputStart:Q.Sn,inputEnd:()=>this.#qh(t)}})}remove(t){this.#Mh.get(t).root.remove();this.#Ah.get(t).remove();this.#Mh.delete(t);this.#Ah.delete(t)}change(t,s,i){switch(s){case"pan":this.#_h(t,i);break;case"name":this.#Yh(t,i);break;case"gain":this.#Jh(t,i);break;case"order":this.#Xh(t,i);break;case"detune":this.#Qh(t,i);break;case"toggle":this.#io(t,i);break;case"pattern":this.#et(t,i);break;case"duration":this.#tt(t,i);break}}#_h(t,s){this.#Mh.get(t).pan.setValue(s)}#Jh(t,s){this.#Mh.get(t).gain.setValue(s)}#Qh(t,s){this.#Mh.get(t).detune.setValue(s)}#Yh(t,s){const i=this.#Mh.get(t).name;i.dataset.name=i.textContent=s}#io(t,s){Q.En(this.#Mh.get(t).toggle,"off",!s);this.#Mh.get(t).root.classList.toggle("gsuiDrumrow-mute",!s);this.#Ah.get(t).classList.toggle("gsuiDrumrow-mute",!s)}#tt(t,s){this.#Mh.get(t).root.querySelector(".gsuiDrumrow-waveWrap").style.animationDuration=`${s*2}s`}#et(t,s){const i=this.#Mh.get(t).root.querySelector(".gsuiDrumrow-waveWrap");Q.Ga(i);if(s){s.classList.add("gsuiDrumrow-wave");i.append(s)}}#Xh(t,s){this.#Mh.get(t).root.dataset.order=this.#Ah.get(t).dataset.order=s}#Uh(t,s,i){const e=this.#Mh.get(t).name;const n=s==="pan"?`pan: ${i>0?"+":""}${i.toFixed(2)}`:s==="gain"?`gain: ${i.toFixed(2)}`:`pitch: ${i>0?"+":""}${i}`;e.textContent=n;e.classList.add("gsuiDrumrow-nameInfo")}#Zh(t){this.#Mh.get(t).root.classList.toggle("gsuiDrumrow-open");this.#Ah.get(t).classList.toggle("gsuiDrums-lineOpen")}#Hh(t,s){return this.#Mh.get(t).root.querySelector(`.gsuiDrumrow-propRadio[value="${s}"] + .gsuiDrumrow-propSpan`)}#qh(t){const s=this.#Mh.get(t).name;s.textContent=s.dataset.name;s.classList.remove("gsuiDrumrow-nameInfo")}#Vh(t,s,i){this.#La("change","changeDrumrow",t,s,i)}#Wh(t){const s=dt.listComputeOrderChange(this,{});this.#La("change","reorderDrumrow",t.dataset.id,s)}#Kh(t){const s=t.target.closest(".gsuiDrumrow").dataset.id;this.#La("propFilter",s,t.target.value)}#Fh(t){if(t.target!==this){const s=t.target.closest(".gsuiDrumrow").dataset.id;switch(t.target.dataset.action){case"props":this.#Zh(s);break;case"delete":this.#La("change","removeDrumrow",s);break}}}#Rh(t){if((t.button===0||t.button===2)&&t.target.classList.contains("gsuiDrumrow-main")){this.#La(t.button===0?"liveStartDrum":"liveStopDrum",t.target.parentNode.dataset.id)}}#Gh(t){if(t.target.classList.contains("gsuiDrumrow-startCursor")){t.target.remove()}}#Nh(t){t.preventDefault();if(t.target.classList.contains("gsuiDrumrow-propSpan")){this.#La("propFilters",t.target.previousElementSibling.value)}}#Ih(t){if(this.#Th){const s=t.dataTransfer.getData("pattern-buffer");if(s){this.#Th===Infinity?this.#La("change","addDrumrow",s):this.#La("change","changeDrumrowPattern",this.#Th,s)}}this.#tc()}#tc(){if(this.#Bh){this.#Bh.classList.remove("gsuiDrumrows-dragover");this.#Bh=this.#Th=null}}#zh(t){if(t.dataTransfer.types.includes("pattern-buffer")){const s=t.target;const i=s.nodeName==="GSUI-DRUMROWS";const e=i?s:s.closest(".gsuiDrumrow");clearTimeout(this.#Lh);this.#Lh=setTimeout((()=>this.#tc()),125);if(e!==this.#Bh){this.#Th=null;if(i){this.#Th=Infinity}else if(e){this.#Th=e.dataset.id}if(this.#Bh){this.#Bh.classList.remove("gsuiDrumrows-dragover")}this.#Bh=e;if(e){e.classList.add("gsuiDrumrows-dragover")}}}}}Object.freeze(wt);customElements.define("gsui-drumrows",wt);"use strict";Q.Ea("gsui-drums-line",(()=>Q.Bn("div",{class:"gsuiDrums-line"},Q.Bn("div",{class:"gsuiDrums-lineDrums"},Q.Bn("div",{class:"gsuiDrums-lineIn"})),Q.Bn("div",{class:"gsuiDrums-lineProps"},Q.Bn("gsui-slidergroup")))));Q.Ea("gsui-drums-drum",(()=>Q.Bn("div",{class:"gsuiDrums-drum"},Q.Bn("div",{class:"gsuiDrums-drumIn"},["detune","pan","gain"].map((t=>Q.Bn("div",{class:"gsuiDrums-drumProp","data-value":t},Q.Bn("div",{class:"gsuiDrums-drumPropValue"}))))))));Q.Ea("gsui-drums-drumcut",(()=>Q.Bn("div",{class:"gsuiDrums-drumcut"},Q.Bn("div",{class:"gsuiDrums-drumcutIn"},Q.Bn("i",{class:"gsuiIcon","data-icon":"drumcut"})))));"use strict";class vt extends HTMLElement{#eh=Q.Bn("gsui-timewindow",{panelsize:140,panelsizemin:70,panelsizemax:240,lineheight:48,lineheightmin:48,lineheightmax:48,pxperbeatmin:50,pxperbeatmax:160});#sc=0;#ic=0;#ec=4;#$r=70;#nc=this.#$r/this.#ec;#ac="";#oc=null;#rc=0;#hc="";#cc=new Map;#lc=new Map;#uc=new Map;#dc=null;#pc=null;#gc=Q.Bn("div",{class:"gsuiDrums-drumHover"},Q.Bn("div",{class:"gsuiDrums-drumHoverIn"}));#mc=Q.Bn("div",{class:"gsuiDrums-drumcutHover"},Q.Bn("div",{class:"gsuiDrums-drumcutHoverIn"}));#fc=this.#gc;#bc=this.#wc.bind(this);#vc=this.#yc.bind(this);#La=Q.La.bind(null,this,"gsuiDrums");constructor(){super();this.timeline=this.#eh.timeline;this.drumrows=Q.Bn("gsui-drumrows");Object.seal(this);Q.zn(this,{gsuiTimewindow:{pxperbeat:t=>{this.setPxPerBeat(t.args[0])}},gsuiSliderGroup:{change(t,s){t.args.unshift(s.dataset.currentProp);return true},input:(t,s)=>{this.changeDrumProp(t.args[0],s.dataset.currentProp,t.args[1]);t.args=[s.dataset.id,t.args[0],s.dataset.currentProp,t.args[1]];return true},inputEnd(t,s){t.args=[s.dataset.id,s.dataset.currentProp];return true}}});Q.En(this.#eh,"step",1);this.#eh.onscroll=this.#kc.bind(this);this.#gc.remove();this.#mc.remove();this.#gc.onmousedown=this.#$c.bind(this,"Drums");this.#mc.onmousedown=this.#$c.bind(this,"Drumcuts")}connectedCallback(){if(!this.firstChild){Q.En(this,"tabindex",-1);this.append(this.#eh);this.#eh.querySelector(".gsuiTimewindow-panelContent").append(this.drumrows);this.#pc=this.#eh.querySelector(".gsuiTimewindow-currentTime");this.#dc=this.#eh.querySelector(".gsuiTimewindow-rows");this.#dc.onmousemove=this.#vc;this.#dc.onmouseleave=this.#Oc.bind(this);this.drumrows.setLinesParent(this.#dc,"gsuiDrums-line")}}static get observedAttributes(){return["disabled","currenttime"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"disabled":Q.En(this.#eh,"disabled",i);break;case"currenttime":Q.En(this.#eh,"currenttime",i);break}}}loop(t,s){Q.En(this.#eh,"loop",t!==false&&`${t}-${s}`)}timedivision(t){const s=t.split("/")[1];this.#ec=s;Q.En(this.#eh,"timedivision",t);Q.En(this.#eh,"currenttimestep",1/s);this.setPxPerBeat(this.#$r);this.#gc.style.width=this.#mc.style.width=this.#pc.style.width=`${1/s}em`}setFontSize(t){Q.En(this.#eh,"lineheight",t)}setPxPerBeat(t){this.#$r=t;this.#nc=t/this.#ec;Q.En(this.#eh,"pxperbeat",t);this.#uc.forEach((s=>Q.En(s,"pxperbeat",t)))}setPropValues(t,s,i){const e=this.#uc.get(t);this.#xc(`line[data-id='${t}']`).dataset.prop=s;e.dataset.currentProp=s;switch(s){case"pan":e.options({min:-1,max:1,step:.05,def:0});break;case"gain":e.options({min:0,max:1,step:.025,def:.8});break;case"detune":e.options({min:-12,max:12,step:1,def:0});break}i.forEach((t=>e.setProp(t[0],"value",t[1])))}addDrum(t,s){const i=this.#uc.get(s.row);this.#Sc(t,"drum",s,"gsui-drums-drum");i.set(t,s.when,1/this.#ec,0)}removeDrum(t){const s=this.#cc.get(t)[0];this.#uc.get(s).delete(t);this.#Dc(t)}addDrumcut(t,s){this.#Sc(t,"drumcut",s,"gsui-drums-drumcut")}removeDrumcut(t){this.#Dc(t)}createDrumrow(t){const s=Q.Ln("gsui-drums-line");const i=s.querySelector("gsui-slidergroup");Q.En(i,"pxperbeat",this.#$r);i.dataset.id=t;this.#uc.set(t,i);return s}changeDrum(t,s,i){const e=this.#cc.get(t)[0];const n=this.#uc.get(e);this.changeDrumProp(t,s,i);if(s===n.dataset.currentProp){n.setProp(t,"value",i)}}changeDrumProp(t,s,i){const e=`.gsuiDrums-drumProp[data-value="${s}"] .gsuiDrums-drumPropValue`;const n=this.#cc.get(t)[3].querySelector(e).style;switch(s){case"detune":n.left=i>0?"50%":`${(1+i/12)*50}%`;n.width=`${Math.abs(i/12)*50}%`;break;case"pan":n.left=i>0?"50%":`${(1+i)*50}%`;n.width=`${Math.abs(i)*50}%`;break;case"gain":n.left=0;n.width=`${i*100}%`;break}}#Sc(t,s,i,e){const n=Q.Ln(e);const a=1/this.#ec;n.dataset.id=t;n.style.left=`${i.when}em`;n.style.width=`${a}em`;this.#xc(`line[data-id='${i.row}'] .gsuiDrums-lineIn`).append(n);this.#cc.set(t,[i.row,s,Math.round(i.when/a),n])}#Dc(t){const s=this.#cc.get(t)[3];s.remove();this.#cc.delete(t)}#xc(t){return(this.firstChild?this:this.#eh).querySelector(`.gsuiDrums-${t}`)}#Cc(t,s){return t.classList.contains(`gsuiDrums-${s}`)}#Pc(t,s,i){const e=Q.Ln(t);e.classList.add("gsuiDrums-preview");e.style.left=`${i}em`;e.style.width=`${1/this.#ec}em`;this.#xc(`line[data-id='${s}'] .gsuiDrums-lineIn`).append(e);return e}#Mc(t,s){const i=this.#oc;const e=1/this.#ec;const n=Math.round(Math.min(t,s)/e);const a=Math.round(Math.max(t,s)/e);const o=new Map;const r=this.#lc;const h=this.#ac.startsWith("add");const c=this.#ac.endsWith("Drums")?"drum":"drumcut";const l=c==="drum"?"gsui-drums-drum":"gsui-drums-drumcut";const u=[];this.#cc.forEach((t=>{if(t[0]===i&&t[1]===c){u.push(t)}}));for(let t=n;t<=a;++t){o.set(t);if(!r.has(t)){if(h){r.set(t,this.#Pc(l,i,t*e))}else{u.find((s=>{if(s[2]===t){s[3].classList.add("gsuiDrums-previewDeleted");r.set(t,s[3]);return true}}))}}}r.forEach(((t,s)=>{if(!o.has(s)){h?t.remove():t.classList.remove("gsuiDrums-previewDeleted");r.delete(s)}}))}#Ac(t){this.#lc.forEach(t?t=>t.remove():t=>t.classList.remove("gsuiDrums-previewDeleted"));this.#lc.clear()}#yc(t){if(t.target!==this.#fc){if(this.#ac){this.#ic=t.pageX;this.#kc()}else{const s=t.target;const i=this.#Cc(s,"lineIn")?s:this.#Cc(s,"drum")||this.#Cc(s,"drumcut")?s.parentNode:null;if(i){const s=i.getBoundingClientRect();const e=(t.pageY-s.top)/s.height;const n=e>.66?this.#mc:this.#gc;this.#ic=t.pageX;this.#hc=n===this.#gc?"drum":"drumcut";if(n!==this.#fc){if(this.#fc){this.#fc.remove()}this.#fc=n}this.#kc();if(this.#fc.parentNode!==i){i.append(this.#fc)}}else if(this.#fc){this.#fc.remove()}}}}#kc(){if(this.#hc){const t=this.#dc.getBoundingClientRect().left;const s=((this.#ic-t)/this.#nc|0)/this.#ec;this.#sc=s;this.#fc.style.left=`${s}em`;if(this.#ac){this.#Mc(this.#rc,s)}}}#Oc(){if(!this.#ac){this.#hc="";this.#fc.remove()}}#$c(t,s){if(!this.#ac){this.#ac=s.button===0?`add${t}`:`remove${t}`;this.#oc=this.#fc.closest(".gsuiDrums-line").dataset.id;this.#rc=this.#sc;this.#Mc(this.#sc,this.#sc);Q.Ha();this.#dc.onmousemove=null;document.addEventListener("mousemove",this.#vc);document.addEventListener("mouseup",this.#bc)}}#wc(){this.#Ac(this.#ac.startsWith("add"));document.removeEventListener("mousemove",this.#vc);document.removeEventListener("mouseup",this.#bc);this.#dc.onmousemove=this.#vc;this.#La("change",this.#ac,this.#oc,this.#rc,this.#sc);this.#ac=""}}Object.freeze(vt);customElements.define("gsui-drums",vt);"use strict";Q.Ea("gsui-keys-octave",(()=>[Q.Bn("div",{class:"gsuiKey","data-key":11},Q.Bn("div",{class:"gsui-row gsuiKey-row","data-key":11},Q.Bn("div"))),Q.Bn("div",{class:"gsuiKey gsuiKeyBlack","data-key":10},Q.Bn("div",{class:"gsui-row gsuiKey-row  gsuiKeyBlack-row","data-key":10},Q.Bn("div"))),Q.Bn("div",{class:"gsuiKey","data-key":9},Q.Bn("div",{class:"gsui-row gsuiKey-row","data-key":9},Q.Bn("div"))),Q.Bn("div",{class:"gsuiKey gsuiKeyBlack","data-key":8},Q.Bn("div",{class:"gsui-row gsuiKey-row  gsuiKeyBlack-row","data-key":8},Q.Bn("div"))),Q.Bn("div",{class:"gsuiKey","data-key":7},Q.Bn("div",{class:"gsui-row gsuiKey-row","data-key":7},Q.Bn("div"))),Q.Bn("div",{class:"gsuiKey gsuiKeyBlack","data-key":6},Q.Bn("div",{class:"gsui-row gsuiKey-row  gsuiKeyBlack-row","data-key":6},Q.Bn("div"))),Q.Bn("div",{class:"gsuiKey","data-key":5},Q.Bn("div",{class:"gsui-row gsuiKey-row","data-key":5},Q.Bn("div"))),Q.Bn("div",{class:"gsuiKey","data-key":4},Q.Bn("div",{class:"gsui-row gsuiKey-row","data-key":4},Q.Bn("div"))),Q.Bn("div",{class:"gsuiKey gsuiKeyBlack","data-key":3},Q.Bn("div",{class:"gsui-row gsuiKey-row  gsuiKeyBlack-row","data-key":3},Q.Bn("div"))),Q.Bn("div",{class:"gsuiKey","data-key":2},Q.Bn("div",{class:"gsui-row gsuiKey-row","data-key":2},Q.Bn("div"))),Q.Bn("div",{class:"gsuiKey gsuiKeyBlack","data-key":1},Q.Bn("div",{class:"gsui-row gsuiKey-row  gsuiKeyBlack-row","data-key":1},Q.Bn("div"))),Q.Bn("div",{class:"gsuiKey","data-key":0},Q.Bn("div",{class:"gsui-row gsuiKey-row","data-key":0},Q.Bn("div")))]));"use strict";class yt extends HTMLElement{static keyNames=Object.freeze({en:Object.freeze(["c","c#","d","d#","e","f","f#","g","g#","a","a#","b"]),fr:Object.freeze(["do","do#","ré","ré#","mi","fa","fa#","sol","sol#","la","la#","si"])});static keyboardToKey={KeyZ:[-1,0],KeyS:[-1,1],KeyX:[-1,2],KeyD:[-1,3],KeyC:[-1,4],KeyV:[-1,5],KeyG:[-1,6],KeyB:[-1,7],KeyH:[-1,8],KeyN:[-1,9],KeyJ:[-1,10],KeyM:[-1,11],Comma:[0,0],KeyL:[0,1],Period:[0,2],Semicolon:[0,3],Slash:[0,4],KeyQ:[0,0],Digit2:[0,1],KeyW:[0,2],Digit3:[0,3],KeyE:[0,4],KeyR:[0,5],Digit5:[0,6],KeyT:[0,7],Digit6:[0,8],KeyY:[0,9],Digit7:[0,10],KeyU:[0,11],KeyI:[1,0],Digit9:[1,1],KeyO:[1,2],Digit0:[1,3],KeyP:[1,4],BracketLeft:[1,5],Equal:[1,6],BracketRight:[1,7]};#Tc=0;#Bc=new Map;#jc=1;#Lc=0;#Ec=0;#Wc=0;#Ic=0;#Fc=0;#Kc=0;#zc=null;#_r=this.#ir.bind(this);#qr=this.#sr.bind(this);constructor(){super();Object.seal(this);this.onmousedown=this.#Rc.bind(this);this.oncontextmenu=()=>false}connectedCallback(){Q.Va(this,{orient:"vertical",rootoctave:"4"})}static get observedAttributes(){return["orient","rootoctave"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"rootoctave":this.#Nc(+i);break}}}octaves(t,s){const i=t+s;Array.prototype.forEach.call(this.children,(t=>{t.remove();t._rowElement.remove()}));this.#Lc=s;this.#Wc=t;this.style.setProperty("--gsuiKeys-firstOctave",t);this.style.setProperty("--gsuiKeys-nbOctaves",s);for(let t=0;t<s;++t){this.append(...Q.Ln("gsui-keys-octave"))}Array.prototype.reduce.call(this.children,((t,s,i)=>{const e=s.firstElementChild;s._rowElement=e;e._keyElement=s;s.dataset.midi=e.dataset.midi=t-1;s.style.setProperty("--gsuiKeys-key-id",i);e.style.top=`${i}em`;return t-1}),i*12);this.#Nc(this.#Tc);return this.querySelectorAll(".gsui-row")}getMidiKeyFromKeyboard(t){const s=yt.keyboardToKey[t.code];return s?(this.#Tc+s[0])*12+s[1]:false}midiReleaseAllKeys(){this.#Bc.forEach(((t,s)=>this.midiKeyUp(s)));this.#ir()}midiKeyDown(t){this.#Gc(this.#Hc(t),true)}midiKeyUp(t){this.#Gc(this.#Hc(t),false)}#Hc(t){return this.children[this.children.length-1-(t-this.#Wc*12)]}#Nc(t){this.#Tc=t;this.querySelector(`.gsuiKey-root`)?.classList.remove("gsuiKey-root");this.querySelector(`.gsuiKey[data-midi="${t*12}"]`)?.classList.add("gsuiKey-root")}#Vc(){return Q.Nn(this,"orient")==="vertical"}#Uc(t){return t===1||t===3||t===5||t===8||t===10}#Gc(t,s){if(t){const i=+t.dataset.midi;t.classList.toggle("gsui-active",s);if(s){this.#Bc.set(i);Q.La(this,"gsuiKeys","keyDown",i,this.#jc)}else{this.#Bc.delete(i);Q.La(this,"gsuiKeys","keyUp",i,this.#jc)}}}#Rc(t){if(this.#Lc){if(t.button===2){Q.En(this,"rootoctave",t.target.dataset.midi/12|0)}else if(t.button===0){const s=this.#Vc();const i=this.getBoundingClientRect();const e=this.children[1].getBoundingClientRect();this.#Ec=s?i.top:i.left;this.#Ic=s?e.right:e.bottom;this.#Fc=s?e.height:e.width;this.#jc=Math.min(t.layerX/(t.target.clientWidth-1),1);document.addEventListener("mouseup",this.#_r);document.addEventListener("mousemove",this.#qr);this.#sr(t)}}}#ir(){document.removeEventListener("mouseup",this.#_r);document.removeEventListener("mousemove",this.#qr);if(this.#zc){this.#Gc(this.#zc,false);this.#zc=this.#Kc=null}this.#jc=1}#sr(t){const s=this.#Vc();const i=s?t.clientY:t.clientX;const e=s?t.clientX:t.clientY;const n=(i-this.#Ec)/this.#Fc;const a=s?n:this.#Lc*12-n;let o=~~a;if(e>this.#Ic&&this.#Uc(~~(o%12))){o+=a-o<.5?-1:1}if(this.#Kc!==o){const t=this.children[o];if(t){if(this.#zc){this.#Gc(this.#zc,false)}this.#zc=t;this.#Kc=o;this.#Gc(t,true)}}}}Object.freeze(yt);customElements.define("gsui-keys",yt);"use strict";Q.Ea("gsui-oscillator",(()=>[Q.Bn("div",{class:"gsuiOscillator-grip gsuiIcon","data-icon":"grip-v"}),Q.Bn("div",{class:"gsuiOscillator-waveWrap"},Q.Bn("div",{class:"gsuiOscillator-waveWrap-left"},Q.Bn("div",{class:"gsuiOscillator-waveWrap-top"},Q.Bn("button",{class:"gsuiOscillator-waveBtn gsuiOscillator-wavePrev gsuiIcon","data-icon":"caret-left",title:"Previous wave"}),Q.Bn("button",{class:"gsuiOscillator-waveBtn gsuiOscillator-waveNext gsuiIcon","data-icon":"caret-right",title:"Next wave"}),Q.Bn("select",{class:"gsuiOscillator-waveSelect"},["sine","triangle","sawtooth","square"].map((t=>Q.Bn("option",{class:"gsuiOscillator-waveOptNative",value:t},t))))),Q.Bn("div",{class:"gsuiOscillator-wave"},Q.Bn("gsui-periodicwave"),Q.Bn("gsui-periodicwave"))),Q.Bn("div",{class:"gsuiOscillator-unisonGraph"},Q.Bn("div",{class:"gsuiOscillator-unisonGraph-voices"}))),Q.Bn("div",{class:"gsuiOscillator-unison"},Q.Bn("gsui-slider",{type:"linear-y",min:1,max:9,step:1,"mousemove-size":"400","data-prop":"unisonvoices"}),Q.Bn("gsui-slider",{type:"linear-y",min:0,max:2,step:.01,"mousemove-size":"800","data-prop":"unisondetune"}),Q.Bn("gsui-slider",{type:"linear-y",min:0,max:1,step:.001,"mousemove-size":"800","data-prop":"unisonblend"})),[["detune","pitch",-24,24,1],["pan","pan",-1,1,.02],["gain","gain",0,1,.01]].map((([t,s,i,e,n])=>Q.Bn("div",{class:`gsuiOscillator-prop gsuiOscillator-${t}`,title:s},Q.Bn("div",{class:"gsuiOscillator-sliderWrap"},Q.Bn("gsui-slider",{type:"circular",min:i,max:e,step:n,"mousemove-size":"800","data-prop":t}),t!=="detune"?null:Q.Bn("gsui-slider",{type:"circular",min:-1,max:1,step:.01,"mousemove-size":"800","data-prop":"detunefine","stroke-width":3})),Q.Bn("div",{class:"gsuiOscillator-sliderValue"})))),Q.Bn("button",{class:"gsuiOscillator-remove gsuiIcon","data-icon":"close",title:"Remove the oscillator"})].flat(1)));"use strict";class kt extends HTMLElement{#qc=null;#La=Q.La.bind(null,this,"gsuiOscillator");#_c={sine:true,triangle:true,sawtooth:true,square:true};#Ea=Q.Ln("gsui-oscillator");#ps=Q.Wn(this.#Ea,{waveSelect:".gsuiOscillator-waveSelect",wavePrev:".gsuiOscillator-wavePrev",waveNext:".gsuiOscillator-waveNext",waves:["gsui-periodicwave:first-child","gsui-periodicwave:last-child"],unisonGraph:".gsuiOscillator-unisonGraph-voices",sliders:{pan:[".gsuiOscillator-pan gsui-slider",".gsuiOscillator-pan .gsuiOscillator-sliderValue"],gain:[".gsuiOscillator-gain gsui-slider",".gsuiOscillator-gain .gsuiOscillator-sliderValue"],detune:[".gsuiOscillator-detune gsui-slider",".gsuiOscillator-detune .gsuiOscillator-sliderValue"],detunefine:[".gsuiOscillator-detune gsui-slider + gsui-slider",".gsuiOscillator-detune .gsuiOscillator-sliderValue"],unisonvoices:["gsui-slider[data-prop='unisonvoices']"],unisondetune:["gsui-slider[data-prop='unisondetune']"],unisonblend:["gsui-slider[data-prop='unisonblend']"]},remove:".gsuiOscillator-remove"});constructor(){super();Object.seal(this);this.#ps.waves[0].frequency=this.#ps.waves[1].frequency=1;this.#ps.waveSelect.onchange=this.#Yc.bind(this);this.#ps.waveSelect.onkeydown=this.#Jc.bind(this);this.#ps.wavePrev.onclick=this.#Xc.bind(this,-1);this.#ps.waveNext.onclick=this.#Xc.bind(this,1);this.#ps.remove.onclick=()=>this.#La("remove");Q.zn(this,{gsuiSlider:{inputStart:Q.Sn,inputEnd:Q.Sn,input:(t,s)=>{this.#to(s.dataset.prop,t.args[0])},change:(t,s)=>{this.#so(s.dataset.prop,t.args[0])}}})}connectedCallback(){if(this.#Ea){Q.En(this,"draggable","true");this.append(...this.#Ea);this.#Ea=null;Q.Va(this,{order:0,type:"sine",detune:0,detunefine:0,gain:1,pan:0,unisonvoices:5,unisondetune:.2,unisonblend:.3});this.updateWave()}}static get observedAttributes(){return["order","type","detune","detunefine","gain","pan","unisonvoices","unisondetune","unisonblend"]}attributeChangedCallback(t,s,i){if(!this.#Ea&&s!==i){const s=+i;switch(t){case"order":this.#Xh(s);break;case"type":this.#fn(i);break;case"unisonvoices":this.#Qc(s);this.#Zc("unisonvoices",s);break;case"unisondetune":this.#tl(s);this.#Zc("unisondetune",s);break;case"unisonblend":this.#sl(s);this.#Zc("unisonblend",s);break;case"detunefine":case"detune":case"gain":case"pan":this.#Zc(t,s);break}}}addWaves(t){const s=[];t.sort();t.forEach((t=>{if(!this.#_c[t]){this.#_c[t]=true;s.push(Q.Bn("option",{class:"gsuiOscillator-waveOpt",value:t},t))}}));Element.prototype.append.apply(this.#ps.waveSelect,s);this.updateWave()}updateWave(t,s){const[i,e]=this.#ps.waves;const n=t==="gain"?s:Q.za(this,"gain");const a=t==="pan"?s:Q.za(this,"pan");i.type=e.type=t==="type"?s:Q.Nn(this,"type");i.amplitude=Math.min(n*(a<0?1:1-a),.95);e.amplitude=Math.min(n*(a>0?1:1+a),.95);i.draw();e.draw()}#Xh(t){this.dataset.order=t}#fn(t){this.#ps.waveSelect.value=t}#Zc(t,s){const[i,e]=this.#ps.sliders[t];let n=s;if(t.startsWith("detune")){n=Q.za(this,"detune")+Q.za(this,"detunefine")}i.setValue(s);Q.En(i,"title",`${t} ${n}`);if(e){e.textContent=n.toFixed(2)}}#Qc(t){const s=this.#ps.unisonGraph;const i=[];for(let s=0;s<t;++s){i.push(Q.Bn("div",{class:"gsuiOscillator-unisonGraph-voice"}))}Q.Ga(s);s.append(...i);this.#sl(Q.za(this,"unisonblend"))}#tl(t){const s=Q.za(this.#ps.sliders.unisondetune[0],"max");this.#ps.unisonGraph.style.height=`${Q.Aa(t/s)*100}%`}#sl(t){const s=this.#ps.unisonGraph.childNodes;const i=Math.floor(s.length/2);const e=s.length%2===0;s.forEach(((s,n)=>s.style.width=`${n===i||e&&n===i-1?100:t*100}%`))}#Xc(t){const s=this.#ps.waveSelect;const i=s.querySelector(`option[value="${s.value}"]`);const e=t<0?i.previousElementSibling:i.nextElementSibling;if(e){s.value=e.value;this.#Yc()}}#Yc(){const t=this.#ps.waveSelect.value;clearTimeout(this.#qc);this.updateWave("type",t);this.#La("liveChange","type",t);this.#qc=setTimeout((()=>{if(t!==Q.Nn(this,"type")){Q.En(this,"type",t);this.#La("change","type",t)}}),700)}#Jc(t){if(t.key.length===1){t.preventDefault()}}#so(t,s){Q.En(this,t,s);this.#La("change",t,s)}#to(t,s){let i=s;const e=this.#ps.sliders[t][1];switch(t){case"gain":this.updateWave("gain",s);break;case"pan":this.updateWave("pan",s);break;case"unisonvoices":this.#Qc(s);break;case"unisondetune":this.#tl(s);break;case"unisonblend":this.#sl(s);break;case"detune":i+=Q.za(this,"detunefine");break;case"detunefine":i+=Q.za(this,"detune");break}if(e){e.textContent=i.toFixed(2)}this.#La("liveChange",t,s)}}Object.freeze(kt);customElements.define("gsui-oscillator",kt);"use strict";class $t extends HTMLElement{#Ua=Q.Ia("svg",{preserveAspectRatio:"none"},Q.Ia("polyline"));static cache={};constructor(){super();this.type="";this.delay=this.attack=0;this.frequency=this.amplitude=this.duration=1;this.width=this.height=0;Object.seal(this)}connectedCallback(){if(!this.firstChild){this.append(this.#Ua);this.resized()}}resized(){const t=this.getBoundingClientRect();const s=~~t.width;const i=~~t.height;this.width=s;this.height=i;Q.En(this.#Ua,"viewBox",`0 0 ${s} ${i}`);this.draw()}draw(){if(this.firstChild&&this.type){const t=$t.cache[this.type];if(t){this.#il(t)}else{console.error(`gsuiPeriodicWave: the wave "${this.type}" is undefined...`)}}}#il(t){const s=this.duration;const i=this.width;const e=this.height/2;const n=this.frequency*s;const a=-this.amplitude*.95*e;const o=i/s*this.delay;const r=i/s*this.attack;const h=new Float32Array(i*2);for(let s=0;s<i;++s){let c=e;if(s>o){const e=s-o;const h=e<r?e/r:1;c+=t[e/i*256*n%256|0]*a*h}h[s*2]=s;h[s*2+1]=c}Q.En(this.#Ua.firstChild,"points",h.join(" "))}static getXFromWave(t,s,i){return t.reduce(((t,e,n)=>{const a=Math.PI*2*n*i;return t+e*Math.cos(a)+s[n]*Math.sin(a)}),0)}static addWave(t,s,i){if(!$t.cache[t]){const e=[];const n=$t.getXFromWave.bind(null,s,i);for(let t=0;t<256;++t){e.push(n(t/256))}$t.cache[t]=e}}}Object.freeze($t);customElements.define("gsui-periodicwave",$t);"use strict";Q.Ea("gsui-synthesizer",(()=>[Q.Bn("div",{class:"gsuiSynthesizer-head"},Q.Bn("gsui-toggle",{"data-related":"env",off:true}),Q.Bn("span",{class:"gsuiSynthesizer-headTitle"},"envelope gain")),Q.Bn("div",{class:"gsuiSynthesizer-env"},Q.Bn("gsui-envelope")),Q.Bn("div",{class:"gsuiSynthesizer-head"},Q.Bn("gsui-toggle",{"data-related":"lfo",off:true}),Q.Bn("span",{class:"gsuiSynthesizer-headTitle"},"LFO gain")),Q.Bn("div",{class:"gsuiSynthesizer-lfo"},Q.Bn("gsui-lfo")),Q.Bn("div",{class:"gsuiSynthesizer-head gsuiSynthesizer-headOscs"},Q.Bn("span",{class:"gsuiSynthesizer-headTitle"},"oscillators"),Q.Bn("span",{class:"gsuiSynthesizer-label gsuiSynthesizer-labelUnison"},"unison"),Q.Bn("span",{class:"gsuiSynthesizer-label gsuiSynthesizer-labelPitch"},"pitch"),Q.Bn("span",{class:"gsuiSynthesizer-label gsuiSynthesizer-labelPan"},"pan"),Q.Bn("span",{class:"gsuiSynthesizer-label gsuiSynthesizer-labelGain"},"gain")),Q.Bn("div",{class:"gsuiSynthesizer-oscList"},Q.Bn("button",{class:"gsuiSynthesizer-newOsc"},Q.Bn("i",{class:"gsuiIcon","data-icon":"plus"})))]));"use strict";class Ot extends HTMLElement{#el=[];#nl=new Map;#Ea=Q.Ln("gsui-synthesizer");#ps=Q.Wn(this.#Ea,{toggleEnv:"gsui-toggle[data-related='env']",toggleLFO:"gsui-toggle[data-related='lfo']",env:"gsui-envelope",lfo:"gsui-lfo",oscList:".gsuiSynthesizer-oscList",newOsc:".gsuiSynthesizer-newOsc"});constructor(){super();this.env=this.#ps.env;this.lfo=this.#ps.lfo;Object.seal(this);this.#ps.newOsc.onclick=this.#al.bind(this);new dt({rootElement:this.#ps.oscList,direction:"column",dataTransferType:"oscillator",itemSelector:"gsui-oscillator",handleSelector:".gsuiOscillator-grip",parentSelector:".gsuiSynthesizer-oscList",onchange:this.#ol.bind(this)});Q.zn(this,{gsuiToggle:{toggle:(t,s)=>{const i=s.dataset.related==="env";const e=i?"toggleEnv":"toggleLFO";const n=i?this.#ps.env:this.#ps.lfo;Q.En(n,"toggle",t.args[0]);Q.La(this,"gsuiSynthesizer",e,t.args[0])}}})}connectedCallback(){if(!this.firstChild){this.append(...this.#Ea);this.#Ea=null}}setWaveList(t){this.#el=t;this.#nl.forEach((s=>s.addWaves(t)))}getOscillator(t){return this.#nl.get(t)}changeEnvProp(t,s){if(t==="toggle"){Q.En(this.#ps.toggleEnv,"off",!s)}Q.En(this.#ps.env,t,s)}changeLFOProp(t,s){if(t==="toggle"){Q.En(this.#ps.toggleLFO,"off",!s)}Q.En(this.#ps.lfo,t,s)}addOscillator(t){const s=Q.Bn("gsui-oscillator",{"data-id":t});this.#nl.set(t,s);s.addWaves(this.#el);this.#ps.oscList.append(s)}removeOscillator(t){const s=this.#nl.get(t);if(s){s.remove();this.#nl.delete(t)}}reorderOscillators(t){dt.listReorder(this.#ps.oscList,t)}#al(){Q.La(this,"gsuiSynthesizer","addOscillator")}#ol(){const t=dt.listComputeOrderChange(this.#ps.oscList,{});Q.La(this,"gsuiSynthesizer","reorderOscillator",t)}}Object.freeze(Ot);customElements.define("gsui-synthesizer",Ot);"use strict";class xt extends HTMLElement{#rl=0;#hl=0;#cl=null;#ll=null;#ul=true;constructor(){super();Object.seal(this)}connectedCallback(){this.init()}init(){if(this.children.length===2){this.#ll=Q.Bn("div",{class:"gsuiPanel-extend"});this.#ll.onpointerdown=this.#dl.bind(this);this.firstElementChild.after(this.#ll)}this.#pl();this.#ll.dataset.axis=this.#gl()?"x":"y";if(this.children.length>0){this.#cl.style.width="";this.#cl.style.height=""}}#gl(){return this.#ll.clientWidth<this.#ll.clientHeight}#pl(){this.#cl=getComputedStyle(this.lastElementChild).flexBasis==="auto"?this.lastElementChild:this.firstElementChild;this.#ul=this.#cl===this.firstElementChild}#dl(t){const s=this.#gl();const i=this.#cl;Q.Ha();this.#rl=s?t.pageX:t.pageY;this.#hl=s?i.clientWidth:i.clientHeight;this.setPointerCapture(t.pointerId);this.onpointerup=this.#ml.bind(this);this.onpointermove=this.#fl.bind(this);document.body.style.cursor=s?"ew-resize":"ns-resize"}#fl(t){const s=this.#gl();const i=(s?t.pageX:t.pageY)-this.#rl;const e=this.#cl.style;const n=`${this.#hl+i*(this.#ul?1:-1)}px`;if(s){e.width=n}else{e.height=n}}#ml(t){const s=this.#gl();const i=this.#cl;const e=s?i.clientWidth:i.clientHeight;const n=s?this.clientWidth:this.clientHeight;const a=`${e/n*100}%`;this.releasePointerCapture(t.pointerId);this.onpointermove=this.onpointerup=null;if(s){i.style.width=a}else{i.style.height=a}document.body.style.cursor=""}}Object.freeze(xt);customElements.define("gsui-panel",xt);"use strict";class St extends HTMLElement{#bl="";#wl=false;#rl=0;#vl=null;#yl=null;#kl=null;constructor(){super();Object.seal(this);this.onpointerdown=this.#$l.bind(this)}connectedCallback(){this.#Ol()}#Ol(){const t=this.children;const s=this.#wl?this.clientWidth:this.clientHeight;this.style.overflow="hidden";this.#wl=this.classList.contains("gsuiPanels-x");this.#bl=this.#wl?"width":"height";this.querySelectorAll(".gsuiPanels-extend").forEach((t=>t.remove()));this.querySelectorAll(".gsuiPanels-last").forEach((t=>t.classList.remove("gsuiPanels-last")));t[t.length-1].classList.add("gsuiPanels-last");Array.prototype.map.call(t,(t=>t.getBoundingClientRect()[this.#bl])).forEach(((i,e)=>{t[e].style[this.#bl]=`${i/s*100}%`;if(e>0){t[e].append(Q.Bn("div",{class:"gsuiPanels-extend"}))}}))}static#xl(t,s,i,e){return e.reduce(((s,e)=>{let n=s;const a=getComputedStyle(e);const o=Math.round(e.getBoundingClientRect()[t]);lg(o,"size");const r=parseFloat(a[`min-${t}`])||10;const h=parseFloat(a[`max-${t}`])||Infinity;const c=Math.round(Math.max(r,Math.min(o+s,h)));lg(c,"newsizeCorrect",r,h);if(Math.abs(c-o)>=.1){e.style[t]=`${(c/i*100).toFixed(1)}%`;n-=c-o;if(e.onresizing){e.onresizing(e)}}return n}),s)}#$l(t){const s=t.target;const i=s.parentNode;if(i.parentNode===this&&s.classList.contains("gsuiPanels-extend")){this.#vl=s;this.#rl=this.#wl?t.pageX:t.pageY;this.#yl=Array.prototype.filter.call(this.children,(t=>i.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_PRECEDING)).reverse();this.#kl=Array.prototype.filter.call(this.children,(t=>i===t||i.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING));this.style.cursor=this.#wl?"col-resize":"row-resize";s.classList.add("gsui-hover");Q.Ha();this.setPointerCapture(t.pointerId);this.onpointerup=this.#ml.bind(this);this.onpointermove=this.#fl.bind(this)}}#ml(t){this.style.cursor="";this.#vl.classList.remove("gsui-hover");this.releasePointerCapture(t.pointerId);this.onpointermove=this.onpointerup=null}#fl(t){const s=Math.round((this.#wl?t.pageX:t.pageY)-this.#rl);const i=this.#wl?this.clientWidth:this.clientHeight;const e=s-St.#xl(this.#bl,s,i,this.#yl);lg(e,s,i);this.#rl+=e;if(Math.abs(e)>0){St.#xl(this.#bl,-e,i,this.#kl)}}}Object.freeze(St);customElements.define("gsui-panels",St);"use strict";Q.Ea("gsui-popup",(()=>Q.Bn("div",{class:"gsuiPopup-window",tabindex:0},Q.Bn("div",{class:"gsuiPopup-head"}),Q.Bn("form",{class:"gsuiPopup-body"},Q.Bn("div",{class:"gsuiPopup-content"}),Q.Bn("div",{class:"gsuiPopup-message"}),Q.Bn("input",{class:"gsuiPopup-inputText",type:"text"}),Q.Bn("div",{class:"gsuiPopup-btns"},Q.Bn("input",{type:"button",class:"gsuiPopup-cancel",value:"Cancel"}),Q.Bn("input",{type:"submit",class:"gsuiPopup-ok",value:"Ok"}))))));"use strict";class Dt extends HTMLElement{#Sl="";#Dl=false;#Cl=null;#Pl=null;#Ea=Q.Ln("gsui-popup");#ps=Q.Wn(this.#Ea,{ok:".gsuiPopup-ok",cnt:".gsuiPopup-content",msg:".gsuiPopup-message",text:".gsuiPopup-inputText",form:".gsuiPopup-body",window:".gsuiPopup-window",header:".gsuiPopup-head",cancel:".gsuiPopup-cancel"});#Ml=this.#ps.window.classList;constructor(){super();Object.seal(this);this.onclick=this.#ps.cancel.onclick=this.#Al.bind(this);this.#ps.form.onsubmit=this.#Tl.bind(this);this.#ps.window.onkeyup=this.#ps.window.onclick=t=>t.stopPropagation();this.#ps.window.onkeydown=t=>{t.stopPropagation();if(t.key==="Escape"){this.#Al()}}}connectedCallback(){if(!this.firstChild){this.append(this.#Ea);this.#Ea=null}}alert(t,s,i){Q.Ga(this.#ps.cnt);this.#Ml.add("gsuiPopup-noText","gsuiPopup-noCancel");this.#Bl(i,false);return this.#jl("alert",t,s)}confirm(t,s,i,e){Q.Ga(this.#ps.cnt);this.#Ml.remove("gsuiPopup-noCancel");this.#Ml.add("gsuiPopup-noText");this.#Bl(i,e);return this.#jl("confirm",t,s)}prompt(t,s,i,e,n){Q.Ga(this.#ps.cnt);this.#Ml.remove("gsuiPopup-noText","gsuiPopup-noCancel");this.#Bl(e,n);return this.#jl("prompt",t,s,i)}custom(t){Q.Ga(this.#ps.cnt);this.#Pl=t.submit||null;this.#Ml.remove("gsuiPopup-noText");this.#Bl(t.ok,t.cancel||false);t.element?this.#ps.cnt.append(t.element):this.#ps.cnt.append(...t.elements);return this.#jl("custom",t.title)}close(){if(this.#Dl){this.#Al()}}#Bl(t,s){this.#Ml.toggle("gsuiPopup-noCancel",s===false);this.#ps.cancel.value=s||"Cancel";this.#ps.ok.value=t||"Ok"}#jl(t,s,i,e){this.#Sl=t;this.#Dl=true;this.#ps.header.textContent=s;this.#ps.msg.innerHTML=i||"";this.#ps.text.value=arguments.length>3?e:"";this.#ps.window.dataset.type=t;this.classList.add("gsuiPopup-show");setTimeout((()=>{if(t==="prompt"){this.#ps.text.select()}else{const s=t!=="custom"?null:this.#ps.cnt.querySelector("input, select");(s||this.#ps.ok).focus()}}),250);return new Promise((t=>this.#Cl=t)).then((t=>{this.#Dl=false;this.classList.remove("gsuiPopup-show");return t}))}#Al(){this.#Cl(this.#Sl==="confirm"?false:this.#Sl==="prompt"?null:undefined)}#Tl(){switch(this.#Sl){case"alert":this.#Cl(undefined);break;case"prompt":this.#Cl(this.#ps.text.value);break;case"confirm":this.#Cl(true);break;case"custom":this.#Ll();break}return false}#El(t){switch(t.type){default:return t.value;case"file":return t.files;case"radio":return t.checked?t.value:null;case"range":case"number":return+t.value;case"checkbox":return t.checked;case"select-one":return Number.isNaN(+t.value)?t.value:+t.value}}#Ll(){const t=this.#Pl;const s=Array.from(this.#ps.form);const i=s.reduce(((t,s)=>{if(s.name){const i=this.#El(s);if(i!==null){t[s.name]=i}}return t}),{});if(!t){this.#Cl(i)}else{const s=t(i);if(s!==false){s&&s.then?s.then((t=>{if(t!==false){this.#Cl(i)}})):this.#Cl(i)}}}}Object.freeze(Dt);customElements.define("gsui-popup",Dt);"use strict";class Ct{#Wl=null;#Il=null;#Fl=null;#Kl=null;#zl=null;#Rl=this.#Nl.bind(this);constructor(t){Object.seal(this);this.#Wl=t.scrolledElem;this.#Il=t.topShadow?[t.topShadow].flat():[];this.#Fl=t.leftShadow?[t.leftShadow].flat():[];this.#Kl=t.rightShadow?[t.rightShadow].flat():[];this.#zl=t.bottomShadow?[t.bottomShadow].flat():[];Ct.#Gl(this.#Il,"top");Ct.#Gl(this.#Fl,"left");Ct.#Gl(this.#Kl,"right");Ct.#Gl(this.#zl,"bottom");this.#Wl.addEventListener("scroll",this.#Rl);Q.Ra(this.#Wl,this.#Rl);const s=[]}static#Gl(t,s){t.forEach((t=>{t.classList.add("gsuiScrollShadow");t.dataset.dir=s}))}#Nl(){const t=this.#Wl;Ct.#Hl(this.#Il,t.scrollTop);Ct.#Hl(this.#Fl,t.scrollLeft);Ct.#Hl(this.#Kl,t.scrollWidth-t.clientWidth-t.scrollLeft);Ct.#Hl(this.#zl,t.scrollHeight-t.clientHeight-t.scrollTop)}static#Hl(t,s){t.forEach((t=>{t.style.setProperty("--gsuiScrollShadow-dist",`${Math.min(s/5,5)}px`);t.classList.toggle("gsuiScrollShadow-shadowed",s>0)}))}}"use strict";Q.Ea("gsui-slicer",(()=>[Q.Bn("div",{class:"gsuiSlicer-source"},Q.Bn("div",{class:"gsuiSlicer-source-head"},Q.Bn("i",{class:"gsuiSlicer-source-icon gsuiIcon","data-icon":"waveform"}),Q.Bn("span",{class:"gsuiSlicer-source-name"})),Q.Bn("div",{class:"gsuiSlicer-source-sample-wrap"},Q.Bn("div",{class:"gsuiSlicer-source-sample"},Q.Ia("svg",{class:"gsuiSlicer-source-wave",viewBox:"0 0 1000 64",preserveAspectRatio:"none"},Q.Ia("polyline")),Q.Bn("div",{class:"gsuiSlicer-currentTime gsuiSlicer-source-currentTime"})))),Q.Bn("div",{class:"gsuiSlicer-time"},Q.Bn("gsui-timeline")),Q.Bn("div",{class:"gsuiSlicer-preview"},Q.Bn("div",{class:"gsuiSlicer-currentTime gsuiSlicer-preview-currentTime"})),Q.Bn("div",{class:"gsuiSlicer-slices"},Q.Bn("div",{class:"gsuiSlicer-slices-scroll"},Q.Bn("div",{class:"gsuiSlicer-slices-in"},Q.Bn("div",{class:"gsuiSlicer-slices-beatlinesWrap"},Q.Bn("gsui-beatlines"),Q.Bn("gsui-beatlines",{vertical:true})),Q.Bn("div",{class:"gsuiSlicer-currentTime gsuiSlicer-slices-currentTime"}),Q.Ia("svg",{class:"gsuiSlicer-slices-line",preserveAspectRatio:"none"},Q.Ia("line")),Q.Bn("div",{class:"gsuiSlicer-slices-wrap"})))),Q.Bn("div",{class:"gsuiSlicer-menu"},Q.Bn("button",{class:"gsuiSlicer-btn gsuiSlicer-btn-step",title:"Magnetism"},Q.Bn("span",{class:"gsuiSlicer-btn-step-value"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"magnet"})),Q.Bn("button",{class:"gsuiSlicer-btn gsuiIcon","data-action":"moveY","data-icon":"hand-pointer",title:"Move slices vertically"}),Q.Bn("button",{class:"gsuiSlicer-btn gsuiIcon","data-action":"reset","data-icon":"slices",title:"Reset slices vertically"}),Q.Bn("button",{class:"gsuiSlicer-btn gsuiIcon","data-action":"split","data-icon":"cut",title:"Cut slices in half"}),Q.Bn("button",{class:"gsuiSlicer-btn gsuiIcon","data-action":"merge","data-icon":"erase",title:"Merge slices together"}))]));"use strict";class Pt extends HTMLElement{static#Vl=1e3;static#Ul=64;#Ja=4;#ql="";#m={};#_l=null;#Yl=null;#ec=4;#Jl=0;#Xl=null;#Ql=null;#Zl=null;#tu=null;#Qa=this.#Za.bind(this);#La=Q.La.bind(null,this,"gsuiSlicer");#Ea=Q.Ln("gsui-slicer");#su=Q.Ia("polyline");#ps=Q.Wn(this.#Ea,{sourceCurrentTime:".gsuiSlicer-source-currentTime",slicesCurrentTime:".gsuiSlicer-slices-currentTime",previewCurrentTime:".gsuiSlicer-preview-currentTime",beatlines:["gsui-beatlines:first-child","gsui-beatlines:last-child"],srcName:".gsuiSlicer-source-name",srcWave:".gsuiSlicer-source-wave",diagonalLine:".gsuiSlicer-slices-line",timeline:"gsui-timeline",preview:".gsuiSlicer-preview",slices:".gsuiSlicer-slices-wrap",step:".gsuiSlicer-btn-step",tools:{moveY:".gsuiSlicer-btn[data-action='moveY']",reset:".gsuiSlicer-btn[data-action='reset']",split:".gsuiSlicer-btn[data-action='split']",merge:".gsuiSlicer-btn[data-action='merge']"}});timeline=this.#ps.timeline;constructor(){const t=document.querySelector("#gsuiSlicer-waveDefs defs");super();Object.seal(this);if(!t){document.body.prepend(Q.Ia("svg",{id:"gsuiSlicer-waveDefs"},Q.Ia("defs")));this.#su.dataset.id=1}else{this.#su.dataset.id=1+Array.prototype.reduce.call(t.children,((t,s)=>Math.max(t,s.dataset.id)),0)}this.#su.id=`gsuiSlicer-waveDef-${this.#su.dataset.id}`;this.#ps.slices.oncontextmenu=()=>false;this.#ps.slices.onpointerdown=this.#iu.bind(this);this.#ps.step.onclick=this.#eu.bind(this);this.#ps.tools.moveY.onclick=this.#ps.tools.reset.onclick=this.#ps.tools.split.onclick=this.#ps.tools.merge.onclick=this.#nu.bind(this);this.ondrop=t=>{const s=t.dataTransfer.getData("pattern-buffer");if(s&&Q.Nn(this,"disabled")===null){this.#La("dropBuffer",s)}};Q.zn(this,{gsuiTimeline:{changeCurrentTime:t=>{Q.En(this,"currenttime",t.args[0]);return true}}})}connectedCallback(){if(this.#Ea){Q.En(this,"tabindex",-1);this.append(...this.#Ea);this.#Ea=null;Q.Va(this,{currenttime:0,step:1,duration:4,timedivision:"4/4",hidetimes:true});this.#au("moveY")}document.querySelector("#gsuiSlicer-waveDefs defs").append(this.#su);Q.Ra(this,this.#Qa)}disconnectedCallback(){this.#su.remove();Q.Na(this,this.#Qa)}static get observedAttributes(){return["currenttime","duration","step","timedivision"]}attributeChangedCallback(t,s,i){if(!this.#Ea&&s!==i){switch(t){case"timedivision":this.#ec=+i.split("/")[1];Q.En(this.#ps.timeline,"timedivision",i);Q.En(this.#ps.beatlines[0],"timedivision",i);Q.En(this.#ps.beatlines[1],"timedivision",i);break;case"currenttime":this.#ou(+i);break;case"duration":this.#Ja=+i;this.#no();break;case"step":this.#ps.step.firstChild.textContent=this.#ru(+i);break}}}getSlicesData(){return this.#hu()}setBufferName(t){this.#ps.srcName.textContent=t}setBuffer(t){this.#_l=t||null;this.classList.toggle("gsuiSlicer-loaded",this.#_l);this.classList.toggle("gsuiSlicer-missingBufferData",!this.#_l);this.#cu(t)}removeBuffer(){this.#_l=null;this.classList.remove("gsuiSlicer-loaded");this.setBufferName("");this.#cu(null)}addSlice(t,s){if(!(t in this.#m)){const i=Q.Ia("svg",{class:"gsuiSlicer-preview-wave","data-id":t,preserveAspectRatio:"none"},Q.Ia("use"));const e=Q.Bn("div",{class:"gsuiSlicer-slices-slice","data-id":t});this.#Jl=Math.max(this.#Jl,t);i.firstChild.setAttributeNS("http://www.w3.org/1999/xlink","href",`#${this.#su.id}`);this.#m[t]=Object.seal({id:t,svg:i,sli:e,x:0,y:0,w:0});this.changeSlice(t,s);this.#ps.preview.append(i);this.#ps.slices.append(e)}}changeSlice(t,s){const i=this.#lu();const e=this.#m[t];const n=+(s.x??e.x).toFixed(10);const a=+(s.y??e.y).toFixed(10);const o=+(s.w??e.w).toFixed(10);if("x"in s||"w"in s){e.x=n;e.w=o;e.svg.style.left=e.sli.style.left=`${n*100}%`;e.svg.style.width=e.sli.style.width=`${o*100}%`}if("y"in s){e.y=a;e.sli.style.height=`${(1-a)*100}%`}Q.En(e.svg,"viewBox",`${(n-(n-a))*Pt.#Vl} 0 ${o*Pt.#Vl} ${Pt.#Ul}`);if(e.x<=i&&i<e.x+e.w){this.#uu(e)}}removeSlice(t){const s=this.#m[t];if(s){delete this.#m[t];s.svg.remove();s.sli.remove();if(t===this.#Jl){this.#Jl=Object.keys(this.#m).reduce(((t,s)=>Math.max(t,s)),0)}if(s===this.#tu){this.#uu(null)}}}#lu(){return Q.za(this,"currenttime")/Q.za(this,"duration")}#cu(t){if(t){Nt.drawBuffer(this.#su,Pt.#Vl,Pt.#Ul,t);Nt.drawBuffer(this.#ps.srcWave.firstChild,Pt.#Vl,Pt.#Ul,t)}else{this.#su.removeAttribute("points");this.#ps.srcWave.firstChild.removeAttribute("points")}}#ou(t){const s=this.#lu();Q.En(this.#ps.timeline,"currenttime",t);this.#ps.slicesCurrentTime.style.left=`${s*100}%`;this.#ps.previewCurrentTime.style.left=`${s*100}%`;Q.En(this,"hidetimes",s<=0||s>=.995);this.#du(s)}#du(t){const s=Object.values(this.#m).find((s=>s.x<=t&&t<s.x+s.w));const i=s?Math.min(s.y+(t-s.x),1):t;this.#ps.sourceCurrentTime.style.left=`${i*100}%`;this.#uu(s)}#uu(t){if(t!==this.#tu){if(this.#tu){this.#tu.sli.classList.remove("gsuiSlicer-slices-slice-hl");this.#tu.svg.classList.remove("gsuiSlicer-preview-wave-hl")}if(t){t.sli.classList.add("gsuiSlicer-slices-slice-hl");t.svg.classList.add("gsuiSlicer-preview-wave-hl")}this.#tu=t}}#au(t,s){if(s!==false){this.#ql=t}this.#ps.tools.moveY.classList.toggle("gsuiSlicer-btn-toggle",t==="moveY");this.#ps.tools.reset.classList.toggle("gsuiSlicer-btn-toggle",t==="reset");this.#ps.tools.merge.classList.toggle("gsuiSlicer-btn-toggle",t==="merge");this.#ps.tools.split.classList.toggle("gsuiSlicer-btn-toggle",t==="split")}#no(t){Q.En(this.#ps.timeline,"pxperbeat",this.#ps.slices.clientWidth/(t||this.#Ja));Q.En(this.#ps.beatlines[0],"pxperbeat",this.#ps.slices.clientWidth/(t||this.#Ja));Q.En(this.#ps.beatlines[1],"pxperbeat",this.#ps.slices.clientHeight/(t||this.#Ja))}#ru(t){return t>=1?"1":t>=.5?"1 / 2":t>=.25?"1 / 4":"1 / 8"}#pu(t){const s=Q.Ta(t/this.#ps.slices.clientWidth,0,.9999);return Object.values(this.#m).find((t=>t.x<=s&&s<t.x+t.w))}#hu(){return Object.values(this.#m).reduce(((t,s)=>{t[s.id]={x:s.x,y:s.y,w:s.w};return t}),{})}#Za(){const t=this.#ps.diagonalLine;const s=t.clientWidth;const i=t.clientHeight;Q.En(t,"viewBox",`0 0 ${s} ${i}`);Q.En(t.firstChild,"x2",s);Q.En(t.firstChild,"y2",i);this.#no()}#eu(){const t=Q.za(this,"step");const s=t>=1?2:t>=.5?4:t>=.25?8:1;Q.En(this,"step",1/s)}#nu(t){this.#au(t.target.dataset.action)}#iu(t){if(t.button===0||t.button===2){this.#Yl=this.#ql==="reset"||t.button===2?this.#gu.bind(this):this.#ql==="moveY"&&t.button===0?this.#mu.bind(this):this.#ql==="split"&&t.button===0?this.#fu.bind(this):this.#ql==="merge"&&t.button===0?this.#bu.bind(this):null;if(this.#Yl){const s=this.#pu(t.offsetX);Q.Ha();this.#Xl=this.#hu();this.#ps.slices.setPointerCapture(t.pointerId);this.#ps.slices.onpointerup=this.#wu.bind(this);this.#ps.slices.onpointermove=this.#vu.bind(this);this.#Ql={};this.#Zl=s.id;this.#vu(t);if(t.button===2){this.#au("reset",false)}}}}#wu(t){const s=Q.Ba(this.#Xl,this.#hu());this.#ps.slices.releasePointerCapture(t.pointerId);this.#ps.slices.onpointermove=this.#ps.slices.onpointerup=this.#Ql=this.#Zl=this.#Xl=null;this.#au(this.#ql);if(s){this.#La("changeProp","slices",s)}}#vu(t){const s=this.#pu(t.offsetX);const i=this.#m[this.#Zl];const e=Math.min(i.x,s.x);const n=Math.max(i.x,s.x);const a=Object.values(this.#m).filter((t=>e<=t.x&&t.x<=n));const o=this.#Yl(a,s,t);this.#Zl=o??s.id}#mu(t,s,i){const e=Q.za(this,"duration");const n=Q.za(this,"step");const a=Q.Ta(i.offsetY/this.#ps.slices.clientHeight,0,1);const o=Math.floor(a*e*this.#ec/n)*n;const r=o/e/this.#ec;t.forEach((t=>{if(t.y!==r){this.changeSlice(t.id,{y:r})}}))}#gu(t){t.forEach((t=>{if(t.y!==t.x){this.changeSlice(t.id,{y:t.x})}}))}#fu(t){t.forEach((t=>{if(!(t.id in this.#Ql)&&t.w>1/128){const s=t.w/2;const i=this.#Jl+1;const e={x:t.x+s,y:t.y,w:s};this.#Ql[i]=this.#Ql[t.id]=true;this.changeSlice(t.id,{w:s});this.addSlice(i,e)}}))}#bu(t,s){if(s.id!==this.#Zl){const s=t.reduce(((t,s)=>t.x<s.x?t:s));this.changeSlice(s.id,{w:t.reduce(((t,s)=>t+s.w),0)});t.forEach((t=>{if(t.id!==s.id){this.removeSlice(t.id)}}));return s.id}}}Object.freeze(Pt);customElements.define("gsui-slicer",Pt);"use strict";Q.Ea("gsui-slider",(()=>[Q.Bn("input",{type:"range",class:"gsuiSlider-input"}),Q.Bn("div",{class:"gsuiSlider-line"},Q.Bn("div",{class:"gsuiSlider-lineColor"})),Q.Ia("svg",{class:"gsuiSlider-svg"},Q.Ia("circle",{class:"gsuiSlider-svgLine"}),Q.Ia("circle",{class:"gsuiSlider-svgLineColor"})),Q.Bn("div",{class:"gsuiSlider-eventCatcher"})]));"use strict";class Mt extends HTMLElement{#yu=0;#ku=100;#$u=0;#Ou=0;#xu=0;#Su=4;#Du="";#Cu=false;#Pu=false;#Mu=null;#Au=false;#Tu=this.#As.bind(this);#Bu=0;#ju=0;#Lu=0;#La=Q.La.bind(null,this,"gsuiSlider");#Ea=Q.Ln("gsui-slider");#ps=Q.Wn(this.#Ea,{input:".gsuiSlider-input",line:".gsuiSlider-line",lineColor:".gsuiSlider-lineColor",svg:".gsuiSlider-svg",svgLine:".gsuiSlider-svgLine",svgLineColor:".gsuiSlider-svgLineColor"});static focused=null;constructor(){super();this.value="";this.width=this.height=0;Object.seal(this);this.onblur=this.#Eu.bind(this);this.onpointerdown=this.#$l.bind(this);this.onpointerleave=this.#Wu.bind(this)}connectedCallback(){if(this.#Ea){const t=this.getBoundingClientRect();this.append(...this.#Ea);this.width=t.width;this.height=t.height;this.#Ea=null;this.#Au=true;this.#Iu();this.#Fu();Q.En(this,"tabindex","0")}}static get observedAttributes(){return["value","type","min","max","step","scroll-step","mousemove-size","stroke-width"]}attributeChangedCallback(t,s,i){if(s!==i){let s;switch(t){case"value":this.setValue(i);break;case"type":this.#Yi(i);this.#Iu();s=true;break;case"min":this.#ps.input.min=this.#yu=+i;s=true;break;case"max":this.#ps.input.max=this.#ku=+i;s=true;break;case"step":this.#ps.input.step=+i;s=true;break;case"scroll-step":this.#$u=+i;break;case"mousemove-size":this.#xu=+i;break;case"stroke-width":this.#Su=+i;this.#Iu();break}if(s){this.#Du=this.#Ku();this.#Fu()}}}setValue(t,s){if(!this.onpointermove||s){const i=this.#Ku();const e=(this.#ps.input.value=t,this.#Ku());if(e!==i){this.#Fu();if(s){this.#La("input",+e)}}if(!s){this.#Du=e}}}#Yi(t){const s=this.#ps.lineColor.style;const i=t==="circular";const e=t==="linear-x";this.#Cu=i;this.#Pu=e;this.classList.toggle("gsuiSlider-circular",i);this.classList.toggle("gsuiSlider-linear",!i);if(!i){if(e){s.left=s.width="";s.top="0";s.height="100%"}else{s.top=s.height="";s.left="0";s.width="100%"}}}#Iu(){if(this.#Cu&&this.width&&this.height){const t=Math.min(this.width,this.height);const s=t/2;const i=~~((t-this.#Su)/2);Q.En(this.#ps.svg,"viewBox",`0 0 ${t} ${t}`);Q.En(this.#ps.svgLine,{r:i,cx:s,cy:s});Q.En(this.#ps.svgLineColor,{r:i,cx:s,cy:s});this.#ps.svgLine.style.strokeWidth=this.#ps.svgLineColor.style.strokeWidth=this.#Su;this.#Lu=i*2*Math.PI}}#Ku(){const t=this.#ps.input.value;return Math.abs(+t)<1e-6?"0":t}#zu(){return this.#ku-this.#yu}#Ru(){return this.#xu||(this.#Cu?this.#Lu:this.#Pu?this.#ps.line.getBoundingClientRect().width:this.#ps.line.getBoundingClientRect().height)}#Fu(){this.value=+this.#Ku();if(this.#Au){const t=this.#zu();const s=(this.value-this.#yu)/t;const i=-this.#yu/t;const e=Math.abs(s-i);const n=Math.min(s,i);if(this.#Cu){const t=this.#ps.svgLineColor.style;t.transform=`rotate(${90+n*360}deg)`;t.strokeDasharray=`${e*this.#Lu}, 999999`}else{const t=this.#ps.lineColor.style;if(this.#Pu){t.left=`${n*100}%`;t.width=`${e*100}%`}else{t.bottom=`${n*100}%`;t.height=`${e*100}%`}}}}#fi(){const t=this.#Ku();if(this.#Du!==t){Q.En(this,"value",t);this.#La("change",+t);this.#Du=t}}#As(t){if(this.#Mu){const s=t.deltaY>0?-1:1;const i=this.#$u||this.#ps.input.step;this.#Ou+=i*s;this.setValue(+this.#Ku()+i*s,true);t.preventDefault();return false}}#$l(t){if(!Q.Ka(this,"disabled")){this.#Bu=this.#zu()/this.#Ru();this.#ju=0;this.#Ou=0;this.#Mu=t.pointerId;this.setPointerCapture(t.pointerId);this.onpointermove=this.#fl.bind(this);this.onpointerup=this.#ml.bind(this);document.body.addEventListener("wheel",this.#Tu,{passive:false});this.focus();this.requestPointerLock();this.#La("inputStart",this.value)}}#fl(t){const s=this.#zu()/5;const i=this.#Cu||!this.#Pu?-t.movementY:t.movementX;const e=+this.#Du+(this.#ju+i)*this.#Bu+this.#Ou;if(this.#yu-s<e&&e<this.#ku+s){this.#ju+=i}this.setValue(e,true)}#ml(){document.exitPointerLock();if(this.#Mu){this.releasePointerCapture(this.#Mu);this.#Mu=null}document.body.removeEventListener("wheel",this.#Tu);this.onpointermove=this.onpointerup=null;this.#fi();this.#La("inputEnd",this.value)}#Eu(){if(this.onpointermove){this.#ml()}}#Wu(){this.#fi()}}Object.seal(Mt);customElements.define("gsui-slider",Mt);"use strict";Q.Ea("gsui-slidergroup",(()=>Q.Bn("div",{class:"gsuiSliderGroup-slidersWrap"},Q.Bn("div",{class:"gsuiSliderGroup-sliders"},Q.Bn("gsui-beatlines",{coloredbeats:""}),Q.Bn("div",{class:"gsuiSliderGroup-currentTime"}),Q.Bn("div",{class:"gsuiSliderGroup-defaultValue"}),Q.Bn("div",{class:"gsuiSliderGroup-loop gsuiSliderGroup-loopA"}),Q.Bn("div",{class:"gsuiSliderGroup-loop gsuiSliderGroup-loopB"})))));Q.Ea("gsui-slidergroup-slider",(()=>Q.Bn("div",{class:"gsuiSliderGroup-slider"},Q.Bn("div",{class:"gsuiSliderGroup-sliderInner"}))));"use strict";class At extends HTMLElement{#yu=0;#ku=0;#Nu=0;#Gu=0;#Hu=0;#Vu=new Map;#Uu=new Map;#qu=new Map;#_u=null;#qo=null;#_o=null;#Yu=Object.freeze({when:this.#Ju.bind(this),value:this.#Xu.bind(this),duration:this.#Qu.bind(this),selected:this.#Zu.bind(this)});#Ea=Q.Ln("gsui-slidergroup");#ps=Q.Wn(this.#Ea,{slidersParent:".gsuiSliderGroup-sliders",defValue:".gsuiSliderGroup-defaultValue",beatlines:"gsui-beatlines",currentTime:".gsuiSliderGroup-currentTime",loopA:".gsuiSliderGroup-loopA",loopB:".gsuiSliderGroup-loopB"});scrollElement=this.#Ea;constructor(){super();Object.seal(this);this.#Ea.oncontextmenu=()=>false}connectedCallback(){if(!this.firstChild){const t=this.hasAttribute("beatlines");if(!t){this.#ps.beatlines.remove();this.#ps.currentTime.remove();this.#ps.loopA.remove();this.#ps.loopB.remove();this.#ps.beatlines=this.#ps.currentTime=this.#ps.loopA=this.#ps.loopB=null}this.append(this.scrollElement);this.#no();this.#ps.slidersParent.onmousedown=this.#td.bind(this);Q.Va(this,{pxperbeat:64});if(t){Q.Va(this,{currenttime:0,timedivision:"4/4"})}}}static get observedAttributes(){return["timedivision","pxperbeat","currenttime","loopa","loopb"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"timedivision":Q.En(this.#ps.beatlines,"timedivision",i);break;case"pxperbeat":this.#no();break;case"currenttime":this.#ps.currentTime.style.left=`${i}em`;break;case"loopa":this.#ps.loopA.classList.toggle("gsuiSliderGroup-loopOn",i);if(i){this.#ps.loopA.style.width=`${i}em`}break;case"loopb":this.#ps.loopB.classList.toggle("gsuiSliderGroup-loopOn",i);if(i){this.#ps.loopB.style.left=`${i}em`}break}}}empty(){this.#Vu.forEach((t=>t.element.remove()));this.#Vu.clear();this.#Uu.clear();this.#qu.clear()}options({min:t,max:s,step:i,def:e}){this.#yu=t;this.#ku=s;this.#Gu=i;this.#Nu=e??s;this.#ps.defValue.style.top=`${100-(this.#Nu-t)/(s-t)*100}%`}delete(t){this.#Vu.get(t).element.remove();this.#Vu.delete(t);this.#Uu.delete(t);this.#sd()}set(t,s,i,e){const n=Q.Ln("gsui-slidergroup-slider");const a=Object.seal({element:n,when:s,duration:i,value:e,selected:false});n.dataset.id=t;this.#Vu.set(t,a);this.#Ju(a,s);this.#Xu(a,e);this.#Qu(a,i);this.#ps.slidersParent.append(n)}setProp(t,s,i){const e=this.#Vu.get(t);if(e){e[s]=i;this.#Yu[s](e,i)}}#id(t){return+(Math.round(t/this.#Gu)*this.#Gu).toFixed(8)}#no(){const t=Q.za(this,"pxperbeat");this.#ps.slidersParent.style.fontSize=`${t}px`;if(this.#ps.beatlines){Q.En(this.#ps.beatlines,"pxperbeat",t)}}#Ju(t,s){t.element.style.left=`${s}em`;t.element.style.zIndex=Math.floor(s*100)}#Qu(t,s){t.element.style.width=`${s}em`}#Zu(t,s){if(s!==this.#Uu.has(t.element.dataset.id)){const i=+t.element.style.zIndex;s?this.#Uu.set(t.element.dataset.id,t):this.#Uu.delete(t.element.dataset.id);t.element.classList.toggle("gsuiSliderGroup-sliderSelected",!!s);t.element.style.zIndex=i+(s?1e3:-1e3);this.#sd()}}#sd(){this.#ps.slidersParent.classList.toggle("gsuiSliderGroup-slidersSelected",this.#Uu.size>0)}#Xu(t,s){const i=t.element.firstElementChild;const e=i.style;const n=this.#ku;const a=this.#yu;const o=Number.isFinite(s)?s:this.#Nu;const r=a>=0===n>=0;const h=Math.abs(o-(r?a:0))/(n-a)*100;const c=r?0:Math.abs(a)/(n-a)*100;e.height=`${h}%`;if(i.classList.toggle("gsuiSliderGroup-sliderInnerDown",o<0)){e.top=`${100-c}%`;e.bottom="auto"}else{e.top="auto";e.bottom=`${c}%`}}#td(t){if(!this.#qo&&(t.button===0||t.button===2)){this.#_u=this.#ps.slidersParent.getBoundingClientRect();this.#Hu=t.button;this.#qu.clear();this.#Vu.forEach(((t,s)=>this.#qu.set(s,t.value)));this.#qo=this.#ed.bind(this);this.#_o=this.#nd.bind(this);document.addEventListener("mouseup",this.#qo);document.addEventListener("mousemove",this.#_o);Q.Ha();Q.Pa.show("pointer");this.#nd(t)}}#nd(t){const s=this.#Uu.size>0?this.#Uu:this.#Vu;const i=t.pageX-this.#_u.left;const e=t.pageY-this.#_u.top;const n=this.#yu;const a=this.#ku;const o=i/Q.za(this,"pxperbeat");const r=this.#Hu===2?this.#Nu:this.#id(n+(a-n)*(1-Math.min(Math.max(0,e/this.#_u.height),1)));let h=0;s.forEach((t=>{if(t.when<=o&&h<=o){h=t.when}}));s.forEach((t=>{if(h<=t.when&&t.when<=o&&o<=t.when+t.duration){t.value=r;this.#Xu(t,r);Q.La(this,"gsuiSliderGroup","input",t.element.dataset.id,r)}}))}#ed(){const t=[];Q.Pa.hide();document.removeEventListener("mouseup",this.#qo);document.removeEventListener("mousemove",this.#_o);this.#qo=this.#_o=null;this.#Vu.forEach(((s,i)=>{if(s.value!==this.#qu.get(i)){t.push([i,s.value])}}));if(t.length){Q.La(this,"gsuiSliderGroup","change",t)}Q.La(this,"gsuiSliderGroup","inputEnd")}}Object.freeze(At);customElements.define("gsui-slidergroup",At);"use strict";Q.Ea("gsui-timeline",(()=>[Q.Bn("div",{class:"gsuiTimeline-steps"}),Q.Bn("div",{class:"gsuiTimeline-beats"}),Q.Bn("div",{class:"gsuiTimeline-measures"}),Q.Bn("div",{class:"gsuiTimeline-loopLine"},Q.Bn("div",{class:"gsuiTimeline-loop"},Q.Bn("div",{class:"gsuiTimeline-loopBody"}),Q.Bn("div",{class:"gsuiTimeline-loopHandle gsuiTimeline-loopHandleA"}),Q.Bn("div",{class:"gsuiTimeline-loopBorder gsuiTimeline-loopBorderA"}),Q.Bn("div",{class:"gsuiTimeline-loopHandle gsuiTimeline-loopHandleB"}),Q.Bn("div",{class:"gsuiTimeline-loopBorder gsuiTimeline-loopBorderB"}))),Q.Bn("div",{class:"gsuiTimeline-timeLine"},Q.Ia("svg",{class:"gsuiTimeline-cursor",width:"16",height:"10"},Q.Ia("polygon",{points:"2,2 8,8 14,2"})),Q.Ia("svg",{class:"gsuiTimeline-cursorPreview",width:"16",height:"10"},Q.Ia("polygon",{points:"2,2 8,8 14,2"})))]));"use strict";class Tt extends HTMLElement{#Mr="";#Gu=1;#ad=null;#od=document.body;#rd="";#hd=false;#cd=0;#ld=0;#ud=0;#dd=0;#pd=0;#La=Q.La.bind(null,this,"gsuiTimeline");#Rl=this.#Nl.bind(this);#Qa=this.#Za.bind(this);#_r=this.#ir.bind(this);#qr=this.#sr.bind(this);#Ea=Q.Ln("gsui-timeline");#ps=Q.Wn(this.#Ea,{steps:".gsuiTimeline-steps",beats:".gsuiTimeline-beats",measures:".gsuiTimeline-measures",loop:".gsuiTimeline-loop",timeLine:".gsuiTimeline-timeLine",cursor:".gsuiTimeline-cursor",cursorPreview:".gsuiTimeline-cursorPreview"});constructor(){super();this.beatsPerMeasure=4;this.stepsPerBeat=4;this.pxPerBeat=10;this.pxPerMeasure=this.beatsPerMeasure*this.pxPerBeat;this.loopA=this.loopB=0;this.looping=false;Object.seal(this);this.#ps.cursorPreview.remove();this.onmousedown=this.#Rc.bind(this)}static numbering(t){document.body.style.setProperty("--gsuiTimeline-numbering",+t)}connectedCallback(){if(!this.firstChild){this.append(...this.#Ea);this.#Ea=null;Q.Va(this,{step:1,currenttime:0})}this.#gd();this.#md();this.#fd()}disconnectedCallback(){this.#bd()}static get observedAttributes(){return["step","timedivision","pxperbeat","loop","currenttime","currenttime-preview"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"step":this.#Gu=+i;break;case"loop":this.#wd(i);break;case"pxperbeat":this.#vd(+i);break;case"currenttime":this.#yd(+i);break;case"timedivision":this.#eo(i);break;case"currenttime-preview":this.#kd(i===null?null:+i);break}}}qa(t){this.#bd();this.#od=t;t.addEventListener("scroll",this.#Rl);Q.Ra(t,this.#Qa)}#bd(){if(this.#od){this.#od.removeEventListener("scroll",this.#Rl);Q.Na(this.#od,this.#Qa)}}beatCeil(t){return this.#$d(Math.ceil,t)}beatRound(t){return this.#$d(Math.round,t)}beatFloor(t){return this.#$d(Math.floor,t)}#$d(t,s){const i=1/this.stepsPerBeat*this.#Gu;return t(s/i)*i}#vd(t){const s=Math.max(0,Math.min((t-32)/256,.5));const i=Math.max(0,Math.min((t-20)/40,.6));const e=Math.max(0,Math.min((t-6)/20,.7));this.pxPerBeat=t;this.pxPerMeasure=this.beatsPerMeasure*t;this.#hd=t<6;this.style.fontSize=`${t}px`;this.style.setProperty("--gsuiTimeline-beats-incr",this.#hd?this.beatsPerMeasure:1);this.style.setProperty("--gsuiTimeline-measures-opacity",e);this.#ps.steps.style.opacity=s;this.#ps.beats.style.opacity=i;this.#gd();this.#md();this.#fd()}#eo(t){const[s,i]=t.split("/");this.beatsPerMeasure=+s;this.stepsPerBeat=+i;this.pxPerMeasure=this.beatsPerMeasure*this.pxPerBeat;this.style.setProperty("--gsuiTimeline-beats-per-measure",this.beatsPerMeasure);this.#Od();if(this.#od){this.#md();this.#fd()}}#wd(t){const[s,i]=(t||"0-0").split("-");this.looping=!!t;this.loopA=+s;this.loopB=+i;this.#xd()}#yd(t){this.#ps.cursor.style.left=`${t}em`}#kd(t){if(t===null){this.#ps.cursorPreview.remove()}else{const s=this.beatRound(t);if(t.toFixed(3)!==s.toFixed(3)){Q.En(this,"currenttime-preview",s)}else{this.#ps.cursorPreview.style.left=`${t}em`;if(!this.#ps.cursorPreview.parentNode){this.#ps.timeLine.append(this.#ps.cursorPreview)}}}}#Sd(t){this.classList.remove(`gsuiTimeline-${this.#Mr}`);this.classList.toggle(`gsuiTimeline-${t}`,!!t);this.#Mr=t}#Dd(t){const s=this.#ps.timeLine.getBoundingClientRect().x;return Math.max(0,this.beatRound((t-s)/this.pxPerBeat))}#Od(){const t=this.stepsPerBeat;const s=[];for(let i=1;i<t;++i){s.push(`transparent calc( ${i/t}em - 1px )`,`currentColor calc( ${i/t}em - 1px )`,`currentColor calc( ${i/t}em + 1px )`,`transparent calc( ${i/t}em + 1px )`)}this.#ps.steps.style.backgroundImage=`\n\t\t\trepeating-linear-gradient(90deg, transparent 0em,\n\t\t\t\t${s.join(",")},\n\t\t\t\ttransparent calc( ${1}em )\n\t\t\t)\n\t\t`}#gd(){const t=Math.floor(this.#od.scrollLeft/this.pxPerMeasure);const s=this.#hd?Math.floor(t/this.beatsPerMeasure)*this.beatsPerMeasure:t;const i=s!==this.#ad;if(i){this.#ad=s;this.style.setProperty("--gsuiTimeline-beats-offset",s)}return i}#md(){const t=this.#ps.measures;const s=this.pxPerMeasure*(this.#hd?this.beatsPerMeasure:1);const i=Math.ceil(this.#od.clientWidth/s)+1;if(i<0||i>500){return console.warn("gsuiTimeline: anormal number of nodes to create",i)}else if(t.children.length>i){while(t.children.length>i){t.lastChild.remove()}}else{while(t.children.length<i){t.append(Q.Bn("span",{class:"gsuiTimeline-measure"}))}}}#fd(){Array.prototype.forEach.call(this.#ps.measures.children,((t,s)=>{t.classList.toggle("gsuiTimeline-measureBig",this.#hd||(this.#ad+s)%this.beatsPerMeasure===0)}))}#xd(){this.classList.toggle("gsuiTimeline-looping",this.looping);if(this.looping){this.#ps.loop.style.left=`${this.loopA}em`;this.#ps.loop.style.width=`${this.loopB-this.loopA}em`}}#Nl(){if(this.#gd()&&!this.#hd){this.#fd()}}#Za(){this.#md();this.#fd()}#Rc(t){const s=t.target.classList.contains("gsuiTimeline-loopLine");if(s&&Date.now()-this.#cd>500){this.#cd=Date.now()}else{this.#Sd(t.target===this.#ps.cursor.parentNode?"draggingTime":t.target.classList.contains("gsuiTimeline-loopBody")?"draggingLoopBody":t.target.classList.contains("gsuiTimeline-loopHandleA")?"draggingLoopHandleA":t.target.classList.contains("gsuiTimeline-loopHandleB")||s?"draggingLoopHandleB":"");if(this.#Mr){this.#ld=null;this.#ud=this.#Dd(t.pageX);if(s){this.loopA=this.loopB=this.#ud;this.#La("inputLoopStart")}else{this.#La("inputCurrentTimeStart")}this.#rd=Q.Nn(this,"loop");this.#dd=this.loopA;this.#pd=this.loopB;document.addEventListener("mousemove",this.#qr);document.addEventListener("mouseup",this.#_r);Q.Ha();this.#sr(t)}}}#sr(t){const s=this.#Dd(t.pageX);const i=s-this.#ud;if(i!==this.#ld){this.#ld=i;switch(this.#Mr){case"draggingTime":Q.En(this,"currenttime-preview",s);this.#La("inputCurrentTime",s);break;case"draggingLoopBody":{const t=Math.max(-this.#dd,i);const s=this.#dd+t;const e=this.#pd+t;const n=`${s}-${e}`;if(n!==Q.Nn(this,"loop")){Q.En(this,"loop",n);this.#La("inputLoop",s,e)}}break;case"draggingLoopHandleA":case"draggingLoopHandleB":{const t=this.#Mr==="draggingLoopHandleA";const s=t?Math.max(-this.#dd,i):i;const e=this.#dd+(t?s:0);const n=this.#pd+(t?0:s);const a=Math.min(e,n);const o=Math.max(e,n);const r=`${a}-${o}`;if(e>n){if(t){this.#Sd("draggingLoopHandleB");this.#dd=this.#pd}else{this.#Sd("draggingLoopHandleA");this.#pd=this.#dd}this.#ud=this.#dd}if(r!==Q.Nn(this,"loop")){if(a!==o){Q.En(this,"loop",r);this.#La("inputLoop",a,o)}else if(this.hasAttribute("loop")){this.removeAttribute("loop");this.#La("inputLoop",false)}}}break}}}#ir(){document.removeEventListener("mousemove",this.#qr);document.removeEventListener("mouseup",this.#_r);switch(this.#Mr){case"draggingTime":{const t=Q.Nn(this,"currenttime-preview");this.removeAttribute("currenttime-preview");this.#La("inputCurrentTimeEnd");if(t!==Q.Nn(this,"currenttime")){Q.En(this,"currenttime",t);this.#La("changeCurrentTime",+t)}}break;case"draggingLoopBody":case"draggingLoopHandleA":case"draggingLoopHandleB":this.#La("inputLoopEnd");if(Q.Nn(this,"loop")!==this.#rd){if(this.loopA!==this.loopB){this.#La("changeLoop",this.loopA,this.loopB)}else{this.removeAttribute("loop");this.#La("changeLoop",false)}}break}this.#Sd("")}}Object.freeze(Tt);customElements.define("gsui-timeline",Tt);"use strict";Q.Ea("gsui-timewindow",(()=>[Q.Bn("div",{class:"gsuiTimewindow-panel"},Q.Bn("div",{class:"gsuiTimewindow-panelUp"},Q.Bn("button",{class:"gsuiTimewindow-step"},Q.Bn("span",{class:"gsuiTimewindow-stepValue"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"magnet"})),Q.Bn("gsui-slider",{"data-zoom":"y",type:"linear-y","mousemove-size":400,min:0,max:1,step:.01,title:"zooming Y"}),Q.Bn("gsui-slider",{"data-zoom":"x",type:"linear-y","mousemove-size":400,min:0,max:1,step:.01,title:"zooming X"})),Q.Bn("div",{class:"gsuiTimewindow-panelContent"}),Q.Bn("div",{class:"gsuiTimewindow-panelContentDown"},Q.Bn("div",{class:"gsuiTimewindow-panelExtend gsuiTimewindow-panelExtendX"})),Q.Bn("div",{class:"gsuiTimewindow-panelExtend gsuiTimewindow-panelExtendY"})),Q.Bn("div",{class:"gsuiTimewindow-main"},Q.Bn("div",{class:"gsuiTimewindow-time"},Q.Bn("gsui-timeline")),Q.Bn("div",{class:"gsuiTimewindow-mainBody"},Q.Bn("div",{class:"gsuiTimewindow-mainContent"},Q.Bn("gsui-beatlines",{coloredbeats:""}),Q.Bn("div",{class:"gsuiTimewindow-currentTime"}),Q.Bn("div",{class:"gsuiTimewindow-loop gsuiTimewindow-loopA"}),Q.Bn("div",{class:"gsuiTimewindow-loop gsuiTimewindow-loopB"}),Q.Bn("div",{class:"gsuiTimewindow-rows"}))),Q.Bn("div",{class:"gsuiTimewindow-contentDown"},Q.Bn("div",{class:"gsuiTimewindow-panelExtend gsuiTimewindow-panelExtendX"})))]));"use strict";class Bt extends HTMLElement{#$r=0;#Cd=0;#Pd=0;#Md=0;#Ad=0;#Td=this.#Bd.bind(this);#jd=this.#Ld.bind(this);#Ed=this.#Wd.bind(this);#Ea=Q.Ln("gsui-timewindow");#ps=Q.Wn(this.#Ea,{main:".gsuiTimewindow-main",down:".gsuiTimewindow-contentDown",panel:".gsuiTimewindow-panel",panelDown:".gsuiTimewindow-panelContentDown",stepBtn:".gsuiTimewindow-step",sliderZoomX:"gsui-slider[data-zoom=x]",sliderZoomY:"gsui-slider[data-zoom=y]",timeline:"gsui-timeline",beatlines:"gsui-beatlines",loopA:".gsuiTimewindow-loopA",loopB:".gsuiTimewindow-loopB",currentTime:".gsuiTimewindow-currentTime"});constructor(){super();this.timeline=this.#ps.timeline;Object.seal(this);Q.zn(this,{gsuiSlider:{input:(t,s)=>{if(s.dataset.zoom==="x"){const s=Q.Ma(t.args[0]);const i=this.#Id()+s*(this.#Fd()-this.#Id());const e=this.#Kd(this.scrollLeft,this.#$r,i,0);this.scrollLeft=e;Q.En(this,"pxperbeat",i);Q.La(this,"gsuiTimewindow","pxperbeat",i)}else if(s.dataset.zoom==="y"){const s=Q.Ma(t.args[0]);const i=this.#zd()+s*(this.#Rd()-this.#zd());const e=this.#Kd(this.scrollTop,this.#Pd,i,0);this.scrollTop=e;Q.En(this,"lineheight",i);Q.La(this,"gsuiTimewindow","lineheight",i)}}},gsuiTimeline:{inputCurrentTime:Q.Sn,changeCurrentTime:t=>{Q.En(this,"currenttime",t.args[0]);return true},inputLoop:t=>{Q.En(this,"loop",Number.isFinite(t.args[0])&&`${t.args[0]}-${t.args[1]}`);return true},inputLoopEnd:()=>this.style.overflowY="",inputLoopStart:()=>this.style.overflowY="hidden",inputCurrentTimeEnd:()=>this.style.overflowY="",inputCurrentTimeStart:()=>this.style.overflowY="hidden"}});this.timeline.qa(this);this.ondragstart=()=>false;this.#ps.main.onwheel=this.#As.bind(this);this.#ps.stepBtn.onclick=this.#eu.bind(this);this.#ps.main.querySelector(".gsuiTimewindow-mainContent").oncontextmenu=t=>t.preventDefault();this.#ps.panel.querySelector(".gsuiTimewindow-panelContent").onwheel=this.#Nd.bind(this);this.#ps.panel.querySelector(".gsuiTimewindow-panelExtendY").onmousedown=this.#Gd.bind(this,"side")}connectedCallback(){if(!this.firstChild){this.#ps.panel.style.minWidth=`${Q.za(this,"panelsize")||100}px`;this.append(...this.#Ea);if(this.hasAttribute("downpanel")){this.#ps.panelDown.firstChild.onmousedown=this.#ps.down.firstChild.onmousedown=this.#Gd.bind(this,"down");this.#ps.panelDown.style.height=this.#ps.down.style.height=`${Q.za(this,"downpanelsize")||50}px`}else{this.#ps.panelDown.remove();this.#ps.down.remove()}this.#Ea=null;Q.Va(this,{step:1,pxperbeat:100,lineheight:48,currenttime:0});new Ct({scrolledElem:this,leftShadow:this.#ps.panel,topShadow:[this.querySelector(".gsuiTimewindow-panelUp"),this.querySelector(".gsuiTimewindow-time")]})}}static get observedAttributes(){return["step","timedivision","pxperbeat","lineheight","currenttime","loop"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"step":Q.En(this.#ps.timeline,"step",i);this.#ps.stepBtn.firstChild.textContent=this.#ru(+i);break;case"timedivision":Q.En(this.#ps.timeline,"timedivision",i);Q.En(this.#ps.beatlines,"timedivision",i);break;case"pxperbeat":this.#$r=+i;Q.En(this.#ps.timeline,"pxperbeat",i);Q.En(this.#ps.beatlines,"pxperbeat",i);Q.En(this.#ps.sliderZoomX,"value",Q.Aa((i-this.#Id())/(this.#Fd()-this.#Id())));this.style.setProperty("--gsuiTimewindow-pxperbeat",`${i}px`);this.#ps.currentTime.style.fontSize=this.#ps.loopA.style.fontSize=this.#ps.loopB.style.fontSize=`${i}px`;break;case"lineheight":this.#Pd=+i;Q.En(this.#ps.sliderZoomY,"value",Q.Aa((i-this.#zd())/(this.#Rd()-this.#zd())));this.style.setProperty("--gsuiTimewindow-lineH",`${i}px`);break;case"currenttime":{const t=Q.za(this,"currenttimestep");Q.En(this.#ps.timeline,"currenttime",i);if(t){this.#ps.currentTime.style.left=`${(i/t|0)*t}em`}else{this.#ps.currentTime.style.left=`${i}em`}}break;case"loop":if(i){const[t,s]=i.split("-");this.classList.add("gsuiTimewindow-looping");Q.En(this.#ps.timeline,"loop",i);this.#ps.loopA.style.width=`${t}em`;this.#ps.loopB.style.left=`${s}em`}else{this.classList.remove("gsuiTimewindow-looping");this.#ps.timeline.removeAttribute("loop")}break}}}#ru(t){return t>=1?"1":t>=.5?"1 / 2":t>=.25?"1 / 4":"1 / 8"}#Id(){return Q.za(this,"pxperbeatmin")||8}#Fd(){return Q.za(this,"pxperbeatmax")||512}#zd(){return Q.za(this,"lineheightmin")||24}#Rd(){return Q.za(this,"lineheightmax")||256}#Kd(t,s,i,e){const n=t/s;const a=e/s*(i-s);return n*i+a}#eu(){const t=Q.za(this,"step");const s=t>=1?.5:t>=.5?.25:t>=.25?.125:1;Q.En(this,"step",s)}#As(t){if(t.ctrlKey){const s=t.deltaY>0?.9:1.1;const i=Math.round(Math.min(Math.max(this.#Id(),this.#$r*s),this.#Fd()));t.preventDefault();if(i!==this.#$r){const s=t.pageX-this.getBoundingClientRect().left-parseInt(this.#ps.panel.style.minWidth);this.scrollLeft=this.#Kd(this.scrollLeft,this.#$r,i,s);Q.En(this,"pxperbeat",i);Q.La(this,"gsuiTimewindow","pxperbeat",i)}}}#Nd(t){if(t.ctrlKey){const s=t.deltaY>0?.9:1.1;const i=Math.round(Math.min(Math.max(this.#zd(),this.#Pd*s),this.#Rd()));t.preventDefault();if(i!==this.#Pd){const s=t.pageY-this.getBoundingClientRect().top-parseInt(this.#ps.timeline.clientHeight);this.scrollTop=this.#Kd(this.scrollTop,this.#Pd,i,s);Q.En(this,"lineheight",i);Q.La(this,"gsuiTimewindow","lineheight",i)}}}#Gd(t,s){Q.Ha();if(t==="side"){this.#Cd=this.#ps.panel.clientWidth;this.#Md=s.pageX;Q.Pa.show("ew-resize");document.addEventListener("mousemove",this.#jd)}else{this.#Cd=this.#ps.down.clientHeight;this.#Ad=s.pageY;Q.Pa.show("ns-resize");document.addEventListener("mousemove",this.#Ed)}document.addEventListener("mouseup",this.#Td)}#Ld(t){const s=this.#Cd+(t.pageX-this.#Md);const i=Q.za(this,"panelsizemin")||50;const e=Q.za(this,"panelsizemax")||260;const n=Math.max(i,Math.min(s,e));this.#ps.panel.style.minWidth=`${n}px`}#Wd(t){const s=this.#Cd+(this.#Ad-t.pageY);const i=Q.za(this,"downpanelsizemin")||50;const e=Q.za(this,"downpanelsizemax")||260;const n=Math.max(i,Math.min(s,e));this.#ps.panelDown.style.height=this.#ps.down.style.height=`${n}px`}#Bd(){document.removeEventListener("mousemove",this.#Ed);document.removeEventListener("mousemove",this.#jd);document.removeEventListener("mouseup",this.#Td);Q.Pa.hide()}}Object.freeze(Bt);customElements.define("gsui-timewindow",Bt);"use strict";Q.Ea("gsui-libraries",(()=>[Q.Bn("div",{class:"gsuiLibraries-head"},Q.Bn("i",{class:"gsuiLibraries-head-icon gsuiIcon","data-icon":"waveform"}),Q.Bn("span",{class:"gsuiLibraries-head-title"},"library"),Q.Bn("div",{class:"gsuiLibraries-libBtns"},Q.Bn("button",{type:"button",class:"gsuiLibraries-libBtn","data-lib":"default"},"default"),Q.Bn("button",{type:"button",class:"gsuiLibraries-libBtn","data-lib":"local"},"local"))),Q.Bn("div",{class:"gsuiLibraries-body"},Q.Bn("gsui-library",{class:"gsuiLibrary-default"}),Q.Bn("gsui-library",{class:"gsuiLibrary-local"}))]));"use strict";class jt extends HTMLElement{#Ea=Q.Ln("gsui-libraries");#ps=Q.Wn(this.#Ea,{libBtns:".gsuiLibraries-libBtns",libDef:".gsuiLibrary-default",libLoc:".gsuiLibrary-local"});#Hd={default:this.#ps.libDef,local:this.#ps.libLoc};constructor(){super();Object.seal(this);this.#ps.libBtns.onclick=jt.#Vd.bind(null,this);this.#Hd.default.setPlaceholder("loading...");this.#Hd.local.setPlaceholder("drag'n drop your own samples in the app, they will appear here")}connectedCallback(){if(this.#Ea){this.append(...this.#Ea);this.#Ea=null;Q.Va(this,{lib:"default"})}}getLibrary(t){return this.#Hd[t]}static#Vd(t,s){if(s.target.dataset.lib){Q.En(t,"lib",s.target.dataset.lib)}}}Object.freeze(jt);customElements.define("gsui-libraries",jt);"use strict";Q.Ea("gsui-library",(()=>[Q.Bn("div",{class:"gsuiLibrary-head"}),Q.Bn("div",{class:"gsuiLibrary-body"},Q.Bn("div",{class:"gsuiLibrary-placeholder"},"no sample here..."))]));Q.Ea("gsui-library-sep",(t=>Q.Bn("div",{class:"gsuiLibrary-sep gsuiLibrary-sep-expanded","data-id":t,title:t},Q.Bn("button",{class:"gsuiLibrary-sep-btn",type:"button",tabindex:-1},Q.Bn("i",{class:"gsuiIcon","data-icon":"caret-right"}),Q.Bn("span",null,t)))));Q.Ea("gsui-library-sample",(t=>Q.Bn("div",{class:"gsuiLibrary-sample gsuiLibrary-sample-expanded",draggable:"true","data-id":t.id,"data-name":t.name,title:t.name},Q.Bn("div",{class:"gsuiLibrary-sample-wave"},Q.Ia("svg",{class:"gsuiLibrary-sample-svg",viewBox:"0 0 40 10",preserveAspectRatio:"none"},Q.Ia("polygon",{class:"gsuiLibrary-sample-poly",points:t.points}))))));"use strict";class Lt extends HTMLElement{#La=Q.La.bind(null,this,"gsuiLibrary");#Ea=Q.Ln("gsui-library");#ps=Q.Wn(this.#Ea,{body:".gsuiLibrary-body",placeholder:".gsuiLibrary-placeholder"});#Ud=new Map;#qd=null;#_d=null;#Yd=null;#Jd=new Map;constructor(){super();Object.seal(this);this.#ps.body.onclick=this.#Xd.bind(this);this.#ps.body.ondragstart=this.#Qd.bind(this);this.#ps.body.oncontextmenu=this.#Zd.bind(this)}connectedCallback(){if(this.#Ea){this.append(...this.#Ea);this.#Ea=null}}clear(){this.#Ud.forEach((t=>t.remove()));this.#Ud.clear();this.#Jd.clear();this.#ps.body.querySelectorAll(".gsuiLibrary-sep").forEach((t=>t.remove()))}unloadSamples(){this.#Ud.forEach((t=>{t.classList.remove("gsuiLibrary-sample-loading","gsuiLibrary-sample-ready");t.title=t.dataset.name}))}setPlaceholder(t){this.#ps.placeholder.textContent=t}setLibrary(t){let s;const i=Array.from(this.#ps.body.children).findLast((t=>t.classList.contains("gsuiLibrary-sep")));const e=t.map((t=>{if(typeof t!=="string"){const s=Q.Ln("gsui-library-sample",{id:t[0],points:t[1],name:t[2]||t[0]});if(this.#Jd.has(t[0])){s.classList.add("gsuiLibrary-sample-fav")}this.#Ud.set(t[0],s);return s}return s=Q.Ln("gsui-library-sep",t)}));this.#ps.body.append(...e);if(s&&s.dataset.id===i?.dataset.id){s.remove()}}bookmarkSample(t,s){s?this.#Jd.set(t):this.#Jd.delete(t);this.#Ud.get(t)?.classList.toggle("gsuiLibrary-sample-fav",s)}loadSample(t){const s=this.#Ud.get(t);s.classList.add("gsuiLibrary-sample-loading");s.title="loading..."}readySample(t){const s=this.#Ud.get(t);s.classList.remove("gsuiLibrary-sample-loading");s.classList.add("gsuiLibrary-sample-ready");s.title=s.dataset.name}playSample(t,s){const i=this.#Ud.get(t);this.stopSample();this.#qd=t;this.#_d=Q.Bn("div",{class:"gsuiLibrary-sample-cursor"});this.#_d.style.left="0%";this.#_d.style.transitionDuration=`${s}s`;i.classList.add("gsuiLibrary-sample-playing");i.append(this.#_d);setTimeout((()=>this.#_d.style.left="100%"),10);this.#Yd=setTimeout(this.stopSample.bind(this),s*1e3)}stopSample(){if(this.#qd){const t=this.#Ud.get(this.#qd);clearTimeout(this.#Yd);this.#_d.remove();t.classList.remove("gsuiLibrary-sample-playing");this.#_d=null;this.#qd=null;this.#Yd=null}}#tp(t){const s=!t.classList.contains("gsuiLibrary-sep-expanded");for(let i=t.nextElementSibling;i;i=i.nextElementSibling){if(i.classList.contains("gsuiLibrary-sample")){i.classList.toggle("gsuiLibrary-sample-expanded",s)}else{break}}t.classList.toggle("gsuiLibrary-sep-expanded",s)}#Qd(t){const s=t.target.dataset;const i=`${s.id}:${s.name}`;t.dataTransfer.setData(`library-buffer:${Q.Nn(this,"name")}`,i)}#Xd(t){const s=t.target;const i=s.classList;if(i.contains("gsuiLibrary-sep-btn")){this.#tp(s.parentNode)}else if(i.contains("gsuiLibrary-sample")&&!i.contains("gsuiLibrary-sample-loading")){const t=i.contains("gsuiLibrary-sample-ready")?"playSample":"loadSample";this.#La(t,s.dataset.id)}}#Zd(t){if(t.target.classList.contains("gsuiLibrary-sample")){this.#La("stopSample")}return false}}Object.freeze(Lt);customElements.define("gsui-library",Lt);"use strict";Q.Ea("gsui-patterns-infoPopup",(()=>Q.Bn("div",{id:"gsuiPatterns-infoPopupContent"},Q.Bn("fieldset",null,Q.Bn("legend",null,"Type"),Q.Bn("label",null,Q.Bn("input",{type:"radio",name:"type",value:"drum"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"buf-drum"}),Q.Bn("span",null,"drum")),Q.Bn("label",null,Q.Bn("input",{type:"radio",name:"type",value:"fx"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"buf-fx"}),Q.Bn("span",null,"fx")),Q.Bn("label",null,Q.Bn("input",{type:"radio",name:"type",value:"vocal"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"buf-vocal"}),Q.Bn("span",null,"vocal")),Q.Bn("label",null,Q.Bn("input",{type:"radio",name:"type",value:"loop"}),Q.Bn("i",{class:"gsuiIcon","data-icon":"buf-loop"}),Q.Bn("span",null,"loop"),Q.Bn("span",null,"bpm"),Q.Bn("input",{class:"gsuiPopup-inputText",type:"number",name:"bpm",min:1,max:999.99,step:.01}))),Q.Bn("fieldset",null,Q.Bn("legend",null,"Name"),Q.Bn("label",null,Q.Bn("input",{class:"gsuiPopup-inputText",type:"text",name:"name"}))))));"use strict";Q.Ea("gsui-patterns-pattern",(()=>Q.Bn("div",{class:"gsuiPatterns-pattern",draggable:"true"},Q.Bn("div",{class:"gsuiPatterns-pattern-grip gsuiIcon","data-icon":"grip-v"}),Q.Bn("div",{class:"gsuiPatterns-pattern-head"},Q.Bn("div",{class:"gsuiPatterns-pattern-info"},Q.Bn("button",{class:"gsuiPatterns-pattern-btn gsuiPatterns-pattern-btnInfo gsuiIcon","data-action":"editInfo","data-icon":"buf-undefined",title:"Edit buffer's info"}),Q.Bn("div",{class:"gsuiPatterns-pattern-name"}),Q.Bn("i",{class:"gsuiPatterns-destArrow gsuiIcon","data-icon":"arrow-right"}),Q.Bn("button",{class:"gsuiPatterns-btnSolid gsuiPatterns-pattern-dest","data-action":"redirect",title:"Redirect this pattern"},Q.Bn("i",{class:"gsuiPatterns-btnIcon gsuiIcon","data-icon":"mixer"}),Q.Bn("span",{class:"gsuiPatterns-btnText"}))),Q.Bn("button",{class:"gsuiPatterns-pattern-btn gsuiIcon","data-action":"clone","data-icon":"clone",title:"Clone this pattern"}),Q.Bn("button",{class:"gsuiPatterns-pattern-btn gsuiIcon","data-action":"remove","data-icon":"close",title:"Delete this pattern"})),Q.Bn("div",{class:"gsuiPatterns-pattern-content"}),Q.Bn("div",{class:"gsuiPatterns-pattern-placeholder"},Q.Bn("i",{class:"gsuiPatterns-pattern-placeholderIcon gsuiIcon","data-icon":"file-corrupt"}),Q.Bn("span",{class:"gsuiPatterns-pattern-placeholderText"},"missing data")))));"use strict";Q.Ea("gsui-patterns-synth",(()=>Q.Bn("div",{class:"gsuiPatterns-synth"},Q.Bn("div",{class:"gsuiPatterns-synth-head"},Q.Bn("button",{class:"gsuiPatterns-synth-btn gsuiPatterns-synth-expand gsuiIcon","data-action":"expand","data-icon":"caret-right"}),Q.Bn("div",{class:"gsuiPatterns-synth-info"},Q.Bn("div",{class:"gsuiPatterns-synth-name"}),Q.Bn("i",{class:"gsuiPatterns-destArrow gsuiIcon","data-icon":"arrow-right"}),Q.Bn("button",{class:"gsuiPatterns-btnSolid gsuiPatterns-synth-dest","data-action":"redirect",title:"Redirect this synthesizer"},Q.Bn("i",{class:"gsuiPatterns-btnIcon gsuiIcon","data-icon":"mixer"}),Q.Bn("span",{class:"gsuiPatterns-btnText"}))),Q.Bn("button",{class:"gsuiPatterns-synth-btn gsuiIcon","data-action":"newPattern","data-icon":"plus",title:"Create a new pattern with this synthesizer"}),Q.Bn("button",{class:"gsuiPatterns-synth-btn gsuiIcon","data-action":"delete","data-icon":"close",title:"Delete the synthesizer and its patterns"})),Q.Bn("div",{class:"gsuiPatterns-placeholderToCheck gsuiPatterns-synth-patterns"},Q.Bn("div",{class:"gsuiPatterns-placeholder"},Q.Bn("span",null,"this synthesizer has no related pattern"))))));"use strict";Q.Ea("gsui-patterns",(()=>Q.Bn("gsui-panels",{class:"gsuiPanels-y"},Q.Ln("gsui-patterns-panel",{class:"Buffers",title:"buffers",icon:"waveform",placeholder:"drag 'n drop raw files here (mp3, ogg, wav)"}),Q.Ln("gsui-patterns-panel",{class:"Slices",title:"slices",icon:"slices",placeholder:"no slices yet",button:{action:"newSlices",title:"Create a new slices pattern"}}),Q.Ln("gsui-patterns-panel",{class:"Drums",title:"drums",icon:"drums",placeholder:"no drums yet",button:{action:"newDrums",title:"Create a new drums pattern"}}),Q.Ln("gsui-patterns-panel",{class:"Keys",title:"keys",icon:"oscillator",placeholder:"no synth yet",button:{action:"newSynth",title:"Create a new synthesizer"}}))));Q.Ea("gsui-patterns-panel",(t=>Q.Bn("div",{class:`gsuiPatterns-panel gsuiPatterns-panel${t.class}`},Q.Bn("div",{class:"gsuiPatterns-panel-menu"},Q.Bn("i",{class:"gsuiPatterns-panel-icon gsuiIcon","data-icon":t.icon}),Q.Bn("span",{class:"gsuiPatterns-panel-title"},t.title),t.button&&Q.Bn("button",{class:"gsuiPatterns-btnSolid","data-action":t.button.action,title:t.button.title},Q.Bn("i",{class:"gsuiPatterns-btnIcon gsuiIcon","data-icon":"plus"}))),Q.Bn("div",{class:"gsuiPatterns-panel-list-wrap"},Q.Bn("div",{class:"gsuiPatterns-placeholderToCheck gsuiPatterns-panel-list"}),Q.Bn("div",{class:"gsuiPatterns-placeholder"},Q.Bn("span",null,t.placeholder))))));"use strict";class Et extends HTMLElement{#La=Q.La.bind(null,this,"gsuiPatterns");#sp=Object.freeze({clone:t=>this.onchange("clonePattern",t),remove:t=>this.onchange("removePattern",t),editInfo:(t,s)=>this.#ip(t,s),undefined:t=>this.onchange("openPattern",t),redirect:(t,s,i)=>this.#ep("redirectPatternBuffer",t,i.target.dataset.id)});#np=Object.freeze({expand:t=>this.expandSynth(t),undefined:t=>this.onchange("openSynth",t),redirect:(t,s)=>this.#ep("redirectSynth",t,s.target.dataset.id),newPattern:t=>{this.onchange("addPatternKeys",t);this.expandSynth(t,true)},delete:t=>{this.#ps.lists.synth.children.length>1?this.onchange("removeSynth",t):Q.Un.alert("Error","You have to keep at least one synthesizer")}});#Ea=Q.Ln("gsui-patterns");#ps=Q.Wn(this.#Ea,{lists:{slices:".gsuiPatterns-panelSlices .gsuiPatterns-panel-list",drums:".gsuiPatterns-panelDrums .gsuiPatterns-panel-list",synth:".gsuiPatterns-panelKeys .gsuiPatterns-panel-list",buffer:".gsuiPatterns-panelBuffers .gsuiPatterns-panel-list"},newSlices:"[data-action='newSlices']",newDrums:"[data-action='newDrums']",newSynth:"[data-action='newSynth']"});#ap=this.#ps.lists.synth.getElementsByClassName("gsuiPatterns-synth-patterns");static infoPopupContent=Q.Ln("gsui-patterns-infoPopup");constructor(){super();this.onchange=this.onpatternDataTransfer=null;Object.seal(this);new dt({rootElement:this.#ps.lists.buffer,direction:"column",dataTransfer:(...t)=>this.onpatternDataTransfer(...t),dataTransferType:"pattern-buffer",itemSelector:".gsuiPatterns-pattern",handleSelector:".gsuiPatterns-pattern-grip",parentSelector:".gsuiPatterns-panel-list",onchange:this.#op.bind(this,this.#ps.lists.buffer)});new dt({rootElement:this.#ps.lists.slices,direction:"column",dataTransfer:(...t)=>this.onpatternDataTransfer(...t),dataTransferType:"pattern-slices",itemSelector:".gsuiPatterns-pattern",handleSelector:".gsuiPatterns-pattern-grip",parentSelector:".gsuiPatterns-panel-list",onchange:this.#op.bind(this,this.#ps.lists.slices)});new dt({rootElement:this.#ps.lists.drums,direction:"column",dataTransfer:(...t)=>this.onpatternDataTransfer(...t),dataTransferType:"pattern-drums",itemSelector:".gsuiPatterns-pattern",handleSelector:".gsuiPatterns-pattern-grip",parentSelector:".gsuiPatterns-panel-list",onchange:this.#op.bind(this,this.#ps.lists.drums)});new dt({rootElement:this.#ps.lists.synth,direction:"column",dataTransfer:(...t)=>this.onpatternDataTransfer(...t),dataTransferType:"pattern-keys",itemSelector:".gsuiPatterns-pattern",handleSelector:".gsuiPatterns-pattern-grip",parentSelector:".gsuiPatterns-synth-patterns",onchange:this.#rp.bind(this)});this.#ps.lists.buffer.ondrop=t=>{const s=t.dataTransfer.getData("library-buffer:default");const i=t.dataTransfer.getData("library-buffer:local");if(s){this.#La("libraryBufferDropped","default",s)}else if(i){this.#La("libraryBufferDropped","local",i)}};this.#ps.lists.synth.ondragover=t=>{const s=t.target.closest(".gsuiPatterns-synth");if(s){this.expandSynth(s.dataset.id,true)}};this.#ps.lists.synth.ondblclick=t=>{if(t.target.classList.contains("gsuiPatterns-synth-info")){this.expandSynth(t.target.closest(".gsuiPatterns-synth").dataset.id)}};this.#ps.lists.buffer.onclick=this.#ps.lists.slices.onclick=this.#ps.lists.drums.onclick=this.#hp.bind(this);this.#ps.lists.synth.onclick=this.#cp.bind(this);this.#ps.newSlices.onclick=()=>this.onchange("addPatternSlices");this.#ps.newDrums.onclick=()=>this.onchange("addPatternDrums");this.#ps.newSynth.onclick=()=>this.onchange("addSynth")}connectedCallback(){if(!this.firstChild){this.append(this.#Ea);this.#Ea=null}}expandSynth(t,s){const i=this.#lp(t);const e=i.classList.toggle("gsuiPatterns-synth-expanded",s);i.querySelector(".gsuiPatterns-synth-expand").dataset.icon=`caret-${e?"down":"right"}`}reorderPatterns(t){dt.listReorder(this.#ps.lists.buffer,t);dt.listReorder(this.#ps.lists.slices,t);dt.listReorder(this.#ps.lists.drums,t);Array.prototype.forEach.call(this.#ap,(s=>{dt.listReorder(s,t)}))}#ep(t,s,i){ot.openSelectChannelPopup(i).then((i=>i&&this.onchange(t,s,i)))}#ip(t,s){const i=Et.infoPopupContent.querySelector(`[value="${s.dataset.bufferType}"]`);if(i){i.checked=true}else{const t=Et.infoPopupContent.querySelector("input:checked");if(t){t.checked=false}}Et.infoPopupContent.querySelector("[name='bpm']").value=s.dataset.bufferBpm;Et.infoPopupContent.querySelector("[name='name']").value=s.dataset.name;Q.Un.custom({title:"Buffer's info",element:Et.infoPopupContent,submit:s=>{s.bpm=s.bpm||null;this.onchange("changePatternBufferInfo",t,s)}})}updateChannel(t,s){this.querySelectorAll(`.gsuiPatterns-btnSolid[data-id="${t}"] .gsuiPatterns-btnText`).forEach((t=>t.textContent=s))}addSynth(t){const s=Q.Ln("gsui-patterns-synth");s.dataset.id=t;this.#ps.lists.synth.prepend(s)}changeSynth(t,s,i){const e=this.#lp(t);switch(s){case"name":e.querySelector(".gsuiPatterns-synth-name").textContent=i;break;case"dest":e.querySelector(".gsuiPatterns-synth-dest").dataset.id=i;break;case"destName":e.querySelector(".gsuiPatterns-synth-dest .gsuiPatterns-btnText").textContent=i;break}}deleteSynth(t){this.#lp(t).remove()}addPattern(t,{type:s,synth:i}){const e=Q.Ln("gsui-patterns-pattern");e.dataset.id=t;if(s!=="buffer"){e.querySelector(".gsuiPatterns-pattern-btnInfo").remove();e.querySelector(".gsuiPatterns-destArrow").remove();e.querySelector(".gsuiPatterns-pattern-dest").remove()}else{e.querySelector("[data-action='clone']").remove()}this.#up(s,i).append(e)}changePattern(t,s,i){const e=this.getPattern(t);switch(s){case"data-missing":Q.En(e,"data-missing",i);break;case"order":e.dataset.order=i;break;case"name":e.dataset.name=i;e.querySelector(".gsuiPatterns-pattern-name").textContent=i;break;case"dest":e.querySelector(".gsuiPatterns-pattern-dest").dataset.id=i;break;case"destName":e.querySelector(".gsuiPatterns-pattern-dest .gsuiPatterns-btnText").textContent=i;break;case"synth":this.#up("keys",i).append(e);break;case"bufferType":Q.En(e,"data-buffer-type",i);e.querySelector(".gsuiPatterns-pattern-btnInfo").dataset.icon=`buf-${i||"undefined"}`;break;case"bufferBpm":Q.En(e,"data-buffer-bpm",i);break}}appendPatternSVG(t,s){s.classList.add("gsuiPatterns-pattern-svg");this.getPattern(t).querySelector(".gsuiPatterns-pattern-content").append(s)}deletePattern(t){const s=this.getPattern(t);if(s){s.remove()}}selectPattern(t,s){const i=this.#ps.lists[t==="keys"?"synth":t];i.querySelector(".gsuiPatterns-pattern-selected")?.classList?.remove("gsuiPatterns-pattern-selected");this.getPattern(s)?.classList?.add("gsuiPatterns-pattern-selected")}selectSynth(t){this.#ps.lists.synth.querySelector(".gsuiPatterns-synth-selected")?.classList?.remove("gsuiPatterns-synth-selected");this.#lp(t).classList.add("gsuiPatterns-synth-selected")}getPattern(t){return this.querySelector(`.gsuiPatterns-pattern[data-id="${t}"]`)}#lp(t){return this.#ps.lists.synth.querySelector(`.gsuiPatterns-synth[data-id="${t}"]`)}#up(t,s){switch(t){case"slices":case"buffer":case"drums":return this.#ps.lists[t];case"keys":return this.#ps.lists.synth.querySelector(`.gsuiPatterns-synth[data-id="${s}"] .gsuiPatterns-synth-patterns`)}}#op(t,s){this.onchange("reorderPattern",s.dataset.id,dt.listComputeOrderChange(t,{}))}#rp(t,s,i,e,n){if(e===n){this.#op(e,t)}else{const s=t.dataset.id;const i=n.parentNode.dataset.id;const a={[s]:{synth:i}};dt.listComputeOrderChange(e,a);dt.listComputeOrderChange(n,a);this.onchange("redirectPatternKeys",s,i,a)}}#hp(t){const s=t.target.closest(".gsuiPatterns-pattern");if(s){this.#sp[t.target.dataset.action](s.dataset.id,s,t);return false}}#cp(t){if(this.#hp(t)!==false){const s=t.target.closest(".gsuiPatterns-synth");if(s){this.#np[t.target.dataset.action](s.dataset.id,t)}}}}Object.freeze(Et);customElements.define("gsui-patterns",Et);"use strict";class Wt extends HTMLElement{constructor(){super();Object.seal(this);this.oncontextmenu=()=>false;this.onmousedown=t=>{if(t.button===2){Q.La(this,"gsuiToggle","toggleSolo")}else if(t.button===0){const t=Q.Nn(this,"off")!==null;Q.En(this,"off",!t);Q.La(this,"gsuiToggle","toggle",t)}}}connectedCallback(){Q.En(this,"tabindex",0)}}Object.freeze(Wt);customElements.define("gsui-toggle",Wt);"use strict";Q.Ea("gsui-track",(()=>[Q.Bn("gsui-toggle",{title:"toggle track (right click for solo)"}),Q.Bn("div",{class:"gsuiTrack-nameWrap"},Q.Bn("input",{class:"gsuiTrack-name",type:"text",disabled:true,spellcheck:"false"}))]));Q.Ea("gsui-track-row",(()=>Q.Bn("div",{class:"gsuiTrack-row gsui-row"},Q.Bn("div"))));"use strict";class It extends HTMLElement{rowElement=Q.Ln("gsui-track-row");#La=Q.La.bind(null,this,"gsuiTrack");#Ea=Q.Ln("gsui-track");#dp=this.#Ea[1].firstChild;constructor(){super();Object.seal(this);this.onchange=this.#fi.bind(this);this.onkeydown=this.#Ps.bind(this);this.ondblclick=this.#pp.bind(this);this.#dp.onblur=this.#Eu.bind(this);Q.zn(this,{gsuiToggle:{toggle:t=>{Q.En(this,"mute",!t.args[0]);this.#La("toggle",t.args[0])},toggleSolo:()=>{Q.En(this,"mute",false);this.#La("toggleSolo")}}})}connectedCallback(){if(!this.firstChild){this.append(...this.#Ea);this.#Ea=null;Q.Va(this,{name:"",order:0})}}static get observedAttributes(){return["mute","name","order"]}attributeChangedCallback(t,s,i){if(s!==i){switch(t){case"mute":this.rowElement.classList.toggle("gsui-mute",i!==null);Q.En(this.firstElementChild,"off",i!==null);break;case"name":this.#dp.value=i;break;case"order":this.dataset.order=i;this.#dp.placeholder=`track ${+i+1}`;break}}}#pp(t){if(t.target===this.#dp){this.#dp.disabled=false;this.#dp.select();this.#dp.focus()}}#Ps(t){if(t.target===this.#dp){t.stopPropagation();switch(t.key){case"Escape":this.#dp.value=Q.Nn(this,"name");case"Enter":this.#dp.blur()}}}#fi(){const t=this.#dp.value.trim();this.#dp.disabled=true;Q.En(this,"name",t);this.#La("rename",t)}#Eu(){this.#dp.disabled=true}}Object.freeze(It);customElements.define("gsui-track",It);"use strict";class Ft extends HTMLElement{#La=Q.La.bind(null,this,"gsuiTracklist");#gp=new Map;constructor(){super();Object.seal(this);Q.zn(this,{gsuiTrack:{rename:(t,s)=>this.#La("renameTrack",s.dataset.id,t.args[0]),toggle:(t,s)=>this.#La("toggleTrack",s.dataset.id),toggleSolo:(t,s)=>this.#La("toggleSoloTrack",s.dataset.id)}})}getTrack(t){return this.#gp.get(t)}addTrack(t){const s=Q.Bn("gsui-track",{"data-id":t});s.rowElement.dataset.id=t;this.#gp.set(t,s);this.append(s);return s}removeTrack(t){const s=this.#gp.get(t);s.remove();s.rowElement.remove();this.#gp.delete(t)}}Object.freeze(Ft);customElements.define("gsui-tracklist",Ft);"use strict";class Kt extends HTMLElement{#mp=Q.Bn("canvas");#Ni=this.#mp.getContext("2d");constructor(){super();Object.seal(this)}connectedCallback(){if(!this.firstChild){this.append(this.#mp)}}clear(){this.#Ni.clearRect(0,0,this.#mp.width,this.#mp.height)}setResolution(t,s){const i=this.#Ni.getImageData(0,0,this.#mp.width,this.#mp.height);this.#mp.width=t;this.#mp.height=s;this.#Ni.putImageData(i,0,0)}draw(t,s){Kt.#fp(this.#Ni);Kt.#il(this.#Ni,t,s)}static#fp(t){t.putImageData(t.getImageData(0,0,t.canvas.width,t.canvas.height-1),0,1)}static#il(t,s,i){const e=t.canvas.width/2;const n=Math.min(e,s.length);const a=zt.draw(t,s,e);const o=zt.draw(t,i,e);const r=t.createImageData(n,1);for(let t=0,s=n-1;t<n;++t,--s){Kt.#bp(r.data,a.data,t*4,s*4)}t.putImageData(r,0,0);t.putImageData(o,e,0)}static#bp(t,s,i,e){t[i]=s[e];t[i+1]=s[e+1];t[i+2]=s[e+2];t[i+3]=s[e+3]}}Object.freeze(Kt);customElements.define("gsui-analyser",Kt);"use strict";class zt extends HTMLElement{#mp=Q.Bn("canvas");#Ni=this.#mp.getContext("2d");constructor(){super();Object.seal(this);this.#mp.height=1}connectedCallback(){if(!this.firstChild){this.append(this.#mp)}}clear(){this.#Ni.clearRect(0,0,this.#mp.width,1)}setResolution(t){this.#mp.width=t;this.#mp.height=1}draw(t){this.#Ni.putImageData(zt.draw(this.#Ni,t,this.#mp.width),0,0)}static#wp=[.08,.15,.17,.25,.3,.4,.6,.8,Infinity];static#vp=[[5,2,20,.08],[8,5,30,.15],[15,7,50,.17],[75,7,35,.25],[80,0,0,.3],[180,0,0,.4],[200,25,10,.6],[200,128,10,.8],[200,200,20,1]];static draw(t,s,i=s.length){const e=t.createImageData(i,1);const n=e.data;const a=s.length;let o=-1;for(let t=0;t<i;++t){const e=t*4;const r=Math.max(Math.round(a*2**(t/i*11-11)),o+1);const h=1-Math.cos(s[r]/255*Math.PI/2);o=r;if(h<.05){n[e]=4+10*h|0;n[e+1]=4+10*h|0;n[e+2]=5+20*h|0}else{const t=zt.#wp.findIndex((t=>h<t));const s=zt.#vp[t];const i=h/s[3];n[e]=s[0]*i|0;n[e+1]=s[1]*i|0;n[e+2]=s[2]*i|0}n[e+3]=255}return e}}Object.freeze(zt);customElements.define("gsui-spectrum",zt);"use strict";class Rt{static#yp=0;#kp=`gsuiSVGDefs_${Rt.#yp++}_`;#$p=Q.Ia("defs");#Op=new Map;#xp=1;#Sp=1;constructor(){const t=Q.Ia("svg");this.rootElement=t;Object.freeze(this);t.style.display="none";t.classList.add("gsuiSVGDefs");t.append(this.#$p);document.body.prepend(t)}setDefaultViewbox(t,s){this.#xp=t;this.#Sp=s}empty(){this.#Op.forEach((t=>t.g.remove()));this.#Op.clear()}delete(t){this.#Op.get(t).g.remove();this.#Op.delete(t)}add(t,s=0,i=0,...e){if(this.#Op.has(t)){console.error(`gsuiSVGDefs: ID "${t}" already used`)}else{const n=Q.Ia("g");n.id=`${this.#kp}${t}`;n.append(...e);this.#$p.append(n);this.#Op.set(t,{g:n,w:s,h:i})}}update(t,s,i,...e){const n=this.#Op.get(t);n.w=s;n.h=i;Q.Ga(n.g);n.g.append(...e)}createSVG(t){const s=this.#Op.get(t)||{};const i=Q.Ia("use");const e=Q.Ia("svg",{preserveAspectRatio:"none",viewBox:`0 0 ${s.w||this.#xp} ${s.h||this.#Sp}`},i);e.dataset.id=t;i.setAttributeNS("http://www.w3.org/1999/xlink","href",`#${this.#kp}${t}`);return e}setSVGViewbox(t,s,i){const e=this.#Op.get(t.dataset.id).h;Q.En(t,"viewBox",`${s} 0 ${i} ${e}`)}}Object.freeze(Rt);"use strict";class Nt{constructor(t){const s=t||Q.Ia("svg");const i=s.querySelector("polygon");this.rootElement=s;this.polygon=i;this.width=this.height=0;Object.seal(this);Q.En(s,"preserveAspectRatio","none");s.classList.add("gsuiWaveform");if(!i){this.polygon=Q.Ia("polygon");s.append(this.polygon)}}remove(){this.empty();this.rootElement.remove()}empty(){this.polygon.removeAttribute("points")}setResolution(t,s){this.width=t;this.height=s;Q.En(this.rootElement,"viewBox",`0 0 ${t} ${s}`)}drawBuffer(t,s,i){Nt.drawBuffer(this.polygon,this.width,this.height,t,s,i)}static drawBuffer(t,s,i,e,n,a){const o=e.getChannelData(0);const r=e.numberOfChannels>1?e.getChannelData(1):o;const h=n||0;const c=a||e.duration-h;Nt.draw(t,s,i,o,r,e.duration,h,c)}static draw(t,s,i,e,n,a,o,r){Q.En(t,"points",Nt.#Dp(s,i,e,n,a,o,r))}static getPointsFromBuffer(t,s,i,e,n){const a=i.getChannelData(0);const o=i.numberOfChannels>1?i.getChannelData(1):a;const r=e||0;const h=n||i.duration-r;return Nt.#Dp(t,s,a,o,i.duration,r,h)}static#Dp(t,s,i,e,n,a,o){const r=s/2;const h=o/n*i.length/t;const c=~~(a/n*i.length);const l=~~Math.max(1,h/100);let u=`0,${Nt.#Cp(r+i[c]*r)}`;let d=`0,${Nt.#Cp(r+e[c]*r)}`;for(let n=1;n<t;++n){let t=Infinity;let a=-Infinity;let o=~~(c+(n-1)*h);const p=o+h;for(;o<p;o+=l){t=Math.min(t,i[o],e[o]);a=Math.max(a,i[o],e[o])}if(Math.abs(a-t)*r<1){a+=1/s;t-=1/s}u+=` ${n},${Nt.#Cp(r+t*r)}`;d=`${n},${Nt.#Cp(r+a*r)} ${d}`}return`${u} ${d}`}static#Cp(t){return t.toFixed(2)}}"use strict";class Gt extends Rt{#Pp=false;hdMode(t){this.#Pp=t}update(t,s){const i=Q.Ia("polygon");const e=this.#Pp?260:s.duration*48|0;const n=48;Nt.drawBuffer(i,e,n,s);return super.update(t,e,n,i)}setSVGViewbox(t,s,i,e){const n=this.#Pp?260:48/e;return super.setSVGViewbox(t,s*n,i*n)}}Object.freeze(Gt);"use strict";class Ht extends Rt{update(t,s,i){return super.update(t,i,1,...Ht.#Xo(s))}static#Xo(t){const s=Object.values(t);const{min:i,size:e}=Ht.#Mp(s);const n=1/(e+1);return s.map((t=>Q.Ia("rect",{x:t.when,y:(e-t.key+i)*n,width:t.duration,height:n})))}static#Mp(t){let s=Infinity;let i=-Infinity;t.forEach((t=>{s=Math.min(s,t.key);i=Math.max(i,t.key)}));s-=s%12;i+=11-i%12;return{min:s,size:i-s}}}Object.freeze(Ht);"use strict";class Vt extends Rt{update(t,s,i,e,n){return super.update(t,e,1,...Vt.#Xo(s,i,n))}static#Xo(t,s,i){const e=Object.entries(s);const n=1/i;const a=1/e.length;const o=e.sort(((t,s)=>t[1].order-s[1].order)).reduce(((t,[s],i)=>{t[s]=i;return t}),{});return Object.values(t).map((t=>("gain"in t?Vt.#Ap:Vt.#Tp)(t.when,o[t.row]*a,n,a)))}static#Ap(t,s,i,e){return Q.Ia("polygon",{points:[t,s,t,s+e*.75,t+i,s+e*.75/2].join(",")})}static#Tp(t,s,i,e){return Q.Ia("rect",{x:t,y:s+e*.8,width:i*.9,height:e*.2})}}Object.freeze(Vt);"use strict";class Ut extends Rt{update(t,s,i){return super.update(t,i,1,...Ut.#Xo(s,i))}static#Xo(t,s){return Object.values(t).map((t=>[Ut.#Bp(t,s,null),Ut.#Bp(t,s,.25)])).flat(1)}static#Bp({x:t,y:s,w:i},e,n){return Q.Ia("rect",{x:e*t,y:s,opacity:n,width:e*(i-.005),height:n===null?.05:1-s})}}Object.freeze(Ut);"use strict";class qt extends HTMLElement{#jp={};#Lp=null;#Ep=null;#Wp=null;#Ip=null;constructor(){super();this.onopen=this.onclose=null;this._arrWindows=[];Object.seal(this)}_a(t){this.#Ep=t}Gn(t){const s=Q.Bn("gsui-window",false);s.dataset.id=t;s.Ya(this);s.addEventListener("focusin",this.#Fp.bind(this,s));this._arrWindows.push(s);this.#jp[t]=s;this.append(s);return s}Fn(t){return this.#jp[t]}_startMousemoving(t,s,i){this.#Lp=this.#Kp.bind(this,i);this.#Wp=s;document.addEventListener("mouseup",this.#Lp);document.addEventListener("mousemove",s);Q.Ha();Q.Pa.show(t)}#Kp(t,s){document.removeEventListener("mouseup",this.#Lp);document.removeEventListener("mousemove",this.#Wp);Q.Pa.hide();this.#Lp=this.#Wp=null;t(s)}_open(t){this.#Fp(t);this.onopen?.(t)}_close(t){if(t===this.#Ip){this.#Ip=null}this.onclose?.(t)}#Fp(t,s){if(t!==this.#Ip){const s=+t.style.zIndex||0;this._arrWindows.forEach((t=>{const i=+t.style.zIndex||0;if(i>s){t.style.zIndex=i-1}}));t.style.zIndex=this._arrWindows.length-1;this.#Ip=t}}}Object.freeze(qt);customElements.define("gsui-windows",qt);"use strict";Q.Ea("gsui-window",(t=>[Q.Bn("div",{class:"gsuiWindow-handlers"},Q.Bn("div",{class:"gsuiWindow-handler","data-dir":"n"}),Q.Bn("div",{class:"gsuiWindow-handler","data-dir":"e"}),Q.Bn("div",{class:"gsuiWindow-handler","data-dir":"s"}),Q.Bn("div",{class:"gsuiWindow-handler","data-dir":"w"}),Q.Bn("div",{class:"gsuiWindow-handler","data-dir":"nw"}),Q.Bn("div",{class:"gsuiWindow-handler","data-dir":"ne"}),Q.Bn("div",{class:"gsuiWindow-handler","data-dir":"sw"}),Q.Bn("div",{class:"gsuiWindow-handler","data-dir":"se"})),Q.Bn("div",{class:"gsuiWindow-wrap"},Q.Bn("div",{class:"gsuiWindow-head"},Q.Bn("button",{class:"gsuiWindow-icon gsuiIcon",tabindex:-1}),Q.Bn("div",{class:"gsuiWindow-title"}),Q.Bn("div",{class:"gsuiWindow-headContent"}),Q.Bn("div",{class:"gsuiWindow-headBtns"},Q.Bn("button",{class:"gsuiWindow-headBtn gsuiIcon","data-action":"minimize","data-icon":"minimize",title:"Minimize"}),Q.Bn("button",{class:"gsuiWindow-headBtn gsuiIcon","data-action":"restore","data-icon":"restore",title:"Restore"}),Q.Bn("button",{class:"gsuiWindow-headBtn gsuiIcon","data-action":"maximize","data-icon":"maximize",title:"Maximize"}),Q.Bn("button",{class:"gsuiWindow-headBtn gsuiIcon","data-action":"close","data-icon":"close",title:"Close"}))),Q.Bn("div",{class:"gsuiWindow-content"}))]));"use strict";class _t extends HTMLElement{#zp=32;#Rp=32;#Np=false;#Gp=null;#Hp=false;#Vp=false;#Up=Object.seal({x:0,y:0,w:32,h:32});#qp=Object.seal({x:0,y:0});#_p=Object.seal({x:0,y:0});#Yp=0;#Ea=Q.Ln("gsui-window");#ps=Q.Wn(this.#Ea,{icon:".gsuiWindow-icon",wrap:".gsuiWindow-wrap",head:".gsuiWindow-head",title:".gsuiWindow-title",content:".gsuiWindow-content",handlers:".gsuiWindow-handlers",headBtns:".gsuiWindow-headBtns",headContent:".gsuiWindow-headContent"});constructor(){super();this.rect=Object.seal({x:0,y:0,w:32,h:32});Object.seal(this);this.#ps.icon.ondblclick=this.Rn.bind(this);this.#ps.headBtns.onclick=this.#Vd.bind(this);this.#ps.head.onmousedown=this.#Jp.bind(this);this.#ps.title.ondblclick=this.#ps.headContent.ondblclick=this.#Xp.bind(this);this.#ps.handlers.onmousedown=this.#Qp.bind(this)}connectedCallback(){if(!this.firstChild){Q.En(this,"tabindex",0);this.append(...this.#Ea);this.#Ea=null}}static get observedAttributes(){return["x","y","w","h","wmin","hmin","icon","title"]}attributeChangedCallback(t,s,i){switch(t){case"y":this.style.top=`${this.rect.y=+i}px`;break;case"x":this.style.left=`${this.rect.x=+i}px`;break;case"w":this.style.width=`${this.rect.w=+i}px`;break;case"h":this.style.height=`${this.rect.h=+i}px`;break;case"wmin":this.#zp=+i;break;case"hmin":this.#Rp=+i;break;case"icon":this.#ps.icon.dataset.icon=i;break;case"title":this.#ps.title.textContent=i;break}}Ja(){return this.#Np}In(){return this.Xa(true)}Rn(){return this.Xa(false)}Xa(t){if(t!==this.#Np){if(t){this.#Np=true;this.#Zp("show",true);this.#Gp._open(this)}else if(!this.onclose||this.onclose()!==false){this.#Np=false;this.#Zp("show",false);Q.Ga(this.#ps.content);this.#Gp._close(this)}}else if(this.#Hp){this.Qa()}}Ya(t){this.#Gp=t}xs(){Q.Ga(this.#ps.content);Q.Ga(this.#ps.headContent)}Vn(...t){this.#ps.content.append(...t)}Hn(...t){this.#ps.headContent.append(...t)}Za(){if(!this.#Vp){const t=this.style;const s=this.#Hp;this.#Up.x=this.rect.x;this.#Up.y=this.rect.y;this.#Up.w=this.rect.w;if(!s){this.#Up.h=this.rect.h}t.top=t.left=t.right=t.bottom=t.width=t.height="";this.#Zp("maximized",true);this.#Zp("minimized",false);this.#Vp=true;this.#Hp=false;if(s){this.#Gp._open(this)}this.focus({preventScroll:true})}}so(){if(!this.#Hp){const t=this.#Up;if(!this.#Vp){Object.assign(t,this.rect)}this.#Zp("minimized",true);this.#Zp("maximized",false);this.#Hp=true;this.#Vp=false;Q.En(this,{x:t.x,y:t.y,w:t.w,h:this.#tg()});Q.Ga(this.#ps.content);this.#Gp._close(this)}}Qa(){if(this.#Hp||this.#Vp){const t=this.#Up;const s=this.#Hp;this.focus({preventScroll:true});this.#Zp("minimized",false);this.#Zp("maximized",false);this.#Hp=this.#Vp=false;Q.En(this,{x:t.x,y:t.y,w:t.w,h:t.h});if(s){this.#Gp._open(this)}}}#Vd(t){switch(t.target.dataset.action){case"minimize":return this.so();case"restore":return this.Qa();case"maximize":return this.Za();case"close":return this.Rn()}}#Xp(t){if(t.target===t.currentTarget){this.#Vp?this.Qa():this.Za()}}#Jp(t){const s=t.target.classList;const i=s.contains("gsuiWindow-head")||s.contains("gsuiWindow-icon")||s.contains("gsuiWindow-title")||s.contains("gsuiWindow-headContent");if(i&&!this.#Vp){this.#_p.x=t.clientX;this.#_p.y=t.clientY;this.#qp.x=this.#qp.y=0;this.#Zp("dragging",true);this.#Gp._startMousemoving("move",this.#sg.bind(this),this.#ig.bind(this))}}#Qp(t){const s=t.target.dataset.dir;if(s){this.#_p.x=t.clientX;this.#_p.y=t.clientY;this.#qp.x=this.#qp.y=0;this.#Yp=this.#tg();this.#Zp("dragging",true);this.#Gp._startMousemoving(`${s}-resize`,this.#eg.bind(this,s),this.#ng.bind(this,s))}}#sg(t){const s=t.clientX-this.#_p.x;const i=t.clientY-this.#_p.y;const e=this.#qp;const n=this.#ag("nesw",s,i);e.x=s+n.x;e.y=i+n.y;this.#og(this.#ps.handlers.style,e);if(!Q.Ka(this.parentNode,"lowgraphics")){this.#og(this.#ps.wrap.style,e)}}#ig(){const{x:t,y:s}=this.rect;const i=this.#qp;this.#Zp("dragging",false);this.#rg(this.#ps.wrap.style);this.#rg(this.#ps.handlers.style);if(i.x||i.y){Q.En(this,{x:t+i.x,y:s+i.y});this.#Up.x=this.rect.x;this.#Up.y=this.rect.y}}#eg(t,s){const i=this.#qp;const e=s.clientX-this.#_p.x;const n=s.clientY-this.#_p.y;const a=this.#ag(t,e,n);i.x=e+a.x;i.y=n+a.y;this.#hg(t,i);this.#cg(this.#ps.handlers.style,t,i);if(!Q.Ka(this.parentNode,"lowgraphics")){this.#cg(this.#ps.wrap.style,t,i)}}#ng(t){const{x:s,y:i,w:e,h:n}=this.rect;const a=this.#qp;this.#Zp("dragging",false);this.#rg(this.#ps.wrap.style);this.#rg(this.#ps.handlers.style);if(a.x||a.y){switch(t){case"e":Q.En(this,{w:e+a.x,h:n});break;case"se":Q.En(this,{w:e+a.x,h:n+a.y});break;case"s":Q.En(this,{w:e,h:n+a.y});break;case"sw":Q.En(this,{w:e-a.x,h:n+a.y,x:s+a.x,y:i});break;case"w":Q.En(this,{w:e-a.x,h:n,x:s+a.x,y:i});break;case"nw":Q.En(this,{w:e-a.x,h:n-a.y,x:s+a.x,y:i+a.y});break;case"n":Q.En(this,{w:e,h:n-a.y,x:s,y:i+a.y});break;case"ne":Q.En(this,{w:e+a.x,h:n-a.y,x:s,y:i+a.y});break}}}#Zp(t,s){this.classList.toggle(`gsuiWindow-${t}`,s)}#tg(){return this.#ps.head.getBoundingClientRect().height}#ag(t,s,i){const e=this.rect;const n=t.includes("w");const a=t.includes("n");const o=t.includes("e");const r=t.includes("s");const h=n?e.x+s:e.x;const c=a?e.y+i:e.y;const l=this.#Gp.getBoundingClientRect();const u=[...this.#Gp._arrWindows,{dataset:{},rect:{x:0,y:0,w:l.width,h:l.height}}];let d=0;let p=0;if(o&&n){const t=this.#lg(u,"x",h+e.w,2,0);const s=this.#lg(u,"x",h,0,2);if(t||s){d=Math.abs(t||Infinity)<Math.abs(s||Infinity)?t:s}}else if(o){d=this.#lg(u,"x",h+e.w+s,2,0)}else{d=this.#lg(u,"x",h,0,2)}if(r&&a){const t=this.#lg(u,"y",c+e.h,2,0);const s=this.#lg(u,"y",c,0,2);if(t||s){p=Math.abs(t||Infinity)<Math.abs(s||Infinity)?t:s}}else if(r){p=this.#lg(u,"y",c+e.h+i,2,0)}else{p=this.#lg(u,"y",c,0,2)}return{x:d,y:p}}#lg(t,s,i,e,n){let a=Infinity;return t.reduce(((t,o)=>{if(o.dataset.id!==this.dataset.id&&(!o.Ja||o.Ja())){const t=o.rect;const r=t[s];const h=r-e-i;const c=r+(s==="x"?t.w:t.h)+n-i;const l=Math.abs(h);const u=Math.abs(c);const d=Math.min(l,u);if(d<4&&d<a){a=d;return l<u?h:c}}return t}),0)}#rg(t){t.top=t.left=t.right=t.bottom=0}#og(t,s){const i=parseFloat(this.style.top);const e=parseFloat(this.style.left);const n=-e-this.clientWidth+(3*24+10);const a=-i;const o=this.parentNode.clientWidth-e-24-10;const r=this.parentNode.clientHeight-i-24;s.y=Math.max(a,Math.min(s.y,r));s.x=Math.max(n,Math.min(s.x,o));t.top=`${s.y}px`;t.left=`${s.x}px`;t.right=`${-s.x}px`;t.bottom=`${-s.y}px`}#hg(t,s){const i=this.rect.w-this.#zp;const e=this.rect.h-this.#Yp-this.#Rp;switch(t){case"n":if(e-s.y<0){s.y=e}break;case"s":if(e+s.y<0){s.y=-e}break;case"w":if(i-s.x<0){s.x=i}break;case"e":if(i+s.x<0){s.x=-i}break;case"nw":if(e-s.y<0){s.y=e}if(i-s.x<0){s.x=i}break;case"ne":if(e-s.y<0){s.y=e}if(i+s.x<0){s.x=-i}break;case"sw":if(e+s.y<0){s.y=-e}if(i-s.x<0){s.x=i}break;case"se":if(e+s.y<0){s.y=-e}if(i+s.x<0){s.x=-i}break}}#cg(t,s,i){switch(s){case"n":t.top=`${i.y}px`;break;case"s":t.bottom=`${-i.y}px`;break;case"w":t.left=`${i.x}px`;break;case"e":t.right=`${-i.x}px`;break;case"nw":t.left=`${i.x}px`;t.top=`${i.y}px`;break;case"ne":t.right=`${-i.x}px`;t.top=`${i.y}px`;break;case"sw":t.left=`${i.x}px`;t.bottom=`${-i.y}px`;break;case"se":t.right=`${-i.x}px`;t.bottom=`${-i.y}px`;break}}}Object.freeze(_t);customElements.define("gsui-window",_t);"use strict";class Yt{#ug=null;#dg="";#pg=[];#x=null;#gg=null;#mg=null;#fg=this.#bg.bind(this);#wg=this.#vg.bind(this);constructor(t){this.#ug=t;this.#gg=t.querySelectorAll(".TextGlitch-clip");this.#mg=t.querySelectorAll(".TextGlitch-word");Object.seal(this);this.setTexts(["GridSound","gRIDsOUND","&<:]$+\\#)","6/1)20^?}","9-!>5θnu]"])}on(){if(!this.#x){this.#fg()}}off(){clearTimeout(this.#x);this.#x=null;this.#wg()}setTexts([t,...s]){this.#dg=t;this.#pg=s}#bg(){this.#yg();setTimeout(this.#wg,50+Math.random()*200);this.#x=setTimeout(this.#fg,250+Math.random()*400)}#yg(){const t=this.#kg(.2);const s=this.#kg(.2);this.#gg.forEach((t=>{const s=this.#kg(.06);const i=this.#kg(0);t.style.transform=`translate(${s}em, ${i}em)`}));this.#gg[0].style.clipPath=`inset( 0 0 ${.6+t}em 0 )`;this.#gg[1].style.clipPath=`inset( ${.4-t}em 0 ${.3-s}em 0 )`;this.#gg[2].style.clipPath=`inset( ${.7+s}em 0 -1em 0 )`;this.#$g(this.#Og());this.#ug.classList.add("TextGlitch-blended")}#vg(){this.#gg.forEach((t=>{t.style.clipPath=t.style.transform=""}));this.#$g(this.#dg);this.#ug.classList.remove("TextGlitch-blended")}#Og(){const t=Array.from(this.#dg);for(let s=0;s<5;++s){const s=this.#xg(this.#dg.length);t[s]=this.#pg[this.#xg(this.#pg.length)][s]}return t.join("")}#kg(t){return Math.random()*t-t/2}#xg(t){return Math.random()*t|0}#$g(t){this.#mg.forEach((s=>s.textContent=t))}}"use strict";document.addEventListener("gsuiEvents",(({detail:t})=>{console.warn(`uncatched gsuiEvent: [${t.component}][${t.eventName}]`,t.args)}));new Promise((t=>{const s=document.querySelector("#splashScreen");const i=document.querySelector("#splashScreen-title");const e=document.querySelector("#splashScreen-start");const n=document.querySelector("#splashScreen-form");const a=document.querySelector("[ name='cookies' ]");const o=new Yt(i);s.classList.add("loaded");if(window.CSS&&CSS.supports("clip-path: inset(0 1px 2px 3px)")){o.on()}a.checked=localStorage.getItem("cookieAccepted")==="1";n.onchange=()=>{e.disabled=!a.checked};e.onclick=()=>{o.off();s.classList.add("starting");localStorage.setItem("cookieAccepted","1");setTimeout(t,100)};n.onchange()})).then((()=>Q.ja("/assets/gswaPeriodicWavesList-v1.js"))).then((()=>Q.ja("/assets/gsuiLibrarySamples-v1.js"))).then((()=>{const t=new $;Q.En(t.rootElement,"version",document.querySelector("#splashScreen-version").textContent);t.getDAWCore().ni();t.newComposition()})).then((()=>{const t=document.querySelector("#splashScreen");t.classList.add("started");setTimeout((()=>t.remove()),800)}));
</script>
</body>
</html>
